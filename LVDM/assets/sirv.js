/*
    @license
    Sirv v3.9.1 (ba425205)
    Copyright 2022 Sirv Limited
    https://sirv.com
*/

if (!window.Sirv) { (function() {!function(){var t={},e=function(i,s){Array.isArray(i)||(i=[i]);const n=[];return i.forEach((i=>{t[i]?(t[i].result||(t[i].result=e(t[i].deps,t[i].cb)),n.push(t[i].result)):n.push(null)})),"function"==typeof s?s.apply(this,n):s};window.Sirv={require:e,define:function(e,i,s){s||(s=i,i=null),t[e]={deps:i,cb:s,result:null}}}}(),Sirv.define("magicJS",["bHelpers"],(t=>{let e,s;return e=s=function(){let t=window,e=t.undefined,i=document;const s=new WeakMap,n={UUID:0,storage:{},$uuid:t=>t.$J_UUID||(t.$J_UUID=++o.UUID),getStorage:t=>o.storage[t]||(o.storage[t]={}),$false:()=>!1,$true:()=>!0,stylesId:"mjs-"+Math.floor(Math.random()*(new Date).getTime()),defined:t=>t!=e,typeOf:e=>{if(!o.defined(e))return!1;if(e.$J_TYPE)return e.$J_TYPE;if(e.nodeType){if(1===e.nodeType)return"element";if(3===e.nodeType)return"textnode"}if(e===t)return"window";if(e===i)return"document";if(e instanceof t.Array)return"array";if(e instanceof t.Function)return"function";if(e instanceof t.String)return"string";if(o.browser.trident){if(o.defined(e.cancelBubble))return"event"}else if(e===t.event||e.constructor==t.Event||e.constructor==t.MouseEvent||e.constructor==t.UIEvent||e.constructor==t.KeyboardEvent||e.constructor==t.KeyEvent)return"event";return e instanceof t.Date?"date":e instanceof t.RegExp?"regexp":e.length&&e.item?"collection":e.length&&e.callee?"arguments":typeof e},detach:t=>{let e;switch(o.typeOf(t)){case"object":e={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=o.detach(t[i]));break;case"array":e=[];for(let i=0,s=t.length;i<s;i++)e[i]=o.detach(t[i]);break;default:return t}return o.$(e)},$:t=>{let e=t;switch(o.typeOf(t)){case"string":{const s=i.getElementById(t);e=o.defined(s)?o.$(s):null;break}case"window":case"document":e=s.has(t)?s.get(t):new y(t);break;case"element":e=s.has(t)?s.get(t):new b(t);break;case"event":e=new o.Events.MagicEvent(t)}return e},$new:(t,e,s)=>o.$(i.createElement(t)).setProps(e||{}).setCss(s||{}),addCSS:(t,e,s,n)=>{let a=i.head||i.body;n&&(a=r(n).node||n),s||(s=o.stylesId);let h=r(a.querySelector("#"+s));h||(h=o.$new("style").attr("id",s).attr("type","text/css"),a.insertBefore(h.node,a.firstChild));let l=h.node.sheet;l||(l=h.node.styleSheet),"string"!==o.typeOf(e)&&(e=Object.entries(e).map((t=>t[0]+":"+t[1])).join(";"));let c=-1;return c=l.insertRule?l.insertRule(t+" {"+e+"}",l.cssRules.length):l.addRule(t,e),c},removeCSS:(t,e)=>{if("element"!==o.typeOf(i))return;const i=o.$(t),s=i.sheet||i.styleSheet;s.deleteRule?s.deleteRule(e):s.removeRule&&s.removeRule(e)},generateUUID:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})).toUpperCase(),getAbsoluteURL:(()=>{let t;return e=>(t||(t=i.createElement("a")),t.setAttribute("href",e),("!!"+t.href).replace("!!",""))})(),getHashCode:t=>{let e=0;const i=t.length;for(let s=0;s<i;++s)e=31*e+t.charCodeAt(s),e%=4294967296;return e},camelize:t=>t.replace(/-\D/g,(t=>t.charAt(1).toUpperCase())),dashize:function(t){return t.replace(/[A-Z]/g,(t=>"-"+t.charAt(0).toLowerCase()))},stringHas:(t,e,i)=>((i=i||"")+t+i).indexOf(i+e+i)>-1},o=n,r=o.$,a={},h=navigator.userAgent.toLowerCase(),l=h.match(/(webkit|gecko|trident)\/(\d+\.?\d*)/i),c=h.match(/(edge|opr)\/(\d+\.?\d*)/i)||h.match(/(crios|chrome|safari|firefox|opera|opr)\/(\d+\.?\d*)/i),d=h.match(/version\/(\d+\.?\d*)/i);o.browser=new class{constructor(){this._magicClasses=[],this._features={fullScreen:!!(i.fullscreenEnabled||i.msFullscreenEnabled||i.webkitFullScreenEnabled||i.webkitFullscreenEnabled),cssFilters:!1},this._touchScreen="ontouchstart"in t||t.DocumentTouch&&i instanceof DocumentTouch||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,this._mobile=!!h.match(/(android|bb\d+|meego).+|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/),this._engine=(()=>{let s="unknown";return l&&l[1]?s=l[1].toLowerCase():t.ActiveXObject?s="trident":i.getBoxObjectFor!==e||null!==t.mozInnerScreenY?s="gecko":null===t.WebKitPoint&&navigator.taintEnabled||(s="webkit"),s})(),this._chrome=!1,this._webkit="webkit"===this._engine,this._gecko="gecko"===this._engine,this._trident="trident"===this._engine,this._androidBrowser=!1,this._version=l&&l[2]?parseFloat(l[2]):0,this._uaName=c&&c[1]?c[1].toLowerCase():"",this._uaVersion=c&&c[2]?parseFloat(c[2]):0,this._cssPrefix="",this._cssDomPrefix="",this._domPrefix="",this._ieMode=0,this._platform=(()=>{let t;return h.match(/ip(?:ad|od|hone)/)?t="ios":(t=h.match(/(?:webos|android)/),t||(t=navigator.platform.match(/mac|win|linux/i),t||(t=["other"])),t=t[0].toLowerCase()),t})(),this._backCompat=i.compatMode&&"backcompat"===i.compatMode.toLowerCase(),this._scrollbarsWidth=0,this._ready=!1,this.calculate()}calculate(){switch(this._engine){case"trident":this._version||(this._version=t.XMLHttpRequest?3:2);break;case"gecko":this._version=c&&c[2]?parseFloat(c[2]):0}c&&"crios"===c[1]&&(this._uaName="chrome"),t.chrome&&(this._chrome=!0),"safari"===this._uaName&&d&&d[1]&&(this._uaVersion=parseFloat(d[1])),"android"===this._platform&&this._webkit&&d&&d[1]&&(this._androidBrowser=!0);const s={gecko:["-moz-","Moz","moz"],webkit:["-webkit-","Webkit","webkit"],trident:["-ms-","ms","ms"]}[this._engine]||["","",""];this._cssPrefix=s[0],this._cssDomPrefix=s[1],this._domPrefix=s[2],this._ieMode=(()=>this._trident&&i.documentMode?i.documentMode:e)(),!this._mobile&&"mac"===this._platform&&this._touchScreen&&(this._mobile=!0,this._platform="ios"),this._magicClasses.push(this._platform+"-magic"),this._mobile&&this._magicClasses.push("mobile-magic"),this._androidBrowser&&this._magicClasses.push("android-browser-magic"),this._ieMode&&(this._uaName="ie",this._uaVersion=this._ieMode,this._magicClasses.push("ie"+this._ieMode+"-magic")),this._magicClasses.push("svg-magic");const n=(i.documentElement.className||"").match(/\S+/g)||[];i.documentElement.className=n.concat(this._magicClasses).join(" ");try{i.documentElement.setAttribute("data-magic-ua",o.browser.uaName),i.documentElement.setAttribute("data-magic-ua-ver",o.browser.uaVersion),i.documentElement.setAttribute("data-magic-engine",o.browser.engine),i.documentElement.setAttribute("data-magic-engine-ver",o.browser.version)}catch(t){}t.navigator.pointerEnabled||["Down","Up","Move","Over","Out"].forEach((e=>{const i="pointer"+e.toLowerCase();"edge"===this._uaName?a[i]=i:t.navigator.msPointerEnabled?a[i]="MSPointer"+e:a[i]=-1}))}get features(){return this._features}get touchScreen(){return this._touchScreen}get mobile(){return this._mobile}get engine(){return this._engine}get version(){return this._version}get uaName(){return this._uaName}get uaVersion(){return this._uaVersion}get cssPrefix(){return this._cssPrefix}get cssDomPrefix(){return this._cssDomPrefix}get domPrefix(){return this._domPrefix}get ieMode(){return this._ieMode}get platform(){return this._platform}get backCompat(){return this._backCompat}get scrollbarsWidth(){return this._scrollbarsWidth}get doc(){return i.compatMode&&"backcompat"===i.compatMode.toLowerCase()?i.body:i.documentElement}get ready(){return this._ready}get chrome(){return this._chrome}get webkit(){return this._webkit}get gecko(){return this._gecko}get trident(){return this._trident}get androidBrowser(){return this._androidBrowser}onready(){if(!this._ready){this._ready=!0;try{const t=o.$new("div").setCss({width:100,height:100,overflow:"scroll",position:"absolute",top:-9999}).appendTo(i.body);this._scrollbarsWidth=t.node.offsetWidth-t.node.clientWidth,t.remove()}catch(t){}try{const t=o.$new("div");t.node.style.cssText=o.dashize("filter")+":blur(2px);",this._features.cssFilters=!!t.node.style.length}catch(t){}this._features.cssFilters||o.$(i.documentElement).addClass("no-cssfilters-magic"),o.$(i).callEvent("domready")}}},(()=>{const t={capable:o.browser.features.fullScreen,enabled:()=>!!(i.fullscreenElement||i[o.browser.domPrefix+"FullscreenElement"]||i.fullScreen||i.webkitIsFullScreen||i[o.browser.domPrefix+"FullScreen"]),request:(e,s)=>{s||(s={}),t.capable&&!s.windowFullscreen?(t.onchange=e=>{t.enabled()?s.onEnter&&s.onEnter():(o.$(i).removeEvent(t.changeEventName,t.onchange),s.onExit&&s.onExit())},o.$(i).addEvent(t.changeEventName,t.onchange),t.onerror=e=>{s.fallback&&s.fallback(),o.$(i).removeEvent(t.errorEventName,t.onerror)},o.$(i).addEvent(t.errorEventName,t.onerror),(t=>{let e=t.requestFullscreen||t[o.browser.domPrefix+"RequestFullscreen"]||t[o.browser.domPrefix+"RequestFullScreen"];e||(e=()=>{}),e.call(t)})(r(e).node)):s.fallback&&s.fallback()},cancel:(()=>{let t=i.exitFullscreen||i.cancelFullScreen||i[o.browser.domPrefix+"ExitFullscreen"]||i[o.browser.domPrefix+"CancelFullScreen"];return t||(t=()=>{}),t})(),changeEventName:(()=>{let t;return i.msExitFullscreen?t="MSFullscreenChange":(t=i.exitFullscreen?"":o.browser.domPrefix,t+="fullscreenchange"),t})(),errorEventName:(()=>{let t;return i.msExitFullscreen?t="MSFullscreenError":(t=i.exitFullscreen?"":o.browser.domPrefix,t+="fullscreenerror"),t})(),prefix:o.browser.domPrefix,activeElement:null};o.browser.fullScreen=t})();const p=/\S+/g,u=/^(border(Top|Bottom|Left|Right)Width)|((padding|margin)(Top|Bottom|Left|Right))$/,g={},m={fontWeight:!0,lineHeight:!0,opacity:!0,zIndex:!0,zoom:!0},f=t=>Array.isArray(t)?t:"string"==typeof t&&t.match(p)||[],v=t=>{if(!(t in i.documentElement.style)){const e=o.browser.cssDomPrefix+t.charAt(0).toUpperCase()+t.slice(1);if(e in i.documentElement.style)return e}return t};o.normalizeCSS=v;class S{constructor(t){this.node=t,this.$J_UUID=++o.UUID,this.$J_TYPE=null,this.$J_EXT=()=>{},s.set(this.node,this)}fetch(t,i){const s=o.getStorage(this.$J_UUID);let n=s[t],r=null;return i!==e&&n===e&&(s[t]=i,n=s[t]),o.defined(n)&&(r=n),r}store(t,e){return o.getStorage(this.$J_UUID)[t]=e,this}del(t){return delete o.getStorage(this.$J_UUID)[t],this}addEvent(e,i,s,n){if("array"===o.typeOf(e))return e.forEach((t=>{this.addEvent(t,i,s,n)})),this;if(!(e=a[e]||e)||!i||"string"!==o.typeOf(e)||"function"!==o.typeOf(i))return this;if("domready"===e&&o.browser.ready)return i(),this;s=parseInt(s||50,10),i.$J_EUID||(i.$J_EUID=Math.floor(Math.random()*+new Date));const r=this.fetch("_EVENTS_",{});let h=r[e];h||(h=[],r[e]=h,o.Events.handlers[e]?o.Events.handlers[e].add.call(this,n):(h.handle=i=>{i=Object.assign(i||t.e,{$J_TYPE:"event"}),this.callEvent(e,o.$(i))},this.node[o._event_add_](o._event_prefix_+e,h.handle,!1)));const l={type:e,fn:i,priority:s,euid:i.$J_EUID};return h.push(l),h.sort(((t,e)=>t.priority-e.priority)),this}removeEvent(...t){const e=this.fetch("_EVENTS_",{});let i=t[0];const s=t.length>1?t[1]:-100;if("array"===o.typeOf(i))return i.forEach((t=>{this.removeEvent(t,s)})),this;if(i=a[i]||i,!i||"string"!==o.typeOf(i)||!e||!e[i])return this;const n=e[i]||[];for(let t=0;t<n.length;t++){const e=n[t];(-100===s||s&&s.$J_EUID===e.euid)&&n.splice(t--,1)}return 0===n.length&&(o.Events.handlers[i]?o.Events.handlers[i].remove.call(this):this.node[o._event_del_](o._event_prefix_+i,n.handle,!1),delete e[i]),this}callEvent(t,i){const s=this.fetch("_EVENTS_",{});if((t=a[t]||t)&&"string"===o.typeOf(t)&&s&&s[t]){try{i&&i.type||(i=Object.assign(i||{},{type:t}))}catch(t){}i.timeStamp===e&&(i.timeStamp=+new Date);const n=s[t]||[];for(let t=0;t<n.length&&(!i.isQueueStopped||!i.isQueueStopped());t++)n[t].fn.call(this,i)}else;}raiseEvent(t,e){const s="domready"!==t;let n,o=this;return t=a[t]||t,s?(o===i&&i.createEvent&&!o.dispatchEvent&&(o=i.documentElement),i.createEvent?(n=i.createEvent(t),n.initEvent(e,!0,!0)):(n=i.createEventObject(),n.eventType=t),i.createEvent?o.dispatchEvent(n):o.fireEvent("on"+e,n),n):(this.callEvent(t),this)}clearEvents(){const t=this.fetch("_EVENTS_");return t?(Object.keys(t).forEach((t=>{this.removeEvent(t)})),this.del("_EVENTS_"),this):this}}class b extends S{constructor(t){super(t),this.$J_TYPE="magicjs-element"}requestFullScreen(){o.browser.fullScreen.capable&&!i.requestFullScreen?o.browser.fullScreen.request(this.node):this.node.requestFullScreen(this.node)}addClass(t){const e=f(t);return e.length&&this.node.classList.add(...e),this}removeClass(t){const e=f(t);return e.length&&this.node.classList.remove(...e),this}getCss(e){const i=o.camelize(e);g[i]||(g[i]=v(i)),e=g[i];let s=((e,i)=>{const s=t.getComputedStyle(e,null);return s?s.getPropertyValue(i)||s[i]:null})(this.node,e);if("auto"===s&&(s=null),null!==s){if("opacity"===e)return o.defined(s)?parseFloat(s):1;u.test(e)&&(s=parseInt(s,10)?s:"0px")}return s}setCssProp(t,e){const i=o.camelize(t);try{g[i]||(g[i]=v(i)),t=g[i],this.node.style[t]=e+("number"!==o.typeOf(e)||m[i]?"":"px")}catch(t){}return this}setCss(t){return Object.entries(t).forEach((t=>{this.setCssProp(...t)})),this}getStyles(...t){return Object.fromEntries(t.map((t=>[t,this.getCss(t)])))}setProps(t){return Object.entries(t).forEach((t=>{t[1]=""+t[1],"class"===t[0]?this.addClass(t[1]):this.node.setAttribute(...t)})),this}get size(){return{width:this.node.offsetWidth,height:this.node.offsetHeight}}render(){return this.size}getInnerSize(t){const e=this.size;return e.width-=parseFloat(this.getCss("border-left-width")||0)+parseFloat(this.getCss("border-right-width")||0),e.height-=parseFloat(this.getCss("border-top-width")||0)+parseFloat(this.getCss("border-bottom-width")||0),t||(e.width-=parseFloat(this.getCss("padding-left")||0)+parseFloat(this.getCss("padding-right")||0),e.height-=parseFloat(this.getCss("padding-top")||0)+parseFloat(this.getCss("padding-bottom")||0)),e}get scroll(){return{top:this.node.scrollTop,left:this.node.scrollLeft}}get fullScroll(){let t=this.node;const e={top:0,left:0};do{e.left+=t.scrollLeft||0,e.top+=t.scrollTop||0,t=t.parentNode}while(t);return e}get position(){const t=this.node.getBoundingClientRect(),e=o.$(i).scroll,s=o.browser.doc;return{top:t.top+e.y-s.clientTop,left:t.left+e.x-s.clientLeft}}get rect(){const t=this.position,e=this.size;return{top:t.top,bottom:t.top+e.height,left:t.left,right:t.left+e.width}}changeContent(t){try{this.node.innerHTML=t}catch(e){this.node.innerText=t}return this}remove(){let t=this;return this.node.parentNode&&(t=o.$(this.node.parentNode.removeChild(this.node))),t}kill(){return Array.from(this.node.childNodes).forEach((t=>{3!==t.nodeType&&8!==t.nodeType&&o.$(t).kill()})),this.remove(),this.clearEvents(),this.$J_UUID&&(o.storage[this.$J_UUID]=null,delete o.storage[this.$J_UUID]),null}append(t,e="bottom"){const i=this.node.firstChild;return t=o.$(t),"top"===e&&i?this.node.insertBefore(t.node,i):this.node.appendChild(t.node||t),this}appendTo(t,e){return o.$(t).append(this,e),this}get tagName(){return this.node.tagName.toLowerCase()}attr(t,e){let i=this;return o.defined(e)?this.node.setAttribute(t,e):(i=this.node.getAttribute(t),i&&"string"===o.typeOf(i)&&""!==i.trim()||(i=null)),i}removeAttr(t){return this.node.removeAttribute(t),this}hasClass(t){if(this.node.classList)return this.node.classList.contains(t);let e=this.node.className;return this.node.className instanceof SVGAnimatedString&&(e=this.node.className.baseVal),!o.stringHas(t||""," ")&&o.stringHas(e||""," ")}hasAttribute(t){return this.node.hasAttribute(t)}}class y extends S{constructor(e){super(e);let i="magicjs-document";e===t&&(i="magicjs-window"),this.$J_TYPE=i}get size(){return o.browser.touchScreen?{width:t.innerWidth,height:t.innerHeight}:{width:o.browser.doc.clientWidth,height:o.browser.doc.clientHeight}}get scroll(){return{x:t.pageXOffset||o.browser.doc.scrollLeft,y:t.pageYOffset||o.browser.doc.scrollTop}}get fullSize(){const t=this.size;return{width:Math.max(o.browser.doc.scrollWidth,t.width),height:Math.max(o.browser.doc.scrollHeight,t.height)}}}o.Events={};o.Events.MagicEvent=class{constructor(t){this.oe=t,this.$J_TYPE="event",this.isQueueStopped=o.$false,this.type=this.oe.type,this.timeStamp=this.oe.timeStamp,this.propertyName=this.oe.propertyName,this.pointerType=this.oe.pointerType}get originEvent(){return this.oe}stop(){return this.stopDistribution().stopDefaults()}stopDistribution(){return this.oe.stopPropagation?this.oe.stopPropagation():this.oe.cancelBubble=!0,this}stopDefaults(){return this.oe.preventDefault?this.oe.preventDefault():this.oe.returnValue=!1,this}stopQueue(){return this.isQueueStopped=o.$true,this}get clientXY(){let t,e={x:0,y:0};return t=/touch/i.test(this.type)?this.oe.changedTouches[0]:this.oe,o.defined(t)&&(e={x:t.clientX,y:t.clientY}),e}get pageXY(){let t=this.oe;return/touch/i.test(this.type)&&(t=this.oe.changedTouches[0]),o.defined(t)?{x:t.pageX||t.clientX+o.browser.doc.scrollLeft,y:t.pageY||t.clientY+o.browser.doc.scrollTop}:{x:0,y:0}}get target(){let t=this.oe.target;for(t||(t=this.oe.srcElement);t&&3===t.nodeType;)t=t.parentNode;return t}get related(){let t=null;switch(this.type){case"mouseover":case"pointerover":case"MSPointerOver":t=this.oe.relatedTarget,t||(t=this.oe.fromElement);break;case"mouseout":case"pointerout":case"MSPointerOut":t=this.oe.relatedTarget,t||(t=this.oe.toElement);break;default:return t}try{for(;t&&3===t.nodeType;)t=t.parentNode}catch(e){t=null}return t}get button(){let t=this.oe.which;return this.oe.which||this.oe.button===e||(t=1&this.oe.button?1:2&this.oe.button?3:4&this.oe.button?2:0),t}isTouchEvent(){return this.oe.pointerType&&("touch"===this.oe.pointerType||this.oe.pointerType===this.oe.MSPOINTER_TYPE_TOUCH)||/touch/i.test(this.type)}isPrimaryTouch(){return this.oe.pointerType?("touch"===this.oe.pointerType||this.oe.MSPOINTER_TYPE_TOUCH===this.oe.pointerType)&&this.oe.isPrimary:this.oe instanceof t.TouchEvent&&(1===this.oe.changedTouches.length&&(!this.oe.targetTouches.length||this.oe.targetTouches[0].identifier===this.oe.changedTouches[0].identifier))}get primaryTouch(){let e=null;return this.oe.pointerType?!this.oe.isPrimary||"touch"!==this.oe.pointerType&&this.oe.MSPOINTER_TYPE_TOUCH!==this.oe.pointerType||(e=this.oe):this.oe instanceof t.TouchEvent&&(e=this.oe.changedTouches[0]),e}get primaryTouchId(){let e=null;return this.oe.pointerType?!this.oe.isPrimary||"touch"!==this.oe.pointerType&&this.oe.MSPOINTER_TYPE_TOUCH!==this.oe.pointerType||(e=this.oe.pointerId):this.oe instanceof t.TouchEvent&&(e=this.oe.changedTouches[0].identifier),e}},o._event_add_="addEventListener",o._event_del_="removeEventListener",o._event_prefix_="",i.addEventListener||(o._event_add_="attachEvent",o._event_del_="detachEvent",o._event_prefix_="on");return o.Events.Custom=class{constructor(t){this.$J_TYPE="event.custom",this.magicEvent="event"===t.$J_TYPE?t:t.magicEvent,this.type=this.magicEvent.type,this._target=null,this.x=this.magicEvent.oe.x,this.y=this.magicEvent.oe.y,this.timeStamp=this.magicEvent.oe.timeStamp,this.relatedTarget=this.magicEvent.related,this.isQueueStopped=this.magicEvent.isQueueStopped,this.events=[]}get originEvent(){return this.magicEvent.originEvent}pushToEvents(t){const e=t;this.events.push(e)}stop(){return this.stopDistribution().stopDefaults()}stopDistribution(){return this.events.forEach((t=>{try{t.stopDistribution()}catch(t){}})),this}stopDefaults(){return this.events.forEach((t=>{try{t.stopDefaults()}catch(t){}})),this}stopQueue(){return this.isQueueStopped=o.$true,this.magicEvent.stopQueue(),this}get clientXY(){return{x:this.clientX||this.magicEvent.oe.clientX,y:this.clientY||this.magicEvent.oe.clientY}}get pageXY(){return{x:this.x,y:this.y}}get target(){return this._target||this.magicEvent.oe.target}get related(){return this.relatedTarget}get button(){return this.magicEvent.button}get originalTarget(){return this.events.length>0?this.events[0].target:e}isTouchEvent(){return this.magicEvent.isTouchEvent()}isPrimaryTouch(){return this.magicEvent.isPrimaryTouch()}get primaryTouch(){return this.magicEvent.primaryTouch}get primaryTouchId(){return this.magicEvent.primaryTouchId}},o.Events.handlers={},(e=>{"interactive"===i.readyState||"complete"===i.readyState?setTimeout((()=>e.browser.onready()),0):(e.$(i).addEvent("readystatechange",(t=>{"interactive"!==t.target.readyState&&"complete"!==t.target.readyState||e.browser.onready()})),e.$(i).addEvent("DOMContentLoaded",(()=>{e.browser.onready()})),e.$(t).addEvent("load",(()=>{e.browser.onready()})))})(n),(t=>{class e extends t.Events.Custom{constructor(t,e){super(t);const i=t.pageXY;this.type="btnclick",this.x=i.x,this.y=i.y,this.clientX=t.oe.clientX,this.clientY=t.oe.clientY,this._target=e.node,this.pushToEvents(t)}}const s={threshold:300,button:1},n=function(t){t.stopDefaults()},o=function(t){const s=this.fetch("event:btnclick:options");if("dblclick"!==t.type&&t.button!==s.button)return;if(this.fetch("event:btnclick:ignore"))return void this.del("event:btnclick:ignore");let n;if("mousedown"===t.type)n=new e(t,this),this.store("event:btnclick:btnclickEvent",n);else if("mouseup"===t.type){if(n=this.fetch("event:btnclick:btnclickEvent"),!n)return;const e=t.pageXY;this.del("event:btnclick:btnclickEvent"),n.pushToEvents(t),t.timeStamp-n.timeStamp<=s.threshold&&Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))<=5&&this.callEvent("btnclick",n),r(i).callEvent("mouseup",t)}else"dblclick"===t.type&&(n=new e(t,this),this.callEvent("btnclick",n))},a={add:function(e){this.store("event:btnclick:options",Object.assign(t.detach(s),e||{})),this.addEvent(["mousedown","mouseup"],o,1).addEvent("click",n,1)},remove:function(){this.removeEvent(["mousedown","mouseup"],o).removeEvent("click",n)}};t.Events.handlers.btnclick=a})(n),(t=>{class e extends t.Events.Custom{constructor(t,e,i){super(t);const s=t.pageXY;this.x=s.x,this.y=s.y,this.type="mousedrag",this.clientX=t.clientX,this.clientY=t.clientY,this._target=e.node,this.state=i,this.dragged=!1,this.pushToEvents(t)}}const s=function(t){if(1!==t.button)return;const i=new e(t,this,"dragstart");this.store("event:mousedrag:dragstart",i)},n=function(t){let i=this.fetch("event:mousedrag:dragstart");i&&(t.stopDefaults(),i=new e(t,this,"dragend"),this.del("event:mousedrag:dragstart"),this.callEvent("mousedrag",i))},o=function(t){let i=this.fetch("event:mousedrag:dragstart");i&&(t.stopDefaults(),i.dragged||(i.dragged=!0,this.callEvent("mousedrag",i)),i=new e(t,this,"dragmove"),this.callEvent("mousedrag",i))},a={add:function(){const t=o.bind(this),e=n.bind(this);this.addEvent("mousedown",s,1).addEvent("mouseup",n,1),r(i).addEvent("mousemove",t,1).addEvent("mouseup",e,1),this.store("event:mousedrag:listeners:document:move",t),this.store("event:mousedrag:listeners:document:end",e)},remove:function(){const t=()=>{};this.removeEvent("mousedown",s).removeEvent("mouseup",n),r(i).removeEvent("mousemove",this.fetch("event:mousedrag:listeners:document:move")||t).removeEvent("mouseup",this.fetch("event:mousedrag:listeners:document:end")||t),this.del("event:mousedrag:listeners:document:move").del("event:mousedrag:listeners:document:end")}};t.Events.handlers.mousedrag=a})(n),(t=>{class e extends t.Events.Custom{constructor(t,e){super(t);const i=t.pageXY;this.x=i.x,this.y=i.y,this.type="dblbtnclick",this.clientX=t.clientX,this.clientY=t.clientY,this._target=e.node,this.timedout=!1,this.tm=null,this.pushToEvents(t)}}const i={threshold:200},s=function(i){let s=this.fetch("event:dblbtnclick:event");if(s)clearTimeout(s.tm),this.del("event:dblbtnclick:event"),s.timedout||(s.pushToEvents(i),i.stopQueue().stop(),this.callEvent("dblbtnclick",s));else{const n=this.fetch("event:dblbtnclick:options");s=new e(i,this),s.tm=setTimeout((()=>{s.timedout=!0,i.isQueueStopped=t.$false,this.callEvent("btnclick",i),this.del("event:dblbtnclick:event")}),n.threshold+10),this.store("event:dblbtnclick:event",s),i.stopQueue()}},n={add:function(e){this.store("event:dblbtnclick:options",Object.assign(t.detach(i),e||{})),this.addEvent("btnclick",s,1)},remove:function(){this.removeEvent("btnclick",s)}};t.Events.handlers.dblbtnclick=n})(n),(t=>{class e extends t.Events.Custom{constructor(t,e){super(t);const i=t.primaryTouch;this.type="tap",this.id=i.pointerId||i.identifier,this.x=i.pageX,this.y=i.pageY,this.pageX=i.pageX,this.pageY=i.pageY,this.clientX=i.clientX,this.clientY=i.clientY,this._target=e.node,this.pushToEvents(t)}get button(){return 0}}const i=function(t){t.stopDefaults()},s=function(t){t.isPrimaryTouch()?(this.store("event:tap:event",new e(t,this)),this.store("event:btnclick:ignore",!0)):this.del("event:tap:event")},n=function(t){const e=this.fetch("event:tap:event");e&&t.isPrimaryTouch()&&(this.del("event:tap:event"),e.id===t.primaryTouchId&&t.timeStamp-e.timeStamp<=200&&Math.sqrt(Math.pow(t.primaryTouch.pageX-e.x,2)+Math.pow(t.primaryTouch.pageY-e.y,2))<=10&&(this.del("event:btnclick:btnclickEvent"),t.stop(),e.pushToEvents(t),this.callEvent("tap",e)))},o={add:function(t){this.addEvent(["touchstart","pointerdown"],s,1).addEvent(["touchend","pointerup"],n,1).addEvent("click",i,1)},remove:function(){this.removeEvent(["touchstart","pointerdown"],s).removeEvent(["touchend","pointerup"],n).removeEvent("click",i)}};t.Events.handlers.tap=o})(n),(t=>{class e extends t.Events.Custom{constructor(t,e){super(t),this.type="dbltap",this.x=t.x,this.y=t.y,this.clientX=t.clientX,this.clientY=t.clientY,this._target=e.node,this.timedout=!1,this.tm=null,this.pushToEvents(t)}}const i={threshold:300},s=function(i){let s=this.fetch("event:dbltap:event");if(s)clearTimeout(s.tm),this.del("event:dbltap:event"),s.timedout||(s.pushToEvents(i),i.stopQueue().stop(),this.callEvent("dbltap",s));else{const n=this.fetch("event:dbltap:options");s=new e(i,this),s.tm=setTimeout((()=>{s.timedout=!0,i.isQueueStopped=t.$false,this.callEvent("tap",i)}),n.threshold+10),this.store("event:dbltap:event",s),i.stopQueue()}},n={add:function(e){this.store("event:dbltap:options",Object.assign(t.detach(i),e||{})),this.addEvent("tap",s,1)},remove:function(){this.removeEvent("tap",s)}};t.Events.handlers.dbltap=n})(n),(t=>{class e extends t.Events.Custom{constructor(t,e,i){super(t);const s=t.primaryTouch;this.type="touchdrag",this.id=s.pointerId||s.identifier,this.clientX=s.clientX,this.clientY=s.clientY,this.pageX=s.pageX,this.pageY=s.pageY,this.x=s.pageX,this.y=s.pageY,this._target=e.node,this.state=i,this.dragged=!1,this.pushToEvents(t)}get button(){return 0}}const s=function(t){if(!t.isPrimaryTouch())return;const i=new e(t,this,"dragstart");this.store("event:touchdrag:dragstart",i)},n=function(t){let i=this.fetch("event:touchdrag:dragstart");i&&i.dragged&&i.id===t.primaryTouchId&&(i=new e(t,this,"dragend"),this.del("event:touchdrag:dragstart"),this.callEvent("touchdrag",i))},o=function(t){let i=this.fetch("event:touchdrag:dragstart");i&&t.isPrimaryTouch()&&(i.id===t.primaryTouchId?(!i.dragged&&Math.sqrt(Math.pow(t.primaryTouch.pageX-i.x,2)+Math.pow(t.primaryTouch.pageY-i.y,2))>10&&(i.dragged=!0,this.callEvent("touchdrag",i)),i.dragged&&(i=new e(t,this,"dragmove"),this.callEvent("touchdrag",i))):this.del("event:touchdrag:dragstart"))},a={add:function(){const t=o.bind(this),e=n.bind(this);this.addEvent(["touchstart","pointerdown"],s,1).addEvent(["touchend","pointerup"],n,1).addEvent(["touchmove","pointermove"],o,1),this.store("event:touchdrag:listeners:document:move",t),this.store("event:touchdrag:listeners:document:end",e),r(i).addEvent("pointermove",t,1).addEvent("pointerup",e,1)},remove:function(){const t=()=>{};this.removeEvent(["touchstart","pointerdown"],s).removeEvent(["touchend","pointerup"],n).removeEvent(["touchmove","pointermove"],o),r(i).removeEvent("pointermove",this.fetch("event:touchdrag:listeners:document:move")||t,1).removeEvent("pointerup",this.fetch("event:touchdrag:listeners:document:end")||t,1),this.del("event:touchdrag:listeners:document:move").del("event:touchdrag:listeners:document:end")}};t.Events.handlers.touchdrag=a})(n),(t=>{let e=null;const s=t.$,n=(t,e)=>{const i=e.x-t.x,s=e.y-t.y;return Math.sqrt(i*i+s*s)},o=(t,e)=>{let i;const s=t.originEvent;return s.targetTouches&&s.changedTouches?(i=s.targetTouches?s.targetTouches:s.changedTouches,i=Array.prototype.slice.call(i)):(i=[],e&&e.forEach((t=>{i.push(t)}))),i},r=(t,e,i)=>!(!t.pointerId||"touch"!==t.pointerType||i&&!e.has(t.pointerId))&&(e.set(t.pointerId,t),!0),a=t=>t.pointerId&&"touch"===t.pointerType?t.pointerId:t.identifier,h=(t,e)=>{let i=!1;for(let s=0;s<t.length&&2!==e.length;s++){const n=a(t[s]);e.includes(n)||(e.push(n),i=!0)}return i},l=(t,e)=>{let i=!1;if(e){const s=(t=>t.map((t=>a(t))))(t);for(let t=0;t<e.length;t++)if(!s.includes(e[t])){e.splice(t,1),i=!0;break}}return i},c=(t,e)=>{const i=[];for(let s=0;s<t.length&&(!e.includes(a(t[s]))||(i.push(t[s]),2!==i.length));s++);return i},d=t=>{const e=t.fetch("event:pinch:target");e&&e.removeEvent(["touchend"],t.fetch("event:pinch:listeners:document:end")),t.del("event:pinch:target")},p=t=>{const e=t.fetch("event:pinch:cache");e&&e.clear(),t.del("event:pinch:cache")};class u extends t.Events.Custom{constructor(t,e,i,s){super(t),this.type="pinch",this._target=e.node,this.state=i,this.x=s.x,this.y=s.y,this.scale=s.scale,this.space=s.space,this.zoom=s.zoom,this.state=i,this.centerPoint=s.centerPoint,this.points=s.points,this.pushToEvents(t)}}const g={x:0,y:0,space:0,scale:1,zoom:0,startSpace:0,startScale:1,started:!1,dragged:!1,points:[],centerPoint:{x:0,y:0}},m=(t,i)=>{const s=i.space;t.length>1?(i.space=((t,e)=>{const i=Array.prototype.slice.call(t),s=Math.abs(i[1].pageX-i[0].pageX),o=Math.abs(i[1].pageY-i[0].pageY),r=Math.min(i[1].pageX,i[0].pageX)+s/2,a=Math.min(i[1].pageY,i[0].pageY)+o/2;let h=0;return e.points=[i[0],i[1]],h=Math.pow(n({x:i[0].pageX,y:i[0].pageY},{x:i[1].pageX,y:i[1].pageY}),2),e.centerPoint={x:r,y:a},e.x=e.centerPoint.x,e.y=e.centerPoint.y,h})(t,i),i.startSpace||(i.startSpace=i.space),s>i.space?i.zoom=-1:s<i.space?i.zoom=1:i.zoom=0,i.scale=i.space/e):i.points=[]},f=function(e){let i,s=this.fetch("event:pinch:variables");const n=this.fetch("event:pinch:cache"),a=this.fetch("event:pinch:activepoints");if(s||(s=Object.assign({},t.detach(g))),s.started){if(e.pointerId&&!r(e,n,!0))return;e.stop(),m(c(o(e,n),a),s),i=new u(e,this,"pinchmove",s),this.callEvent("pinch",i)}},v=function(i){let n,a,l=this.fetch("event:pinch:cache"),d=this.fetch("event:pinch:activepoints");if("mouse"===i.pointerType)return;d||(d=[],this.store("event:pinch:activepoints",d)),l||(l=new Map,this.store("event:pinch:cache",l)),this.fetch("event:pinch:target")||(this.store("event:pinch:target",s(i.target)),s(i.target).addEvent(["touchend"],this.fetch("event:pinch:listeners:document:end"),1)),r(i,l);const p=o(i,l);h(p,d),2===p.length&&(n=this.fetch("event:pinch:pinchstart"),a=this.fetch("event:pinch:variables"),a||(a=Object.assign({},t.detach(g))),m(c(p,d),a),n||(n=new u(i,this,"pinchstart",a),this.store("event:pinch:pinchstart",n),this.store("event:pinch:variables",a),e=a.space,this.callEvent("pinch",n),a.started=!0))},S=function(t){const e=this.fetch("event:pinch:cache");if("mouse"===t.pointerType||t.pointerId&&(!e||!e.has(t.pointerId)))return;let i=this.fetch("event:pinch:pinchstart");const s=this.fetch("event:pinch:variables"),n=this.fetch("event:pinch:activepoints"),r=o(t,e);((t,e)=>{t.pointerId&&"touch"===t.pointerType&&e&&e.has(t.pointerId)&&e.delete(t.pointerId)})(t,e);const a=l(r,n);if(!(i&&s&&s.started&&a&&n))return;a&&h(r,n);let g="pinchend";r.length>1?g="pinchresize":(this.del("event:pinch:pinchstart").del("event:pinch:variables").del("event:pinch:activepoints"),p(this),d(this)),m(c(r,n),s),i=new u(t,this,g,s),this.callEvent("pinch",i)},b={add:function(o){e||(e=(()=>{const e=t.W.size;return e.width=Math.min(e.width,e.height),e.height=e.width,Math.pow(n({x:0,y:0},{x:e.width,y:e.height}),2)})());const r=f.bind(this),a=S.bind(this);this.addEvent(["touchstart","pointerdown"],v,1).addEvent(["pointerup"],S,1).addEvent(["touchmove","pointermove"],f,1),this.store("event:pinch:listeners:document:move",r),this.store("event:pinch:listeners:document:end",a),s(i).addEvent("pointermove",r,1).addEvent("pointerup",a,1)},remove:function(){this.removeEvent(["touchstart","pointerdown"],v).removeEvent(["pointerup"],S).removeEvent(["touchmove","pointermove"],f);const t=()=>{};s(i).removeEvent("pointermove",this.fetch("event:pinch:listeners:document:move")||t,1).removeEvent("pointerup",this.fetch("event:pinch:listeners:document:end")||t,1),this.del("event:pinch:listeners:document:move").del("event:pinch:listeners:document:end"),d(this),p(this),this.del("event:pinch:variables").del("event:pinch:activepoints").del("event:pinch:pinchstart")}};t.Events.handlers.pinch=b})(n),(t=>{let s,n,o="wheel";"onwheel"in i||t.browser.ieMode>8||(o="mousewheel");class r extends t.Events.Custom{constructor(t,e,i,s,n,o,r){super(t);const a=t.pageXY;this.x=a.x,this.y=a.y,this.type="mousescroll",this._target=e.node,this.delta=i||0,this.deltaX=s||0,this.deltaY=n||0,this.deltaZ=o||0,this.deltaFactor=r||0,this.deltaMode=t.deltaMode||0,this.isMouse=!1,this.pushToEvents(t)}}const a=()=>{s=null},h=function(i){let o=0,h=0;const l=i.originEvent;if(l.detail&&(h=-1*i.detail),l.wheelDelta!==e&&(h=l.wheelDelta),l.wheelDeltaY!==e&&(h=l.wheelDeltaY),l.wheelDeltaX!==e&&(o=-1*l.wheelDeltaX),l.deltaY&&(h=-1*l.deltaY),l.deltaX&&(o=l.deltaX),0===h&&0===o)return;let c=0===h?o:h;const d=Math.max(Math.abs(h),Math.abs(o));(!s||d<s)&&(s=d);const p=c>0?"floor":"ceil";c=Math[p](c/s),o=Math[p](o/s),h=Math[p](h/s),n&&clearTimeout(n),n=setTimeout(a,200);const u=new r(i,this,c,o,h,0,s);var g,m;u.isMouse=(g=s,m=l.deltaMode||0,g>50||1===m&&!("win"===t.browser.platform&&g<1)||g%12==0||g%4.000244140625==0),this.callEvent("mousescroll",u)},l={add:function(){this.addEvent(o,h,1)},remove:function(){this.removeEvent(o,h,1)}};t.Events.handlers.mousescroll=l})(n),o.W=o.$(t),o.D=o.$(i),o.U=e,o.DPPX=window.devicePixelRatio>=2?2:1,n}(),(t=>{const e=t.$,i={linear:"linear",sineIn:"easeInSine",sineOut:"easeOutSine",expoIn:"easeInExpo",expoOut:"easeOutExpo",quadIn:"easeInQuad",quadOut:"easeOutQuad",cubicIn:"easeInCubic",cubicOut:"easeOutCubic",backIn:"easeInBack",backOut:"easeOutBack",elasticIn:(t,e)=>(e=e||[],Math.pow(2,10*--t)*Math.cos(20*t*Math.PI*(e[0]||1)/3)),elasticOut:(t,e)=>1-i.elasticIn(1-t,e),bounceIn:t=>{for(let e=0,i=1;;e+=i,i/=2)if(t>=(7-4*e)/11)return i*i-Math.pow((11-6*e-11*t)/4,2)},bounceOut:t=>1-i.bounceIn(1-t),none:t=>0},s={INIT:0,STARTED:1,PLAYING:2,PAUSED:3,ENDED:4};class n{constructor(i,n){this.styles=null,this.cubicBezier=null,this.easeFn=null,this.state=s.INIT,this.pStyles=[],this.alternate=!1,this.continuous=!1,this.startTime=null,this.finishTime=null,this.pausedTime=0,this.options={fps:60,duration:600,transition:"ease",cycles:1,direction:"normal",onStart:()=>{},onComplete:()=>{},onBeforeRender:()=>{},onAfterRender:()=>{},forceAnimation:!1,roundCss:!1},this.els=[],Array.isArray(i)||(i=[i]),i.forEach((t=>{t&&this.els.push(e(t))})),this.options=Object.assign(this.options,n),this.timer=!1,this.setTransition(this.options.transition),"string"===t.typeOf(this.options.cycles)&&(this.options.cycles="infinite"===this.options.cycles?1/0:parseInt(this.options.cycles,10)||1)}static getTransition(){return i}setTransition(e){this.options.transition=e,this.easeFn=n.cubicBezierAtTime;const s=i[this.options.transition]||this.options.transition;"function"===t.typeOf(s)?this.easeFn=s:this.cubicBezier=this.parseCubicBezier(s)||this.parseCubicBezier("ease")}start(t){const e=/%$/;if(this.state===s.PLAYING)return this;this.state=s.STARTED,this.cycle=0,this.alternate=["alternate","alternate-reverse"].includes(this.options.direction),this.continuous=["continuous","continuous-reverse"].includes(this.options.direction),t||(t={}),Array.isArray(t)||(t=[t]),this.styles=t;const i=this.styles.length;this.pStyles=new Array(i);for(let t=0;t<i;t++){this.pStyles[t]={};for(const i in this.styles[t])e.test(this.styles[t][i][0])&&(this.pStyles[i]=!0),["reverse","alternate-reverse","continuous-reverse"].includes(this.options.direction)&&this.styles[t][i].reverse()}return this.calcTime(),this.options.onStart(),0===this.options.duration?(this.render(1),this.options.onComplete(this.els.length<2?this.els[0]:this.els)):this.startAnimation(),this}stopAnimation(){this.timer&&(this.options.forceAnimation?clearInterval(this.timer):t.W.node.cancelAnimationFrame.call(t.W.node,this.timer),this.timer=!1)}resume(){return this.state!==s.PAUSED||(this.calcTime(),this.pausedTime=0,this.startAnimation()),this}pause(){return[s.PAUSED,s.ENDED].includes(this.state)||(this.pausedTime=Date.now()-this.startTime,this.stopAnimation(),this.state=s.PAUSED),this}isPlaying(){return this.state===s.PLAYING}isPaused(){return this.state===s.PAUSED}stop(e){return[s.INIT,s.ENDED].includes(this.state)||(t.defined(e)||(e=!1),this.stopAnimation(),this.state=s.ENDED,e&&(this.render(1),this.options.onComplete(this.els.length<2?this.els[0]:this.els))),this}startAnimation(){this.options.forceAnimation?this.timer=setInterval((()=>{this.loop()}),Math.round(1e3/this.options.fps)):this.timer=t.W.node.requestAnimationFrame.call(t.W.node,this.loop.bind(this)),this.state=s.PLAYING}calcTime(){this.startTime=Date.now()-this.pausedTime,this.finishTime=this.startTime+this.options.duration}loop(){const e=Date.now(),i=(e-this.startTime)/this.options.duration,s=Math.floor(i);if(e>=this.finishTime&&s>=this.options.cycles)return this.stopAnimation(),this.render(1),this.options.onComplete(this.els.length<2?this.els[0]:this.els),this;if(this.alternate&&this.cycle<s)for(let t=0,e=this.styles.length;t<e;t++)for(const e in this.styles[t])this.styles[t][e].reverse();this.cycle=s,this.options.forceAnimation||(this.timer=t.W.node.requestAnimationFrame.call(t.W.node,this.loop.bind(this))),this.render((this.continuous?s:0)+this.easeFn(i%1,this.options.duration,this.cubicBezier))}render(t){const e=[],i=this.els.length;for(let s=0;s<i;s++)e.push(this.renderOverLoad(t,this.els[s],this.styles[s],this.pStyles[s]));let s=this.els,n=e;i<2&&(s=this.els[0],n=e[0]),this.options.onBeforeRender(n,s),this.set(e),this.options.onAfterRender(n,s)}renderOverLoad(t,e,i,s){const n={};return Object.entries(i).forEach((e=>{const[i,o]=e;"opacity"===i?n[i]=Math.round(100*this.calc(o[0],o[1],t))/100:(n[i]=this.calc(o[0],o[1],t),s[i]&&(n[i]+="%"))})),n}calc(t,e,i){return t=parseFloat(t),((e=parseFloat(e))-t)*i+t}set(t){for(let e=0,i=this.els.length;e<i;e++)this.els[e].setCss(t[e]);return this}parseCubicBezier(e){let i=null;if(Array.isArray(e)&&4===e.length)return e;if("string"!==t.typeOf(e))return null;switch(e){case"linear":i=[0,0,1,1];break;case"ease":i=[.25,.1,.25,1];break;case"ease-in":i=[.42,0,1,1];break;case"ease-out":i=[0,0,.58,1];break;case"ease-in-out":i=[.42,0,.58,1];break;default:if((e=e.replace(/\s/g,"")).match(/^cubic-bezier\((?:-?[0-9\.]{0,}[0-9]{1,},){3}(?:-?[0-9\.]{0,}[0-9]{1,})\)$/)){i=e.replace(/^cubic-bezier\s*\(|\)$/g,"").split(",");for(let t=i.length-1;t>=0;t--)i[t]=parseFloat(i[t])}}return i}static cubicBezierAtTime(t,e,i){let s=0,n=0,o=0,r=0,a=0,h=0;const l=t=>((s*t+n)*t+o)*t,c=t=>(3*s*t+2*n)*t+o;return o=3*i[0],n=3*(i[2]-i[0])-o,s=1-o-n,h=3*i[1],a=3*(i[3]-i[1])-h,r=1-h-a,d=t,p=(t=>1/(200*t))(e),(t=>((r*t+a)*t+h)*t)(((t,e)=>{let i,s,n,o,r,a;const h=t=>t>=0?t:0-t;for(n=t,a=0;a<8;a++){if(o=l(n)-t,h(o)<e)return n;if(r=c(n),h(r)<1e-6)break;n-=o/r}if(i=0,s=1,n=t,n<i)return i;if(n>s)return s;for(;i<s;){if(o=l(n),h(o-t)<e)return n;t>o?i=n:s=n,n=.5*(s-i)+i}return n})(d,p));var d,p}}t.FX=n})(e),(t=>{let e=null;const s={boolean:1,array:2,number:3,function:4,url:5,string:100},n={boolean:(i,s,n)=>{if("boolean"!==t.typeOf(s)){if(n||"string"!==t.typeOf(s))return!1;if(!/^(true|false)$/.test(s))return!1;s=!s.replace(/true/i,"").trim()}return!(i.hasOwnProperty("enum")&&!i.enum.includes(s))&&(e=s,!0)},url:(e,i,s)=>{let n=!1;return"string"===t.typeOf(i)&&(t=>/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/i.test(t))(i)&&(e.hasOwnProperty("enum")?e.enum.includes(i)&&(n=!0):n=!0),n},string:(i,s,n)=>"string"===t.typeOf(s)&&(!(i.hasOwnProperty("enum")&&!i.enum.includes(s))&&(e=""+s,!0)),number:(i,s,n)=>{const o="string"===t.typeOf(s)&&/%$/.test(s);return(!n||!1!==typeof s)&&(s=parseFloat(s),!isNaN(s)&&(isNaN(i.minimum)&&(i.minimum=Number.NEGATIVE_INFINITY),isNaN(i.maximum)&&(i.maximum=Number.POSITIVE_INFINITY),!(i.hasOwnProperty("enum")&&!i.enum.includes(s))&&(!(i.minimum>s||s>i.maximum)&&(e=o?s+"%":s,!0))))},array:(i,s,n)=>{if("string"===t.typeOf(s))try{s=s.replace(/'/g,'"'),s=t.W.node.JSON.parse(s)}catch(t){return!1}return"array"===t.typeOf(s)&&(e=s,!0)},function:(i,s,n)=>"function"===t.typeOf(s)&&(e=s,!0)},o=(e,i,s)=>{const o=e.hasOwnProperty("oneOf")?e.oneOf:[e];if("array"!==t.typeOf(o))return!1;for(let t=0,e=o.length-1;t<=e;t++)if(n[o[t].type](o[t],i,s))return!0;return!1},r=e=>{const i={},s=(e,n)=>{Object.entries(e).forEach((e=>{const[o,r]=e,a=n.slice(0);"object"!==t.typeOf(r)||(t=>Object.keys(t).some((t=>"defaults"===t)))(r)?(a.push(o),i[a.join(".")]=r):(a.push(o),s(r,a))}))};return s(e,[]),i},a=t=>{const e={};return Object.entries(t).forEach((t=>{((t,i)=>{let s=e;const n=t.length;""===t[n-1].trim()&&t.splice(n-1,1),t.forEach(((t,e)=>{e===n-1?s[t]=i:(s[t]||(s[t]={}),s=s[t])}))})(t[0].split("."),t[1])})),e},h=e=>t.camelize((e+"").trim());t.Options=class{constructor(t){this.schema={},this.options={},this.parseSchema(t)}parseSchema(e,a){e=r(e),Object.entries(e).forEach((r=>{const[l,c]=r,d=h(l);if(!this.schema.hasOwnProperty(d)||a){if(this.schema[d]=(t=>{if(t.hasOwnProperty("oneOf")){const e=t.oneOf.length;for(let i=0;i<e;i++)for(let n=i+1;n<e;n++)if(s[t.oneOf[i].type]>s[t.oneOf[n].type]){const e=t.oneOf[i];t.oneOf[i]=t.oneOf[n],t.oneOf[n]=e}}return t})(c),!(e=>{const i=e.hasOwnProperty("oneOf")?e.oneOf:[e];if("array"!==t.typeOf(i))return!1;for(let e=i.length-1;e>=0;e--){if(!i[e].type||!s.hasOwnProperty(i[e].type))return!1;if(t.defined(i[e].enum)){if("array"!==t.typeOf(i[e].enum))return!1;for(let t=i[e].enum.length-1;t>=0;t--)if(!n[i[e].type]({type:i[e].type},i[e].enum[t],!0))return!1}}return!(e.hasOwnProperty("defaults")&&!o(e,e.defaults,!0))})(this.schema[d]))throw"Incorrect definition of the '"+i+"' parameter in "+e;t.defined(this.options[d])&&this.checkValue(d,this.options[d])||(this.options[d]=t.U)}}))}set(i,s){i=h(i),"string"===t.typeOf(s)&&(s=s.trim()),this.schema.hasOwnProperty(i)&&(e=s,o(this.schema[i],s)&&(this.options[i]=e),e=null)}get(e){if(e=h(e),this.schema.hasOwnProperty(e))return t.defined(this.options[e])?this.options[e]:this.schema[e].defaults}fromJSON(t){t=r(t);for(const e in t)this.set(e,t[e])}getJSON(){const e=Object.assign({},this.options);return Object.keys(e).forEach((i=>{e[i]===t.U&&this.schema[i].defaults!==t.U&&(e[i]=this.schema[i].defaults)})),a(e)}fromString(t,e){const i={};e||(e={});return t.split(";").forEach((t=>{var s;s=(s=t).trim(),Object.entries(e).find((([t,e])=>!(!e.test||!e.test(s)||(i[t]||(i[t]=""),i[t]+=s+";",0))))||(t=t.split(":"),this.set(t.shift().trim(),t.join(":")))})),i}checkValue(i,s){let n=!1;return i=h(i),"string"===t.typeOf(s)&&(s=s.trim()),this.schema.hasOwnProperty(i)&&(e=s,o(this.schema[i],s)&&(n=!0),e=null),n}exists(t){return t=h(t),this.schema.hasOwnProperty(t)}isset(e){return e=h(e),this.exists(e)&&t.defined(this.options[e])}remove(t){t=h(t),this.exists(t)&&(delete this.options[t],delete this.schema[t])}}})(e),e})),Sirv.define("globalVariables",["bHelpers","magicJS"],((t,e)=>{e.$;const i="smv";let s="https:",n="",o="";const r=(()=>{let t;return e=>(t||(t=document.createElement("a")),t.setAttribute("href",e),("!!"+t.href).replace("!!",""))})(),a=document.getElementsByTagName("script");for(let t=0,e=a.length;t<e;t++){const e=a[t].getAttribute("src")||"";if(null!==a[t].getAttribute("data-sirvjs-test"))n=r(e).replace(/([^#?]+)\/.*$/,"$1/");else if(/sirv\.(com|localhost(:\d+)?)\/(([^#?]+)\/)?sirv\.js([?#].*)?$/i.test(e)||/sirv\.(com|localhost(:\d+)?)\/(([^#?]+)\/)?sirv\.full\.js([?#].*)?$/i.test(e)){o=r(e).replace(/(^https?:\/\/[^/]*).*/,"$1/"),n=r(e).replace(/([^#?]+)\/.*$/,"$1/"),(/sirv\.localhost(:\d+)?\/(([^#?]+)\/)?sirv\.js([?#].*)?$/i.test(e)||/sirv\.localhost(:\d+)?\/(([^#?]+)\/)?sirv\.full\.js([?#].*)?$/i.test(e))&&(s="http:");break}}return{SIRV_PREFIX:i,CSS_RULES_ID:"sirv-core-css-reset",SIRV_BASE_URL:o,CSS_CURSOR_ZOOM_IN:"smv-cursor-zoom-in",CSS_CURSOR_FULSCREEN_ALWAYS:"smv-cursor-fullscreen-always",REG_URL_QUERY_STRING:/([^\?]+)\??([^\?]+)?/,FULLSCREEN_VIEWERS_IDs_ARRAY:[],CUSTOM_DEPENDENCIES:null,MIN_RATIO:1.2,SIRV_HTTP_PROTOCOL:s,SIRV_ASSETS_URL:n,SLIDE_SHOWN_BY:{NONE:0,AUTOPLAY:1,USER:2,INIT:3,ENABLE:4},VIDEO:{NONE:0,PLAY:1,PAUSE:2,PLAYING:3},FULLSCREEN:{CLOSED:0,OPENING:1,OPENED:2,CLOSING:3},APPEARANCE:{HIDDEN:0,SHOWING:1,SHOWN:2,HIDING:3},SLIDE:{TYPES:{NONE:0,HTML:1,IMAGE:2,PANZOOM:3,ZOOM:4,SPIN:5,VIDEO:6},NAMES:["none","html","image","panzoom","zoom","spin","video"]}}})),Sirv.define("globalFunctions",["bHelpers","magicJS","globalVariables","helper"],((t,e,i,s)=>{const n=e,o=n.$,r={},a=t=>{let e=t.replace(/^(https?:)?/,"https:");return/^(http(s)?:)?\/\/[^/]+?sirv\.localhost(:\d+)?\/.*$/i.test(t)&&(e=t.replace(/^(https?:)?/,"http:")),e},h=t=>t.replace(/^((?:https?:)?\/\/)([^/].*)/,(function(t,e,i){return e+i.split("/").map((function(t,e){return 0===e?t:(t=>{try{t=decodeURIComponent(t)}catch(t){}return encodeURIComponent(t)})(t)})).join("/")}));class l{constructor(){this.CSSMap={},this.sirvNodesMap=new WeakMap,this.rootNodesMap=new Map,this.rootNodes=[],this.sirvCSSSrc="viewer.css",this.mainCSSID="sirv-stylesheet-sirv"}static getShadowDOM(t){let e=!1;const i=(t=o(t).node).parentNode;return i&&window.ShadowRoot&&(e=i instanceof window.ShadowRoot?i:l.getShadowDOM(i)),e}rootContains(t){return this.rootNodes.some((e=>(e===n.D.node&&(e=n.D.node.body),!!e&&e.contains(t))))}addModuleCSSByName(t,e,i,s){this.CSSMap[t]||(this.CSSMap[t]={cssStringFunction:e,id:i,position:s})}getRootNode(t){t=o(t).node;const e=l.getShadowDOM(t),i=e||n.D.node;return this.rootNodesMap.has(i)||(this.rootNodesMap.set(i,{isResetCSSAdded:!1,isVideoCSSAdded:!1,isSirvAdAdded:!1,styles:{},modulesCss:{},isShadowDOM:!!e}),this.rootNodes.push(i)),i}attachNode(t){if(t=o(t).node,!this.sirvNodesMap.has(t)){const e=this.getRootNode(t);this.sirvNodesMap.set(t,e)}}detachNode(t){return t=o(t).node,this.sirvNodesMap.delete(t)}addCSSStringToHtml(){this.addCSSString(n.D.node.head||n.D.node.body)}addCSSString(t){t||(t=n.D.node.head||n.D.node.body),t=o(t).node;const e=this.sirvNodesMap.get(t),i=this.rootNodesMap.get(e);let r=null;i.isShadowDOM&&(r=e),Object.entries(this.CSSMap).forEach((([t,e])=>{i.modulesCss[t]||(i.modulesCss[t]=1,s.addCss(e.cssStringFunction(),e.id,e.position,r,"#"+this.mainCSSID))}))}addMainStyleToHtml(){this.resetGlobalCSS(n.D.node.head||n.D.node.body),this.addStyle(n.D.node.head||n.D.node.body,i.SIRV_ASSETS_URL+this.sirvCSSSrc,this.mainCSSID,"#"+i.CSS_RULES_ID)}addMainStyle(t){return this.addMainStyleToHtml(),this.resetGlobalCSS(t),this.addStyle(t,i.SIRV_ASSETS_URL+this.sirvCSSSrc,this.mainCSSID,"#"+i.CSS_RULES_ID)}addStyle(t,e,i,n){t=o(t).node;const r=this.sirvNodesMap.get(t),a=this.rootNodesMap.get(r);return a.styles[i]||(a.styles[i]=new Promise(((t,o)=>{let h=null;a.isShadowDOM&&(h=r),s.loadStylesheet(e,i,h,n).then(t).catch(o)}))),a.styles[i]}resetGlobalCSS(t){t||(t=n.D.node.head||n.D.node.body),t=o(t).node;const e=this.sirvNodesMap.get(t),s=this.rootNodesMap.get(e);if(s.isResetCSSAdded)return;s.isResetCSSAdded=!0;let r=null;s.isShadowDOM&&(r=e),n.addCSS(".smv",{display:"flex !important"},i.CSS_RULES_ID,r),n.addCSS(".smv.smv-selectors-top",{"flex-direction":"column-reverse"},i.CSS_RULES_ID,r),n.addCSS(".smv.smv-selectors-left",{"flex-direction":"row-reverse"},i.CSS_RULES_ID,r),n.addCSS(".smv.smv-selectors-right",{"flex-direction":"row"},i.CSS_RULES_ID,r),n.addCSS(".smv.smv-selectors-bottom",{"flex-direction":"column"},i.CSS_RULES_ID,r),n.addCSS(".smv-slides-box",{"flex-grow":1,"flex-shrink":1},i.CSS_RULES_ID,r),n.addCSS("figure > .Sirv",{"vertical-align":"top"},i.CSS_RULES_ID,r),n.addCSS(".Sirv > iframe, .Sirv > video",{display:"none"},i.CSS_RULES_ID,r),n.addCSS(":not(.smv) smv-thumbnail",{display:"none"},i.CSS_RULES_ID,r),n.addCSS(".Sirv, .Sirv .smv-component",{"-webkit-box-sizing":"border-box !important","-moz-box-sizing":"border-box !important","box-sizing":"border-box !important"},i.CSS_RULES_ID,r),n.addCSS("div.Sirv, div.Sirv div.smv-component, figure.Sirv, div.smv-component",{width:"100%",height:"100%",margin:0,"text-align":"center"},i.CSS_RULES_ID,r),n.addCSS("div.Sirv",{"max-height":"100%","block-size":"inherit"},i.CSS_RULES_ID,r),n.addCSS(".Sirv img",{width:"100%",height:"100%"},i.CSS_RULES_ID,r),n.addCSS("img.Sirv, .Sirv img",{"max-width":"100%"},i.CSS_RULES_ID,r),n.addCSS("img.Sirv:not([width]):not([height])",{width:"100%"},i.CSS_RULES_ID,r),n.addCSS("img.Sirv",{display:"inline-block","font-size":0,"line-height":0},i.CSS_RULES_ID,r),n.addCSS(".Sirv.smv-bg-image.smv-bg-contain, .Sirv.smv-bg-image.smv-bg-cover",{"background-repeat":"no-repeat","background-position":"center"},i.CSS_RULES_ID,r),n.addCSS(".Sirv.smv-bg-image.smv-bg-contain",{"background-size":"contain"},i.CSS_RULES_ID,r),n.addCSS(".Sirv.smv-bg-image.smv-bg-cover",{"background-size":"cover"},i.CSS_RULES_ID,r),n.addCSS("img.Sirv:not([src]), img.Sirv.sirv-image-loading:not([src])",{opacity:"0"},i.CSS_RULES_ID,r),n.addCSS("img.Sirv.sirv-image-loaded",{opacity:"1",transition:"opacity 0.5s linear"},i.CSS_RULES_ID,r)}showSirvAd(t,e,s,r){if(/^my.sirv.(com|localhost)$/i.test(n.D.node.location.hostname))return;t||(t=n.D.node.head||n.D.node.body),t=o(t).node;const a=this.sirvNodesMap.get(t);let h=null;this.rootNodesMap.get(a).isShadowDOM&&(h=a);const l="sirvCR"+Math.floor(Math.random()*Date.now());n.addCSS("#"+l,"\n            display: inline-block !important;\n            position: absolute !important;\n            top: auto !important;\n            right: 0 !important;\n            bottom: 0 !important;\n            left: auto !important;\n            width: auto !important;\n            height: auto !important;\n            max-width: none !important;\n            max-height: none !important;\n            margin: auto !important;\n            padding: 8px !important;\n            z-index: 2147483647 !important;\n            visibility: visible !important;\n            opacity: 1 !important;\n            transform: none !important;\n            font-size: 0 !important;\n            line-height: 1 !important;\n            background-color: #ffffffbf;\n            backdrop-filter: blur(10px);\n            -webkit-backdrop-filter: blur(10px);\n        ",i.CSS_RULES_ID,h),n.addCSS("#"+l+"  > img","\n            display: inline-block !important;\n            position: static !important;\n            width: 90px !important;\n            height: auto !important;\n            max-width: 100% !important;\n            max-height: none !important;\n            margin: 0 !important;\n            padding: 0 !important;\n            visibility: visible !important;\n            opacity: 1 !important;\n            transform: none !important;\n        ",i.CSS_RULES_ID,h),n.addCSS("@media screen and (min-width: 481px)","#"+l+"  > img {\n            width: 135px !important;\n        }",i.CSS_RULES_ID,h);const c=n.$new("a",{id:l,href:s,target:"_blank"});c.attr("style","position: absolute !important; opacity: 1 !important"),c.setCss({display:"inline-block",overflow:"hidden",visibility:"visible",fontSize:0,fontWeight:"normal",fontFamily:"sans-serif",bottom:0,right:0,margin:"auto",width:"auto",height:"auto",transform:"none",zIndex:2147483647}).appendTo(e).addEvent(["tap","btnclick"],(t=>{t.stopDistribution(),n.W.node.open(c.attr("href"))})).append(n.$new("img",{width:90,height:18,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAAkCAYAAAAgqxBxAAAMJ0lEQVR4nO1ce5AUxRnv4yH4wCfREogIqFHOI94uVoSNMnFvZ6e/30+TGB/BRFPRUomWRiMKd2tUTKEWKlGSCBKCxtJSSKkxKLhnKqaiJvgOYjSAAhdQ8EDkIYgm8fLH9hzNZGZn9+68o8r5VU3V7fbXX389+5vu79FzSiVIkCBBggQJegiu6w4DMIlkkeRKklsBbCG5EsAzJKeJyCnldDiOs5/neaO6y+YECUJBciaAz0i2xV0AFmut+wV1iMhoAK1GZqnjOAN7Yi4JvsDQWu9PckkIaTcBWAbgHZI7Am1vKqV6BXUBWBzQ87MemFKCLzJIvhIg671a63Gu6+7ryziOMxBAA4DpADYDuDRC14qArl9130wSfOEhIpcFCPjduD75fP5gx3H2C2sDcJal62MAx3W91QkShKMGwDqL0DO7QimAsQAubGhoOKIr9CVIUBHy+XxtYHUe3tM2JUjQYWitT7PI/EFP25MgQadA8kxrhd7mOE6fnrYpk8kMEJHRnud9padtSRADkm0NDQ0HRLU3NDQcAWBzd9njed7XbZdDa31SZ3WKSB2AR80133GcA+1213W/bLXf5H+fzWYPATAHwAdmx1jjt+Xz+YMBPALgIZIPxxV2gkhNLp6TamqeV18oPlxfKM7p7BwTGOxphM5kMgNI/tdyO57urE7bjTHXYLsdwHFW2/umz5BAcNoGYIvfx3GcPradJP9cjU2pQnFdqtDclio0t9UXis93do4JDPY0QiulFIB7AkS6Kb5XNLTWp1r6Pslms4fZ7SQHW+RcaL5bGXgI/gNgmVKqxu8nIj+xZTKZzIBK7Plq45PH+GROFZrbUpOL6c7ML4GFPZHQjuMcCODfAUI9lsvlBnVEXxyhXdc9lOQnfgGHZKP1MP0GwNhcLjcon88frqxKZD6fPzzgHp1TiT31heYpu1bn5tWVTqKfiAw1N6EmTh7AQQCGl/txuwqmwjU87NxBEFrrfp7nHWl+hOA8anK53CARGVpB8FRDcrCIDLXHrZbQ/n0123bsfe0oAJwccl5jB8lpWush1eiKI3Q2mz3EKqOvB7DTkPkHFdj5nKV7QSX2pJqKS9tX56ZiIcrokQCeBnAQybnGsKUAVgFYJyITwvp5npcl+aI5vLKE5EZzyCVjGV0AMCOsP8lbSD4c0fZrABf6n0UkZ8ZoIfmqGWt2Op3ex+4H4HXHcfqIyDUkN5JcYUq7x1kyFwNYTfKfJJcAaAXQpEJIJiJXkHwXwCqSb5B8n+TMdDq9D4CdlRDacZz9ANxN8n1zX1cDeE9ErvLHBPAQgO9H6TIrWktwvlEwxZDWEGJ/AuC+Sit+cYQ2nNkecHNmVaKb5EVWn521tbV7lZOvb1w40nY3aictCC/0iEgdyQ0A/iIil6TT6b5W2wkkV4jINYE+3zE/rqhdROhtSqUbtNauUu2Rd0vIsDWGVOtDyq41ANb5qR6t9bcArNFaj/MFMpnMAADzADxlja9ItgC4EsDvABwUHBTATwG8TPJo/zsTxLwAYGpAdgrJN0Skzv/OcZz+ACaSXEByaxyhzcOwSEQm2DuByR68TvIW8/lsAM9E6SJ5LYD7otrDYDINs0JI7V932b91GCohNICPLJntjuP0r9S+atyOVFOx0O5uNBWfixQ0hG4jeWNYu+d5o0hu9yeTTqf3IblRa31qmDzJMwGsMU9cbwCbXdc91pbRWmdIPgtgnoicbbcBON5/CMzq1gpgbHAcQ67V/sNjxm4B8HrY0661HklyY/BHMfdgKMkdxtdTnucdSXK71npE2ByNvxjrcvjEidAxnOQO13WH1dbW7kVyg+u6wyJk3wRwctRY5SAiJwCYjdI56OAJvGX5fL42qm+1hAYwrxrbAPze6ju/nGyqqfiWRegLyk24zvw4kbV6AM8DuMDIjwfwUoyhy0WE5u/5InJFYMw7jVtwUdDtMCvsHCN3HoDIpxHA7SR/6X82hL48Yp53AvhFGV3NvptjVuHHomSNu1URoT3PO7HMmE8AmGj+niEiNwRltNYnAViuOul3mxXxRpJbg25I1IPbAUJfXY1NZqdvLwZFxUappkWjdvnOzZ8edfnC6BjKbH8flRsYwAwA083f0wH8PEZ+Ns3ZWQAXAHjCau4FYC3Jo3O53CAAmwPB1gKYU2IA7gFwa9Q4JC8ybof/uSWqoADghXLbGoC7ReRm8/dDACZFyWaz2cMqJXS5ABbAFN+V0FrXk1ypAsQFMEtEJkfpqBau6x4K4NHASr1GKdU7KNsBQp9RjS2O4/Qnuc3vLyLfDJOzsxuppubyu4Ah9JoYmetI3q+UUiQfjLvBAG4CMFsppXK53CD76UMpCn/Fkn1Oa32aUkql0+m+JpAaaNoeB/ABgHfCLuPHP+vrItli+7wBm9YanzZK14cA7jZ6/ogykbopDlSS5fi43H0yxz3bI3yWAl7H/zxmzJi9WQpuB4cq6AQAzAmQ+sqgTLWE1lrrDtjxgEXo34bJpArFt31CnzB5kVNWoSF0a8yg15Oc6xuAUlagnPxUWIfBAfwdwDfM3zNINlrjX+Xr1lpnALxs9XtcRK4xNy70spPyMYReo7V2y+nyswgA/kTy/Kj5pdPpvhUSeme5+0Tyx7ZrA+ByAPda92Z8YHfrUgBYbhH67WB7tYT23cxqICJeIKjcLY1a11g81vKdy/LUV1gH4NNy+VgAs/3tWERu9lffKARXcZZSdD9TpZzuu7SyDCYgW6+U6iUik20XA6Uo/ZbYSewapxyhXwBwViV6AMwjeW1Uu18YqMTlKJdqA3Cbvyso1e7nbrQerCeq3carQcgLAbsdOe0OQiulFMkPfR2e52XttlSheJuVe55WyaTqSLbl8/lUmQFXWEFeA4BVKuQdNKXat+P1dj5aRE4h+azWuh7AayH6X/Q870SSf7AnJCLjSb4aO4ldeiIJTXKaH2zGwQSskUEhAFThQ4+LkgHwkoicF/huvoic6zjOQJLvxuVnOwOTlrVTZ67d3l2ENjFXqNtR3/TUivYVunHhyEomVYfS28FzI9rPBbDayln2YqkgEfoeGoBJxm1oD27MFr3e+OKNwT4s5VmvN25BexA1ZsyYvY3v+73YiajyhNZajzC+fH2cHq31EJJbtdahNxDAkwA+q4TQiEhHkRSSG4N5eK21NoHxpSTviLO1MzDpSTvjIQFbuoXQIvI1a5wdjqPavYX6QnGOIXRlC5sh9FIAj5C8S0SOUUrVmGN+l7JUKBkX7GMIeoPrusPS6XTffD5/FIBbAaxFSCUKpWLHWtvd8GH6rgWwKNhm/OpWAFO01iMcx+njOE5/z/NGAZgoIqN92XKENnb/EECriEwwgVZNJpMZYFJjU13XPdSSnQBgDYAzDOl6marqAyYF+I8KfOjnSc4FMMcUino1NDQcgFLmp9UPhgPobYLUJQCOj9LfFRCR0Tahg7t0dxHa6HrP13O6m835348qPHNSqtDclmpsjnQBg5OqA7DKlIyvMpH2BgDvoVT4iFrxhgCYhVIpd5MJMO7yixNBkPw2ylS7ANwXtRKb1W4mgOVmrLUk/yoi12mtv2SN8WBUccIaJ43SWdwWAJtYKqcXReSyYIoNQN6sxuvMQ7UYpkRtHoB9w0cppcdMhbWGpfTiYuu+PgIg8qQYgNsBLC43j64AgIJF2K3BymE3E/rWMLfjsInFfeubiu+OaipW9nCb1TasPJ2ghwDgSRG55PMcw8Q6G6yA8N6gTHcS2vbnAWyy21JNi0aps+b/X548SlFC6D0IxlXZorXev5p+psQ93XabomCyKX8LuBtHBeW6k9BG37JdAaoberQiFgmh9yyQvCMuLRoGa8veZty38wEcr7XeX2vdz8REYwFMZalYY6frQkvW3U1olkrzJZt4etX3QCmVEHpPgO+7m8LP5rDAOQ4mHgg7VbeVpYrq9rB2BE4ZBuw61ZL7NO74aGcJ7bruMGu8dR1SkhC654HSwagtJP8F4PSO6NBanwbg6QhSh12vRGRZdtMZ6LNbCd7kytssQo/viO02ALy5y+1gWfui0Ls73jZJEIvKgp4YaK1HAPgRyftReivkDZJvAXgNwFMicnOlb1obf34igKsBXBmsejqO019ErjAyE9EF/9wGwMVmV9nGzzkPnyBBggQJugP/A94x91x//ZrKAAAAAElFTkSuQmCC"}).setProps({alt:r}))}}const c=new l,d={rootDOM:c,loadJsFile:(t,e)=>(r[t]||(r[t]=((t,e)=>new Promise(((i,s)=>{const o=n.$new("script");o.attr("type","text/javascript"),o.node.onload=i,o.node.onerror=s,o.attr("src",t),o.appendTo(e||n.D.node.head)})))(t,e)),r[t]),loadCssFile:(t,e,i,s)=>(r[e]||(r[e]=c.addStyle(t,e,i,s)),r[e]),viewerFilters:[],getNodeWithSirvClassName:t=>{let e=null;return t&&(e=(t=o(t)).hasClass("Sirv")?t.node:d.getNodeWithSirvClassName(t.node.parentNode)),e},iconsHash:{nodes:[],elements:[[{classes:["smv-arrow-control"]},{classes:["smv-arrow"]},{classes:["smv-icon"]}],[{classes:["smv-button-fullscreen-open"]},{classes:["smv-icon"]}],[{classes:["smv-button-fullscreen-close"]},{classes:["smv-icon"]}],[{classes:["smv-thumbnails"]},{classes:["smv-selector"],attrs:[{name:"data-type",value:"spin"}]}]],waitBody:()=>new Promise(((t,e)=>{const i=document.body;i?t(i):setTimeout((function(){d.iconsHash.waitBody().then(t)}),16)})),make:()=>{d.iconsHash.elements.forEach((t=>{const e=[];t.reverse().forEach((t=>{const i=n.$new("div");t.classes&&t.classes.forEach((t=>{i.addClass(t)})),t.attrs&&t.attrs.forEach((t=>{i.attr(t.name,t.value)})),e.push(i)}));for(let t=1,i=e.length;t<i;t++)e[t].append(e[t-1]);d.iconsHash.nodes.push(e[e.length-1])})),d.iconsHash.nodes.forEach((t=>{t.setCss({top:"-10000px",left:"-10000px",width:"10px",height:"10px",position:"absolute",visibility:"hodden",opacity:0}),d.iconsHash.waitBody().finally((()=>{n.$(n.D.node.body).append(t)}))}))},remove:()=>{d.iconsHash.nodes.length&&(d.iconsHash.nodes.forEach((t=>{t.remove()})),d.iconsHash.nodes=[])}},adjustURL:t=>(/^(http(s)?:)?\/\//.test(t)||(t=i.SIRV_BASE_URL+t),a(t).replace(/([^:])\/+/g,"$1/")),normalizeURL:t=>h(a(t))};return d.rootDOM.attachNode(n.D.node.head||n.D.node.body),d})),Sirv.define("helper",["bHelpers","magicJS","globalVariables"],((t,e,i)=>{const s=e,n=s.$,o={};o.WaitToStart=class{constructor(){this.started=!1,this.callbacks=[]}wait(t){this.started?t():this.callbacks.push(t)}start(){this.started||(this.started=!0,this.callbacks.forEach((t=>t())))}destroy(){this.callbacks=[]}},o.addCss=(t,e,i,o,r)=>{let a=document.head||document.body;const h=s.$new("style",{type:"text/css"});let l;h.attr("id",e||"sirv-module-"+h.$J_UUID),i||(i="top"),o&&(a=n(o).node||o),"top"===i&&(l=a.firstChild);const c=a.querySelector(r);return c&&c.nextSibling&&(l=c.nextSibling),a.insertBefore(h.node,l),h.node.innerHTML=t,h},o.cleanQueryString=t=>t=(t=(t=(t=(t=(t=t.replace(/&+/g,"&")).replace(/&$/,"")).replace(/\?&/,"?")).replace(/profile=&|profile=$/g,"")).replace(/image=&/g,"image&")).replace(/image=$/g,"image"),o.createReadOnlyProp=(t,e,i)=>{Object.defineProperty(t,e,{value:i,writable:!1})};return o.debounce=(t,e,i)=>{let n,o,r,a,h,l,c=0,d=!1,p=!1,u=!0;const g=!e&&0!==e&&s.browser.features.requestAnimationFrame;if("function"!=typeof t)throw new TypeError("Expected a function");var m;e=+e||0,(m=i)&&"object"==typeof m&&m.constructor===Object&&(d=!!i.leading,p="maxWait"in i,r=p?Math.max(+i.maxWait||0,e):r,u="trailing"in i?!!i.trailing:u);const f=e=>{const i=n,r=o;return n=s.U,o=n,c=e,a=t.apply(r,i),a},v=(t,e)=>g?(s.browser.cancelAnimationFrame(h),s.browser.requestAnimationFrame(t)):setTimeout(t,e),S=t=>{const i=t-l,n=t-c;return l===s.U||i>=e||i<0||p&&n>=r},b=t=>(h=s.U,u&&n?f(t):(n=s.U,o=n,a)),y=()=>{const t=Date.now();return S(t)?b(t):(h=v(y,(t=>{const i=t-c,s=e-(t-l);return p?Math.min(s,r-i):s})(t)),s.U)},w=(...t)=>{const i=Date.now(),r=S(i);if(n=t,o=this,l=i,r){if(h===s.U)return(t=>(c=t,h=v(y,e),d?f(t):a))(l);if(p)return h=v(y,e),f(l)}return h===s.U&&(h=v(y,e)),a};return w.cancel=()=>{var t;h!==s.U&&(t=h,g?s.browser.cancelAnimationFrame(t):clearTimeout(t)),c=0,n=s.U,l=n,o=n,h=n},w.flush=()=>h===s.U?a:b(Date.now()),w.pending=()=>h!==s.U,w},o.deepExtend=(()=>{const t=(e,i)=>{const n=s.typeOf(i);return s.defined(e)||(e="array"===n?[]:{}),"array"===n?i.forEach(((i,n)=>{const o=s.typeOf(i);"array"===o&&"array"===s.typeOf(e[n])||"object"===o&&"object"===s.typeOf(e[n])?e[n]=t(e[n],i):e.push(i)})):Object.entries(i).forEach((([i,n])=>{const o=s.typeOf(n);e[i]="array"===o||"object"===o?t(e[i],n):n})),e};return(...e)=>{let i=null;return e&&e.length&&(i=e.shift(),e.forEach((e=>{const n=s.typeOf(e);"array"!==n&&"object"!==n||(i=t(i,e))}))),i}})(),o.fixSize=(t,e)=>{t=n(t);return["width","height"].forEach((i=>{var n;s.browser.ieMode&&!t.attr("src")&&((t,e)=>"auto"===t.attr(e))(t,i)&&(e[i]=0),0===e[i]&&(e[i]=o.imageLib.getPartSize(t,i)),e[i]=((n=e[i])<=4&&(n=0),n)})),e},o.generateUUID=()=>parseInt(1e7*Math.random(),10),o.getArrayIndex=(t,e)=>((t%=e)<0&&(t+=e),t),o.getDPPX=(t,e,i)=>{let n=e/t;return n>=s.DPPX||i?n=s.DPPX:(n*=100,n=Math.ceil(n)/100),n},o.getMatrix=t=>{let e=null,i=n(t).getCss("transform")+"";const s=(t,e)=>{const i={},s=["x","y","z"];return t.forEach((function(t,n){var o;i[s[n]]=(o=e[t],parseFloat(o.trim()))})),i};if("none"!==i){e={},i=i.split("(")[1],i=i.split(")")[0],i=i.split(",");const t=i.length>6;e.transform=s(t?[12,13,14]:[4,5],i),e.scale=s(t?[0,5,10]:[0,3],i)}return e},o.getRemoteData=(()=>{const t=window.fetch?(t,e)=>fetch(t,{referrerPolicy:e||"no-referrer-when-downgrade"}).then((t=>{if(200===t.status)return t.json();throw{status:t.status,data:t}})):t=>new Promise(((e,i)=>{const s=new XMLHttpRequest;s?(s.onerror=t=>{i(t||!0)},s.onload=t=>{try{if(200!==s.status)throw{status:s.status,data:t};{const t=JSON.parse(s.responseText);e(t)}}catch(t){i(t)}},s.open("GET",t),void 0!==s.responseType&&(s.responseType="text"),s.send(null)):i(!0)})),e=(t,e)=>new Promise(((i,s)=>{let n=!1;const o=document.createElement("script");window[e]||(window[e]=(...t)=>{n=!0,delete window[e],document.body.removeChild(o),i(t[0])});const r=()=>{n||(delete window[e],document.body.removeChild(o),s(t))};o.onreadystatechange=()=>{"complete"!==this.readyState&&"loaded"!==this.readyState||(this.onreadystatechange=null,setTimeout(r,0))},o.onerror=r,o.onload=r,o.src=t+"&callback="+e,document.body.appendChild(o)}));return(i,s,n)=>new Promise(((r,a)=>{t(i,n).then(r).catch((t=>{t&&t.status&&[404,200].includes(t.status)?a(t):(console.log("XHR error. Switching to JSONP."),s||(s="sirv_data_"+o.generateUUID()),e(i,s).then(r).catch(a))}))}))})(),o.getSirvType=(()=>{const t=t=>{let e=!1;return t&&(e=""!==(t+="").trim()),e};return e=>{let s=(e=n(e)).attr("data-type")||e.attr("data-effect");const r=e.fetch("view-content");let a,h,l=null;if(t(s)&&"static"!==s){const o=i.SLIDE.NAMES.indexOf(s);a=o>=0?o:i.SLIDE.TYPES.ZOOM,s=e.attr("data-src"),t(s)?h=s:(s=n(e.node.getElementsByTagName("img")[0]),s.attr&&(h=s.attr("src")||s.attr("data-src")))}else s=e.attr("data-src"),t(s)?(o.isSpin(s)&&"img"!==e.tagName||r===i.SLIDE.TYPES.SPIN?a=i.SLIDE.TYPES.SPIN:o.isVideo(s)?a=i.SLIDE.TYPES.VIDEO:(a=i.SLIDE.TYPES.IMAGE,r&&(a=r)),h=s):(s=e.attr("src"),t(s)&&"img"===e.tagName&&(h=s,a=i.SLIDE.TYPES.IMAGE));return a&&(l={type:a,imgSrc:h}),l}})(),o.imageLib={isNumber:t=>/(px|%)$/.test(t),getSize:(t,e)=>new Promise(((i,s)=>{const r=n(t).getInnerSize();e||(e=100),e-=1,!r.width&&!r.height&&e>0?setTimeout((()=>{o.imageLib.getSize(t,e).then(i)}),16):i(r)})),getBackgroundValue:t=>t&&/px$/.test(t)?parseInt(t,10):null,getBackgroundSize:t=>{let e=null,i=n(t).getCss("background-size");if(i){i=i.split(",")[0].split(" ");const t=o.imageLib.getBackgroundValue((i[0]||"").trim()),s=o.imageLib.getBackgroundValue((i[1]||"").trim());null!==t&&(e={width:t}),null!==s&&(e||(e={}),e.height=s)}return e},calcProportionalBackgroundSize:(t,e)=>{const i={width:e.width,height:e.height};return t.width&&e.width>t.width&&(i.width=t.width,i.height=t.width*e.height/e.width),t.height&&e.height>t.height&&(i.height=t.height,i.width=t.height*e.width/e.height),i},getBackgroundPositionValue:t=>{let e;switch(t){case"top":case"left":e=0;break;case"center":e=50;break;case"right":case"bottom":e=100;break;default:e=o.imageLib.isNumber(t)?parseInt(t,10):0}return e},getBackgroundPosition:t=>{const e={side:"left",position:0,sign:"%"},i={side:"top",position:0,sign:"%"};let s=0,r=1,a=n(t).getCss("background-position");return a&&(a=a.replace(/important/,""),a=a.replace(/!/g,""),a=a.trim(),a=a.replace(/\s+/g," "),a=a.split(" "),a.length>2&&(s=1,r=3,["left","right"].includes(a[0])&&(e.side=a[0]),["top","bottom"].includes(a[2])&&(i.side=a[2])),e.position=o.imageLib.getBackgroundPositionValue(a[s]),i.position=o.imageLib.getBackgroundPositionValue(a[r]),/px$/.test(a[s])&&(e.sign="px"),/px$/.test(a[r])&&(i.sign="px")),{x:e,y:i}},getPartSize:(t,e)=>{let i,n=0;return i=s.browser.ieMode?(t.currentStyle[e]||"0").replace(/px$/,""):(t.getCss(e)||"0").replace(/px$/,""),isFinite(i)&&(n=Math.round(parseFloat(i))-parseFloat(t.getCss("border-top-width")||0)-parseFloat(t.getCss("border-bottom-width")||0)-parseFloat(t.getCss("padding-top")||0)-parseFloat(t.getCss("padding-bottom")||0)),n},checkMaxSize:(t,e,i)=>{let s,n;return(t.width>e.width*i||t.height>e.height*i)&&(t.width>e.width?(s="width",n="height"):(s="height",n="width"),t[s]=e[s],t[n]&&(t[n]=e[n]),t.round=!1),t},calcImageProportion:(t,e,i,s)=>{const n=i[e]/i[t],o={};return o[t]=s,o[e]=parseInt(n*o[t],10),o},contain:(t,e)=>{let i={width:t.width,height:t.height};return e.width&&i.width>e.width&&(i=o.imageLib.calcImageProportion("width","height",i,e.width)),e.height&&i.height>e.height&&(i=o.imageLib.calcImageProportion("height","width",i,e.height)),i},cover:(t,e)=>{let i={width:t.width,height:t.height};return e.width&&i.width<e.width&&(i=o.imageLib.calcImageProportion("width","height",i,e.width)),e.height&&i.height<e.height&&(i=o.imageLib.calcImageProportion("height","width",i,e.height)),i},calcProportionSize:(t,e,i)=>{let s={},n=e.width,r=e.height;const a=n/r,h=r/n,l=()=>{s.height=t.height,s.width=parseInt(a*t.height,10)},c=()=>{s.width=t.width,s.height=parseInt(h*t.width,10)};return(t.width>n||t.height>r)&&(t.width>n?(t.width=n,t.height&&(t.height>r?t.height=r:l())):(t.height=r,t.width&&(t.width>n?t.width=n:c()))),(t.width||t.height)&&(t.width&&t.height?t.width/t.height-a<=t.height/t.width-h?c():l():t.width?c():l()),i&&(o.imageLib.isNumber(i.width)&&o.imageLib.isNumber(i.height)?(n=parseInt(i.width,10),/%$/.test(i.width)&&(n=n/100*t.width),r=parseInt(i.height,10),/%$/.test(i.height)&&(r=r/100*t.height),s=n<e.width/e.height*r?o.imageLib.calcImageProportion("width","height",e,n):o.imageLib.calcImageProportion("height","width",e,r)):(o.imageLib.isNumber(i.width)&&(n=parseInt(i.width,10),/%$/.test(i.width)&&(n=n/100*t.width),s=o.imageLib.calcImageProportion("width","height",e,n)),o.imageLib.isNumber(i.height)&&(r=parseInt(i.height,10),/%$/.test(i.height)&&(r=r/100*t.height),s=o.imageLib.calcImageProportion("height","width",e,r)),[i.width,i.height].includes("initial")?(s.width=e.width,s.height=e.height):[i.width,i.height].includes("cover")?s=o.imageLib.cover(s,t):[i.width,i.height].includes("contain")&&(s=o.imageLib.contain(s,t)))),s}},o.InViewModule=(()=>{const t=e=>{let i=!0;return"body"!==e.tagName&&(i="none"!==e.getCss("display")&&t(n(e.node.parentNode))),i};const e=new class{constructor(){this.timer=null,this.started=!1,this.list=[]}_startTimer(){this.list.length&&(clearTimeout(this.timer),this.timer=setTimeout((()=>{this._check(),this.started&&this._startTimer()}),500))}_check(){this.list.forEach((e=>{const i=t(e.obj.node),s=i!==e.obj.isShown;e.obj.isShown=i,s&&e.callback(e.obj)}))}push(t,e){const i={obj:t,callback:e};this.list.push(i),this.started||(this.started=!0,this._startTimer())}remove(t){for(let e=0,i=this.list.length;e<i;e++)if(this.list[e].obj.node.node===t){this.list.splice(e,1);break}this.list.length||(this.started=!1)}},i=t=>{let e=[];return Array.isArray(t)?t.forEach((t=>{const i=(t=>{let e=null;return null!==t&&(t=parseFloat(t),isNaN(t)||(t<0&&(t=0),t>1&&(t=1),e=t)),e})(t);null===i||e.includes(i)||e.push(i)})):e=[0],e};class o{constructor(t,e){this.callback=t,this.options=Object.assign({rootMargin:"0px",threshold:[0],root:null},e||{}),this.options.rootMargin=(t=>{let e=[];const i=()=>0;if(t&&!Array.isArray(t)&&(t="number"===s.typeOf(t)?[t]:"string"===s.typeOf(t)?t.split(" ").filter((t=>""!==t)):null),Array.isArray(t)){let n=t.length;switch(n>4&&(n=4),t.forEach((t=>{if(["string","number"].includes(s.typeOf(t))){const i=parseInt(t,10);/%$/.test(t)?e.push((t=>t/100*i)):e.push((t=>i))}else e.push(i)})),n){case 1:e.push(e[0]),e.push(e[0]),e.push(e[0]);break;case 2:e.push(e[0]),e.push(e[1]);break;case 3:e.push(e[1])}}else e=[i,i,i,i];return e})(this.options.rootMargin),this.options.threshold=i(this.options.threshold),this.nodeList=[],this.last=[],this.viewPortSize={top:0,left:0,width:0,height:0},this.correctPosition={top:0,left:0},this.eventWasAdded=!1,this.bindedRender=this._render.bind(this),this.bindedResize=this._resize.bind(this),this._resize()}_addEvents(t){this.eventWasAdded||(this.eventWasAdded=!0,n(window).addEvent("resize",this.bindedResize),n(this.options.root||window).addEvent("scroll",this.bindedRender))}_removeEvents(t){this.eventWasAdded&&(this.eventWasAdded=!1,n(window).removeEvent("resize",this.bindedResize),n(this.options.root||window).removeEvent("scroll",this.bindedRender))}_resize(t){const e=this.options.rootMargin,i=((s=this.options.root)||(s=window),{width:s.offsetWidth||s.innerWidth||document.documentElement.clientWidth,height:s.offsetHeight||s.innerHeight||document.documentElement.clientHeight});var s;this.correctPosition={top:0-e[0](i.width),left:0-e[1](i.width)},this.viewPortSize={width:i.width+e[1](i.width)+e[3](i.width),height:i.height+e[0](i.width)+e[2](i.width)}}_renderElement(t){let e=null;if(t.isShown){const i=((t,e,i)=>{const s=Object.assign({},e);try{const e=n(t).getBoundingClientRect();s.top+=e.top,s.left+=e.left}catch(t){}return Object.assign(s,i)})(this.options.root,this.correctPosition,this.viewPortSize),s=((t,e)=>{const i=t.width||1,s=t.height||1;let n=Math.min(t.left+i,e.left+e.width)-Math.max(t.left,e.left),o=Math.min(t.top+s,e.top+e.height)-Math.max(t.top,e.top);return n<0&&(n=0),o<0&&(o=0),((t,e)=>{let i=0;return t>0&&(i=e/t),i})(i*s,n*o)})(t.node.node.getBoundingClientRect(),i);((t,e,i)=>{let s=!1;if(e!==i)if(e<i){for(let n=0,o=t.length;n<o;n++)if(0===t[n]&&0===e||e<t[n]&&t[n]<=i){s=!0;break}}else for(let n=0,o=t.length;n<o;n++)if(1===t[n]&&1===e||e>t[n]&&t[n]>=i){s=!0;break}return s})(this.options.threshold,t.intersectionRatio,s)&&(t.intersectionRatio=s,e={target:t.node.node,intersectionRatio:t.intersectionRatio,isIntersecting:t.intersectionRatio>0})}return e}_render(){const t=[];this.nodeList.forEach((e=>{const i=this._renderElement(e);i&&t.push(i)})),t.length&&(this.last=t,this.callback(t))}takeRecords(){return this._render(),this.last}observe(i){i={node:i=n(i),isShown:t(i),intersectionRatio:0,isIntersecting:!1},e.push(i,(t=>{const e=this._renderElement(t);e&&(this.last=[e],this.callback([e]))})),this.nodeList.push(i),this._addEvents();let s=this._renderElement(i);s||(s={target:i.node.node,intersectionRatio:0,isIntersecting:!1}),this.callback([s])}unobserve(t){t=n(t);const i=this.nodeList.map((t=>t.node.node)).indexOf(t.node);e.remove(t.node),i>-1&&this.nodeList.splice(i,1),this.nodeList.length||this._removeEvents()}disconnect(){this.nodeList.forEach((t=>{e.remove(t.node)})),this.nodeList=[],this._removeEvents()}}return class{constructor(t,e){const i=window.IntersectionObserver||o;this.observer=new i(t,e||{})}static isInView(t){const e=n(t).getBoundingClientRect();return(e.top>=0||e.top-e.bottom<e.top)&&e.left>=0&&e.top<=(window.innerHeight||document.documentElement.clientHeight)}takeRecords(){return this.observer.takeRecords()}observe(t){t.node&&(t=t.node),this.observer.observe(t)}unobserve(t){this.observer.unobserve(t)}disconnect(){this.observer.disconnect()}}})(),o.isPercentage=t=>/^([-]?[0-9]*\.?[0-9]+)%$/.test(""+t),o.isSVG=t=>!!t&&(t=(t=(t=t.split("?")[0]).split("."))[t.length-1],/svg/i.test(t)),o.isSpin=t=>(t=(t||"").split("?")[0],/([^#?]+)\/?([^#?]+\.spin)(\?([^#]*))?(#(.*))?$/.test(t)),o.isVideo=t=>(t=(t||"").split("?")[0],/([^#?]+)\/?([^#?]+\.(mp4|mov|avi|m4v|mkv|webm|wmv|ogv|ogg))(\?([^#]*))?(#(.*))?$/i.test(t)),o.loadImage=t=>new Promise(((e,i)=>{let o,r,a=!1;if(["array","string"].includes(s.typeOf(t))?("string"===s.typeOf(t)&&(t=[t]),o=s.$new("img").setCss({maxWidth:"none",maxHeight:"none"}),o.attr("referrerpolicy","no-referrer-when-downgrade"),a=!0):(o=n(t),o.node.parentNode||(a=!0)),a&&(r=s.$new("div").setCss({top:"-10000px",left:"-10000px",width:"10px",height:"10px",position:"absolute",overflow:"hidden"}),r.append(o),n(s.D.node.body).append(r)),o.node.complete&&o.node.src)r&&r.remove(),e({image:null,size:o.size});else{const n=t=>{o.removeEvent(["load","error"],n),"error"===t.type?i({error:t}):e({image:t,size:{width:o.node.naturalWidth||o.node.width,height:o.node.naturalHeight||o.node.height}}),r&&r.remove()};o.addEvent(["load","error"],n),r&&"array"===s.typeOf(t)&&(o.attr("src",t[0]),t[1]&&o.attr("srcset",t[1]+" 2x"))}})),o.loadStylesheet=(t,e,i,o)=>new Promise(((r,a)=>{let h=!1;const l=i||s.D.node;if(Array.from(l.querySelectorAll("link")).forEach((e=>{const i=n(e).attr("href")||"";s.getAbsoluteURL(i)===s.getAbsoluteURL(t)&&(h=!0)})),h)r();else{const n=s.$new("link");e!==s.U&&(n.node.id=e),n.node.rel="stylesheet",n.node.type="text/css",n.node.onload=()=>{r()},n.node.onerror=t=>{a(t)},n.node.href=t;let h=s.D.node.head||s.D.node.getElementsByTagName("head")[0]||s.D.node.body||s.D.node.documentElement;i&&(h=i);let l=h.firstChild;const c=h.querySelector(o);c&&c.nextSibling&&(l=c.nextSibling),h.insertBefore(n.node,l)}})),o.makeQueryblePromise=t=>{if(t.isResolved)return t;let e=!0,i=!1,s=!1;const n=t.then((t=>(e=!1,s=!0,t)),(t=>(e=!1,i=!0,t)));return n.isFulfilled=()=>s,n.isPending=()=>e,n.isRejected=()=>i,n},o.paramsFromQueryString=(()=>{const t={w:"scale.width",h:"scale.height",cw:"crop.width",ch:"crop.height",cx:"crop.x",cy:"crop.y",q:"quality",s:"size",text:"text.text",watermark:"watermark.image","watermark.w":"watermark.scale.width","watermark.h":"watermark.scale.height","watermark.cw":"watermark.crop.width","watermark.ch":"watermark.crop.height","watermark.cx":"watermark.crop.x","watermark.cy":"watermark.crop.y"};return e=>{const i={};return e&&(n(e.split("&")).forEach((e=>{const s=e.split("=");s[0]=t[s[0]]||s[0],s[0].trim().split(".").reduce(((t,e,i,n)=>(/^\d$/.test(e)&&(t.__toArray=!0),void 0===t[e]&&(i<n.length-1?t[e]={}:t[e]=(t=>{let e="";const i=t.split(/(%(?:D0|D1)%.{2})/);for(let t=0,s=i.length;t<s;t++){let s;try{s=decodeURIComponent(i[t])}catch(e){s=i[t]}e+=s}return e})(s[1]||"")),t[e])),i)})),Object.keys(i).forEach((t=>{if("object"==typeof i[t]&&i[t].__toArray){delete i[t].__toArray;const e=Object.keys(i[t]);i[t]=e.map((e=>i[t][e]))}}))),i}})(),o.paramsToQueryString=(()=>{const t={"scale.width":"w","scale.height":"h","crop.width":"cw","crop.height":"ch","crop.x":"cx","crop.y":"cy",quality:"q",size:"s","text.text":"text","watermark.image":"watermark","watermark.scale.width":"watermark.w","watermark.scale.height":"watermark.h","watermark.crop.width":"watermark.cw","watermark.crop.height":"watermark.ch","watermark.crop.x":"watermark.cx","watermark.crop.y":"watermark.cy"},e=(i,n)=>{const o=[];for(const r in i){if(!Object.prototype.hasOwnProperty.call(i,r))continue;if("$J"===(r+"").substring(0,2))continue;let a=i[r];if("object"===s.typeOf(a))a=e(a,(n||"")+r+"."),o.push(a);else if("array"===s.typeOf(a))a.forEach(((t,i)=>{a=e(t,(n||"")+r+"."+i+"."),o.push(a)}));else{let e=(n||"")+r;e=t[e]||e,o.push(e+"="+encodeURIComponent(a))}}return o.join("&")};return e})(),o.round=(t,e,i)=>{e||(e=0);let s=Math.pow(10,e);return s=i?parseInt(t*s,10)/s:Math.round(t*s)/s,s},o.roundSize=(t,e)=>(t&&(e||(e=100),t=Math.ceil(t/e)*e),t),o.sendRawStats=(t,e)=>{try{const i="https://stats.sirv.com/"+Date.now();if(!0===e&&navigator.sendBeacon)return void navigator.sendBeacon(i,o.paramsToQueryString(t));const s=new XMLHttpRequest;s.open("POST",i),void 0!==s.responseType&&(s.responseType="text"),s.send(o.paramsToQueryString(t))}catch(t){}},o.sliderLib={findIndex:(t,e,i,n)=>{let r=null;if("string"===s.typeOf(t))switch(t){case"next":t=e+1;break;case"prev":t=e-1}return"number"===s.typeOf(t)&&(r=t,r<0?r=n?o.getArrayIndex(r,i):0:t>=i&&(r=n?o.getArrayIndex(r,i):i-1)),r},getSrc:t=>s.defined(t)&&""!==(t+"").trim()?t+"":null},o.sortSlidesByOrder=(t,e)=>{const s=e.slice(),n=[];if(t&&t.length)for(let e=0,o=Math.min(t.length,s.length);e<o;e++)for(let o=0,r=s.length;o<r;o++)if(i.SLIDE.NAMES.indexOf(t[e])===s[o].type&&s[o].enabled){n.push(s[o]),s.splice(o,1);break}return s.forEach((t=>{n.push(t)})),n},o.spinLib=(()=>{const t={calcProportionSize:(t,e,i,s)=>{let n=e.width,o=e.height;if(n>t.width){const e=o/n;n=t.width,o=parseInt(n*e,10)}if(o>t.height){const e=n/o;o=t.height,n=parseInt(o*e,10)}return s||e.width<n&&(n=e.width,o=e.height),{width:n,height:o}},reverse:(t,e,i)=>{if(t)for(let t=0,e=i.length;t<e;t++)i[t].reverse();return e&&i.reverse(),i},getNextIndex:(t,e,i,s,n)=>{let r;return i?"next"===i?(r=t+e,n?r=o.getArrayIndex(r,s):r>=s&&(r=s-1)):(r=t-e,n?r=o.getArrayIndex(r,s):r<0&&(r=0)):(r=e,n?r=o.getArrayIndex(r,s):(r>=s&&(r=s-1),r<0&&(r=0))),r},getUrl:t=>{let e=t;return e=e.split("/"),e.splice(e.length-1,1),e=e.join("/"),e=e.replace(/https?:/,""),e},swapLayers:(t,e)=>{let i=t;return e&&(i={},Object.entries(t).forEach((([t,e])=>{Object.entries(e).forEach((([e,s])=>{i[e]||(i[e]={}),i[e][t]=s}))}))),i},getMaxCount:t=>Math.max(0,...Object.values(t).map((t=>Object.keys(t).length))),correctArray:(t,e)=>{let i=[],s=e-t.length;if(s>0){const e=t.length;for(let n=0;n<e-1;n++){const e=parseInt(t[n],10);let o=parseInt(t[n+1],10)-e-1;if(i.push(t[n]),o>0&&s>0)for(o>s&&(o=s);o>0;)o-=1,s-=1,i.push(t[n])}if(i.push(t[e-1]),s>0){let e=parseInt(t[0],10)-1;if(e>0)for(;e>0;)e-=1,s-=1,i.unshift(t[0]);if(s>0)for(;s>0;)s-=1,i.push(t[t.length-1])}}else i=JSON.parse(JSON.stringify(t));return i},getFrames:(e,i)=>{const s={},o=t.correctArray(Object.keys(e),i);return n(o).forEach(((t,i)=>{s[i+1+""]=e[t]})),s},checkLayers:e=>{const i={},s=t.getMaxCount(e);return Object.values(e).forEach(((e,n)=>{i[n+1+""]=t.getFrames(e,s)})),i}};return t})(),o.toInteger=t=>(t?"string"===s.typeOf(t)&&(t=parseInt(t,10),isNaN(t)&&(t=0)):t=0,t),o.videoModule=(()=>{let t=null,e=null;const i={},o="0.jpg",r="default.jpg",a=t=>new Promise(((e,i)=>{const s=new XMLHttpRequest;s.open("GET",t,!0),s.onreadystatechange=()=>{if(4===s.readyState&&200===s.status)try{const t=JSON.parse(s.responseText)[0];e(t)}catch(t){i(null)}},s.send(!0)})),h=t=>(t=n(t))&&"video"===t.tagName,l=t=>{let e=null;return void 0!==(t=t.replace(/(>|<)/gi,"").split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/))[2]&&(t=t[2].split(/[^0-9a-z_\-]/i)).length&&t[0]&&(e=t[0]),e},c=t=>{let e=null;return(t=t.match(/(?:https?:\/\/)?(?:www.)?(?:player.)?vimeo.com\/(?:[a-z]*\/)*([0-9]{6,11})[?]?.*/)[1])&&(e=t),e},d=t=>{let e=null;if("string"===s.typeOf(t))e=t;else if((t=n(t))&&"element"===s.typeOf(t.node))if(["iframe","div"].includes(t.tagName))e=t.attr("src")||t.attr("data-src");else if(h(t)&&(e=t.attr("src")||t.attr("data-src"),!e)){e=null;const i=Array.from(t.node.children);let o;do{o=n(i.shift()),o&&"element"===s.typeOf(o.node)&&"source"===o.tagName&&(e=o.attr("src")||o.attr("data-src"))}while(!e&&o)}return e},p={aspectratio:9/16,getAspectRatio:t=>new Promise(((e,s)=>{let n;(t=d(t))&&i[t]&&e(i[t].aspectratio);"vimeo"===p.getType(t)?(n=c(t),n?a("https://vimeo.com/api/v2/video/"+n+".json").then((t=>{e(t?t.height/t.width:p.aspectratio)})).catch((t=>{s(t)})):e(p.aspectratio)):e(p.aspectratio)})),getId:t=>{let e=null;if(p.isVideo(t))switch(t=d(t),p.getType(t)){case"youtube":e=l(t);break;case"vimeo":e=c(t)}return e},isVideo:t=>{let e=!1;return h(t)?e=!0:(t=d(t))&&(e=["youtube","vimeo"].includes(p.getType(t))),e},getType:t=>{let e=null;return h(t)?e="video":(t=d(t))&&(/^(https?:)?\/\/((www\.)?youtube\.com|youtu\.be)\//.test(t)?e="youtube":/^(https?:)?\/\/((www|player)\.)?vimeo\.com\//.test(t)&&(e="vimeo")),e},getImageSrc:(t,e)=>new Promise(((h,u)=>{let g;t&&n(t)&&"element"===s.typeOf(n(t).node)&&(g=t),t=d(t);let m=null;if(t){if(i[t])if(e){if(i[t].all)return void h(i[t].all)}else{if(i[t].url)return void h(i[t].url);if(i[t].all)return void h(i[t].all.thumbnail.url)}let d;switch(p.getType(g||t)){case"youtube":d=l(t),d&&(m=e?{thumbnail:{url:"https://img.youtube.com/vi/"+d+"/"+r,width:120,height:90},medium:{url:"https://img.youtube.com/vi/"+d+"/"+o,width:480,height:360}}:"https://img.youtube.com/vi/"+d+"/"+r,i[t]||(i[t]={}),i[t].aspectratio=p.aspectratio,e?i[t].all=m:i[t].url=m),h(m);break;case"vimeo":d=c(t),d?(m="https://vimeo.com/api/v2/video/"+d+".json",a(m).then((s=>{let n=null;s&&(n=e?{thumbnail:{url:s.thumbnail_small,width:100,height:75},medium:{url:s.thumbnail_medium,width:200,height:150}}:s.thumbnail_small),n&&(i[t]||(i[t]={}),e?i[t].all=n:i[t].url=n,i[t].aspectratio=s.height/s.width),h(n)})).catch(u)):h(m);break;case"video":if(g)if(g=n(g.node.cloneNode(!0)),g.attr&&(m=g.attr("poster")),m&&""!==m.trim())i[t]||(i[t]={}),i[t].aspectratio=p.aspectratio,e?(i[t].all={thumbnail:{url:m,width:200,height:150},medium:{url:m,width:200,height:150}},h(i[t].all)):(i[t].url=m,h(m));else{const o=0,r=s.$new("canvas"),a=r.node.getContext("2d"),l=()=>{g.removeEvent(["loadedmetadata","loadeddata","abort","error","stalled"]),g.remove()};(()=>{let t=g.attr("data-src");t&&g.attr("src",t),Array.from(g.node.children).forEach((e=>{(e=n(e))&&"source"===e.tagName&&(t=e.attr("data-src"),t&&e.attr("src",t))}))})(),g.setCss({top:-1e5,left:-1e5,width:200,height:150,position:"absolute"}),g.muted=!0,g.addEvent("loadedmetadata",(t=>{const e=g.size;e.width&&e.height||(e.width=200,e.height=150),g.setCss({width:e.width,height:e.height}),r.node.width=e.width,r.node.height=e.height,o<g.node.duration&&(g.node.currentTime=o)})),g.addEvent("loadeddata",(t=>{g.currentTime=o})),g.addEvent(["abort","error","stalled"],(t=>{l(),u(null)})),g.addEvent("seeked",(s=>{a.drawImage(g.node,0,0,r.node.width,r.node.height),l();try{m=r.node.toDataURL()}catch(t){}m?(i[t]||(i[t]={}),i[t].aspectratio=p.aspectratio,e?(i[t].all={thumbnail:{url:m,width:200,height:150},medium:{url:m,width:200,height:150}},h(i[t].all)):(i[t].url=m,h(m))):h(m)})),g.appendTo(s.D.node.body),g.node.load()}else h(m);break;default:h(m)}}else h(m)})),getSrc:d,getAPI:i=>{let o=null;if(p.isVideo(i))switch(p.getType(i)){case"video":o=Promise.resolve();break;case"vimeo":t||(t=new Promise(((t,e)=>{if(s.W.node.Vimeo)t(s.W.node.Vimeo);else if("function"==typeof s.W.node.define&&s.W.node.define.amd&&"function"==typeof s.W.node.require)s.W.node.require(["https://player.vimeo.com/api/player.js"],(e=>{t({Player:e})}),e);else{const i=s.$new("script");i.attr("src","https://player.vimeo.com/api/player.js"),n(i).addEvent("load",(()=>{t(s.W.node.Vimeo)})),n(i).addEvent("error",e),i.appendTo(document.body)}}))),o=t;break;case"youtube":e||(e=s.W.node.YT?Promise.resolve(s.W.node.YT):new Promise(((t,e)=>{const i=s.W.node.onYouTubeIframeAPIReady||(()=>{});s.W.node.onYouTubeIframeAPIReady=()=>{i(),t(s.W.node.YT)},document.querySelector('script[src$="youtube.com/iframe_api"]')||s.$new("script",{src:"https://www.youtube.com/iframe_api"}).appendTo(s.D.node.body)}))),o=e}else o=Promise.reject(!0);return o}};return p})(),o})),Sirv.define("EventEmitter",["bHelpers","magicJS","helper"],((t,e,i)=>{const s=e,n=s.$;class o{constructor(t,e,i){this.type=t,this._direction=e,this.propagation=!0,this.nextCalls=!0,this.emptyEvent=!0,this.data=Object.assign(i,{eventType:this.type,eventDirection:this._direction,stopEmptyEvent:this.stopEmptyEvent.bind(this),stopPropagation:this.stopPropagation.bind(this),stopNextCalls:this.stopNextCalls.bind(this),stop:this.stop.bind(this),stopAll:this.stopAll.bind(this)})}copyData(){const t=Object.assign({},this.data);return delete t.eventDirection,delete t.stopEmptyEvent,delete t.stopPropagation,delete t.stopNextCalls,delete t.stop,delete t.stopAll,t}get customData(){return this.data}get direction(){return this._direction}get emptyEventStopped(){return!this.emptyEvent}get propagationStopped(){return!this.propagation}get nextCallsStopped(){return!this.nextCalls}stopEmptyEvent(){this.emptyEvent=!1}stopPropagation(){this.propagation=!1}stopNextCalls(){this.nextCalls=!1}stop(){this.stopPropagation(),this.stopEmptyEvent()}stopAll(){this.stop(),this.stopNextCalls()}}const r=(t,e)=>("string"===s.typeOf(t)?""===(t=t.trim())&&(t=e):t=e,t);return class{constructor(){this.__parent=null,this.__childs=n([]),this.__subscribers={},this.__NAME_OF_EMPTY_EVENT="__empty__"}__setChild(t){this.__childs.push(t)}__removeChild(t){const e=this.__childs.indexOf(t);-1!==e&&this.__childs.splice(e,1)}set parentClass(t){this.__parent=t,this.__parent.__setChild(this)}__removeParent(){this.__parent&&(this.__parent.__removeChild(this),this.__parent=null)}__callNext(t){t.propagationStopped||("up"===t.direction?this.__parent&&this.__parent.__next(t):this.__childs.forEach((e=>{e.__next(t)})))}__next(t){const e=this.__subscribers[t.type];if(t=new o(t.type,t.direction,t.copyData()),e)for(let i=0,s=e.length;i<s&&(e[i](t.customData,t,this),!t.nextCallsStopped);i++);if(Object.prototype.hasOwnProperty.call(this.__subscribers,this.__NAME_OF_EMPTY_EVENT)&&!t.emptyEventStopped)for(let e=0,i=this.__subscribers[this.__NAME_OF_EMPTY_EVENT].length;e<i;e++)this.__subscribers[this.__NAME_OF_EMPTY_EVENT][e](t.customData);this.__callNext(t)}emit(t,e){e&&"object"===s.typeOf(e)||("object"===s.typeOf(t)?(e=t,t=null):e={}),t=r(t,this.__NAME_OF_EMPTY_EVENT),this.__callNext(new o(t,"up",e))}broadcast(t,e){e&&"object"===s.typeOf(e)||("object"===s.typeOf(t)?(e=t,t=null):e={}),t=r(t,this.__NAME_OF_EMPTY_EVENT),this.__callNext(new o(t,"down",e))}on(t,e){const i=this;return"function"===s.typeOf(t)&&(e=t,t=null),e?(t=r(t,this.__NAME_OF_EMPTY_EVENT),this.__subscribers[t]||(this.__subscribers[t]=[]),this.__subscribers[t].push(e),()=>i.off(t,e)):null}off(t,e){let i;"function"===s.typeOf(t)&&(e=t,t=null),t=r(t,this.__NAME_OF_EMPTY_EVENT),e?Object.prototype.hasOwnProperty.call(this.__subscribers,t)&&(i=this.__subscribers[t].indexOf(e),-1!==i&&this.__subscribers[t].splice(i,1)):delete this.__subscribers[t]}destroy(){this.__removeParent(),this.__childs=n([]),this.__subscribers={}}}})),Sirv.define("EventManager",["bHelpers","magicJS","globalVariables","globalFunctions","EventEmitter","helper"],((t,e,i,s,n,o)=>{const r=e;r.$;class a extends n{constructor(t){super(),this.items=t,this.events={lazyimage:{},viewer:{},spin:{},zoom:{},image:{},video:{}},this.reversedEvents=[],this.addEvents()}static eventsNameParser(t){let e=null;return t&&"string"===r.typeOf(t)&&(e=t.split(":").map((t=>t.trim())).filter((t=>""!==t)),/sirv/i.test(e[0])&&e.shift(),e.length<2&&(e=null)),e}static triggerCustomEvent(t,e,i,s,n){let o;s===r.U&&(s=!0),n===r.U&&(n=!0);try{o=new CustomEvent(t,{bubbles:s,cancelable:n,detail:i})}catch(e){try{o=r.D.createEvent("Event"),o.initEvent(t,s,n),o.detail=i}catch(t){}}o&&e.node.dispatchEvent(o)}addReverseEvent(t,e,i){this.reversedEvents.push({eventName:t,componentName:i,callback:e})}callReverseCallback(t,e,i){let s=!1;for(let n=0,o=this.reversedEvents.length;n<o;n++)if(this.reversedEvents[n].componentName===t&&this.reversedEvents[n].eventName===e){this.reversedEvents[n].callback(i),this.reversedEvents.splice(n,1),s=!0;break}return s}addEvents(){this.on("destroy",(t=>{t.stopAll(),s.stop(t.data.node,"viewer")})),this.on("imagePublicEvent",(t=>{t.stopAll();if(!this.callReverseCallback("lazyimage",t.data.type,t.data.image)){a.triggerCustomEvent("sirv:lazyimage:"+t.data.type,t.data.node,Object.assign({},t.data.image));const e=this.events.lazyimage[t.data.type];e&&e.forEach((e=>{e(t.data.image)}))}})),this.on("viewerPublicEvent",(t=>{let e,i,n;t.stopAll();let o="viewer";"componentEvent"===t.data.slider.type?(i=t.data.type,n=Object.assign({},t.data.slide[t.data.slide.component]),o=t.data.slide.component,t.data.node&&(e=t.data.componentEventData.node),Object.entries(t.data.componentEventData).forEach((([e,i])=>{"node"===e?t.data.node&&(n[e]=i.node):"type"!==e&&(n[e]=i)}))):(i=t.data.slider.type,"ready"===i&&s.iconsHash.remove(),t.data.node&&(e=t.data.node),t.data.slider&&(n=t.data.slider,"sendStats"===i&&(n.statsData=t.data.event)),["beforeSlideIn","beforeSlideOut","afterSlideIn","afterSlideOut","enableItem","disableItem","thumbnailClick"].includes(i)&&(n=t.data.slide));if(!this.callReverseCallback(o,i,n)){e&&a.triggerCustomEvent("sirv:"+o+":"+i,e,Object.assign({},n));const t=this.events[o][i];t&&t.forEach((t=>{t(n)}))}})),this.on((t=>{t.stopAll()}))}addEvent(t,e){let i=()=>!1;const s=a.eventsNameParser(t);if(s&&this.events[s[0]]&&e){if(this.events[s[0]][s[1]]||(this.events[s[0]][s[1]]=[]),this.events[s[0]][s[1]].push(e),["ready","init","onLoad"].includes(s[1])){const t="lazyimage"===s[0]?"image":"viewer";("viewer"===t&&"onLoad"!==s[1]||"onLoad"===s[1]&&"image"===t)&&setTimeout((()=>{this.items[t].forEach((t=>{t.checkReadiness(s[1],s[0])&&(this.addReverseEvent(s[1],e,s[0]),t.sendEvent(s[1],s[0]))}))}),0)}i=()=>this.removeEvent(t,e)}return i}removeEvent(t,e){const i=a.eventsNameParser(t);if(i&&this.events[i[0]]&&this.events[i[0]][i[1]]){if(!e)return delete this.events[i[0]][i[1]],!0;{const t=this.events[i[0]][i[1]].indexOf(e);if(t>=0)return this.events[i[0]][i[1]].splice(t,1),!0}}return!1}}return a})),Sirv.define("ContextMenu",["bHelpers","magicJS","globalVariables","globalFunctions"],((t,e,i,s)=>{const n=e,o=n.$;return class{constructor(t,e,i){void 0===i&&(i="magic"),this.CSS_CLASS=i+"-contextmenu",this.target=t,this.conext=null,this.overlay=null,this.items={},this.active=!1,this.showBind=null,this.hideBind=null,this.hideOnScrollBind=null,this.context=null,this._canShow=!0,this._position={top:null,left:null},this._fullScreenBox=null,this.setup(e||[])}get position(){return{top:this._position.top,left:this._position.left}}isExist(t){return!!this.items[t]}setup(t){this.context=n.$new("ul").addClass(this.CSS_CLASS).addEvent(["contextmenu","dragstart","selectstart"],(t=>{t.stop()})),t.forEach((t=>{this.addItem(t)})),this.hideFX=new n.FX(this.context,{duration:200,onComplete:()=>{this.context.remove()}}),this.target.addEvent("contextmenu",this.showBind=this.show.bind(this)),this.overlay=n.$new("div").addClass(this.CSS_CLASS+"-overlay").addEvent("click contextmenu",this.hide.bind(this)).addEvent("mousescroll",(t=>{t.stop(),o(t).events[0].stop().stopQueue()})),this.hideBind=o((t=>{this.active&&(t.stop(),27===t.originEvent.keyCode&&this.hide())})).bind(this),n.W.addEvent("keydown",this.hideBind,1),this.hideOnScrollBind=o((t=>{this.active&&this.hide()})).bind(this),n.W.addEvent("scroll",this.hideOnScrollBind)}addItem(t){const e=this,i=n.$new("li").appendTo(this.context);n.defined(t.separator)?i.addClass("menu-separator"):n.defined(t.label)&&(i.append(n.D.node.createTextNode(t.label)),n.defined(t.disabled)&&!0===t.disabled&&i.attr("disabled",!0),"function"===n.typeOf(t.action)&&i.addEvent("btnclick",(s=>{s.stop(),i.attr("disabled")||(e.hide(),t.action.call(t.action,e.position))}))),n.defined(t.hidden)&&!0===t.hidden&&i.setCss({display:"none"});const s=t.id||"item-"+Math.floor(Math.random()*Date.now());return this.items[s]=i,s}hideItem(t){this.items[t]&&o(this.items[t]).setCss({display:"none"})}showItem(t){this.items[t]&&o(this.items[t]).setCss({display:""})}disableItem(t){this.items[t]&&o(this.items[t]).attr("disabled",!0)}enableItem(t){this.items[t]&&o(this.items[t]).removeAttr("disabled")}show(t){let e=n.D.node.body;if(!this._canShow)return;this.hideFX.stop(),n.browser.fullScreen.enabled()&&(this._fullScreenBox||n.D.msFullscreenElement)&&(e=this._fullScreenBox||n.D.msFullscreenElement),this.overlay.appendTo(e),this.context.setCss({top:-1e4}).appendTo(e);const i=t.clientXY;let s=i.x,o=i.y;const r=t.pageXY;this._position.top=r.y,this._position.left=r.x;const a=(t=>{const e=n.W.size,i=n.W.scroll;return{left:t=t||0,right:e.width-t,top:t,bottom:e.height-t,x:i.x,y:i.y}})(5),h=this.context.size;a.right<s+h.width&&(s-=h.width),a.bottom<o+h.height&&(o=a.bottom-h.height),this.context.setCss({top:o,left:s,display:"block",opacity:1}),this.active=!0}hide(t){if(this.active&&(this.overlay.remove(),this.hideFX.start({opacity:[1,0]}),this.active=!1,t&&(t.stopDefaults(),"contextmenu"===t.type))){const e=t.pageXY,i=this.target.rect;i.left<=e.x&&i.right>=e.x&&i.top<=e.y&&i.bottom>=e.y&&this.show(t)}}set canShow(t){this._canShow=t}set fullScreenBox(t){this._fullScreenBox=t}destroy(){this.target.removeEvent("contextmenu",this.showBind),n.W.removeEvent("keydown",this.hideBind).removeEvent("scroll",this.hideOnScrollBind);try{this.context.kill()}catch(t){}try{this.overlay.kill()}catch(t){}}}})),Sirv.define("BaseInstance",["bHelpers","magicJS","EventEmitter","helper"],((t,e,i,s)=>{const n=e,o=n.$;return class extends i{constructor(t,e,i){super(),this.defaultSchema=i,this._options=e,this.instanceNode=o(t),this.instanceUrl=this.instanceNode.attr("data-src")||this.instanceNode.attr("src")||this.instanceNode.attr("data-bg-src"),this.option=null,this.ready=!1,this.id=null,this.isCustomId=!1,this.isStartedFullInit=!1,this.isStarted=!1,this.destroyed=!1,this.referrerPolicy=this.instanceNode.attr("data-referrerpolicy")||this.instanceNode.attr("referrerpolicy")||"no-referrer-when-downgrade",this.instanceOptions=this.makeOptions(),this.createOptionFunction();const s=this;this.api={isReady:()=>s.ready,resize:s.resize,getOptions:s.options}}setOptions(t,e,i,s){return t.fromJSON(e),t.fromString(i),t.fromString(s),t}makeGlobalOptions(t){const e=this._options.options;return this.setOptions(t,e.common.common,e.local.common,this.instanceNode.attr("data-options")||"")}makeMobileOptions(t){const e=this._options.options;return this.setOptions(t,e.common.mobile,e.local.mobile,this.instanceNode.attr("data-mobile-options")||"")}makeOptions(){let t=new n.Options(this.defaultSchema);return t=this.makeGlobalOptions(t),n.browser.touchScreen&&n.browser.mobile&&(t=this.makeMobileOptions(t)),t}getOptionsForStartFullInit(t){t&&(this._options.options=t,this.instanceOptions=this.makeOptions(),this.createOptionFunction())}get options(){return this.instanceOptions.getJSON()}resize(){return!!this.ready&&this.onResize()}onResize(){return!0}get imageClassContainer(){return{}}checkImage(t,e){let i;const s=this.imageClassContainer;return i=e?s.isExist(t):s.isLoaded(t),i}getId(t,e){this.id=this.instanceNode.attr("id"),this.id||(this.isCustomId=!0,t||(t="component-"),e||(e="smv-"),this.id=e+t+s.generateUUID(),this.id=this.id.trim(),this.instanceNode.attr("id",this.id))}createOptionFunction(){this.option=(...t)=>t.length>1?this.instanceOptions.set(t[0],t[1]):this.instanceOptions.get(t[0])}startFullInit(t){this.destroyed||this.isStartedFullInit||(this.isStartedFullInit=!0,this.getOptionsForStartFullInit(t))}get originImageUrl(){return null}run(){return!this.isStarted&&(this.isStarted=!0,!0)}done(){this.ready=!0}destroy(){this.destroyed=!0,this.isStarted=!1,this.ready=!1,this.isStartedFullInit=!1,this.isCustomId&&(this.instanceNode.removeAttr("id"),this.isCustomId=!1),this.instanceNode=null,super.destroy()}}})),Sirv.define("Instance",["bHelpers","magicJS","globalVariables","globalFunctions","BaseInstance","helper"],((t,e,i,s,n,o)=>{const r=e,a=(r.$,t=>new Error("This method '"+t+"' is not implemented."));return class extends n{constructor(t,e,n){super(t,e,n),this.type=i.SLIDE.TYPES.NONE,this.always=e.always,this.quality=e.quality,this.hdQuality=e.hdQuality,this.isHDQualitySet=e.isHDQualitySet,this.isFullscreenEnabled=e.isFullscreen,this.dataAlt=null,this.isSlideShown=!1,this.isInView=!1,this.preload=!1,this.firstSlideAhead=!1,this.infoSize=null,this.pinchCloud=null,this.onLoad=!1,this.waitToStart=new o.WaitToStart,this.waitGettingInfo=new o.WaitToStart,this.gettingInfoPromise=null,this.fullscreenState=i.FULLSCREEN.CLOSED,this.baseUrl=s.normalizeURL(this.instanceUrl.replace(i.REG_URL_QUERY_STRING,"$1")),this.queryParams=this.instanceUrl.replace(i.REG_URL_QUERY_STRING,"$2"),this.on("stats",(t=>{t.data.component=i.SLIDE.NAMES[this.type]}))}sendEvent(t,e){e||(e={}),e.event||(e.event={}),e.id=this.id,e.url=this.instanceUrl,e.event.timestamp=Date.now(),e.event.type=i.SLIDE.NAMES[this.type]+":"+t,this.emit("componentEvent",{data:{type:t,data:e}})}onStartActions(){}onStopActions(){}onInView(t){}onBeforeFullscreenIn(t){}onAfterFullscreenIn(t){}onBeforeFullscreenOut(t){}onAfterFullscreenOut(t){}onMouseAction(t){}onSecondSelectorClick(){}onStopContext(){}loadContent(){return!0}loadThumbnail(){return!this.destroyed&&(this.waitToStart.start(),!0)}startGettingInfo(){return!this.destroyed&&(this.waitGettingInfo.start(),!0)}startFullInit(t){this.isStartedFullInit||(super.startFullInit(t),t&&(this.always=t.always),this.dataAlt=this.instanceNode.attr("data-alt"),this.on("startActions",(t=>{t.stop(),this.isSlideShown=!0,this.onStartActions(t.who)})),this.on("stopActions",(t=>{t.stop(),this.isSlideShown=!1,this.onStopActions()})),this.on("inView",(t=>{t.stop();const e=t.data;this.onInView(e),this.isInView=e})),this.setEvents())}isFullscreenActionEnded(){return[i.FULLSCREEN.CLOSED,i.FULLSCREEN.OPENED].includes(this.fullscreenState)}setEvents(){this.on("beforeFullscreenIn",(t=>{t.stop(),this.fullscreenState===i.FULLSCREEN.OPENED||this.destroyed||(this.fullscreenState=i.FULLSCREEN.OPENING,this.onBeforeFullscreenIn(t.data))})),this.on("afterFullscreenIn",(t=>{t.stop(),this.destroyed||(this.fullscreenState=i.FULLSCREEN.OPENED,this.onAfterFullscreenIn(t.data))})),this.on("beforeFullscreenOut",(t=>{t.stop(),this.fullscreenState===i.FULLSCREEN.CLOSED||this.destroyed||(this.fullscreenState=i.FULLSCREEN.CLOSING,this.onBeforeFullscreenOut(t.data))})),this.on("afterFullscreenOut",(t=>{t.stop(),this.destroyed||(this.fullscreenState=i.FULLSCREEN.CLOSED,this.onAfterFullscreenOut(t.data))}))}getSelectorImgUrl(t){return Promise.reject(a("getSelectorImgUrl"))}getInfoSize(){return Promise.reject(a("getInfoSize"))}run(t,e,i){const s=super.run();return s&&(this.isSlideShown=t,this.preload=e,this.firstSlideAhead=i,this.firstSlideAhead||this.waitToStart.start()),s}getThumbnailData(){return{src:null}}getSocialButtonData(t){const e=t;(this.infoSize.width<t.width||this.infoSize.height<t.height)&&(e.width=this.infoSize.width,e.height=this.infoSize.height);return this.getThumbnailData(e).src}createPinchEvent(t){const e={isAdded:!1,pinch:!1,scale:0,block:!1,onPinchStart:t=>{},onPinchResize:t=>{},onPinchMove:t=>{},onPinchEnd:t=>{e.pinch&&(e.pinch=!1,this.sendEvent("pinchEnd")),e.block=!1},handler:t=>{switch(t.state){case"pinchstart":e.onPinchStart(t);break;case"pinchresize":e.onPinchResize(t);break;case"pinchmove":e.onPinchMove(t);break;case"pinchend":e.onPinchEnd(t)}e.pinch&&t.stop()},addEvent:()=>{!e.isAdded&&r.browser.touchScreen&&(t.addEvent("pinch",e.handler),e.isAdded=!0)},removeEvent:()=>{e.isAdded&&(t.removeEvent("pinch",e.handler),e.isAdded=!1,e.block=!1,e.pinch=!1)}};e.addEvent(),this.pinchCloud=e}done(){super.done(),this.createPinchEvent(),this.on("resize",(t=>{t.stop(),this.onResize()})),this.on("stopContext",(t=>{t.stop(),this.onStopContext()})),this.on("secondSelectorClick",(t=>{t.stopAll(),this.onSecondSelectorClick()})),this.on("mouseAction",(t=>{t.stop(),this.onMouseAction(t.data.type)})),this.on("dragEvent",(t=>{t.stop(),this.pinchCloud&&("dragstart"===t.data.type?this.pinchCloud.removeEvent():"dragend"===t.data.type&&this.pinchCloud.addEvent())})),this.sendEvent("ready")}sendContentLoadedEvent(){this.onLoad||(this.onLoad=!0,this.sendEvent("contentLoaded"))}destroy(){this.off("stats"),this.off("startActions"),this.off("stopActions"),this.off("inView"),this.off("resize"),this.off("stopContext"),this.off("secondSelectorClick"),this.off("mouseAction"),this.off("dragEvent"),this.off("beforeFullscreenIn"),this.off("afterFullscreenIn"),this.off("beforeFullscreenOut"),this.off("afterFullscreenOut"),this.pinchCloud=null,this.isSlideShown=!1,super.destroy(),this.waitGettingInfo.destroy(),this.waitGettingInfo=null,this.waitToStart.destroy(),this.waitToStart=null,this.gettingInfoPromise=null}}})),Sirv.define("HotspotInstance",["bHelpers","magicJS","Instance"],((t,e,i)=>{const s=e.$,n=(t,e)=>{console.warn("sirv.js: The "+t+" method is deprecated and will be removed. \r\n           Use "+e+" instead.")};return class extends i{constructor(t,e,i){super(t,e,i),this.hotspots=null,this.hotspotsData=null;const s=this;this.api=Object.assign(this.api,{addHotspot:t=>{n(".addHotspot()",".hotspots.add()"),s.hotspots.api.add(t),s.isInView&&s.isSlideShown&&s.hotspots.showNeededElements()},removeHotspot:t=>{n(".removeHotspot()",".hotspots.remove()"),s.hotspots.api.remove(t)},removeAllHotspots:()=>{n(".removeAllHotspots()",".hotspots.removeAll()"),s.hotspots.api.removeAll()},getHotspots:()=>(n(".getHotspots()",".hotspots.list()"),s.hotspots.api.list())})}createHotspotsClass(t,e){this.hotspots=new t(e),this.hotspots.parentClass=this,this.on("hotspotActivate",(t=>{t.stopAll(),this.onHotspotActivate(t.data),this.sendEvent("hotspotOpened")})),this.on("hotspotDeactivate",(t=>{t.stopAll(),this.onHotspotDeactivate(t.data),this.sendEvent("hotspotClosed")})),this.api=Object.assign(this.api,{hotspots:this.hotspots.api});const i=this;this.api.hotspots.add=t=>{if(t){let e=null;if(!i.hotspots.api.list().length){const t=this.getParentContainer();e=i.hotspots.getRightBoundengClientRect(this.getContainerForBoundengClientRect()),i.hotspots.appendTo(t)}i.hotspots.addHotspot(t),i.hotspots.containerSize=e,i.hotspots.showAll(),i.isInView&&i.isSlideShown&&i.hotspots.showNeededElements()}}}getContainerForBoundengClientRect(){return this.getParentContainer()}done(){if(!this.ready&&!this.destroyed&&this.hotspots){let t=this.instanceNode;"img"===t.tagName&&(t=s(t.node.parentNode)),this.hotspotsData&&this.hotspotsData.length&&(this.hotspots.appendTo(t),this.hotspots.createHotspots(this.hotspotsData)),this.nativeFullscreen&&this.hotspots.changeBoxContainerParent(!0),this.hotspots.showAll()}super.done()}getParentContainer(){let t=this.instanceNode;return"img"===t.tagName&&(t=s(t.node.parentNode)),t}onHotspotActivate(t){}onHotspotDeactivate(t){}onStartActions(){this.hotspots&&this.isInView&&this.isSlideShown&&this.hotspots.showNeededElements(),super.onStartActions()}onStopActions(){this.hotspots&&this.hotspots.hideActiveHotspotBox(!0),super.onStopActions()}onBeforeFullscreenIn(t){this.hotspots&&(this.hotspots.hideActiveHotspotBox(),this.nativeFullscreen&&this.hotspots.changeBoxContainerParent(!0))}onBeforeFullscreenOut(t){this.hotspots&&(this.hotspots.hideActiveHotspotBox(),this.nativeFullscreen&&this.hotspots.changeBoxContainerParent())}onAfterFullscreenOut(t){this.hotspots&&this.isInView&&this.isSlideShown&&this.hotspots.showNeededElements()}destroy(){this.hotspots&&this.hotspots.destroy(),this.hotspots=null,this.off("hotspotActivate"),this.off("hotspotDeactivate"),super.destroy()}}})),Sirv.define("Loader",["bHelpers","magicJS","globalVariables","globalFunctions","helper","EventEmitter"],((t,e,i,s,n,o)=>{const r=e,a=r.$;return class extends o{constructor(t,e){super(),this.parentNode=a(t),this.options=Object.assign({width:null,height:null,class:null},e||{}),this.node=r.$new("div").addClass("smv-loader"),this.type="simple",this.inDoc=!1,this.options.class&&this.node.addClass(this.options.class),this.options.width&&this.node.setCssProp("width",this.options.width),this.options.height&&this.node.setCssProp("height",this.options.height)}append(){this.inDoc||(this.inDoc=!0,this.parentNode.append(this.node))}show(){this.append(),this.node.setCss({display:"",visibility:"visible"})}hide(){this.node.setCss({display:"none",visibility:"hidden"})}destroy(){this.hide(),this.node.remove(),this.node=null,this.inDoc=!1,super.destroy()}}})),Sirv.define("RoundLoader",["bHelpers","magicJS","globalVariables","globalFunctions","helper","Loader"],((t,e,i,s,n,o)=>{const r=e,a=(r.$,"smv-show");return class extends o{constructor(t,e){super(t,e),this.type="round",this.state=i.APPEARANCE.HIDDEN,this.timer=null,this.loaderElement=r.$new("div"),this.addClass(),this.node.append(this.loaderElement)}addClass(){this.node.addClass("smv-round-loader")}isHiding(){return this.state===i.APPEARANCE.HIDING}show(){[i.APPEARANCE.SHOWING,i.APPEARANCE.SHOWN].includes(this.state)||(this.state=i.APPEARANCE.SHOWING,this.timer=setTimeout((()=>{this.timer=null,this.append(),this.node.removeEvent("transitionend"),this.node.addEvent("transitionend",(t=>{t.stop(),this.state=i.APPEARANCE.SHOWN})),this.node.render(),this.node.addClass(a)}),250))}hide(t){(this.state!==i.APPEARANCE.HIDDEN||t)&&(clearTimeout(this.timer),this.node.removeEvent("transitionend"),this.state!==i.APPEARANCE.SHOWN&&(t=!0),this.state=i.APPEARANCE.HIDING,t?(this.node.remove(),this.inDoc=!1,this.state=i.APPEARANCE.HIDDEN):this.node.addEvent("transitionend",(t=>{t.stop(),this.node.remove(),this.inDoc=!1,this.state=i.APPEARANCE.HIDDEN})),this.node.removeClass(a))}destroy(){this.hide(!0),this.state=i.APPEARANCE.HIDDEN,this.node.innerHTML="",super.destroy()}}})),Sirv.define("ComponentLoader",["bHelpers","magicJS","globalVariables","globalFunctions","helper","RoundLoader"],((t,e,i,s,n,o)=>{const r=e;r.$;return class extends o{constructor(t,e){super(t,e=(t=>(t||(t={}),t.width||(t.width="100%"),t.height||(t.height="100%"),t))(e)),this.type="component",this.loaderElement.addClass("smv-bounce-wrapper").append(r.$new("div").addClass("smv-bounce1")).append(r.$new("div").addClass("smv-bounce2"))}addClass(){this.node.addClass("smv-component-loader")}destroy(){this.loaderElement.removeClass("smv-bounce-wrapper"),this.loaderElement.node.innerHTML="",super.destroy()}}})),Sirv.define("ResponsiveImage",["bHelpers","magicJS","globalVariables","globalFunctions","helper","EventEmitter"],((t,e,i,s,n,o)=>{const r=e,a=r.$,h=(t,e)=>{let i=t+"?"+n.paramsToQueryString(e);return i=n.cleanQueryString(i),i};class l{constructor(t,e,i,s,n,o){this._name=t,this._state=0,this.imageNode=null,this._size={width:0,height:0},this.loader=null,this.callbacks=[],this.srcSettings=i,this.srcsetSettings=s,this.dontLoad=n,this.dppx=this.srcsetSettings?this.srcsetSettings.dppx:1,this.referrerPolicy=o,""===i.profile&&delete i.profile,s&&""===s.profile&&delete s.profile,this._src=h(e,i),this._srcset=null,s&&(this._srcset=h(e,s.settings))}get name(){return this._name}get node(){return this.imageNode}get size(){return this._size}get src(){return this._src}get srcset(){return this._srcset}get state(){return this._state}get DPPX(){return this.dppx}load(){return new Promise(((t,e)=>{this.dontLoad||this._state?t(this):(this._state=1,this.imageNode=a(new Image),this.imageNode.attr("referrerpolicy",this.referrerPolicy||"no-referrer-when-downgrade"),this.imageNode.addEvent("load",(e=>{if(e.stop(),this._state=2,this._size={width:this.imageNode.node.naturalWidth||this.imageNode.node.width,height:this.imageNode.node.naturalHeight||this.imageNode.node.height},"safari"===r.browser.uaName){let t=!1;this.srcSettings.scale.width?this._size.width>this.srcSettings.scale.width+5&&(t=!0):this._size.height>this.srcSettings.scale.height+5&&(t=!0),t&&(this._size.width/=this.dppx,this._size.height/=this.dppx)}t(this)})),this.imageNode.addEvent("error",(t=>{t.stop(),this._state=3,this.imageNode=null,e(this)})),this.addSrc(),this.addSrcset(),this.imageNode.node.src=this._src)}))}addSrc(){this.imageNode.node.src=this._src}addSrcset(){this._srcset&&(this.imageNode.node.srcset=this._srcset+" "+this.dppx+"x")}get loading(){return 1===this._state}destroy(){1===this._state&&this.imageNode&&this.imageNode.attr("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="),this._state=0}}class c extends l{constructor(t,e,i,s,n,o,r){super(t,e,i,s,n,o),this._tileName=r}get tileName(){return this._tileName}addSrc(){1===this.dppx&&super.addSrc()}}const d=(t,e)=>{const i=Object.assign({},t);let s;return delete i.src,delete i.srcset,i.imageSettings=Object.assign({},(null==t?void 0:t.imageSettings)||{}),e>1&&(s=JSON.parse(JSON.stringify(i)),s.width&&(s.width=parseInt(s.width*e,10)),s.height&&(s.height=parseInt(s.height*e,10)),s.imageSettings.crop&&(s.imageSettings.crop.width&&(s.imageSettings.crop.width=parseInt(s.imageSettings.crop.width*e,10)),s.imageSettings.crop.height&&(s.imageSettings.crop.height=parseInt(s.imageSettings.crop.height*e,10))),s.dppx=e),i.imageSettings=Object.assign(i.imageSettings,t.src),s&&t.srcset&&(s.imageSettings=Object.assign(s.imageSettings,t.srcset)),{src:i,srcset:s}},p=t=>(100*t).toFixed(4)+"%",u=(t,e)=>t&&t.crop&&t.crop[e]?t.crop[e]:null,g={};class m extends o{constructor(t,e){super(),"string"!==r.typeOf(t)&&(t=a(t).attr("src")),this.o=Object.assign({type:"main",infoId:"sirv-image-"+n.generateUUID(),imageSettings:{},round:!0,dontLoad:!1,convertSmallerSideToZero:!0,referrerPolicy:"no-referrer-when-downgrade",loadNewImage:!1},e),this.imageInfoPromise=null,this.images={},this._originUrl=(t=>t.split("?")[0])(r.getAbsoluteURL(t)),this.infoUrl=this._originUrl+"?nometa&info",this.imageSettings=Object.assign({},this.o.imageSettings)}static roundImageSize(t,e){let i;return e||(e={width:Number.MAX_VALUE,height:Number.MAX_VALUE}),t.width&&t.height?t.width>=t.height?(i=n.roundSize(t.width),i<=e.width&&(t.height=Math.floor(t.height/t.width*i),t.width=i)):(i=n.roundSize(t.height),i<=e.height&&(t.width=Math.floor(t.width/t.height*i),t.height=i)):t.width?(i=n.roundSize(t.width),i<=e.width&&(t.width=i)):t.height&&(i=n.roundSize(t.height),i<=e.height&&(t.height=i)),t}_convertImageSettings(t){const e=(t,e)=>{e.width&&(t.width=e.width),e.height&&(t.height=e.height)};t||(t={}),t=Object.assign({},t);let i=this.getClearSizeWithoutProcessingSettings({width:t.width,height:t.height});e(t,i);const s=d(t,t.dppx);if(t.round||!t.hasOwnProperty("round")&&this.o.round){const t=this.originSize;i=m.roundImageSize(s.src,t),e(s,i),s.srcset&&(i=m.roundImageSize(s.srcset,t),e(s,i))}return s}_mixSettings(t){return((t,e,i)=>{let s=n.deepExtend({},e);return t&&t.imageSettings.processingSettings&&(s.crop||(s.crop={}),s.crop=n.deepExtend(s.crop,t.cropSettings),s.canvas||(s.canvas={}),s.canvas=n.deepExtend(s.canvas,t.canvasSettings),s.frame||(s.frame={}),s.frame=n.deepExtend(s.frame,t.frameSettings),s.scale||(s.scale={}),s.scale.option||(s.scale.option="fill")),i.width&&"auto"!==i.width&&(s.scale.width=i.width),i.height&&"auto"!==i.height&&(s.scale.height=i.height),i.imageSettings&&(s=n.deepExtend(s,i.imageSettings)),s})(g[this.o.infoId],this.imageSettings,t)}_calcProcessingSettings(){let t=g[this.o.infoId];const e={},i={},s={};t.imageSettings.viewer||(t.imageSettings.viewer={});const n=t.imageSettings.viewer,o={width:t.imageSettings.original.width,height:t.imageSettings.original.height,widthScale:1,heightScale:1};n.scale&&(n.scale.width&&(o.width*=n.scale.width),n.scale.height&&(o.height*=n.scale.height)),o.widthScale=o.width/t.imageSettings.width,o.heightScale=o.height/t.imageSettings.height,n.crop&&(n.crop.width&&(e.width=p(n.crop.width)),n.crop.height&&(e.height=p(n.crop.height)),n.crop.x&&(e.x=p(n.crop.x)),n.crop.y&&(e.y=p(n.crop.y))),n.canvas&&(n.canvas.width&&(i.width=p(n.canvas.width)),n.canvas.height&&(i.height=p(n.canvas.height)),n.canvas.border&&(i.border={},n.canvas.border.width&&(i.border.width=p(n.canvas.border.width)),n.canvas.border.height&&(i.border.height=p(n.canvas.border.height)))),n.frame&&n.frame.width&&(s.width=p(n.frame.width)),t=Object.assign(t,{cropSettings:e,canvasSettings:i,frameSettings:s,originSize:o})}_addImage(t,e){const i=r.defined(e.src.dontLoad)?e.src.dontLoad:this.o.dontLoad,s=t=>{const e=this._mixSettings(t);return e.scale&&e.scale.width&&e.scale.height&&"ignore"!==e.scale.option&&(e.scale.width>=e.scale.height?this.o.convertSmallerSideToZero&&(e.scale.height=0):this.o.convertSmallerSideToZero&&(e.scale.width=0)),e},n=s(e.src);let o=null,a=null;if(e.src.imageSettings&&e.src.imageSettings.tile){a=e.src.imageSettings.tile.number+""}e.srcset&&(o={dppx:e.srcset.dppx,settings:s(e.srcset)});let h=null;return h=null===a?new l(t,this._originUrl,n,o,i,this.o.referrerPolicy):new c(t,this._originUrl,n,o,i,this.o.referrerPolicy,a),this.images[t]={serverWidth:e.src.width,serverHeight:e.src.height,image:h},this.images[t]}_load(t,e){let i,s;this._addImage(t,e).image.load().then((t=>{s=t,i="imageOnload",s instanceof l&&(this.someImageIsLoaded=!0)})).catch((t=>{s=t,i="imageOnerror"})).finally((()=>{s instanceof l&&(this.someImageIsComplete=!0);const t=this.images[s.name];t&&this.emit(i,{data:this._createImageData(t,e.src.callbackData)})}))}_createImageData(t,e){const i=t.image;return{callbackData:e,name:i.name,tileName:i.tileName,tile:i instanceof c,node:i.node,serverWidth:t.serverWidth,serverHeight:t.serverHeight,width:i.size.width,height:i.size.height,src:i.src,srcset:i.srcset,state:i.state,dppx:i.DPPX||1}}getCropPosition(){const t=g[this.o.infoId];let e=u(this.imageSettings,"x");e&&!/%$/.test(e)&&(e=p(e/t.originSize.width));let i=u(this.imageSettings,"y");return i&&!/%$/.test(i)&&(i=p(i/t.originSize.height)),{x:e||t.cropSettings.x,y:i||t.cropSettings.y,type:u(this.imageSettings,"type")||u(t.imageSettings.processingSettings,"type")}}isExist(t){t=this._convertImageSettings(t);const e=this.generateImageName(t.src);let i=Object.prototype.hasOwnProperty.call(this.images,e);if(!i&&(!t.src.imageSettings||!t.src.imageSettings.tile)&&t.src.width){const e=Object.entries(this.images).filter((t=>t[1].image instanceof c==!1)).map((t=>t[1]));i=this._getBiggerImage(t.src.width,e)}return!!i}isLoaded(t){t=this._convertImageSettings(t);let e=this.images[this.generateImageName(t.src)];return e&&(e=2===e.image.state),!!e}get ready(){return this.someImageIsLoaded}get complete(){return this.someImageIsComplete}get originSize(){let t=null,e=null;if(g[this.o.infoId]&&(e=g[this.o.infoId].imageSettings),e){let i,s;e.processingSettings?(i=e.width,s=e.height):(i=e.original.width,s=e.original.height),t={width:i,height:s}}return t}loadInfo(){return this.imageInfoPromise||(this.imageInfoPromise=new Promise(((t,e)=>{let i=this._originUrl;const s=r.getHashCode(this.infoUrl.replace(/^http(s)?:\/\//,"")),o=n.paramsToQueryString(this.imageSettings);""!==o?(i+="?"+o,i+="&"):i+="?",i+="nometa&info=sirv_image_info_"+s+"_"+this.o.type,i=n.cleanQueryString(i),n.getRemoteData(i,"image_info_"+n.generateUUID(),this.o.referrerPolicy).then((i=>{!i.width||i._isplaceholder?e(i):(g[this.o.infoId]={imageSettings:i},this._calcProcessingSettings(),t(g[this.o.infoId]))})).catch(e)}))),this.imageInfoPromise}_getBiggerImage(t,e,i){return t||(t=0),e||(e=this.images),i===r.U&&(i=this.o.dontLoad),Object.entries(e).map((t=>t[1])).sort(((t,e)=>t.serverWidth-e.serverWidth)).find((e=>t<e.serverWidth&&(2===e.image.state||i)))||null}sendLoad(t){t=this._convertImageSettings(t);let e=this.images[this.generateImageName(t.src)];e||(e=this._getBiggerImage(t.src.width)),this.emit("imageOnload",{data:this._createImageData(e,t.src.callbackData)})}cancelLoadingImage(t){t=this._convertImageSettings(t);const e=this.generateImageName(t.src),i=this.images[e];i&&i.image.loading&&(i.image.destroy(),delete this.images[e])}generateImageName(t){return(t=>{let e=(t=t.replace("?+","?").replace("&+","&").split("?"))[1];return t=t[0],e=e.split("&").sort(),""+r.getHashCode(t+"?"+e.join("&"))})(n.cleanQueryString(this._originUrl+"?"+n.paramsToQueryString(this._mixSettings(t))))}getClearSizeWithoutProcessingSettings(t){const e={},i=g[this.o.infoId];return t.width&&(e.width=Math.round(t.width*i.originSize.widthScale)),t.height&&(e.height=Math.round(t.height*i.originSize.heightScale)),e}getImage(t){const e=this._convertImageSettings(t),i=r.defined(e.src.dontLoad)?e.src.dontLoad:this.o.dontLoad,s=this.generateImageName(e.src);let n=this.images[s];return n||this._load(s,Object.assign({},e)),n&&n.image.state<2&&!i&&(n=null),n||!e.src.maxSize&&this.o.loadNewImage||(e.src.exactSize?i&&(n=this.images[s]):n=this._getBiggerImage(null,null,i)),n&&(n=this._createImageData(n,e.src.callbackData)),n}get originUrl(){let t=null;return this._originUrl&&(t=this._originUrl),t}getProcessingSettings(){const t=g[this.o.infoId];return{crop:t.cropSettings,cropClear:t.cropSettingsClear,canvas:t.canvasSettings,canvasClear:t.canvasSettingsClear}}get description(){let t=null;const e=g[this.o.infoId];return e&&(t=e.imageSettings.original.description||null),t}getThumbnail(t){let e={imageSettings:null,size:null,src:null,srcset:null};if(g[this.o.infoId]){const i=d(t,r.DPPX);let s=null,o=this.o.convertSmallerSideToZero;const a=t.originUrl||this._originUrl,h=(e,i)=>{let s={scale:{option:"fill"}};if(e.width||e.height)if(e.width&&e.height)s.scale.width=e.width,s.scale.height=e.height;else{const t=e.width||e.height;s.scale.width=t,s.scale.height=t}e.width===e.height&&(t.crop?s.crop={x:"center",y:"center",width:e.width,height:e.height}:(s.scale.option="fit",s.canvas||(s.canvas={}),s.canvas.width=e.width,s.canvas.height=e.height)),s.scale&&(t.width&&t.height?g[this.o.infoId].imageSettings.original.width>=g[this.o.infoId].imageSettings.original.height?o&&(s.scale.height=0):o&&(s.scale.width=0):t.width?o&&(s.scale.height=0):t.height&&o&&(s.scale.width=0)),i&&(s=Object.assign(s,i));const r=s;return s={},s.imageSettings=r,s=this._mixSettings(s),s.text&&delete s.text,!t.watermark&&s.watermark&&delete s.watermark,n.paramsToQueryString(s)},l=t=>{const e={};return t.width&&(e.width=t.width),t.height&&(e.height=t.height),e};(i.src.crop||i.src.width&&i.src.height)&&(o=!1),e={callbackData:t.callbackData,size:l(i.src.imageSettings),src:n.cleanQueryString(a+"?"+h(l(i.src),i.src.imageSettings))},r.DPPX>1&&(s=h(l(i.srcset),i.srcset.imageSettings),s&&(e.srcset=n.cleanQueryString(a+"?"+s)))}return e}get accountInfo(){const t={},e=g[this.o.infoId];return e&&(t.account=e.imageSettings.account,t.branded=e.imageSettings.branded),t}destroy(){Object.values(this.images).forEach((t=>t.image.destroy())),this.images={},this.someImageIsLoaded=!1,this.someImageIsComplete=!1,g[this.infoId]&&(delete g[this.infoId],this.infoId=null),super.destroy()}}return m})),Sirv.define("SliderBuilder",["bHelpers","magicJS","EventEmitter","helper","globalVariables","globalFunctions"],((t,e,i,s,n,o)=>{const r=e,a=r.$;return class{constructor(t,e){this.mainNode=a(e),this.sirvOptions=s.deepExtend({},t||{}),this.nodes=[],this.configURL=null,this.dataJSON=null,this.configHash=null,this.attrbMainNode=null,this.cfCallbackName=null,this.urlParams=null,this.componentsList=[],this.referrerPolicy=this.mainNode.attr("data-referrerpolicy")||this.mainNode.attr("referrerpolicy")||"no-referrer-when-downgrade"}getOptions(){return new Promise(((t,e)=>{var i,o;this.checkNode()?(this.buildCallBackName(),s.getRemoteData((i=this.configURL,o=this.cfCallbackName,i+(r.stringHas(i,"?")?"&":"?")+"nometa&info="+o),this.cfCallbackName,this.referrerPolicy).then((e=>{if(e&&e.assets)this.dataJSON=e,this.buildOptions(),t({dataOptions:this.sirvOptions});else{let i=n.SLIDE.TYPES.IMAGE;e.layers&&(i=n.SLIDE.TYPES.SPIN),t({content:i,dataOptions:this.sirvOptions})}})).catch((t=>{this.configURL,e({error:this.configURL,dataOptions:this.sirvOptions})}))):t({dataOptions:this.sirvOptions})}))}buildViewer(){return new Promise(((t,e)=>{if(this.dataJSON){const t=/(^https?:\/\/[^/]*)([^#?]*)\/.*$/.exec(this.configURL),e=this.dataJSON.dirname||t[2];this.prepareListComponents(this.dataJSON.assets,t[1],e),this.generateComponents(),this.addAllComponents()}t({mainNode:this.mainNode})}))}prepareListComponents(t,e,i){t.forEach((t=>{let s;const r=/^(https?:)?\/\/[^/]/.test(t.name);s=r?t.name:/^\//.test(t.name)?e+t.name:e+i+"/"+t.name,this.componentsList.push({path:r?s:o.normalizeURL(s),type:n.SLIDE.NAMES.indexOf(t.type),is3rd:r})}))}checkNode(){let t=!1;const e=/([^#?]+)\/?([^#?]+\.view)(\?([^#]*))?(#(.*))?$/;return this.mainNode&&(this.attrbMainNode=this.mainNode.attr("data-src"),this.attrbMainNode&&e.test(this.attrbMainNode)&&(t=!0)),t}buildOptions(){this.sirvOptions.common=s.deepExtend(this.sirvOptions.common,this.dataJSON.settings||{}),this.sirvOptions.mobile=s.deepExtend(this.sirvOptions.mobile,this.dataJSON.settings||{})}buildCallBackName(){this.configURL=o.normalizeURL(this.attrbMainNode.replace(n.REG_URL_QUERY_STRING,"$1")),this.urlParams=this.attrbMainNode.replace(n.REG_URL_QUERY_STRING,"$2"),this.urlParams&&(this.configURL+="?"+this.urlParams),this.configHash=r.getHashCode(this.configURL.replace(/^http(s)?:\/\//,"")),this.cfCallbackName="view-1_"+this.configHash}generateComponents(){this.componentsList.forEach((t=>{let e=r.$new("div");t.type===n.SLIDE.TYPES.IMAGE&&(t.is3rd?(e=r.$new("img"),e.attr("data-type","static")):e.attr("data-type","zoom"));let i=t.path;this.urlParams&&(i+="?"+this.urlParams),e.attr("data-src",i),this.nodes.push(e)}))}addAllComponents(){this.mainNode.node.innerHTML="",this.nodes.forEach((t=>{this.mainNode.node.appendChild(t.node)}))}destroy(){this.mainNode=null,this.sirvOptions=null,this.nodes=[],this.configURL=null,this.dataJSON=null,this.configHash=null,this.cfCallbackName=null,this.componentsList=[]}}})),Sirv.define("getDPPX",["bHelpers","magicJS","helper","ResponsiveImage"],((t,e,i,s)=>{const n=e;n.$;return(t,e,o,r,a,h)=>{let l=1;if(n.DPPX>1)if(e>t){const t=a?s.roundImageSize({height:e}).height:e;l=i.getDPPX(t,r,h)}else{const e=a?s.roundImageSize({width:t}).width:t;l=i.getDPPX(e,o,h)}return l}})),Sirv.define("ViewerImage",["bHelpers","magicJS","globalVariables","globalFunctions","helper","ResponsiveImage","HotspotInstance","Hotspots","getDPPX"],((t,e,i,s,n,o,r,a,h)=>{const l=e,c=l.$;return class extends r{constructor(t,e){super(t,e,{}),this.type=i.SLIDE.TYPES.IMAGE,this.instanceNode.attr("referrerpolicy",this.referrerPolicy),this.image=null,this.isInfoLoaded=!1,this.getImageInfoPromise=null,this.loadStaticImagePromise=null,this.imageShowPromise=null,this.srcWasSetted=!1,this.lastImageSize={width:0,height:0},this.imageIndex=e.imageIndex,this.dppx=1,this.upscale=!1,this.size={width:0,height:0},this.dontLoad=!0,this.accountInfo={},this.attemptsNumber=1,this.isFullscreen=e.isFullscreen,this.nativeFullscreen=e.nativeFullscreen,this.infoAlt=null,this.originAlt=this.instanceNode.attr("alt"),this.originTitle=this.instanceNode.attr("title"),this.src=this.instanceNode.attr("src"),this.srcset=this.instanceNode.attr("srcset"),this.startedSrc=this.src,this.dataSrc=this.instanceNode.attr("data-src"),this.isStaticImage=this.src&&!this.dataSrc,this.imageUrl=this.dataSrc||this.src,this.getImageTimer=n.debounce((()=>{this.getImage()}),32),this.firstSlideAhead=!1,this.src=s.normalizeURL(this.imageUrl.replace(i.REG_URL_QUERY_STRING,"$1")),this.queryParamsQuality=null,this.queryParams=n.paramsFromQueryString(this.imageUrl.replace(i.REG_URL_QUERY_STRING,"$2")),this.getQueryParams(),this.isNotSirv=!1,n.isSVG(this.imageUrl)&&(this.isNotSirv=!0),this.createHotspotsClass(a),this.createSirvImage()}sendEvent(t,e){e||(e={}),e.imageIndex=this.imageIndex,super.sendEvent(t,e)}getInfo(){return this.gettingInfoPromise||(this.gettingInfoPromise=new Promise(((t,e)=>{this.waitGettingInfo.wait((()=>{this.image.loadInfo().then((e=>{this.destroyed||(this.isInfoLoaded=!0,this.infoAlt=this.image.description,this.infoSize=this.image.originSize,this.accountInfo=this.image.accountInfo,this.hotspotsData=e.hotspots,this.hotspots&&(this.hotspots.originImageSize=this.infoSize),t())})).catch((t=>{this.destroyed||(this.isInfoLoaded=!0,t.status&&404===t.status||(this.isNotSirv=!0),e(t))}))}))}))),this.gettingInfoPromise}getQueryParams(){if(this.imageUrl){if(this.queryParams){const t=parseInt(this.queryParams.quality,10);isNaN(t)?delete this.queryParams.quality:this.queryParams.quality=t}this.queryParamsQuality=this.queryParams.quality||null}}getImageCreateSettings(){let t={src:{},srcset:{}};null!==this.quality&&null===this.queryParamsQuality&&(t.src.quality=this.quality);const e=this.hdQuality;return(null===this.queryParamsQuality||this.isHDQualitySet&&e<this.queryParamsQuality)&&(t.srcset={quality:e}),t.width=this.size.width,this.size.height&&(t.height=this.size.height),t=n.imageLib.checkMaxSize(t,this.infoSize),this.infoSize.width!==t.width&&this.infoSize.height!==t.height||(t.round=!1),l.DPPX>1&&(t.dppx=this.dppx),t}setHDQuality(t){return t.dppx>1&&t.dppx<1.5&&(null===this.queryParamsQuality&&null!==this.quality?t.srcset.quality=this.quality:t.srcset&&delete t.srcset.quality),t}replaceSrc(){let t;if(this.isNotSirv){if(this.srcWasSetted)return;this.srcWasSetted=!0,t={src:this.imageUrl}}else{let e=this.getImageCreateSettings();e.dppx>1&&e.dppx<1.5&&delete e.srcset.quality,e=this.setHDQuality(e),t=this.image.getImage(e),this.lastImageSize.width=t.width||t.serverWidth,this.lastImageSize.height=t.height||t.serverHeight}this.instanceNode.attr("src",t.src),t.srcset?!this.isNotSirv&&this.dppx>1&&this.instanceNode.attr("srcset",t.srcset+" "+this.dppx+"x"):this.instanceNode.removeAttr("srcset")}showImage(){return this.imageShowPromise||(this.imageShowPromise=new Promise(((t,e)=>{this.isStaticImage?(this.instanceNode.setCssProp("opacity",""),t()):this.isInView&&this.isSlideShown?(this.instanceNode.addEvent("transitionend",(e=>{"opacity"===e.propertyName&&(e.stop(),this.instanceNode.removeEvent("transitionend"),this.instanceNode.setCss({opacity:"",transition:""}),t())})),this.instanceNode.render(),this.instanceNode.setCss({opacity:1,transition:"opacity 0.3s linear"})):(this.instanceNode.setCssProp("opacity",""),t())}))),this.imageShowPromise}createSirvImage(){this.imageUrl&&!this.isNotSirv&&(this.on("imageOnload",(t=>{t.stopAll(),this.replaceSrc(),this.ready||(t.data.node?this.showImage().finally((()=>{this.done()})):n.loadImage(this.instanceNode).finally((()=>{this.showImage().finally((()=>{this.done(),this.sendContentLoadedEvent()}))})))})),this.on("imageOnerror",(t=>{t.stopAll(),console.log("image error")})),this.image=new o(this.imageUrl,{imageSettings:this.queryParams,round:!0,dontLoad:this.dontLoad,referrerPolicy:this.referrerPolicy}),this.image.parentClass=this,this.getInfo())}getInfoSize(){return this.getImageInfoPromise||(this.getImageInfoPromise=new Promise(((t,e)=>{this.image?this.getInfo().then((()=>{t({size:this.infoSize,imageIndex:this.imageIndex})})).catch((t=>{e({error:t,isPlaceholder:t._isplaceholder,imageIndex:this.imageIndex})})):e({error:"nonsirv",isPlaceholder:!1,imageIndex:this.imageIndex})}))),this.getImageInfoPromise}startFullInit(t){this.isStartedFullInit||(super.startFullInit(t),this.getId("responsive-image-"),this.isStaticImage||this.instanceNode.setCssProp("opacity",0))}run(t,e,i,s){this.firstSlideAhead=i;let o=super.run(t,e,i);if(o)if(this.destroyed)o=!1;else{this.instanceNode.removeAttr("alt"),this.instanceNode.removeAttr("title"),this.instanceNode.setCss({display:"inline-flex"}).render(),this.instanceNode.setCss({display:""}).render();let t=null;n.imageLib.getSize(this.instanceNode.node.parentNode).then((e=>{t=e})).finally((()=>{this.destroyed||(t.width&&t.height<=20&&(t.height=0),this.size=n.imageLib.calcProportionSize(t,this.infoSize),(this.originAlt||this.infoAlt)&&c(this.instanceNode).attr("alt",this.originAlt||this.infoAlt),this.originTitle&&c(this.instanceNode).attr("title",this.originTitle),this.isStaticImage?this.loadStaticImage().finally((()=>{this.isInfoLoaded&&this.done()})):(this.originAlt&&c(this.instanceNode).attr("alt",this.originAlt),this.isInView&&(this.isSlideShown||this.preload||s)&&this.getImage()),this.dataAlt&&c(this.instanceNode).attr("alt",this.dataAlt))})),this.startGettingInfo()}return o}loadContent(){this.getImage(!0)}loadStaticImage(){return this.loadStaticImagePromise||(this.loadStaticImagePromise=new Promise(((t,e)=>{this.isStaticImage?this.instanceNode.node.complete?t():(this.instanceNode.addEvent("load",(e=>{this.sendContentLoadedEvent(),t()})),this.instanceNode.addEvent("error",(t=>{e()}))):t()}))),this.loadStaticImagePromise}getImage(t){this.isStaticImage||(this.isNotSirv||this.ready||this.size.width||this.size.height?(this.waitToStart.start(),this.isNotSirv?this.replaceSrc():this.getSirvImg()):this.attemptsNumber<100&&setTimeout((()=>{this.attemptsNumber+=1,this.isStarted=!1,this.run(this.isSlideShown,this.preload,this.firstSlideAhead,t)}),16*this.attemptsNumber))}get imageClassContainer(){return this.image}getSirvImg(){let t=this.getImageCreateSettings();if(l.DPPX>1){const e=this.image.originSize;this.dppx=h(t.width,t.height,e.width,e.height,!l.defined(t.round)||t.round,this.upscale),t.dppx=this.dppx}t=this.setHDQuality(t),this.checkImage(t,this.dontLoad)?this.replaceSrc():this.image.getImage(t)}get originImageUrl(){return this.src}done(){if(!this.ready){if(this.accountInfo.branded){let t=this.instanceNode;"img"===t.tagName&&(t=t.node.parentNode);const e=s.getNodeWithSirvClassName(this.instanceNode)||l.D.node.head||l.D.node.body;s.rootDOM.showSirvAd(e,t,"https://sirv.com/about-image/?utm_source=client&utm_medium=sirvembed&utm_content=typeofembed(image)&utm_campaign=branding","Image viewer by Sirv")}super.done(),this.hotspots&&(this.hotspots.containerSize=this.instanceNode.node.getBoundingClientRect()),this.isFullscreenEnabled||(this.pinchCloud.removeEvent(),this.pinchCloud=null)}}getSelectorImgUrl(t){return new Promise(((e,i)=>{const s=this.getImageCreateSettings();s.src&&(t.src=s.src),t.srcset=s.srcset,this.isInfoLoaded?this.waitToStart.wait((()=>{e(Object.assign(this.image.getThumbnail(t),{imageIndex:this.imageIndex,alt:this.dataAlt||this.originAlt||this.infoAlt,referrerpolicy:this.instanceNode.attr("referrerpolicy")}))})):this.getInfo().then((()=>{this.waitToStart.wait((()=>{e(Object.assign(this.image.getThumbnail(t),{imageIndex:this.imageIndex,alt:this.dataAlt||this.originAlt||this.infoAlt,referrerpolicy:this.instanceNode.attr("referrerpolicy")}))}))})).catch(i)}))}getThumbnailData(t){return this.image.getThumbnail(t)}createPinchEvent(){super.createPinchEvent(this.instanceNode),this.pinchCloud.onPinchStart=t=>{[i.FULLSCREEN.OPENING,i.FULLSCREEN.CLOSING].includes(this.fullscreenState)||(this.pinchCloud.pinch=!0,this.pinchCloud.scale=t.scale,this.sendEvent("pinchStart"))},this.pinchCloud.onPinchMove=t=>{this.pinchCloud.pinch&&!this.pinchCloud.block&&(this.fullscreenState===i.FULLSCREEN.OPENED?t.scale<.2&&(this.pinchCloud.block=!0,this.sendEvent("fullscreenOut")):t.scale>=2&&(this.pinchCloud.block=!0,this.sendEvent("fullscreenIn")))}}onStartActions(){this.ready||this.isInView&&this.isStarted&&(this.fullscreenState===i.FULLSCREEN.OPENED&&this.onResize(),this.always?this.getImageTimer():this.getImage()),super.onStartActions()}onStopActions(){super.onStopActions()}onInView(t){t&&!this.isStaticImage&&(this.ready||this.isInView||this.isStarted&&(this.isInView=!0,this.isInfoLoaded&&(this.preload||this.isSlideShown)&&this.getImage()))}onBeforeFullscreenIn(t){this.getImageTimer.cancel(),this.ready&&!this.isStaticImage&&this.instanceNode.setCssProp("visibility","hidden"),super.onBeforeFullscreenIn(t),this.hotspots&&this.hotspots.disableAll()}onAfterFullscreenIn(t){this.always&&!this.ready&&this.isInView&&this.isStarted&&(this.onResize(),this.getImage()),this.hotspots&&setTimeout((()=>{this.fullscreenState===i.FULLSCREEN.OPENED&&(this.hotspots.enableAll(),this.isInView&&this.isSlideShown&&this.hotspots.showNeededElements())}),100)}onBeforeFullscreenOut(t){this.instanceNode.setCss({width:"",height:"",visibility:""}),super.onBeforeFullscreenOut(t)}onAfterFullscreenOut(t){super.onAfterFullscreenOut(t)}onResize(){if(!this.isStarted||this.isStaticImage||this.isNotSirv)return!1;if(this.isFullscreenActionEnded()){let t=c(this.instanceNode.node.parentNode).size;if(t=n.imageLib.calcProportionSize(t,this.infoSize),this.fullscreenState===i.FULLSCREEN.OPENED&&(this.instanceNode.setCss({width:t.width+"px",height:t.height+"px"}),this.instanceNode.setCssProp("visibility","")),this.size.width=t.width,this.size.height&&(this.size.height=t.height),this.ready){const t=50;(this.size.width-this.lastImageSize.width>t||this.size.height-this.lastImageSize.height>t)&&this.getImage(),this.hotspots&&(this.hotspots.containerSize=this.instanceNode.node.getBoundingClientRect(),this.isInView&&this.isSlideShown&&this.hotspots.showNeededElements())}return!0}return!1}destroy(){if(this.image&&(this.off("imageOnload"),this.off("imageOnerror"),this.image.destroy(),this.image=null),this.getImageTimer.cancel(),this.getImageTimer=null,this.instanceNode.setCssProp("opacity",""),this.hotspot&&c(this.instanceNode.node.parentNode).removeEvent("tap"),this.instanceNode.node.hasAttribute("src"))try{this.instanceNode.removeAttr("src"),this.isStaticImage&&this.instanceNode.attr("src",this.imageUrl)}catch(t){}if(this.isStaticImage?this.instanceNode.attr("src",this.src):this.instanceNode.removeAttr("src"),this.srcset)this.instanceNode.attr("srcset",this.srcset);else try{this.instanceNode.removeAttr("srcset")}catch(t){}return this.srcset=null,this.originAlt||!this.infoAlt&&!this.dataAlt||this.instanceNode.removeAttr("alt"),this.instanceNode.removeEvent("load"),this.hotspotsData=null,super.destroy(),!0}}})),Sirv.define("defaultsVideoOptions",{autoplay:{type:"boolean",defaults:!1},loop:{type:"boolean",defaults:!1},volume:{type:"number",minimum:0,maximum:100,defaults:100},seo:{type:"boolean",defaults:!0},preload:{type:"boolean",defaults:!0},thumbnail:{oneOf:[{type:"url"},{type:"boolean",enum:[!1]},{type:"number",minimum:0}],defaults:!1},motionFactor:{type:"number",minimum:1,maximum:4,defaults:3},dynamicAdaptiveStreaming:{type:"boolean",defaults:!0},quality:{min:{type:"number",enum:[360,480,720,1080],defaults:360},max:{type:"number",enum:[360,480,720,1080],defaults:1080}},controls:{enable:{type:"boolean",defaults:!0},volume:{type:"boolean",defaults:!0},speed:{type:"boolean",defaults:!1},quality:{type:"boolean",defaults:!1},fullscreen:{type:"boolean",defaults:!0}}});
Sirv.define("Hotspot",["bHelpers","globalFunctions","magicJS","EventEmitter","helper"],((t,o,s,i,e)=>{const h=s,n=h.$;o.rootDOM.addModuleCSSByName("Hotspot",(()=>"@charset \"UTF-8\";.sirv-hotspot-pointer{display:inline-block;position:absolute;width:20px;height:20px;transform:translate(-50%,-50%);background-repeat:no-repeat;cursor:pointer;z-index:11;pointer-events:auto}.sirv-hotspot-pointer.pulsating-point{background-image:none}.sirv-hotspot-pointer.pulsating-point::after,.sirv-hotspot-pointer.pulsating-point::before{display:inline-block;position:absolute;top:0;left:0;width:100%;height:100%;transform-origin:50% 50%;border-radius:100%;content:''}.sirv-hotspot-pointer.pulsating-point::before{transition:opacity .2s ease-in,transform .1s ease-out;background-color:#ff0;opacity:.6;overflow:hidden}.sirv-hotspot-pointer.pulsating-point::after{border:1px solid #ff0;opacity:0;box-sizing:border-box;animation:pulsating-point-pulsate 3s ease-out infinite;pointer-events:none}.sirv-hotspot-pointer.pulsating-point:hover::before{cursor:pointer;opacity:.8}.sirv-hotspot-pointer.pulsating-point:active::before{transform:scale(.875)}.sirv-hotspot-pointer.pulsating-point:hover::after{animation:none}.sirv-hotspot-pointer.pulsating-point:active::after{animation:pulsating-point-stop-pulsate .3s}.smv .smv-slides-box .smv-slides .smv-slide .smv-content .sirv-hotspot-container{position:absolute!important;pointer-events:none}.smv .smv-slides-box .smv-slides .smv-slide .smv-content .sirv-hotspot-container.sirv-hotspot-overwrite-pointer-event{pointer-events:auto!important}@keyframes pulsating-point-pulsate{0%{transform:scale(1);opacity:.8}45%{transform:scale(1.75);opacity:0}}@keyframes pulsating-point-stop-pulsate{from{opacity:.4}to{transform:scale(2);opacity:0}}.sirv-hotspot-tooltip{display:block;position:absolute;padding:8px 24px;transition:opacity .15s linear 0s;border:1px solid #efefef;border-radius:4px;background-color:#fff;font:normal 12px/1.42857 'Lucida Grande','Lucida Sans Unicode',Verdana,'Helvetica Neue',Arial,Helvetica,sans-serif;border-collapse:separate;box-shadow:0 5px 10px 2px rgba(0,0,0,.1);opacity:0;z-index:9999999999;pointer-events:none;-webkit-font-smoothing:antialiased}.sirv-hotspot-tooltip--default{margin-top:-8px;padding:6px 9px;transform:translate(-50%,-100%);border:0;background-color:rgba(49,51,61,.76);color:#eee}.sirv-hotspot-tooltip--default::after{position:absolute;top:100%;left:50%;width:0;height:0;transform:translateX(-50%);border-width:8px 8px 0;border-style:solid;border-color:rgba(49,51,61,.76) transparent transparent;content:''}.sirv-hotspot-tooltip--balloon{margin-top:-40px;transform:translate(-40px,-100%)}.sirv-hotspot-tooltip--balloon::after{position:absolute;top:100%;left:24px;width:0;height:0;border-width:0 15px 40px 0;border-style:solid;border-color:transparent #fff transparent transparent;content:''}.sirv-hotspot-tooltip.sirv-hotspot-tooltip-visible{transition-delay:.1s;opacity:1}.sirv-hotspot-box{display:flex;position:fixed;max-width:100vw;max-height:100vh;padding:10px;transition:opacity .15s linear 0s;z-index:9999999999;box-sizing:border-box}.sirv-hotspot-box.sirv-hotspot-box-out-of-width{right:0!important;left:0!important}.sirv-hotspot-box.sirv-hotspot-box-out-of-height{top:0!important;bottom:0!important}.sirv-hotspot-box .sirv-hotspot-box-wrapper{display:flex;position:relative;max-width:inherit;max-height:inherit;padding:22px;border:1px solid #efefef;border-radius:4px;background:#fff;font-size:16px!important;line-height:100%;text-align:left;border-collapse:separate;box-shadow:0 5px 10px 2px rgba(0,0,0,.1);overflow:hidden;box-sizing:border-box}.sirv-hotspot-box .sirv-hotspot-box-content{top:0;left:0;width:100%;max-width:inherit;height:calc(100% + 2px);max-height:inherit;overflow:auto}.sirv-hotspot-box .sirv-hotspot-close-button{position:absolute;top:2px;right:2px;width:24px;height:24px;color:#888;font:normal 22px/1 Arial,monospace;text-align:center;cursor:pointer;speak:none;-webkit-font-smoothing:antialiased}.sirv-hotspot-box .sirv-hotspot-close-button::before{display:inline;position:static;color:inherit!important;font:inherit!important;content:'×';vertical-align:middle;-webkit-font-smoothing:inherit!important}"));const r="sirv-hotspot-tooltip",p="sirv-hotspot-box-out-of-width",a="sirv-hotspot-box-out-of-height",l="sirv-hotspot-overwrite-pointer-event",d={AUTO:0,VISIBLE:1};return class extends i{constructor(t,o,s){super(),this.container=t,this.hotspotData=o,this._id=s,this.box=null,this.boxContainer=h.D.node.body,this.baseBoxSize=null,this.tooltip=null,this.version=1,this.pointer=null,this.hotspotSettings={},this.dX=1,this.dY=1,this.isActive=!1,this.isDisabled=!1,this.isPointerInDoc=!1,this.isHovered=!1,this.isShown=!1,this.isBoxContent=!1,this.tooltipState=d.AUTO,this.boxState=d.AUTO,this.init()}isTooltipHovered(){return this.isHovered}isBoxActivated(){return this.isActive}isBoxAlwaysVisible(){return this.boxState===d.VISIBLE}isTooltipAlwaysVisible(){return this.tooltipState===d.VISIBLE}init(){this.setVersion(),this.parseHotspotData(),this.createBlocks(),this.addEvents(),this.createBox()}setVersion(){(this.hotspotData.style||this.hotspotData.tooltip||this.hotspotData.box&&this.hotspotData.box.content)&&(this.version=2)}parseHotspotData(){Object.keys(this.hotspotData).forEach((t=>this.hotspotSettings[t]=this.hotspotData[t])),this.hotspotSettings.pointerPositionPercentage={top:e.isPercentage(""+this.hotspotSettings.pointer.y),left:e.isPercentage(""+this.hotspotSettings.pointer.x)}}createBlocks(){var t,o,s,i;(this.pointer=h.$new("div").addClass("sirv-hotspot-pointer").attr("data-spot-id",this._id),this.pointer.addClass("hotspot-pointer"),this.version>1&&this.hotspotSettings.tooltip&&this.hotspotSettings.tooltip.content)&&(this.tooltip=h.$new("div").addClass(r).changeContent(this.hotspotSettings.tooltip.content),(null==(t=this.hotspotSettings)||null==(o=t.tooltip)?void 0:o.style)&&this.tooltip.addClass(null==(s=this.hotspotSettings)||null==(i=s.tooltip)?void 0:i.style))}setTooltipPosition(){if(this.tooltip){let t=this.pointer.rect;const o={top:0,left:0};o.top=this.hotspotSettings.tooltip.style?t.top:t.bottom,o.left=this.hotspotSettings.tooltip.style?(t.left+t.right)/2:t.right,"body"!==h.$(this.boxContainer).tagName&&(t=this.pointer.node.getBoundingClientRect(),o.top=this.hotspotSettings.tooltip.style?t.top-this.container.node.getBoundingClientRect().top:t.bottom-this.container.node.getBoundingClientRect().top,o.left=this.hotspotSettings.tooltip.style?t.left-this.container.node.getBoundingClientRect().left+t.width/2:t.left-this.container.node.getBoundingClientRect().left+t.width),this.tooltip.setCss(o)}}showTooltip(){this.isHovered||this.isDisabled||this.tooltip&&(this.setTooltipPosition(),this.tooltip.appendTo(this.boxContainer).addClass("sirv-hotspot-tooltip-visible"),this.isHovered=!0,this.emit("hotspotHovered",{data:{hotspot:this}}))}addEvents(){let t;this.pointer.addEvent(["click","mousedown"],(t=>{t.stop()})),this.pointer.addEvent(["btnclick","tap"],(t=>3===t.button||(this.hotspotSettings.link?(h.W.node.open(this.hotspotSettings.link),t.stop()):this.isBoxContent&&(t.stop(),this.showBox()),!1))),("edge"===h.browser.uaName||h.browser.ieMode)&&this.pointer.addEvent("mousedown",(t=>{t.stopDistribution()})),this.hotspotSettings.tooltip&&this.hotspotSettings.tooltip.content&&(this.pointer.addEvent("mouseenter",(t=>{this.showTooltip()})),this.pointer.addEvent("mouseleave",(()=>{this.tooltipState!==d.VISIBLE&&(this.hideTooltip(),this.isHovered=!1,this.emit("hotspotLeft",{data:{hotspot:this}}))}))),n(h.W).addEvent("resize",(o=>{clearTimeout(t),t=setTimeout((()=>{if(this.isActive){const t=this.hotspotSettings;t&&this.box.setCss(this.correctBoxPosition(this.getBoxPosition(t)))}}),42)}))}createBox(){var t,o;let s=null;var i,e;(this.version>1&&this.hotspotSettings.box&&this.hotspotSettings.box.content?s=this.hotspotSettings.box.content:this.hotspotSettings.data&&(s=this.hotspotSettings.data),this.box=h.$new("div").addClass("sirv-hotspot-box"),null==(t=this.hotspotSettings)||null==(o=t.box)?void 0:o.style)&&this.box.addClass(null==(i=this.hotspotSettings)||null==(e=i.box)?void 0:e.style);if(s){this.isBoxContent=!0;const t=h.$new("div").addClass("sirv-hotspot-box-wrapper").append(h.$new("div").addEvent(["btnclick","tap"],(t=>{this.boxState!==d.VISIBLE&&(t.stop(),this.hideBox(!0))})).addClass("sirv-hotspot-close-button")),o=h.$new("div").addClass("sirv-hotspot-box-content").changeContent(s+"").addEvent("click",(t=>{t.stopDistribution()}));t.append(o),this.box.append(t)}this.box.setCss({top:"-10000px",left:"-10000px",position:"absolute",opacity:0})}getBoxPosition(t){const o={top:0,left:0,transform:""};if(t&&t.box){const s=t.box.x,i=t.box.y;if(this.hotspotSettings.box.fixed){const t=this.container.rect;if(o.position="absolute","body"!==h.$(this.boxContainer).tagName){switch(i){case"top":o.top=0;break;case"bottom":o.top=t.bottom-t.top,o.transform+=" translateY(-100%)";break;case"center":o.top=(t.bottom-t.top+0)/2,o.transform+=" translateY(-50%)";break;default:o.top=0+(parseFloat(i)||0)}switch(s){case"left":o.left=0;break;case"right":o.left=t.right-t.left,o.transform+=" translateX(-100%)";break;case"center":o.left=(t.right-t.left)/2,o.transform+=" translateX(-50%)";break;default:o.left=t.left+(parseFloat(s)||0)}}else{switch(i){case"top":o.top=t.top;break;case"bottom":o.top=t.bottom,o.transform+=" translateY(-100%)";break;case"center":o.top=(t.top+t.bottom)/2,o.transform+=" translateY(-50%)";break;default:o.top=t.top+(parseFloat(i)||0)}switch(s){case"left":o.left=t.left;break;case"right":o.left=t.right,o.transform+=" translateX(-100%)";break;case"center":o.left=(t.left+t.right)/2,o.transform+=" translateX(-50%)";break;default:o.left=t.left+(parseFloat(s)||0)}}}else{const t=this.pointer.position,e=h.W.scroll;o.left=t.left-e.x+(parseFloat(s)||0),o.top=t.top-e.y+(parseFloat(i)||0)}}return o}correctBoxPosition(t){if(this.hotspotSettings.box&&!this.hotspotSettings.box.fixed){this.box.removeClass(p),this.box.removeClass(a);const o=h.W.size;this.baseBoxSize.width>o.width?this.box.addClass(p):t.left+this.baseBoxSize.width>o.width&&(t.left=o.width-this.baseBoxSize.width),this.baseBoxSize.height>o.height?this.box.addClass(a):t.top+this.baseBoxSize.height>o.height&&(t.top=o.height-this.baseBoxSize.height)}return t}setBoxPosition(){let t={transform:""};t=this.correctBoxPosition(this.getBoxPosition(this.hotspotSettings)),this.box.setCssProp("position",""),this.box.setCss(t),this.box.render()}showBox(){this.isActive||this.isDisabled||(this.tooltip&&this.tooltipState===d.AUTO&&this.tooltip.removeClass("sirv-hotspot-tooltip-visible"),this.box.setCss({opacity:0}),this.box.appendTo(this.boxContainer),this.setBaseBoxSize(this.box.size),this.setBoxPosition(),this.box.setCss({opacity:1}),this.isActive=!0,this.emit("hotspotActivate",{data:{hotspot:this}}))}hideBox(t){if(this.isActive){if(t)return this.box&&this.box.setCssProp("opacity",0),setTimeout((()=>{this.hideBox()}),300),this._id;this.box&&this.box.remove(),this.isActive=!1,this.emit("hotspotDeactivate",{data:{hotspot:this}})}}changeBoxContainer(t){this.boxContainer=null!=t?t:h.D.node.body}setBaseBoxSize(t,o){(t&&o||!this.baseBoxSize)&&(this.baseBoxSize={width:t.width,height:t.height})}setHotspotSettings(t){for(const o in t)({}).hasOwnProperty.call(t,o)&&(this.hotspotSettings[o]=t[o])}getHotspotSettings(t){return this.hotspotSettings}setAspectRatio(t,o){this.dX=t,this.dY=o}setPointerPosition(){const t=this.hotspotSettings;t&&this.pointer.setCss({top:t.pointerPositionPercentage.top?t.pointer.y:Math.ceil(t.pointer.y*this.dY),left:t.pointerPositionPercentage.left?t.pointer.x:Math.ceil(t.pointer.x*this.dX)})}showPointer(){if(this.hotspotSettings&&!this.isDisabled){var t,o,s,i;this.pointer.addClass("pulsating-point"),this.setPointerPosition();const e=null!=(t=null==(o=this.hotspotSettings)||null==(s=o.pointer)?void 0:s.style)?t:null==(i=this.hotspotSettings)?void 0:i.style;e&&this.pointer.addClass(e),this.isPointerInDoc||(this.isPointerInDoc=!0,this.pointer.appendTo(this.container))}else this.hidePointer()}hidePointer(){this.isPointerInDoc&&(this.isPointerInDoc=!1,this.pointer.remove())}isHotspotShown(){return this.isShown}show(){this.isDisabled||this.isShown||(this.isShown=!0,this.showPointer(),this.boxState===d.SHOW&&this.showBox(),this.tooltipState===d.SHOW&&this.showTooltip())}hide(){this.isShown&&(this.isShown=!1,this.hideBox(),this.hideTooltip(),this.hidePointer())}isEnabled(){return!this.isDisabled}enable(){this.isDisabled&&(this.isDisabled=!1)}disable(){this.isDisabled||(this.isDisabled=!0,this.hide())}hideTooltip(){this.isHovered&&(this.isHovered=!1,this.tooltip&&this.tooltip.removeClass("sirv-hotspot-tooltip-visible"))}overridePointerEvent(){this.isBoxAlwaysVisible()||this.isTooltipAlwaysVisible()||this.container.addClass(l)}removeOverridePointerEvent(){this.container.removeClass(l)}get id(){return this._id}set id(t){this._id=t}get boxSize(){var t,o;return null!=(t=null==(o=this.box)?void 0:o.size)?t:{width:0,height:0}}setState(t,o){this.boxState!==t.popup&&(this.boxState=t.popup,t.popup===d.VISIBLE?o||this.showBox():this.hideBox()),this.tooltipState!==t.tooltip&&(this.tooltipState=t.tooltip,t.tooltip===d.VISIBLE?o||this.showTooltip():this.hideTooltip())}rewriteAttrPointer(t){this.pointer.attr("data-spot-id",t||this._id)}getHotspotPointer(){return this.pointer}destroy(){this.hideBox(),this.hideTooltip(),this.hotspotData=null,this.container=null,this._id=null,this.pointer.clearEvents(),this.tooltip&&this.tooltip.clearEvents(),this.pointer.remove(),this.box=null,this.boxContainer=null,this.baseBoxSize=null,this.tooltip=null,this.version=null,this.pointer=null,this.hotspotSettings=null,this.isActive=!1,this.isDisabled=!1,this.isPointerInDoc=!1,this.isHovered=!1,super.destroy()}}})),Sirv.define("Hotspots",["bHelpers","magicJS","globalFunctions","EventEmitter","Hotspot","helper"],((t,o,s,i,e,h)=>{const n=o,r=n.$;return class extends i{constructor(){super(),this.container=n.$new("div").addClass("sirv-hotspot-container"),this.hotspots=[],this.activeHotspots=[],this.hoveredHotspots=[],this._originImageSize={width:0,height:0},this._instanceComponentNode=null,this.api={add:this.addHotspot.bind(this),remove:this.removeHotspot.bind(this),removeAll:this.removeAllHotspots.bind(this),list:()=>this.hotspots.map((t=>t.getHotspotPointer())),setVisibility:this.setStateById.bind(this),enable:this.enable.bind(this),disable:this.disable.bind(this)},this.addEvents()}set originImageSize(t){this._originImageSize={width:t.width,height:t.height}}appendTo(t){this.container.appendTo(t)}set instanceComponentNode(t){this.hotspots.length||(this._instanceComponentNode=t)}set containerSize(t){if(!this.hotspots.length||!t)return;const o=this.getRightBoundengClientRect();this.container.setCss({top:t.top-o.top,left:t.left-o.left,width:100*t.width/o.width+"%",height:100*t.height/o.height+"%"});const s=this.container.size,i=s.width/this._originImageSize.width,e=s.height/this._originImageSize.height;this.hotspots.forEach((t=>t.setAspectRatio(i,e)))}getActiveHotspot(t){return this.activeHotspots.filter((o=>o.id===t))[0]||null}getHoveredHotspots(t){return this.hoveredHotspots.filter((o=>o.id===t))[0]||null}addEvents(){this.on("hotspotActivate",(t=>{this.getActiveHotspot(t.data.hotspot.id)||(t.stopEmptyEvent(),this.activeHotspots.forEach((t=>{t.isBoxAlwaysVisible()||t.hideBox(!0)})),this.activeHotspots.push(t.data.hotspot),this.activeHotspots[this.activeHotspots.length-1].overridePointerEvent(),t.data.id=t.data.hotspot.id,delete t.data.hotspot)})),this.on("hotspotDeactivate",(t=>{t.stopEmptyEvent();const o=this.getActiveHotspot(t.data.hotspot.id);o&&(o.removeOverridePointerEvent(),this.activeHotspots=this.activeHotspots.filter((t=>t.id!==o.id))),t.data.id=t.data.hotspot.id,delete t.data.hotspot})),this.on("hotspotHovered",(t=>{this.getHoveredHotspots(t.data.hotspot.id)||(t.stopAll(),this.hoveredHotspots.push(t.data.hotspot))})),this.on("hotspotLeft",(t=>{t.stopAll();const o=this.getHoveredHotspots(t.data.hotspot.id);o&&(this.hoveredHotspots=this.hoveredHotspots.filter((t=>t.id!==o.id)))})),this.clickFn=t=>{this.activeHotspots.forEach((t=>{t.isBoxAlwaysVisible()||t.hideBox(!0)})),this.hoveredHotspots.forEach((t=>{t.isTooltipAlwaysVisible()||t.hideTooltip(!0)}))},r(n.D).addEvent("click",this.clickFn)}isHotspotActivated(){return this.activeHotspots.length>0}createHotspots(t){t&&t.length&&t.forEach((t=>{this.createHotspot(t,this.hotspots.length)}))}createHotspot(t,o){const s=new e(this.container,t,o);s.parentClass=this,this.hotspots.push(s)}addHotspot(t){Array.isArray(t)||(t=[t]),this.createHotspots(t,this.hotspots.length)}getRightBoundengClientRect(t){return this.hotspots.length?this.container.node.parentNode.getBoundingClientRect():this._instanceComponentNode?this._instanceComponentNode.node.getBoundingClientRect():t.node.getBoundingClientRect()}changeBoxContainerParent(t){const o=t?this.container:null;this.hotspots.forEach((t=>{t.changeBoxContainer(o)}))}hideActiveHotspotBox(t){const o=this.activeHotspots.length||this.hoveredHotspots.length;return this.activeHotspots.forEach((o=>{o.hideBox(t)})),this.hoveredHotspots.forEach((t=>{t.hideTooltip()})),o}show(t){const o=this.hotspots[t];o&&o.show()}showAll(){this.hotspots.forEach((t=>{t.show()}))}hide(t){const o=this.hotspots[t];o&&o.hide()}hideAll(){this.hotspots.forEach((t=>{t.hide()}))}enable(t){const o=this.hotspots[t];o&&(o.enable(),o.show())}disable(t){this.hotspots[t]&&this.hotspots[t].disable()}enableAll(){this.hotspots.forEach((t=>{t.enable(),t.show()}))}disableAll(){this.hotspots.forEach((t=>{t.disable()}))}showNeededElements(){this.hotspots.forEach((t=>{t.isEnabled()&&t.isHotspotShown()&&(t.isBoxAlwaysVisible()&&(t.isBoxActivated()&&t.setBoxPosition(),t.showBox()),t.isTooltipAlwaysVisible()&&(t.isTooltipHovered()&&t.setTooltipPosition(),t.showTooltip()))}))}removeHotspot(t){const o=this.hotspots[t];o&&(o.disable(),o.destroy(),this.removeByIndex(t),this.hotspots.length||this.container.remove())}removeAllHotspots(){for(let t=this.hotspots.length-1;t>=0;t--)this.removeHotspot(t)}removeByIndex(t){this.hotspots.splice(t,1),(this.hotspots.length>0&&0===t||t>0&&t<=this.hotspots.length-1)&&this.rewriteHotspotIndex(t)}rewriteHotspotIndex(t){for(let o=t,s=this.hotspots.length;o<s;o++)this.hotspots[o].id=o,this.hotspots[o].rewriteAttrPointer()}setStateById(t,o){this.hotspots[t]&&this.hotspots[t].setState(o)}destroy(){r(n.D).removeEvent("click",this.clickFn),this.hotspots.forEach((t=>{t.destroy()})),this.container=null,this.activeHotspots=[],this.hoveredHotspots=[],this._instanceComponentNode=null,this.off("hotspotActivate"),this.off("hotspotDeactivate"),this.off("hotspotHovered"),this.off("hotspotLeft"),this.hotspots=[],super.destroy()}}})),Sirv.define("SpinHotspots",["bHelpers","magicJS","globalFunctions","EventEmitter","Hotspots","helper"],((t,o,s,i,e,h)=>{const n=o;n.$;return class extends e{constructor(){super(),this.options={rows:1,columns:36,rowsRevers:!1,columnsRevers:!1,originImageSize:{}},this.row=null,this.col=null,this.hotspotsSettings=[]}set Options(t){this.options=Object.assign(this.options,t||{})}get frameIndex(){let t;return t=this.options.rowsRevers&&this.options.columnsRevers?(this.options.rows-this.row-1)*this.options.columns+(this.options.columns-this.col):this.options.rowsRevers?(this.options.rows-this.row-1)*this.options.columns+this.col+1:this.options.columnsRevers?this.row*this.options.columns+(this.options.columns-this.col):this.row*this.options.columns+this.col+1,t}createHotspotsSettings(t){let o=!0;for(let s=0,i=t.length;s<i;s++){const i=new Map;Object.entries(t[s].frames).forEach((([e,n])=>{const r=n;r.pointerPositionPercentage={top:h.isPercentage(""+n.pointer.y),left:h.isPercentage(""+n.pointer.x)},Object.entries(t[s]).forEach((([t,s])=>{"frames"!==t&&("data"!==t||o)&&(r[t]=s,o=!1)})),i.set(parseInt(e,10),r)})),this.hotspotsSettings.push(i),o=!0}}createHotspots(t){Array.isArray(t)||(t=[t]),this.createHotspotsSettings(t);const o=this.startHotspotSettings;super.createHotspots(o)}addHotspot(t){Array.isArray(t)||(t=[t]),this.createHotspotsSettings(t);const o=this.startHotspotSettings;super.createHotspots(o.slice(o.length-t.length)),this.updateAndShow()}get startHotspotSettings(){const t=[];return this.hotspotsSettings.forEach((o=>{let s=null;"ie"===n.browser.uaName?o.forEach((t=>{s||(s=t)})):o.entries().next().value&&(s=o.entries().next().value[1]),s&&t.push(s)})),t}setFramePosition(t,o){this.row=t,this.col=o}updateAndShow(){const t=this.frameIndex;this.hotspotsSettings.forEach(((o,s)=>{const i=o.get(t),e=this.hotspots[s];i&&e.isEnabled()?(e.setHotspotSettings(i),e.isHotspotShown()?(e.setPointerPosition(),this.showNeededElements(),e.isBoxAlwaysVisible()&&(e.setBaseBoxSize(e.boxSize),e.setBoxPosition()),e.isTooltipAlwaysVisible()&&e.setTooltipPosition()):this.show(s)):this.hide(s)}))}hideNeededElements(t){this.activeHotspots.forEach((o=>{o.isBoxAlwaysVisible()||o.hideBox(t)})),this.hoveredHotspots.forEach((o=>{o.isTooltipAlwaysVisible()&&o.hideTooltip(t)}))}changeHotspotsPosition(t,o){this.row===t&&this.col===o||(this.setFramePosition(t,o),this.updateAndShow())}showAll(){const t=this.frameIndex;this.hotspotsSettings.forEach(((o,s)=>{o.get(t)&&this.show(s)}))}enable(t){if(this.hotspotsSettings[t]){const o=this.hotspots[t];o.enable(),this.hotspotsSettings[t].get(this.frameIndex)&&o.show()}}setStateById(t,o){this.hotspots[t]&&this.hotspots[t].setState(o,!this.hotspotsSettings[t].get(this.frameIndex))}removeHotspot(t){this.hotspots[t]&&(this.hotspotsSettings.splice(t,1),super.removeHotspot(t))}destroy(){super.destroy(),this.options=null,this.row=null,this.col=null,this.hotspotsSettings=null}}}));
Sirv.define("Zoominstance",["bHelpers","magicJS","HotspotInstance","ImageZoom"],((o,t,s,e)=>{t.$;return class extends s{constructor(o,t,s){super(o,t,s),this.zoom=null,this.upscale=!1,this.defaultZoomOptions={},this.zoomContainer=this.instanceNode,this.zoomClassName="smv-zoomed-in",this.api=Object.assign(this.api,{zoomIn:this.zoomIn.bind(this),zoomOut:this.zoomOut.bind(this),isZoomed:this.isZoomed.bind(this)})}setDefaultZoomOptions(){this.defaultZoomOptions={test:!1,upscale:this.upscale,smoothing:!0}}createZoom(o,t){if(!this.destroyed){let o=Object.assign({},this.defaultZoomOptions);return t&&(o=Object.assign(o,t)),this.zoom=new e(this.instanceNode,o),this.zoom.parentClass=this,o}return null}onZoomGetImage(o){o.data.exactSize=!0,o.data.maxSize=!1,o.data.round=!1,o.data.callbackData={lens:!0,indexX:o.data.indexX,indexY:o.data.indexY,level:o.data.level,number:o.data.number,map:o.data.map}}onZoomCancelLoadingOfTiles(o){o.data.callbackData||(o.data.callbackData={}),o.data.callbackData.lens=!0}onZoomBeforeShow(o){}onZoomShown(o){}onZoomHidden(o){}setZoomEvents(){this.zoom&&(this.on("zoomGetImage",(o=>{o.stopAll(),this.onZoomGetImage(o)})),this.on("zoomCancelLoadingOfTiles",(o=>{o.stopAll(),this.onZoomCancelLoadingOfTiles(o)})),this.on("zoomBeforeShow",(o=>{o.stopAll(),this.onZoomBeforeShow(o)})),this.on("zoomShown",(o=>{o.stopAll(),this.onZoomShown(o)})),this.on("zoomHidden",(o=>{o.stopAll(),this.onZoomHidden(o)})))}zoomIn(){return this.ready}zoomOut(){return this.ready}getZoomData(){return this.ready&&this.zoom?this.zoom.getZoomData():0}isZoomed(){return!(!this.ready||!this.zoom)&&(this.zoom.shown||this.zoom.showing)}isZoomSizeExist(){return!1}clearZoom(){this.zoom&&(this.off("zoomGetImage"),this.off("zoomCancelLoadingOfTiles"),this.off("zoomBeforeShow"),this.off("zoomShown"),this.off("zoomHidden"),this.zoom.destroy(),this.zoom=null)}destroy(){this.clearZoom(),super.destroy()}}}));
Sirv.define("ImageZoom",["bHelpers","magicJS","globalVariables","globalFunctions","helper","EventEmitter"],((i,t,e,s,h,o)=>{const n=t,a=n.$;s.rootDOM.addModuleCSSByName("ImageZoom",(()=>".sirv-zoom{position:absolute;-webkit-backface-visibility:hidden!important;backface-visibility:hidden!important;-webkit-touch-callout:none!important;-webkit-user-select:none!important;-ms-user-select:none!important;user-select:none!important;outline:0!important;z-index:999999999;touch-action:none;-webkit-tap-highlight-color:transparent!important}.sirv-zoom .sirv-outside-zoom{background:#fff;box-shadow:0 0 3px rgba(153,153,153,.5)}.sirv-zoom .sirv-circle-zoom{border:0;border-radius:100%;background:rgba(255,255,255,.3)}.sirv-zoom .sirv-circle-zoom::before{position:absolute;display:block;top:0;right:0;bottom:0;left:0;border:1px solid rgba(153,153,153,.7);border-radius:100%;background:0 0;box-shadow:inset 0 0 20px 1px rgba(0,0,0,.3);content:'';z-index:126}.sirv-zoom .sirv-zoom-wrapper{position:absolute;display:inline-block;overflow:hidden;z-index:9}.sirv-zoom .sirv-zoom-wrapper .sirv-zoom-image-wrapper{position:absolute;overflow:hidden}.sirv-zoom .sirv-zoom-wrapper .sirv-zoom-image-wrapper>img{position:absolute;top:0;left:0;margin:0;padding:0;-webkit-user-drag:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;user-drag:none}.sirv-zoom .sirv-zoom-wrapper .sirv-deepzoom{position:relative;top:0;left:0;width:100%;height:100%;overflow:hidden;z-index:42}.sirv-zoom .sirv-zoom-wrapper .sirv-deepzoom>div{position:absolute;top:0;left:0;width:100%;height:100%}.sirv-zoom .sirv-zoom-wrapper .sirv-deepzoom>div canvas{top:0;left:0}.zoom-helper{position:fixed;border-radius:4px;display:inline-block;top:10px;right:10px;padding:10px;border:1px solid #ccc9c9;background-color:#eaeaea;box-shadow:1px 1px 9px 1px rgba(0,0,0,.5);overflow:hidden;z-index:999;overflow-y:auto}.zoom-helper .z-loaded-color{background-color:#87bd89!important}.zoom-helper .z-loading-color{background-color:#a99cef!important}.zoom-helper .z-canceled-color{background-color:#f19c9c!important}.zoom-helper .z-helper-head{margin-bottom:9px}.zoom-helper .z-body,.zoom-helper .z-head,.zoom-helper .z-level{position:relative}.zoom-helper .z-level{border-radius:4px;margin-bottom:9px;padding:10px;background-color:#d4d3d3;box-sizing:border-box}.zoom-helper .z-head{margin-bottom:9px}.zoom-helper .z-body{border-top:1px solid;border-left:1px solid}.zoom-helper .z-tile{position:absolute;display:inline-block;border-right:1px solid;border-bottom:1px solid;box-sizing:border-box}.zoom-helper .z-status{border-radius:50%;display:inline-block;width:10px;height:10px;margin-left:10px;background-color:#e87979;box-sizing:border-box}.zoom-helper .z-status.shown{background-color:#66ca66!important}.sirv-zoom-map{position:absolute;box-sizing:border-box;bottom:16px;left:16px;width:200px;height:150px;border:1px solid #bdbdbd;overflow:hidden;z-index:126;cursor:pointer}.sirv-zoom-map .sirv-zoom-map-lens{position:absolute;box-sizing:border-box;top:50px;left:50px;width:50px;height:50px;border:1px solid #fff;z-index:42}.sirv-zoom-map .sirv-zoom-map-lens::after,.sirv-zoom-map .sirv-zoom-map-lens::before{position:absolute;display:block;width:100%;height:100%;content:''}.sirv-zoom-map .sirv-zoom-map-lens::before{box-sizing:content-box;border-width:1em;border-style:solid;border-color:rgba(0,0,0,.6);border-image:initial;top:-1em;left:-1em}.sirv-zoom-map .sirv-zoom-map-lens::after{box-sizing:border-box;border-width:1px;border-style:solid;border-color:#fff;border-image:initial}.sirv-zoom-map>img{position:relative;top:0;left:0;width:100%;height:100%}.sirv-zoom-lens,.sirv-zoom-lens-wrapper{position:absolute;top:0;left:0}.sirv-zoom-lens-wrapper{background-color:rgba(153,153,153,.4);overflow:hidden;z-index:9999999999}.sirv-zoom-lens{box-shadow:0 0 3px rgba(153,153,153,.5);overflow:hidden}.sirv-zoom-lens img{max-width:none!important;max-height:none!important;transition:none!important}.sirv-filter-bw{filter:grayscale(.5) opacity(.5);filter:url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg'><filter id='grayscale'><feColorMatrix type='saturate' values='0'/><feComponentTransfer><feFuncA type='linear' slope='0.6'/></feComponentTransfer></filter></svg>#grayscale\")}"));const r={canZoom:"smv-cursor-zoom",zoomIn:"smv-cursor-zoom-in",zoomOut:"smv-cursor-zoom-out",drag:"smv-cursor-dragging"},l=["mousedrag","touchdrag"],d=["edge","ie"].includes(n.browser.uaName)?"pointerup":"touchend",c=["edge","ie"].includes(n.browser.uaName)?"pointermove":"mousemove",m=(i,t)=>i/100*t,g=(i,t)=>(i-t)/2,p=(i,t,e,s)=>(i>t&&(i=t),i+e<s&&(i=s-e),i),w=(i,t)=>i/t*100,S=(i,t,e)=>(i<t&&(i=t),i>e&&(i=e),i),z=(i,t)=>t/i;class v extends o{constructor(i){super(),this.o=Object.assign({maxTileSize:15,minTileSize:5},i||{}),this.inDoc=!1,this.container=n.$new("div").addClass("zoom-helper"),this.header=n.$new("div").addClass("z-helper-head"),this.zoom=n.$new("span").addClass("z-zoom"),this.tileSize={width:0,height:0},this.levels={}}_createHead(){let i=n.$new("div");i.innerHTML="Zoom: ",i.append(this.zoom),this.setZoom(0),this.header.append(i),i=n.$new("div"),i.innerHTML='<div class="z-status z-canceled-color"></div> - canceled',this.header.append(i),i=n.$new("div"),i.innerHTML='<div class="z-status z-loading-color"></div> - loading',this.header.append(i),i=n.$new("div"),i.innerHTML='<div class="z-status z-loaded-color"></div> - loaded',this.header.append(i)}_calcSizeOfTile(i){const t=(i,t)=>{let e=parseInt(i*t,10);return e<this.o.minTileSize&&(e=this.o.minTileSize),e};let e,s;return i.width>i.height?(e=this.o.maxTileSize,s=t(e,i.height/i.width)):(s=this.o.maxTileSize,e=t(s,i.width/i.height)),{width:e,height:s}}_createTile(i,t,e){const s=(i,t)=>i?(()=>{let i=parseInt(t/2,10);return i<3&&(i=3),i})():t,h=(i,t)=>i%t<t/2,o=s(e.cols-1===i&&h(e.levelSize.width,e.tileSize.width),this.tileSize.width),a=s(e.rows-1===t&&h(e.levelSize.height,e.tileSize.height),this.tileSize.height),r=n.$new("div").addClass("z-tile");return r.setCss({top:t*this.tileSize.height+"px",left:i*this.tileSize.width+"px",width:o+"px",height:a+"px"}),{currentClass:null,width:o,height:a,col:i,row:t,node:r}}_show(i){i&&(this.inDoc||(this.inDoc=!0,this._createHead(),this.container.append(this.header),a(n.D.node.body).append(this.container)),i.inDoc||(i.inDoc=!0,this.container.append(i.node),this.container.setCssProp("max-height",n.W.innerHeight-55+"px")))}_setItemClass(i,t,e,s){const h=i.tiles[e][t];h.currentClass!==s&&(h.currentClass&&h.node.removeClass(h.currentClass),h.currentClass=s,h.node.addClass(s))}setZoom(i){(i+="").length<2&&(i+=".0"),this.zoom.innerHTML=i}createLevel(i){const t=n.$new("div").addClass("z-level"),e=n.$new("div").addClass("z-body"),s=n.$new("div").addClass("z-head"),h=n.$new("div").addClass("z-status");let o=n.$new("div");o.innerHTML="Level: "+i.level,s.append(o),o=n.$new("div"),o.innerHTML="Shown:",o.append(h),s.append(o),o=n.$new("div"),o.innerHTML=i.levelSize.width+"x"+i.levelSize.height,s.append(o),t.append(s),t.append(e),this.tileSize.width||(this.tileSize=this._calcSizeOfTile(i.levelSize));const a=((t,s)=>{let h,o;const n=[];for(o=0;o<s;o++){const s=[];for(h=0;h<t;h++){const t=this._createTile(h,o,i);e.append(t.node),s.push(t)}n.push(s)}return n})(i.cols,i.rows),r=a[i.rows-1][i.cols-1];e.setCss({width:(i.cols-1)*this.tileSize.width+r.width+"px",height:(i.rows-1)*this.tileSize.height+r.height+"px"}),this.levels[i.level]={inDoc:!1,number:i.level,status:h,node:t,head:s,body:e,tiles:a}}tileAction(i){const t=this.levels[i.level+""];let e;switch(i.type){case 0:e="z-canceled-color";break;case 1:e="z-loading-color";break;case 2:e="z-loaded-color"}this._setItemClass(t,i.col,i.row,e)}setLevelState(i,t){const e=this.levels[i+""],s="shown";t?e.inDoc&&e.status.addClass(s):e.status.removeClass(s)}setData(i){let t;n.defined(i.level)&&(t=this.levels[i.level+""]),t&&this._show(t),i.zoom&&this.setZoom(i.zoom),t&&"col"in i&&this._setItemClass(t,i.col,i.row,"z-loaded-color"),t&&n.defined(i.levelStatus)&&this.setLevelState(i.level,i.levelStatus)}destroy(){this.inDoc&&(this.inDoc=!1,this.zoom.remove(),this.zoom.inneHTML="",this.header.remove(),this.header.inneHTML="",this.container.remove(),this.container.inneHTML="",this.levels={},this.tileSize={width:0,height:0}),super.destroy()}}const u=(()=>{class i{constructor(i){this.isInner=i.inner,this.rows=i.lengthOfRow,this.cols=i.lengthOfColumn,this.size={width:i.cameraWidth,height:i.cameraHeight},this.bMapS={width:i.mapWidth,height:i.mapHeight},this.bTileS={width:i.tileWidth,height:i.tileHeight},this.bScale={x:i.scaleX,y:i.scaleY},this.mapS={width:this.bMapS.width,height:this.bMapS.height},this.tileS={width:this.bTileS.width,height:this.bTileS.height},this.baseLastTileSize={width:this.bMapS.width-(this.cols-1)*this.bTileS.width,height:this.bMapS.height-(this.rows-1)*this.bTileS.height},this.lastTileSize={width:this.baseLastTileSize.width,height:this.baseLastTileSize.height},this.position={x:0,y:0},this.lastCorrectionPosition={x:0,y:0},this.scale={x:0,y:0},this.lastScale=0,this.lastGlobaslScale=0,this.count={x:0,y:0},this.calcCount(),this.shownTiles={startX:0,countX:this.count.x,startY:0,countY:this.count.y}}static getTileIndex(i,t){return Math.floor(i/t)}static getTileSize(i,t){return i*t}get x(){return this.position.x}get y(){return this.position.y}get width(){return this.size.width}get height(){return this.size.height}get mapWidth(){return this.mapS.width}get mapHeight(){return this.mapS.height}get shownTilesX(){return this.shownTiles.startX}get shownTilesY(){return this.shownTiles.startY}get shownTilesWidth(){return this.shownTiles.countX}get shownTilesHeight(){return this.shownTiles.countY}get scaleX(){return this.scale.x}get scaleY(){return this.scale.y}set mapWidth(i){null!=i&&(this.mapS.width=i)}set mapHeight(i){null!=i&&(this.mapS.height=i)}checkTile(i,t){const e=this.shownTiles;return e.startX<=i&&e.startY<=t&&e.startX+e.countX>i&&e.startY+e.countY>t}calcCount(){this.count={x:Math.ceil(this.size.width/this.tileS.width)+1,y:Math.ceil(this.size.height/this.tileS.height)+1}}findShownTiles(){const t=this.position,e=this.tileS;let s=0,h=0,o=this.count.x,n=this.count.y;t.x<0&&(s=i.getTileIndex(Math.abs(t.x),e.width)),t.y<0&&(h=i.getTileIndex(Math.abs(t.y),e.height)),s+o>this.cols&&(o=this.cols-s),h+n>this.rows&&(n=this.rows-h),this.shownTiles={startX:s,countX:o,startY:h,countY:n}}calcTileSize(){this.tileS.width=i.getTileSize(this.bTileS.width,this.scale.x),this.tileS.height=i.getTileSize(this.bTileS.height,this.scale.y),this.lastTileSize.width=i.getTileSize(this.baseLastTileSize.width,this.scale.x),this.lastTileSize.height=i.getTileSize(this.baseLastTileSize.height,this.scale.y)}calcData(i){this.lastScale!==this.scale.x&&(this.calcTileSize(),this.calcCount(),this.mapS.width=this.tileS.width*(this.cols-1)+this.lastTileSize.width,this.mapS.height=this.tileS.height*(this.rows-1)+this.lastTileSize.height,this.lastCorrectionPosition.x=(this.bMapS.width*this.bScale.x-this.mapS.width)/2,this.lastCorrectionPosition.y=(this.bMapS.height*this.bScale.y-this.mapS.height)/2,this.lastScale=this.scale.x),this.position.x=i.x+this.lastCorrectionPosition.x,this.position.y=i.y+this.lastCorrectionPosition.y}action(i,t){this.lastGlobaslScale!==t.x&&(this.lastScale=this.scale.x,this.scale.x=t.x*this.bScale.x,this.scale.y=t.y*this.bScale.y,this.lastGlobaslScale=t.x),this.calcData(i),this.findShownTiles()}resize(i){this.size.width=i.width,this.size.height=i.height,this.calcCount(),this.findShownTiles()}destroy(){this.shownTiles=[]}}const t=0,e=1,s=2;class r extends o{constructor(i){super(),this.id=i.id,this.index={x:i.indexX,y:i.indexY},this.position={x:i.x,y:i.y},this.size={width:i.width,height:i.height},this.storage=i.storage,this.state=t,this.node=null,this.storage.has(this.id)&&(this.node=this.storage.get(this.id),this.state=s)}get loaded(){return this.state===s}addImageToStorage(){this.storage.has(this.id)||this.storage.set(this.id,this.node)}load(){this.state===t&&(this.state=e,this.emit("getTile",{data:{indexX:this.index.x,indexY:this.index.y,number:this.id}}))}cancelLoading(){this.state===e&&(this.state=t,this.emit("zoomCancelLoadingOfTiles",{data:{indexX:this.index.x,indexY:this.index.y,number:this.id}}))}set image(i){this.state!==s&&(this.state=s,this.node=a(i),this.addImageToStorage())}destroy(){this.cancelLoading(),this.storage=null,super.destroy()}}class l{constructor(i,t){this.p=a(i),this.dppx=t,this.w=n.$new("div"),this.cvs=n.$new("canvas"),this.ctx=this.cvs.node.getContext("2d"),this.w.append(this.cvs)}set index(i){this.w.addClass("deepzoom-level-"+i),this.w.attr("z-index"+(i+1))}append(){this.p.append(this.w)}show(){this.w.setCssProp("display","")}hide(){this.w.setCssProp("display","none")}clear(){this.ctx.clearRect(0,0,this.cvs.node.width,this.cvs.node.height)}draw(i,t,e,s){this.ctx.setTransform(1,0,0,1,0,0),this.clear(),this.ctx.setTransform(i,0,0,t,e,s)}drawTile(i,t,e){"edge"===n.browser.uaName||"ie"===n.browser.uaName?this.dppx>1?this.ctx.drawImage(i.node,0,0,t.width,t.height,e.x,e.y,t.width,t.height):this.ctx.drawImage(i.node,e.x,e.y,t.width,t.height):this.ctx.drawImage(i.node,0,0,t.width,t.height,e.x,e.y,t.width,t.height)}set canvasSize(i){this.cvs.setCss(i),this.cvs.attr("width",i.width*this.dppx),this.cvs.attr("height",i.height*this.dppx)}destroy(){this.cvs.remove(),this.w.remove()}}const d=new Map,c=(i,t)=>i/t;class g extends o{constructor(t,e){super(),this.view=t,this.id=e.id,this.dppx=e.dppx,this.size={width:e.width,height:e.height},this.mSize={width:e.maxWidth,height:e.maxHeight},this.tSize={width:e.tileWidth,height:e.tileHeight},this.tileImageSize={width:e.tileImageWidth,height:e.tileImageHeight},this.layerSize={width:e.layerWidth,height:e.layerHeight},this.hash=e.hash+"-"+this.size.width+"x"+this.size.height,d.has(this.hash)||d.set(this.hash,new Map),this.scaleFactor={x:(this.mSize.width-this.size.width)/this.size.width+1,y:(this.mSize.height-this.size.height)/this.size.height+1},this.maxDisplayedSize={width:e.maxDisplayedWidth,height:e.maxDisplayedHeight},this.minDisplayedSize={width:e.minDisplayedWidth,height:e.minDisplayedHeight},this.globalScale={x:1,y:1},this.globalPosition={x:0,y:0},this.view.index=this.id,this.lensSize={width:e.viewPortWidth,height:e.viewPortHeight},this.isAdded=!1,this.isShown=!1,this.tiles=this.calcTiles(),this.tileCount=this.tiles.length*this.tiles[0].length,this.loadedTiles=0,this.camera=new i({inner:e.inner,scaleX:this.scaleFactor.x,scaleY:this.scaleFactor.y,cameraWidth:e.viewPortWidth,cameraHeight:e.viewPortHeight,mapWidth:this.size.width,mapHeight:this.size.height,tileWidth:c(this.tileImageSize.width,this.dppx),tileHeight:c(this.tileImageSize.height,this.dppx),lengthOfRow:this.tiles.length,lengthOfColumn:this.tiles[0].length}),T&&T.createLevel({level:this.id,cols:this.tiles[0].length,rows:this.tiles.length,levelSize:{width:this.size.width,height:this.size.height},tileSize:{width:this.tileImageSize.width,height:this.tileImageSize.height}})}addEvents(){const i=this.tileImageSize;this.on("getTile",(t=>{t.data.width=this.size.width,t.data.height=this.size.height,t.data.level=this.id,t.data.imageSettings={tile:{width:i.width,height:i.height,number:t.data.number}},this.dppx>1&&(t.data.dppx=this.dppx),T&&T.tileAction({level:this.id,col:t.data.indexX,row:t.data.indexY,type:1})})),this.on("zoomCancelLoadingOfTiles",(t=>{t.data.width=this.size.width,t.data.height=this.size.height,t.data.imageSettings={tile:{width:i.width,height:i.height,number:t.data.number}},T&&T.tileAction({level:this.id,col:t.data.indexX,row:t.data.indexY,type:0})}))}cancelLoadingOfTiles(){this.tiles.forEach((i=>{i.forEach((i=>{i.cancelLoading()}))}))}set image(i){const t=this.tiles[i.indexY][i.indexX];t.loaded||(this.loadedTiles+=1),t.image=i.node,this.isShown&&this.camera.checkTile(i.indexX,i.indexY)&&this.drawTile(t),T&&T.setData({level:this.id,col:i.indexX,row:i.indexY})}append(){!this.isAdded&&this.isShown&&(this.isAdded=!0,this.addEvents(),this.view.append())}calcTiles(){const i=[],t=this.tileImageSize,e=Math.ceil(this.layerSize.width/t.width),s=Math.ceil(this.layerSize.height/t.height);for(let h=0;h<s;h++){const o=a([]);for(let i=0;i<e;i++){const n=new r({y:h*t.height,x:i*t.width,indexX:i,indexY:h,id:h*e+i,width:i!==e-1?t.width:this.layerSize.width-i*t.width,height:h!==s-1?t.height:this.layerSize.height-h*t.height,storage:d.get(this.hash)});n.parentClass=this,o.push(n)}i.push(o)}return i}correctDPPXPosition(i,t,e){let s=i;if(this.dppx>1){const h=t/2;s=Math.abs(i-h)/(e/100),s=h*this.dppx-e*this.dppx/100*s}return s}draw(){const i=this.camera;this.isShown&&(this.view.draw(i.scaleX,i.scaleY,this.correctDPPXPosition(i.x,i.width,i.mapWidth),this.correctDPPXPosition(i.y,i.height,i.mapHeight)),this.eachTile((i=>{this.drawTile(i)})))}drawTile(i){i&&i.loaded&&this.view.drawTile(i.node,i.size,i.position)}eachTile(i){const t=this.camera;for(let e=0,s=t.shownTilesHeight;e<s;e++)for(let s=0,h=t.shownTilesWidth;s<h;s++)i(this.tiles[t.shownTilesY+e][t.shownTilesX+s])}checkSize(){const i=this.isShown,t=this.camera,e=t.mapWidth<=this.maxDisplayedSize.width,s=t.mapHeight<=this.maxDisplayedSize.height,h=t.mapWidth>this.minDisplayedSize.width,o=t.mapHeight>this.minDisplayedSize.height;this.isShown=e&&s&&h&&o,i!==this.isShown&&(this.isShown?this.view.show():this.view.hide(),this.isShown||this.cancelLoadingOfTiles())}action(i,t){this.globalPosition.x=i.x,this.globalPosition.y=i.y,this.globalScale.x=t.x,this.globalScale.y=t.y,this.camera.action(this.globalPosition,this.globalScale),(this.camera.mapWidth>this.mSize.width||this.camera.mapHeight>this.mSize.height)&&(this.camera.mapWidth=this.mSize.width,this.camera.mapHeight=this.mSize.height),this.checkSize(),this.append(),this.draw(),T&&T.setData({level:this.id,levelStatus:this.isShown})}loadImages(){this.isShown&&this.loadedTiles!==this.tileCount&&this.eachTile((i=>{i.load()}))}set lensSize(i){this.view.canvasSize=i}resize(i){this.lensSize=i,this.camera.resize(i),this.action(this.globalPosition,this.globalScale)}destroy(){this.off("getTile"),this.off("zoomCancelLoadingOfTiles"),this.isShown=!1,this.camera.destroy(),this.tiles.forEach((i=>{i.forEach((i=>{i.destroy()}))})),super.destroy()}}class p{constructor(i,t){this.p=a(i),this.c=n.$new("div"),this.c.addClass(t+"-deepzoom")}get container(){return this.c}show(){this.p.append(this.c)}hide(){this.c.remove()}destroy(){this.c.remove(),this.c=null}}class w extends o{constructor(i,t){super(),this.view=i,this.options=Object.assign({tiles:!0,inner:!0,tileSize:{width:256,height:256},minZoomFactor:100,upscale:!1},t),this._hash=null,this.setDefaultVars()}static convertScaleToSize(i,t){return{width:h.round(i.width*t.x,2),height:h.round(i.height*t.y,2)}}set hash(i){this._hash=""+n.getHashCode(i)}setDefaultVars(){this.isShown=!1,this.originSize={width:0,height:0},this._maxSize={width:0,height:0},this._minSize={width:0,height:0},this._lensSize={width:0,height:0},this.currentSize={width:0,height:0},this.levels=a([]),this.on("getTile",(i=>{this.options.tiles||(delete i.data.imageSettings.tile,delete i.data.number)}))}createLevels(){const i=(i,t)=>t<1.5?i:i*n.DPPX,t=this._maxSize,e=this._minSize;if(!this.levels.length&&t.width-e.width>this.options.minZoomFactor){let s=[];this.options.inner?s=((i,t)=>{let e=Math.max(1,Math.round(Math.log(Math.max(t.width/i.width,t.height/i.height))/Math.LN2)),s=t.width,h=t.height;const o=[];for(;e>0;)e-=1,o.push({width:s,height:h}),s=parseInt(s/2,10),h=parseInt(h/2,10);return o})(e,t,this.options.inner):s.push({width:t.width,height:t.height});let o=this.options.tileSize;for(let n=0,a=s.length;n<a;n++){this.options.tiles||(o=s[n]);const r=n+1<a-1?s[n+1]:e,d=n-1>=0?s[n-1]:t,c=h.getDPPX(s[n].width,this.originSize.width,this.options.upscale),p=new l(this.view.container,c),w=new g(p,{id:a-n,hash:this._hash,dppx:c,inner:this.options.inner,width:s[n].width,height:s[n].height,maxWidth:this._maxSize.width,maxHeight:this._maxSize.height,layerWidth:Math.round(s[n].width*c),layerHeight:Math.round(s[n].height*c),maxDisplayedWidth:s[n].width+m(d.width-s[n].width,50),maxDisplayedHeight:s[n].height+m(d.height-s[n].height,50),minDisplayedWidth:r.width+m(s[n].width-r.width,50),minDisplayedHeight:r.height+m(s[n].height-r.height,50),tileWidth:o.width,tileHeight:o.height,tileImageWidth:i(o.width,c),tileImageHeight:i(o.height,c),viewPortWidth:this._lensSize.width,viewPortHeight:this._lensSize.height});w.parentClass=this,this.levels.push({view:p,controller:w})}this.levels.reverse()}}getCurrentShownLevel(){let i=null;const t=this.levels.length;if(this.isShown)for(let e=t-1;e>=0;e--)if(this.levels[e].controller.isShown){i=this.levels[e].controller;break}return i}getScale(i){const t=this.getCurrentShownLevel();let e;const s=this.levels.length;switch(i){case"zoomin":e=t?this.currentSize.width<t.size.width?z(this._maxSize.width,t.size.width):t.id!==s?z(this._maxSize.width,this.levels[t.id].controller.size.width):z(this._maxSize.width,this.levels[s-1].controller.size.width):z(this._maxSize.width,this.levels[0].controller.size.width);break;case"zoomout":e=t?this.currentSize.width>t.size.width?z(this._maxSize.width,t.size.width):t.id>1?z(this._maxSize.width,this.levels[t.id-2].controller.size.width):z(this._maxSize.width,this._minSize.width):z(this._maxSize.width,this._minSize.width)}return e}show(){return this.isShown||(this.isShown=!0,this.view.show()),this}hide(){return this.isShown&&(this.isShown=!1,this.view.hide(),this.levels.forEach((i=>{i.view.destroy(),i.controller.destroy()})),this.setDefaultVars()),this}action(i,t){return this.isShown&&(this.currentSize=w.convertScaleToSize(this._maxSize,t),this.levels.forEach((e=>{e.controller.action(i,t)})),T&&T.setData({zoom:h.round(this.currentSize.width/this._minSize.width,1,this.currentSize.width===this._maxSize.width)})),this}set lensSize(i){this._lensSize.width=i.width,this._lensSize.height=i.height}set minSize(i){this._minSize.width=i.width,this._minSize.height=i.height}set maxSize(i){this._maxSize.width=i.width,this._maxSize.height=i.height,this.originSize.width=i.originWidth,this.originSize.height=i.originHeight,this.createLevels()}loadImages(){this.isShown&&this.levels.forEach((i=>{i.controller.loadImages()}))}set image(i){this.isShown&&(this.levels[i.level-1].controller.image=i)}resize(){this.isShown&&this.levels.forEach((i=>{i.controller.resize(this._lensSize)}))}destroy(){this.hide(),this.off("getTile"),this.off("zoomCancelLoadingOfTiles"),super.destroy()}}return class extends o{constructor(i,t){super(),this.view=new p(i,"sirv"),this.controller=new w(this.view,t),this.controller.parentClass=this}set lensSize(i){this.controller.lensSize=i}loadImages(){this.controller.loadImages()}getScale(i){return this.controller.getScale(i)}set image(i){this.controller.image=i}set hash(i){this.controller.hash=i}set minSize(i){this.controller.minSize=i}set maxSize(i){this.controller.maxSize=i}show(){this.controller.show()}hide(){this.controller.hide()}action(i,t){this.controller.action(i,t)}resize(){this.controller.resize()}destroy(){this.controller.destroy(),this.controller=null,this.view.destroy(),this.view=null,super.destroy()}}})(),x=(()=>{class i{constructor(i,t){this.pn=a(i);const e="sirv-zoom-lens";this.c=n.$new("div"),this.c.addClass(e+"-wrapper"),this.ic=n.$new("div"),this.ic.addClass(e),this.ic.appendTo(this.c),this.img=null,this.bwImg=null,t&&this.c.addEvent("mousedown",(i=>{i.stop()}))}get container(){return this.c}calcContainerPosition(){if(["img","canvas"].includes(this.pn.tagName)){const i=this.pn.position,t=a(this.pn.node.parentNode).position;this.c.setCss({top:i.top-t.top,left:i.left-t.left})}}set imageSize(i){this.img&&[this.img,this.bwImg].forEach((t=>{t&&t.setCss({top:0,left:0,width:i.width,height:i.height,position:"absolute"})}))}get size(){return this.pn.size}set containerSize(i){this.c.setCss({width:i.width,height:i.height})}set insideContainerSize(i){this.ic.setCss({width:i.width,height:i.height})}set insideContainerFontSize(i){this.ic.setCssProp("font-size",Math.max(i.width,i.height)+"px")}setTransform(i,t){this.ic.setCssProp("transform","translate3d("+i+"px,"+t+"px, 0px)"),this.img&&this.img.setCssProp("transform","translate3d("+-1*i+"px, "+-1*t+"px, 0px)")}show(i,t){i&&(this.img=a(i)),this.calcContainerPosition(),this.imageSize=t,this.img&&this.ic.append(this.img);let e=this.pn;["img","canvas"].includes(e.tagName)&&(e=a(e.node.parentNode)),e.append(this.c)}hide(){this.c.remove(),this.img&&(this.img.remove(),this.img=null,this.bwImg&&(this.bwImg.remove(),this.bwImg=null))}destroy(){this.c.removeEvent("mousedown"),this.c.remove()}}const t=(i,t)=>Math.abs(i-t),e=(i,t,e)=>(i-t)*e;class s{constructor(i){this.view=i,this.pSize={width:0,height:0},this.inDoc=!1,this.timer=null,this.isPlaying=!1,this.pos={x:null,y:null},this.dPos={x:null,y:null},this._size={width:0,height:0},this.dSize={width:0,height:0}}doAnimation(){let i=!1;const e=.001;return(t(this.pos.x,this.dPos.x)>e||t(this.pos.y,this.dPos.y)>e||t(this._size.width,this.dSize.width)>e||t(this._size.height,this.dSize.height)>e)&&(i=!0),i}animate(){this.isPlaying=!0;const i=.4,t=e(this.pos.x,this.dPos.x,i),s=e(this.pos.y,this.dPos.y,i),h=e(this._size.width,this.dSize.width,i),o=e(this._size.height,this.dSize.height,i);this.dPos.x+=t,this.dPos.y+=s,this.dSize.width+=h,this.dSize.height+=o,this.setCss(),this.doAnimation()?this.timer=setTimeout((()=>{this.animate()}),16):this.stopAnimation()}setCss(){const i=this._size,e=this.dSize;(t(i.width,e.width)>0||t(i.height,e.height)>0)&&(this.view.insideContainerSize=e,this.view.insideContainerFontSize=this.pSize),this.view.setTransform(Math.round(this.dPos.x),Math.round(this.dPos.y))}stopAnimation(){this.isPlaying&&(this.isPlaying=!1,clearTimeout(this.timer),this.dPos.x=this.pos.x,this.dPos.y=this.pos.y,this.dSize.width=this._size.width,this.dSize.height=this._size.height,this.setCss())}set size(i){this._size.width=i.width,this._size.height=i.height,this.inDoc&&null!==this.dPos.x&&(this.isPlaying||this.animate())}set position(i){const t=this._size,e=this.pSize;let s=i.x-t.width/2,h=i.y-t.height/2;s<0&&(s=0),h<0&&(h=0),s>e.width-t.width&&(s=e.width-t.width),h>e.height-t.height&&(h=e.height-t.height),this.pos.x=s,this.pos.y=h,null===this.dPos.x&&(this.dPos.x=s,this.dPos.y=h),this.inDoc&&(this.isPlaying||this.animate())}setSizes(){const i=this.view.size;this.pSize=i,this.view.containerSize=i,this.view.insideContainerFontSize=i}show(i){this.inDoc||(this.inDoc=!0,this.setSizes(),this.view.show(i,this.pSize))}hide(){this.inDoc&&(this.inDoc=!1,this.view.hide(),this.pos={x:null,y:null},this.dPos={x:null,y:null},this._size={width:0,height:0},this.dSize={width:0,height:0})}resize(){this.inDoc&&(this.setSizes(),this.view.calcContainerPosition())}destroy(){this.stopAnimation(),this.inDoc=!1}}return class{constructor(t,e){this.view=new i(t,e),this.controller=new s(this.view)}addEventToMainContainer(i,t){this.view.container.addEvent(i,t)}removeEventToMainContainer(i,t){t?this.view.container.removeEvent(i,t):this.view.container.removeEvent(i)}clearEvents(){this.view.container.clearEvents()}get boundaries(){return this.view.container.node.getBoundingClientRect()}show(i){this.controller.show(i)}hide(){this.controller.hide()}set size(i){this.controller.size=i}set position(i){this.controller.position=i}destroy(){this.controller.destroy(),this.view.destroy()}}})(),y=(()=>{class i{constructor(i){this.p=a(i);const t="sirv-zoom-map";this.c=n.$new("div"),this.c.addClass(t),this.lens=n.$new("div"),this.lens.addClass(t+"-lens"),this._img=null,this.b=a(n.D.node.body),this.c.append(this.lens)}calcRightPosition(i,t){const e=this.c.rect;return{x:i-e.left,y:t-e.top}}addDomEventToDocBody(i,t){this.b.addEvent(i,t)}removeDomEventToDocBody(i,t){this.b.removeEvent(i,t)}addDomEventToLens(i,t){this.lens.addEvent(i,t)}addDomEvent(i,t){this.c.addEvent(i,t)}set cursor(i){this.c.setCssProp("cursor",i)}removeEvents(){this.c.removeEvent(["btnclick","tap"]),this.c.removeEvent(["mousedown","touchstart"]),this.lens.removeEvent(["mousedown","touchstart"]),this.c.removeEvent(["mousemove","touchmove"])}set size(i){this.c.setCss({width:i.width+"px",height:i.height+"px"})}addLensCss(i,t,e){this.lens.setCss({top:i.top-1+"px",left:i.left-1+"px",width:t.width+"px",height:t.height+"px","font-size":e+"px"})}set img(i){this._img=n.$new("img",{src:i.src}),i.srcset&&this._img.attr("srcset",i.srcset+" 2x"),this.c.append(this._img)}removeEventTransitionEvent(){this.c.removeEvent("transitionend")}show(i){this.c.setCss({opacity:0,transition:"opacity .3s linear"}),this.p.append(this.c),this.c.render(),this.removeEventTransitionEvent(),this.c.addEvent("transitionend",(t=>{t.stop(),this.removeEventTransitionEvent(),this.c.setCssProp("transition",""),this.addDomEvent(["mousedown","touchstart"],(i=>{i.stop()})),i()})),this.c.setCssProp("opacity",1)}hide(i,t){this.removeEventTransitionEvent(),i?(this.c.remove(),this.removeEvents(),t()):this.c.addEvent("transitionend",(i=>{i.stop(),this._removeEventTransitionEvent(),this.c.setCssProp("transition",""),this.c.remove(),this.removeEvents(),t()})),this.c.setCssProp("opacity",0)}destroy(){this.c=null,this.lens=null}}const t=(i,t,e)=>(n.defined(t)||(t=0),n.defined(e)||(e=100),Math.min(Math.max(i,t),e));class s extends o{constructor(i,t){super(),this.view=i,this.o=t,this.state=e.APPEARANCE.HIDDEN,this.scale={x:1,y:1},this.viewPortSize={width:0,height:0},this.bISize={width:0,height:0},this.cBISize={width:0,height:0},this.cBIPosition={top:0,left:0},this.mapSize={width:0,height:0},this.ls={width:0,height:0},this.lp={top:0,left:0},this.clp={x:0,y:0},this.isDragMoved=!1}static setInTheCenter(i){return i<50?i=Math.max(i-(50-i),0):i>50&&(i=Math.min(i+(i-50),100)),i}getPercentPosition(i,e){const s=this.mapSize,o=this.view.calcRightPosition(i,e);return{x:i=t(h.round(w(o.x,s.width),1)),y:e=t(h.round(w(o.y,s.height),1))}}isInside(i,t){let e=!1;const s=this.lp,h=this.ls,o=this.view.calcRightPosition(i,t);return s.left<o.x&&s.left+h.width>o.x&&s.top<o.y&&s.top+h.height>o.y&&(e=!0),e}addEvents(){let i=1,t=!1;this.dragEndHandler=i=>{t&&(i.stop(),t=!1,this.clp={x:0,y:0},this.view.cursor="",this.view.removeDomEventToDocBody(i.type,this.dragEndHandler),this.view.removeDomEventToDocBody("mouseout",this.mouseOutHandler))},this.mouseOutHandler=i=>{i.stop(),i.oe.relatedTarget&&"HTML"!==i.oe.relatedTarget.tagName||!t||(this.dragEndHandler(i),this.view.removeDomEventToDocBody(["mouseup","touchend"],this.dragEndHandler))},this.view.addDomEvent(["btnclick","tap"],(i=>{i.stop(),this.emit("zoomMapNewPosition",{data:this.getPercentPosition(i.x,i.y)})})),this.view.addDomEventToLens(["mousedown","touchstart"],(e=>{const s=e.pageXY;if(this.isInside(s.x,s.y)){e.stop(),i=1;const s=(i=>{let t;const e={x:0,y:0},s=i.originEvent;return n.defined(s.offsetX)?(e.x=s.offsetX,e.y=s.offsetY):(t=a(i.target).position,e.x=s.targetTouches[0].pageX-t.left,e.y=s.targetTouches[0].pageY-t.top),e})(e);this.clp.y=s.y,this.clp.x=s.x,t=!0,this.view.addDomEventToDocBody(["mouseup","touchend"],this.dragEndHandler),this.view.addDomEventToDocBody("mouseout",this.mouseOutHandler)}})),this.view.addDomEvent(["mousemove","touchmove"],(e=>{if(t){if(i<=0){e.stop();const i=e.pageXY;this.view.cursor="move",this.emit("zoomMapNewPosition",{data:this.getPercentPosition(i.x,i.y)})}i--}}))}calcMap(i,t,e,s){let h=this.o.maxwidth,o=this.o.maxheight;e<=h&&(h=e/2,o=h*(t/i)),s<=o&&(o=s/2,h=o*(i/t)),h/o>i/t?h=o*(i/t):o=h*(t/i),h=parseInt(h,10),o=parseInt(o,10),this.mapSize.width=h,this.mapSize.height=o,this.viewPortSize.width=e,this.viewPortSize.height=s,this.bISize.width=i,this.bISize.height=t}prepare(i,t,e,s){this.calcMap(i,t,e,s),this.view.size=this.mapSize,this.emit("zoomGetImage",{data:{width:this.mapSize.width,height:this.mapSize.height}})}set lensPosition(i){const t=this.cBISize,e=this.mapSize;let s=e.height/t.height*i.top,h=e.width/t.width*i.left;this.cBIPosition.top=i.top,this.cBIPosition.left=i.left,s<0&&(s=0),h<0&&(h=0);const o=this.ls;s+o.height>e.height&&(s=e.height-o.height),h+o.width>e.width&&(h=e.width-o.width),this.lp.top=s,this.lp.left=h}set lensSize(i){this.cBISize.width=i.width,this.cBISize.height=i.height;const t=this.mapSize,e=this.viewPortSize;this.ls.width=e.width>=i.width?t.width:e.width/i.width*t.width,this.ls.height=e.height>=i.height?t.height:e.height/i.height*t.height}move(i,t){const e=this.bISize,s=e.width*t.x,h=e.height*t.y,o=Math.abs(i.y+(e.height-h)/2),n=Math.abs(i.x+(e.width-s)/2);this.scale.x=t.x,this.scale.y=t.y,this.lensSize={width:s,height:h},this.lensPosition={top:o,left:n},this.view.addLensCss(this.lp,this.ls,Math.max(this.mapSize.width,this.mapSize.height))}show(){[e.APPEARANCE.SHOWING,e.APPEARANCE.SHOWN].includes(this.state)||(this.state=e.APPEARANCE.SHOWING,this.view.show((()=>{this.addEvents(),this.state=e.APPEARANCE.SHOWN})))}hide(i){[e.APPEARANCE.HIDDEN,e.APPEARANCE.HIDING].includes(this.state)&&!i||(this.state=e.APPEARANCE.HIDING,this.view.hide(i,(()=>{this.view.removeDomEventToDocBody(["mouseup","touchend"],this.dragEndHandler),this.state=e.APPEARANCE.HIDDEN})))}resize(i,t,e,s,h,o){this.o.maxwidth=i,this.o.maxheight=t,this.calcMap(e,s,h,o),this.view.size=this.mapSize}destroy(){this.hide(!0),super.destroy()}}return class extends o{constructor(t,e){super(),this.options=Object.assign({maxwidth:200,maxheight:200},e||{}),this.view=new i(t),this.controller=new s(this.view,this.options),this.controller.parentClass=this}prepare(i,t,e,s){this.controller.prepare(i,t,e,s)}move(i,t){this.controller.move(i,t)}set img(i){this.view.img=i}show(){this.controller.show()}hide(i){this.controller.hide(i)}resize(i,t,e,s,h,o){this.controller.resize(i,t,e,s,h,o)}destroy(){this.controller.destroy(),this.view.destroy(),super.destroy()}}})();class P{constructor(i){this.pn=a(i);const t="sirv-zoom";var e;this.cnv=n.$new("div"),this.cnv.addClass(t),this.node=n.$new("div").setCss({opacity:0}),this.node.addClass("sirv-zoom-wrapper"),this.zoomWrapper=n.$new("div").addClass("sirv-zoom-image-wrapper"),this.zoom=(e=this.pn,a(a(e).node.getElementsByTagName("img")[0]||a(e).node.getElementsByTagName("canvas")[0]||e)),this.lens=n.D.node.body,this.isBody=!0,this.image=null,this.perspective="",n.browser.mobile&&"ios"===n.browser.platform&&(this.perspective="perspective(1000px) ")}get hash(){return this.image?this.image.$J_UUID+""||this.image.attr("src"):null}get parentSize(){return this.pn.size}get parentPostion(){return this.pn.position}get zoomSize(){return this.zoom.size}get parentBoundaries(){return this.cnv.node.parentNode?this.cnv.node.getBoundingClientRect():null}addScrollEvent(i){n.W.addEvent("scroll",i)}removeScrollEvent(i){i?n.W.removeEvent("scroll",i):n.W.removeEvent("scroll")}addClassToWrapper(i){this.node.addClass("sirv-"+i+"-zoom")}addEventToMainContainer(i,t){this.cnv.addEvent(i,t)}removeEventFromMainContainer(...i){this.cnv.removeEvent(i)}addEventToWrapper(i,t){this.node.addEvent(i,t)}removeEventFromWrapper(...i){this.node.removeEvent(i)}addMouseoutEvent(i){this.addEventToWrapper("mouseout",(t=>{let e=t.related;if(e){for(;e&&e!==this.node.node&&e!==this.lens.node;)e=e.parentNode;this.node.node!==e&&i(t)}}))}set lensContainer(i){i||(i=a(n.D.node.body)),this.isBody=a(i)===a(n.D.node.body),this.lens=a(i)}toggleCursorClass(i,t){this.cnv.removeClass(i).addClass(t)}setImagePosition(i,t){this.image&&this.zoomWrapper.setCssProp("transform",this.perspective+"translate3d("+i.x+"px, "+i.y+"px, 0) scale("+t.x+", "+t.y+")")}addStartCss(){this.lensStyle={opacity:0,transform:"scale(0)"}}appendNodes(i,t){this.cnv.addEvent("contextmenu",(i=>{i.stopDefaults()})),this.image=a(i),this.image.setCss({width:t.width+"px",height:t.height+"px"}),n.browser.mobile||this.image.addEvent("mousedown",(i=>{i.stopDefaults()})),this.zoomWrapper.append(this.image),this.node.append(this.zoomWrapper),this.node.appendTo(this.cnv),this.cnv.appendTo(this.lens,!1)}set eventNodePositionSize(i){let t=i.position.top,e=i.position.left;if(!this.isBody){const i=this.lens.position;t-=i.top,e-=i.left}this.cnv.setCss({top:t,left:e,width:i.size.width,height:i.size.height})}set lensStyle(i){this.node.setCss(i)}set lensPosition(i){this.lensStyle={top:i.top,left:i.left}}set lensSize(i){this.lensStyle={width:i.width,height:i.height}}setLensCss(i,t,e){this.lensPosition=i,this.lensSize=t,this.lensStyle={opacity:1,transform:"scale(1)",transition:e||"none"}}setImageSize(i,t,e){this.zoomWrapper.setCss({top:0,left:0,width:t.width+"px",height:t.height+"px","transform-origin":"50% 50%",transform:this.perspective+"translate3d("+i.x+"px, "+i.y+"px, 0) scale("+e.x+", "+e.y+")"}),this.zoomWrapper.render(),this.image.setCss({width:"100%",height:"100%"}),this.image.render()}clearCss(){this.node.setCss({transition:"",opacity:"",transform:""}),this.node.removeAttr("style"),this.image&&this.image.setCss({width:"",height:""}),this.zoomWrapper.setCss({top:"",left:"",width:"",height:"",transition:"",transform:""})}clearDOM(){this.image&&(this.image.remove(),this.image=null),this.zoomWrapper.remove(),this.node.remove(),this.cnv.remove()}removeEvents(){this.cnv.clearEvents(),this.image&&this.image.clearEvents(),this.node.clearEvents()}get boundaries(){return this.cnv.node.getBoundingClientRect()}destroy(){this.image&&(this.image.remove(),this.image=null),this.zoomWrapper.remove(),this.node.remove(),this.cnv.remove()}}class b extends P{constructor(i){super(i),this.mouseMoveHandler=null}getContainerForMap(){return this.node}addStartCss(){super.addStartCss(),this.node.addEvent("mousescroll",(i=>{i.stop()})),this.lensStyle={opacity:0,transform:"scale(1)"}}removeDragstart(){this.node.del("event:mousedrag:dragstart")}addEventsCanvasClass(i){this.cnv.addClass(i)}removeEventsCanvasClass(i){this.cnv.removeClass(i)}getContainerSize(){return this.node.size}getContainerPosition(){return this.node.position}addGlobalEvent(i){this.mouseMoveHandler||(this.mouseMoveHandler=i,n.D.addEvent("mousemove",i))}removeGlobalEvent(){this.mouseMoveHandler&&(n.D.removeEvent("mousemove",this.mouseMoveHandler),this.mouseMoveHandler=null)}removeEvents(){super.removeEvents(),this.removeGlobalEvent()}}class f extends P{get parentSize(){return this.zoom.size}get parentPostion(){return this.zoom.position}}class E extends P{getImageForEye(){return this.image.node.cloneNode()}getNodeForEye(){return this.zoom}set lensPosition(i){this.cnv.setCss({top:i.top,left:i.left})}setCanvasNodeSize(i){this.cnv.setCss({width:i.width,height:i.height})}addStartCss(i){this.lensStyle={opacity:0,transform:"translate3d("+i.start.x+"%, "+i.start.y+"%, 0px)"}}get parentSize(){return this.zoom.size}get parentPostion(){return this.zoom.position}setLensCss(i,t,e){this.cnv.setCss({top:i.top,left:i.left}),super.setLensCss(i,t,e)}addMouseMoveEvent(i){n.W.addEvent("mousemove",i)}removeMouseMoveEvent(i){n.W.removeEvent("mousemove",i)}clearCss(){this.cnv.removeAttr("style")}}const C=(()=>{const i=0,t=1;return class{constructor(t,e){this.state=i,this.id=null,this.cb=t||(()=>{}),this.stopCb=e||(()=>{})}start(){if(this.state!==t){this.state=t;const e=t=>{this.cb(t),this.state!==i&&(this.id=requestAnimationFrame(e))};this.id=requestAnimationFrame(e)}}stop(){this.state!==i&&(this.state=i,cancelAnimationFrame(this.id),this.stopCb())}}})();let T=null;class D extends o{constructor(i,t){super(),this.o=Object.assign({test:!1,pan:!1,smoothing:!0,tiles:!0,customZooming:!0,clickBehavior:"both",upscale:!1,trigger:"hover"},t),this.view=i,this.state=e.APPEARANCE.HIDDEN,this._x=0,this._y=0,this.baseScale={x:1,y:1},this.scale={x:1,y:1},this.dScale={x:1,y:1},this.iSize={width:0,height:0},this.iPos={x:0,y:0},this.iDPos={x:0,y:0},this.pPos={top:0,left:0},this.pSize={width:0,height:0},this.anim=null,this.animCb=null,this.animStep=0,this.lastAnimTimer=0,this.deepZoom=null,this.deepZoomTimer=null,this.lensSize={width:0,height:0},this.lensHalfSize={width:0,height:0},this.lensPosition={top:0,left:0},this.currentLensSize={width:100,height:100},this.dppx=1,this.zoomNodeSize={width:0,height:0},this.boundaries=null,this.ANIM_STEP=.1,this.nonDeepZoomImageLevels=[],this.scrollHandler=()=>{[e.APPEARANCE.SHOWING,e.APPEARANCE.SHOWN].includes(this.state)&&this.hide(this.state===e.APPEARANCE.SHOWING)}}init(){this.getAllSizes(),this.view.setLensCss(this.lensPosition,this.lensSize),this.createDeepZoom(),this.createAnimation(this.ANIM_STEP),this.view.addScrollEvent(this.scrollHandler)}createDeepZoom(){this.deepZoom=new u(this.view.node,{tiles:this.o.tiles,inner:["inner","outside"].includes(this.o.type),upscale:this.o.upscale}),this.deepZoom.parentClass=this,this.on("getTile",(i=>{i.stopAll(),this.emit("zoomGetImage",{data:i.data})})),this.on("zoomCancelLoadingOfTiles",(i=>{i.stopEmptyEvent()}))}set lensContainer(i){this.view.lensContainer=i}getBoundaries(){this.boundaries=this.view.parentBoundaries}getAllSizes(){this.pSize=this.view.parentSize,this.pPos=this.view.parentPostion,this.zoomNodeSize=this.view.zoomSize,this.getBoundaries()}get shown(){return this.state===e.APPEARANCE.SHOWN}get showing(){return this.state===e.APPEARANCE.SHOWING}deepZoomAction(i,t){clearTimeout(this.deepZoomTimer),this.deepZoomTimer=setTimeout((()=>{this.deepZoom.loadImages(),t&&(this.deepZoom.lensSize=t,this.deepZoom.resize()),this.deepZoom.action(this.iDPos,this.dScale),i||this.deepZoomAction(this.dScale.x===this.scale.x)}),this.lastAnimTimer+10),t&&(this.deepZoom.lensSize=t,this.deepZoom.resize()),this.deepZoom.action(this.iDPos,this.dScale)}stopMovingAndZooming(){this.scale.x=this.dScale.x,this.scale.y=this.dScale.y,this.iPos.x=this.iDPos.x,this.iPos.y=this.iDPos.y}createAnimation(i){const t=i=>{let t=!1;return this.dScale[i]<this.baseScale[i]&&(t=!0,this.dScale[i]=this.baseScale[i]),this.dScale[i]>1&&(t=!0,this.dScale[i]=1),t};this.animStep=i;let e=0;this.anim=new C((s=>{if(!e)return void(e=s);let o,n,a,r,l=!1;this.lastAnimTimer=s-e,e=s;let d=!1,c=!1;this.scale.x!==this.dScale.x&&(l=!0,this.sendZoomingAction(),a=this.scale.x-this.dScale.x,o=a*this.animStep,this.dScale.x+=o,this.dScale.y+=o,d=t("x"),c=d,Math.abs(a)<1e-4&&(this.dScale.x=this.scale.x,this.dScale.y=this.scale.x)),this.iPos.x===this.iDPos.x&&this.iPos.y===this.iDPos.y||(l=!0,a=this.iPos.x-this.iDPos.x,r=this.iPos.y-this.iDPos.y,o=a*this.animStep,n=r*this.animStep,this.iDPos.x+=o,this.iDPos.y+=n,this.iDPos.x=h.round(this.iDPos.x,4),this.iDPos.y=h.round(this.iDPos.y,4),(Math.max(Math.abs(a),Math.abs(r))<1||d||c)&&(this.iDPos.x=this.iPos.x,this.iDPos.y=this.iPos.y)),l?this.render(this.iDPos,this.dScale):this.animCb&&(this.animCb(),this.animStep=i,this.animCb=null)}),(()=>{e=0}))}render(i,t){this.deepZoomAction(),this.view.setImagePosition(i||this.iDPos,t||this.dScale)}correctX(i){return i-this.pPos.left}correctY(i){return i-this.pPos.top}set x(i){this._x=this.correctX(i)}set y(i){this._y=this.correctY(i)}getZoomData(i){let t=0;return i||(i=this.scale.x),(this.shown||this.showing)&&(t=h.round((i-this.baseScale.x)/(1-this.baseScale.x),2)),t}get nextMinZoom(){let i=this.deepZoom.getScale("zoomout");return i<this.baseScale.x&&(i=this.baseScale.x),this.getZoomData(i)}get nextMaxZoom(){let i=this.deepZoom.getScale("zoomin");return i>1&&(i=1),this.getZoomData(i)}zoom(i,t,e){const s=this.scale.x,h=this.iSize,o=h.width*this.scale.x,n=h.height*this.scale.y,a=g(h.width,o),r=g(h.height,n);t=t||this.pPos.left+this.lensHalfSize.width,e=e||this.pPos.top+this.lensHalfSize.height,this.baseScalePercent={x:w(Math.abs(this.iPos.x)+this.correctX(t)-a,o),y:w(Math.abs(this.iPos.y)+this.correctY(e)-r,n)};const l=this.deepZoom.getScale(i);this.scale.x=l,this.scale.y=l,this.x=t,this.y=e,this.afterZoom(s)}afterZoom(i){i!==this.scale.x&&(this.sendZoomingAction(),this.setCursorState(),this.o.smoothing?this.animStep=.25:(this.dScale.x=this.scale.x,this.dScale.y=this.scale.y,this.iDPos.x=this.iPos.x,this.iDPos.y=this.iPos.y,this.render(this.iPos,this.scale)))}zoomUp(i,t){return!(!this.shown&&!this.showing||1===this.scale.x)&&(this.zoom("zoomin",i,t),!0)}zoomDown(i,t){return!(!this.shown&&!this.showing||this.scale.x===this.baseScale.x)&&(this.zoom("zoomout",i,t),!0)}sendZoomingAction(){clearTimeout(this.zoomingTimer),this.zoomingTimer=setTimeout(a((i=>{this.emit("zooming",{data:{zoom:this.getZoomData(),from:i,to:this.scale.x}})})).bind(this,this.dScale.x),24)}setCursorState(i){if(!n.defined(i)){const t=this.getZoomData();0===t?i="zoomIn":1===t?i="zoomOut":t>0&&t<1&&(i="up"===this.o.clickBehavior?"zoomIn":"zoomOut")}this.currentCursorState!==i&&(this.view.toggleCursorClass(r[this.currentCursorState],r[i]),this.currentCursorState=i)}setImage(i){const t=i.node;if(this.shown||this.showing){const e=Object.assign({},i.callbackData);e.node=t,this.deepZoom.image=e}}setLensSize(i,t){this.lensSize={width:i,height:t},this.lensHalfSize={width:this.lensSize.width/2,height:this.lensSize.height/2}}calcLensSize(){const i=this.pSize,t=this.currentLensSize;this.setLensSize(m(i.width,t.width),m(i.height,t.height))}getBaseScale(){this.baseScale={x:this.zoomNodeSize.width/this.iSize.width,y:this.zoomNodeSize.height/this.iSize.height}}calcLensPosition(){}getImagePosition(){}showDeepZoom(i,t){if(this.deepZoom){this.o.test&&!T&&(T=new v,T.parentClass=this);const e=this.view.hash;e&&(this.deepZoom.hash=e),this.deepZoom.lensSize=this.lensSize,this.deepZoom.minSize=this.zoomNodeSize,this.deepZoom.maxSize=Object.assign({originWidth:i,originHeight:t},this.iSize),this.deepZoom.show()}}endOfShowing(i){let t=!1;return this.state===e.APPEARANCE.SHOWING&&(t=!0,this.state=e.APPEARANCE.SHOWN,i||this.setEvents(),this.setCursorState(),this.o.smoothing||this.deepZoomAction()),t}sendZoomShownEvent(){this.emit("zoomShown",{data:{clientPosition:{x:this._x,y:this._y},pagePosition:{x:this.pPos.left,y:this.pPos.top}}})}showCenter(i,t,e){this.getAllSizes();const s=this.pPos.left+this.pSize.width/2,h=this.pPos.top+this.pSize.height/2;return this.show(i,t,s,h,!1,e)}show(){return this.state===e.APPEARANCE.HIDDEN&&(this.state=e.APPEARANCE.SHOWING,!0)}endOfHiding(){this.stopMovingAndZooming(),clearTimeout(this.hideTimer),this.anim.stop(),this.setCursorState("zoomIn"),this.view.clearCss(),this.baseScale={x:1,y:1},this.scale={x:1,y:1},this.dScale={x:1,y:1},this.setUpEvent=!1,this.baseScalePercent={x:0,y:0},clearTimeout(this.deepZoomTimer),this.deepZoom.hide(),this.view.clearDOM(),this.state=e.APPEARANCE.HIDDEN,T&&(T.destroy(),T=null),this.emit("zoomHidden",{data:{clientPosition:{x:this._x,y:this._y},pagePosition:{x:this.pPos.left,y:this.pPos.top}}})}hide(i){return!![e.APPEARANCE.SHOWN,e.APPEARANCE.SHOWING].includes(this.state)&&(this.state=e.APPEARANCE.HIDING,this.view.removeEvents(),i?(clearTimeout(this.deepZoomTimer),this.deepZoom.hide(),this.endOfHiding()):this.stopMovingAndZooming(),!0)}addClickEvent(){let i=["btnclick","tap"];"dblclick"===this.o.trigger&&(i=["dblbtnclick","dbltap"]),this.view.addEventToWrapper(i,(i=>{i.stop(),this.x=i.x,this.y=i.y,"up"===this.o.clickBehavior?this.zoomUp(i.x,i.y)||this.hide():this.o.smoothing&&this.scale.x!==this.baseScale.x?this.hide():this.hide(!0)}))}customMove(i,t){[e.APPEARANCE.HIDDEN,e.APPEARANCE.HIDING].includes(this.state)||this.move(i,t)}move(i,t){this.x=i,this.y=t,this.afterMove()}afterMove(){this.o.smoothing||this.render(this.iPos,this.scale)}setEvents(){}setLensStyleOnResize(){this.view.lensStyle={top:this.lensPosition.top,left:this.lensPosition.left,width:this.lensSize.width,height:this.lensSize.height}}onResize(){if(this.state!==e.APPEARANCE.HIDDEN)if(this.state===e.APPEARANCE.HIDING)this.hide(!0);else{if(this.state===e.APPEARANCE.SHOWING&&this.o.smoothing&&(this.state=e.APPEARANCE.SHOWN,this.setEvents(),this.view.removeEventFromWrapper("transitionend"),this.view.lensStyle={transition:""},this.stopMovingAndZooming(),this.view.setImagePosition(this.iPos,this.scale)),this.getAllSizes(),this.zoomNodeSize.width>this.iSize.width||this.zoomNodeSize.height>this.iSize.height)return void this.hide(!0);this.getBaseScale(),this.scale.x=S(this.scale.x,this.baseScale.x,1),this.scale.y=S(this.scale.y,this.baseScale.y,1),this.calcLensSize(),this.calcLensPosition(),this.setLensStyleOnResize(),this.deepZoom.lensSize=this.pSize,this.deepZoom.minSize=this.zoomNodeSize,this.deepZoom.resize(),this.view.eventNodePositionSize={position:this.pPos,size:this.pSize},this.o.smoothing||(this.sendZoomingAction(),this.setCursorState(),this.deepZoomAction(),this.view.setImagePosition(this.iPos,this.scale))}}destroy(){this.hide(!0),clearTimeout(this.zoomingTimer),this.view.removeScrollEvent(this.scrollHandler),this.setCursorState("canZoom"),clearTimeout(this.deepZoomTimer),this.deepZoom.destroy(),this.deepZoom=null,this.off("getTile"),this.off("zoomCancelLoadingOfTiles"),T&&(T.destroy(),T=null),this.zoomingTimer=null,super.destroy()}}const I=class extends D{constructor(i,t){super(i,Object.assign({map:!1,mapSize:50},t)),this.baseScalePercent={x:0,y:0},this.clonedImage=null,this.hideTimer=null,this.showTimer=null,this.map=null,this.zoomingTimer=null,this.currentCursorState=0,this.innerImagePosition={x:0,y:0},this.setUpEvent=!1,n.browser.mobile&&(this.o.pan=!0,"hover"===this.o.trigger&&(this.o.trigger="click")),this.view.setLensCss(this.lensPosition,this.lensSize),this.ANIM_STEP=.3}init(){super.init(),this.createZoomMap()}createZoomMap(){if(!this.o.map)return;const i=parseInt(m(this.pSize.width/2,this.o.mapSize),10),t=parseInt(m(this.pSize.height/2,this.o.mapSize),10);this.map=new y(this.view.getContainerForMap(),{maxwidth:i,maxheight:t}),this.map.parentClass=this,this.on("zoomGetImage",(i=>{i.stopEmptyEvent(),i.data.map=!0,i.data.exactSize=!0})),this.on("zoomMapNewPosition",(i=>{i.stopAll(),this.x=this.pPos.left+m(this.lensSize.width,i.data.x),this.y=this.pPos.top+m(this.lensSize.height,i.data.y),this.calcPositionOfImageInCenter(this.scale),this.o.smoothing||(this.deepZoomAction(),this.view.setImagePosition(this.iPos,this.scale),this.map&&this.map.move(this.iPos,this.scale))}))}move(i,t){this.x=i,this.y=t,this.calcPositionOfImage(this.scale),this.afterMove()}render(i,t){super.render(i,t),this.map&&this.map.move(i||this.iDPos,t||this.dScale)}calcPositionOfImageForPinch(i){i||(i=this.dScale);const t=this.iSize.width*i.x,e=this.iSize.height*i.y,s=g(this.iSize.width,t),h=g(this.iSize.height,e);let o,n;t>this.lensSize.width?(o=this._x-(m(t,this.baseScalePercent.x)+s),o=p(o,0-s,s+t,this.lensSize.width)):o=this.lensSize.width/2-(t/2+s),e>this.lensSize.height?(n=this._y-(m(e,this.baseScalePercent.y)+h),n=p(n,0-h,h+e,this.lensSize.height)):n=this.lensSize.height/2-(e/2+h),this.iPos={x:o,y:n}}setScale(i,t,s){this.state===e.APPEARANCE.SHOWN&&(n.defined(t)&&(this.x=t,this.y=s),this.scale.x=i,this.scale.y=i,this.scale.x=S(this.scale.x,this.baseScale.x,1),this.scale.y=S(this.scale.y,this.baseScale.y,1),this.calcPositionOfImageForPinch(this.scale),this.sendZoomingAction(),this.setCursorState(),this.o.smoothing||(this.dScale.x=this.scale.x,this.dScale.y=this.scale.y,this.imageDPosition.x=this.imagePosition.x,this.imageDPosition.y=this.imagePosition.y,this.deepZoomAction(),this.view.setImagePosition(this.imagePosition,this.scale),this.map&&this.map.move(this.imagePosition,this.scale)))}afterZoom(i){this.calcPositionOfImageForPinch(this.scale),super.afterZoom(i)}calcPositionOfImage(i,t,e,s){const h=e||this._x,o=s||this._y;i||(i=this.dScale);const n=this.iSize.width*i.x,a=this.iSize.height*i.y,r=g(this.iSize.width,n),l=g(this.iSize.height,a);let d,c;n>this.lensSize.width?(d=h-m(n,w(h,this.pSize.width))-r,d=p(d,0-r,r+n,this.lensSize.width)):d=this.lensSize.width/2-(n/2+r),a>this.lensSize.height?(c=o-m(a,w(o,this.pSize.height))-l,c=p(c,0-l,l+a,this.lensSize.height)):c=this.lensSize.height/2-(a/2+l),this.iPos={x:d,y:c}}calcPositionOfImageInCenter(i){i||(i=this.dScale);const t=this.iSize.width*i.x,e=this.iSize.height*i.y,s=g(this.iSize.width,t),h=g(this.iSize.height,e);let o=this._x/(this.lensSize.width/t),n=this._y/(this.lensSize.height/e);o=this.lensSize.width/2-o-s,n=this.lensSize.height/2-n-h,o=p(o,0-s,s+t,this.lensSize.width),n=p(n,0-h,h+e,this.lensSize.height),this.iPos={x:o,y:n}}set basePercent(i){if([e.APPEARANCE.SHOWN,e.APPEARANCE.SHOWING].includes(this.state)){const t=this.iSize,e=t.width*this.scale.x,s=t.height*this.scale.y,h=g(t.width,e),o=g(t.height,s);this.baseScalePercent={x:w(Math.abs(this.iPos.x)+this.correctX(i.x)-h,e),y:w(Math.abs(this.iPos.y)+this.correctY(i.y)-o,s)}}}setImage(i){(this.shown||this.showing)&&(i.callbackData.map?this.map&&(this.map.img={src:i.src,srcset:i.srcset}):super.setImage(i))}endOfShowing(i){super.endOfShowing(i)&&this.map&&this.map.show()}getImagePosition(){this.innerImagePosition={x:g(this.lensSize.width,this.zoomNodeSize.width),y:g(this.lensSize.height,this.zoomNodeSize.height)}}show(i,t,e,s,h,o){return!!super.show()&&(this.setUpEvent=h,this.iSize={width:t.width,height:t.height},this.view.addStartCss(),this.view.appendNodes(i,this.iSize),this.getAllSizes(),this.x=e,this.y=s,this.calcLensSize(),this.getImagePosition(),this.getBaseScale(),this.showDeepZoom(t.originWidth,t.originHeight),this.showTimer=setTimeout((()=>{if(this.showTimer=null,this.emit("zoomBeforeShow",{data:{}}),o&&"max"!==o){let i;"zero"===o?(this.scale.x=this.baseScale.x,this.scale.y=this.baseScale.y):(i=this.deepZoom.getScale("zoomin"),this.scale.x=i,this.scale.y=i)}this.calcPositionOfImage(this.scale,!0),this.view.eventNodePositionSize={position:this.pPos,size:this.pSize},this.dScale.x=this.baseScale.x,this.dScale.y=this.baseScale.y,this.iDPos={x:-1*g(this.iSize.width,this.iSize.width*this.dScale.x)+this.innerImagePosition.x,y:-1*g(this.iSize.height,this.iSize.height*this.dScale.y)+this.innerImagePosition.y},this.view.setLensCss(this.lensPosition,this.lensSize),this.view.setImageSize(this.iDPos,this.iSize,this.dScale),this.boundaries=this.view.boundaries,this.map&&this.map.prepare(this.iSize.width,this.iSize.height,this.pSize.width,this.pSize.height),this.o.smoothing&&"zero"!==o?(this.setEvents(),this.animStep=.3,this.animCb=()=>{this.deepZoomAction(),this.endOfShowing(!0)}):this.endOfShowing(),this.o.smoothing&&this.anim.start(),this.sendZoomShownEvent()}),0),!0)}hide(i){const t=super.hide(i);return t&&(clearTimeout(this.showTimer),i||(this.scale.x!==this.baseScale.x||this.scale.y!==this.baseScale.y?(this.animStep=.4,this.scale.x=this.baseScale.x,this.scale.y=this.baseScale.y,this.iPos={x:-1*g(this.iSize.width,this.iSize.width*this.scale.x)+this.innerImagePosition.x,y:-1*g(this.iSize.height,this.iSize.height*this.scale.y)+this.innerImagePosition.y},this.animCb=()=>{this.endOfHiding()}):this.endOfHiding())),t}addMouseScrollEvent(){this.view.addEventToWrapper("mousescroll",(i=>{if(i.stop(),this.o.pan){const t=this.iSize,e=t.width*this.scale.x,s=t.height*this.scale.y,h=g(t.width,e),o=g(t.height,s);this.baseScalePercent={x:w(Math.abs(this.iPos.x)+this.correctX(i.x)-h,e),y:w(Math.abs(this.iPos.y)+this.correctY(i.y)-o,s)}}let t;const e=this.scale.x;if(i.isMouse){const t=37,e=i.delta/m(i.deltaFactor,t);this.scale.x+=e,this.scale.y+=e}else t=i.delta,Math.abs(t)>15&&(t=15,i.delta<0&&(t*=-1)),t/=350,this.scale.x+=t,this.scale.y+=t;this.scale.x=S(this.scale.x,this.baseScale.x,1),this.scale.y=S(this.scale.y,this.baseScale.y,1),this.o.pan?(this.x=i.x,this.y=i.y,this.calcPositionOfImageForPinch(this.scale)):this.calcPositionOfImage(this.scale),e!==this.scale.x&&(this.sendZoomingAction(),this.setCursorState(),this.o.smoothing||(this.dScale.x=this.scale.x,this.dScale.y=this.scale.y,this.iDPos.x=this.iPos.x,this.iDPos.y=this.iPos.y,this.deepZoomAction(),this.view.setImagePosition(this.iPos,this.scale),this.map&&this.map.move(this.iPos,this.scale))),this.hideByTimer()}))}hideByTimer(){clearTimeout(this.hideTimer),this.scale.x<=this.baseScale.x+1e-8&&"outside"!==this.o.type&&(this.hideTimer=setTimeout((()=>{this.hide(!0)}),1e3))}addInnerTouchDrag(){let i,t,e,s,h,o,n=!1;this.view.addEventToWrapper(l,(a=>{a.stop(),"dragstart"===a.state?(n=!0,this.view.addEventsCanvasClass(r.drag),this.stopMovingAndZooming(),this.x=a.x,this.y=a.y,e=this.iSize.width*this.scale.x,s=this.iSize.height*this.scale.y,h=g(this.iSize.width,e),o=g(this.iSize.height,s),i=a.x,t=a.y):"dragend"===a.state?(n=!1,this.view.removeEventsCanvasClass(r.drag)):n&&(this.x=a.x,this.y=a.y,e>this.lensSize.width?(this.iPos.x+=a.x-i,this.iPos.x=p(this.iPos.x,0-h,h+e,this.lensSize.width)):this.iPos.x=this.lensSize.width/2-(e/2+h),s>this.lensSize.height?(this.iPos.y+=a.y-t,this.iPos.y=p(this.iPos.y,0-o,o+s,this.lensSize.height)):this.iPos.y=this.lensSize.height/2-(s/2+o),this.o.smoothing&&this.o.pan?this.animStep=.3:(this.iDPos.x=this.iPos.x,this.iDPos.y=this.iPos.y,this.deepZoomAction(),this.view.setImagePosition(this.iPos,this.scale),this.map&&this.map.move(this.iPos,this.scale)),i=a.x,t=a.y)}))}addInnerPinch(){let i,t;const s=1-this.baseScale.x;let h,o,n,a,r;this.o.customZooming&&this.view.addEventToWrapper("pinch",(d=>{d.stop(),"pinchstart"===d.state?(clearTimeout(i),this.stopMovingAndZooming(),this.view.node.removeEvent(l),this.scale.x=this.dScale.x,this.scale.y=this.dScale.y,t=this.scale.x,o=1,n=1,a=1,r=this.baseScale.x,this.basePercent=d.centerPoint):"pinchresize"===d.state?this.basePercent=d.centerPoint:"pinchmove"===d.state?(this.x=d.centerPoint.x,this.y=d.centerPoint.y,h=d.scale,h*=t,a<h&&(a=h,r=this.baseScale.x,n=1,o=s/(a-this.baseScale.x)),r>h&&(r=h,a=1,o=1,n=this.baseScale.x/r),h=(this.baseScale.x+(h-this.baseScale.x)*o)*n,this.scale.x=h,this.scale.y=h,this.scale.x=S(this.scale.x,this.baseScale.x,1),this.scale.y=S(this.scale.y,this.baseScale.y,1),this.calcPositionOfImageForPinch(this.scale),this.sendZoomingAction(),this.setCursorState(),this.o.smoothing||(this.dScale.x=this.scale.x,this.dScale.y=this.scale.y,this.iDPos.x=this.iPos.x,this.iDPos.y=this.iPos.y,this.deepZoomAction(),this.view.setImagePosition(this.iPos,this.scale),this.map&&this.map.move(this.iPos,this.scale))):"pinchend"===d.state&&(clearTimeout(i),i=setTimeout((()=>{this.addInnerTouchDrag()}),42),this.scale.x<=this.baseScale.x+1e-8&&"outside"!==this.o.type&&this.state!==e.APPEARANCE.HIDING&&(clearTimeout(i),this.hide(!0)))}))}hideZoomByMouseOut(){this.view.addGlobalEvent((i=>{((i,t,e,s)=>{let h=!1;const o=t.left-s.x,n=t.top-s.y;return(i.x<=o||i.y<=n||i.x>=o+e.width||i.y>=n+e.height)&&(h=!0),h})(i.clientXY,this.view.getContainerPosition(),this.view.getContainerSize(),n.D.scroll)&&(this.view.removeGlobalEvent(),this.hide())}))}setEvents(){this.setUpEvent&&n.browser.mobile&&this.view.addEventToWrapper(d,(i=>{i.stop(),this.hide(!0)})),this.o.customZooming&&this.addMouseScrollEvent(),this.addInnerTouchDrag(),this.view.removeDragstart(),this.setUpEvent||this.addInnerPinch(),"hover"!==this.o.trigger?this.addClickEvent():this.hideZoomByMouseOut(),this.o.pan||n.browser.mobile||this.view.addEventToMainContainer(c,(i=>{if(i.pointerType&&"touch"===i.pointerType)return;i.stop();const t=i.pageXY;this.move(t.x,t.y)}))}keepOldPosition(i){let t=this.iPos.x,e=this.iPos.y;const s=this.iSize.width*this.scale.x,h=this.iSize.height*this.scale.y,o=g(this.iSize.width,s),n=g(this.iSize.height,h);t-=(i.width-this.lensSize.width)/2,e-=(i.height-this.lensSize.height)/2,t=s>this.lensSize.width?p(t,0-o,o+s,this.lensSize.width):this.lensSize.width/2-(s/2+o),e=h>this.lensSize.height?p(e,0-n,n+h,this.lensSize.height):this.lensSize.height/2-(h/2+n),this.iPos={x:t,y:e}}onResize(){const i=this.lensSize;if(super.onResize(),this.state!==e.APPEARANCE.HIDDEN&&this.state!==e.APPEARANCE.HIDING&&(this.keepOldPosition(i),this.getImagePosition(),this.map)){const i=parseInt(m(this.pSize.width/2,this.o.mapSize),10),t=parseInt(m(this.pSize.height/2,this.o.mapSize),10);this.map.resize(i,t,this.iSize.width,this.iSize.height,this.pSize.width,this.pSize.height),this.o.smoothing||this.map.move(this.iPos,this.scale)}}destroy(){clearTimeout(this.showTimer),this.map&&(this.map.destroy(),this.map=null,this.off("zoomGetImage"),this.off("zoomMapNewPosition")),super.destroy()}},A=class extends D{constructor(i,t){n.browser.mobile&&9===t.margin&&delete t.margin,super(i,Object.assign({width:70,height:70,margin:65},t)),this.setUpEvent=!1,this.isSquare=!0,this.ANIM_STEP=.4}init(){super.init(),this.setOutsideLensSize()}setOutsideLensSize(){const i={width:this.o.width,height:this.o.height};i.width===i.height&&(this.isSquare=!0),[i.width,i.height].includes("auto")?(this.isSquare=!0,"auto"===i.width?"auto"!==i.height?(i.height=this.getPercentSize(i.height,"height"),i.width=i.height):(i.height=70,i.width=i.height):"auto"!==i.width?(i.width=this.getPercentSize(i.width,"width"),i.height=i.width):(i.height=70,i.width=i.height)):(i.width=this.getPercentSize(i.width,"width"),i.height=this.getPercentSize(i.height,"height")),this.currentLensSize=(i=>{let t;t=i.width>=i.height?i.width/i.height:i.height/i.width;const e=10,s=90;return t>9?{width:50,height:50}:(i.width<e&&(i.height=e*(i.height/i.width),i.width=e),i.height<e&&(i.width=e*(i.width/i.height),i.height=e),i.width>s&&(i.height=s*(i.height/i.width),i.width=s),i.height>s&&(i.width=s*(i.width/i.height),i.height=s),i)})({width:i.width,height:i.height}),this.ANIM_STEP=.6}calcLensSize(){if(this.isSquare){const i=this.pSize,t=this.currentLensSize,e=m(Math.min(i.width,i.height),t.width);this.setLensSize(e,e)}else super.calcLensSize()}calcLensPosition(){const i=this.pSize;let t,e,s,h,o=this.o.margin;o<0&&(o=0),this._x<0&&(this._x=0),this._y<0&&(this._y=0),this._x>i.width&&(this._x=i.width),this._y>i.height&&(this._y=i.height),t=this._y-this.lensHalfSize.height,e=this._x-this.lensHalfSize.width;const r=this.pPos;n.browser.mobile&&(t-=o,s=a(n.W).scroll,h=a(n.W).size,r.top+t<s.y&&(r.left+this._x-this.lensSize.width-o>s.x?(t=this._y-this.lensHalfSize.height,e=this._x-this.lensSize.width-o):r.left+this._x+this.lensSize.width+o<s.x+h.width?(t=this._y-this.lensHalfSize.height,e=this._x+o):s.y+h.height>r.top+this._y+o+this.lensSize.height&&(t=this._y+o))),this.lensPosition={top:t,left:e}}calcPositionOfImage(i,t,e,s){const h=e||this._x,o=s||this._y,n=this.lensHalfSize.width-m(this.iSize.width,w(h,this.pSize.width)),a=this.lensHalfSize.height-m(this.iSize.height,w(o,this.pSize.height));this.iPos={x:n,y:a}}getPercentSize(i,t){return/%$/.test(i)?i=parseInt(i,10):(i=parseInt(i,10),i/=this.pSize[t]/100),i}setEvents(){this.setUpEvent&&!this.o.pan&&this.view.addEventToMainContainer(d,(i=>{i.stop(),this.hide(!0)})),this.o.customZooming&&this.addMouseScroollEvent(),this.addMouseOverEvent(),"hover"===this.o.trigger&&this.addMouseOutEvent(),this.o.pan&&this.addDragEvent(),n.browser.mobile&&this.addTapEvent(),"hover"!==this.o.trigger&&this.addClickEvent(),this.o.pan||n.browser.mobile||this.view.addEventToMainContainer(c,(i=>{if(i.pointerType&&"touch"===i.pointerType)return;i.stop();const t=i.pageXY;this.move(t.x,t.y),(this._x<=0||this._y<=0||this._x>=this.pSize.width||this._y>=this.pSize.height)&&this.hide()}))}afterMove(){this.calcLensPosition(),this.calcPositionOfImage(this.scale),this.view.lensPosition=this.lensPosition,super.afterMove()}changeLensSize(i){i.width=S(i.width,10,90),i.height=S(i.height,10,90),i.width!==this.currentLensSize.width&&(this.currentLensSize.width=i.width,this.currentLensSize.height=i.height,this.calcLensSize(),this.calcLensPosition(),this.calcPositionOfImage(),this.iDPos.x=this.iPos.x,this.iDPos.y=this.iPos.y,this.deepZoomAction(!1,this.lensSize),this.view.setImagePosition(this.iPos,this.scale),this.view.lensPosition=this.lensPosition,this.view.lensSize=this.lensSize)}addMouseScroollEvent(){this.view.addEventToWrapper("mousescroll",(i=>{let t;i.stop();const e=i.delta,s={width:0,height:0};if(this.isSquare)for(t in s)({}).hasOwnProperty.call(s,t)&&(s[t]=this.currentLensSize[t]+e);else t=this.currentLensSize.height/this.currentLensSize.width,s.width=this.currentLensSize.width+e,s.height=this.currentLensSize.height+e*t;this.changeLensSize(s)}))}addMouseOverEvent(){this.view.addEventToMainContainer("mouseover",(i=>{i.stop();const t=i.pageXY;this.x=t.x,this.y=t.y,this.calcLensPosition(),this.calcPositionOfImage(),this.view.lensPosition={top:this.lensPosition.top,left:this.lensPosition.left},this.view.setImagePosition(this.iPos,this.scale)}))}addMouseOutEvent(){this.view.addEventToWrapper("mouseout",(i=>{let t=i.related;for(;t&&t!==this.node&&t!==this.lensContainer&&t!==this.eventsCanvasNode;)t=t.parentNode;if(this.node!==t&&this.eventsCanvasNode!==t){const t=i.clientXY;(t.x<this.boundaries.left||t.x>this.boundaries.right||t.y<this.boundaries.top||t.y>this.boundaries.bottom)&&(i.stop(),this.o.smoothing?this.hide():this.hide(!0))}}))}addDragEvent(){let i=!1;this.view.addEventToMainContainer(l,(t=>{t.stop(),"dragstart"===t.state?i=!0:"dragend"===t.state?i=!1:i&&this.move(t.x,t.y)}))}addTapEvent(){this.view.addEventToMainContainer("dblclick"===this.o.trigger?"dbltap":"tap",(i=>{i.stop(),this.o.smoothing?this.hide():this.hide(!0)}))}hide(i){const t=super.hide(i);return t&&(i||(this.view.addEventToWrapper("transitionend",(i=>{i.stop(),this.view.removeEventFromWrapper("transitionend"),this.endOfHiding()})),this.view.lensStyle={transition:"opacity .2s linear, transform .2s linear",opacity:0,transform:"scale(0)"})),t}show(i,t,e,s,h,o){return!!super.show()&&(this.emit("zoomBeforeShow",{data:{}}),this.setUpEvent=h,this.iSize={width:t.width,height:t.height},this.view.addStartCss(),this.view.appendNodes(i,this.iSize),this.getAllSizes(),this.x=e,this.y=s,this.calcLensSize(),this.calcLensPosition(),this.getBaseScale(),this.showDeepZoom(t.originWidth,t.originHeight),this.calcPositionOfImage(this.scale,!0),this.view.eventNodePositionSize={position:this.pPos,size:this.pSize},this.dScale.x=this.baseScale.x,this.dScale.y=this.baseScale.y,this.iDPos={x:-1*g(this.iSize.width,this.iSize.width*this.dScale.x)-this.lensPosition.left,y:-1*g(this.iSize.height,this.iSize.height*this.dScale.y)-this.lensPosition.top},this.view.setLensCss(this.lensPosition,this.lensSize,"opacity .15s linear, transform .15s linear"),this.view.setImageSize(this.iDPos,this.iSize,this.dScale),this.boundaries=this.view.boundaries,this.o.smoothing?(this.view.addEventToWrapper("transitionend",(i=>{i.stop(),this.view.removeEventFromWrapper("transitionend"),this.view.lensStyle={transition:""},this.sendZoomShownEvent()})),this.endOfShowing(),this.anim.start()):(this.endOfShowing(),this.sendZoomShownEvent()),!0)}},M=class extends D{constructor(i,t){super(i,Object.assign({margin:9,outsidePosition:"right",width:100,height:100},t)),this.showingParams=null,this.eye=new x(this.view.getNodeForEye(),"hover"===this.o.trigger),this.ANIM_STEP=.18,this.mouseOutHandler=this.mouseOut.bind(this)}getBoundaries(){this.boundaries=this.eye.boundaries}init(){super.init(),this.setOutsideLensSize()}setEyesParams(){const i=this.currentLensSize.width/(this.iSize.width*this.scale.x),t=this.currentLensSize.height/(this.iSize.height*this.scale.y);this.eye.size={width:i*this.zoomNodeSize.width,height:t*this.zoomNodeSize.height},this.eye.position={x:this._x,y:this._y}}calcLensPosition(){let i=this.o.margin;const t=this.pSize,e=this.pPos;i<0&&(i=0);let s=e.top,h=e.left;switch(this.o.outsidePosition){case"top":s+=-1*(this.lensSize.height+i);break;case"left":h+=-1*(this.lensSize.width+i);break;case"right":h+=t.width+i;break;case"bottom":s+=t.height+i}this.lensPosition={top:s,left:h}}calcPositionOfImage(i){i||(i=this.dScale);const t=this.iSize.width*i.x,e=this.iSize.height*i.y,s=g(this.iSize.width,t),h=g(this.iSize.height,e);let o=this._x/(this.zoomNodeSize.width/t),n=this._y/(this.zoomNodeSize.height/e);o=this.lensSize.width/2-o-s,n=this.lensSize.height/2-n-h,o=p(o,0-s,s+t,this.lensSize.width),n=p(n,0-h,h+e,this.lensSize.height),this.iPos={x:o,y:n}}afterMove(){this.calcLensPosition(),this.calcPositionOfImage(this.scale),this.setEyesParams(),this.view.lensPosition=this.lensPosition,super.afterMove()}hide(i){const t=super.hide(i);return t&&(n.browser.mobile||this.view.removeMouseMoveEvent(this.mouseOutHandler),this.eye.clearEvents(),this.eye.hide(),i||(this.view.removeEvents(),this.endOfHiding())),t}getShowingPropertiesToOutsideMode(){const i={start:{x:0,y:0},end:{x:0,y:0}};switch(this.o.outsidePosition){case"top":i.start.y=10,i.end.y=0;break;case"left":i.start.x=10,i.end.x=0;break;case"right":i.start.x=-10,i.end.x=0;break;case"bottom":i.start.y=-10,i.end.y=0}return i}endOfShowing(){super.endOfShowing(),this.getBoundaries()}show(i,t,e,s,h,o){return!!super.show()&&(this.emit("zoomBeforeShow",{data:{}}),this.iSize={width:t.width,height:t.height},this.showingParams=this.getShowingPropertiesToOutsideMode(),this.view.addStartCss(this.showingParams),this.view.appendNodes(i,this.iSize),this.getAllSizes(),this.x=e,this.y=s,this.calcLensSize(),this.calcLensPosition(),this.getBaseScale(),this.showDeepZoom(t.originWidth,t.originHeight),this.calcPositionOfImage(this.scale,!0),this.view.eventNodePositionSize={position:this.pPos,size:this.pSize},this.dScale.x=this.baseScale.x,this.dScale.y=this.baseScale.y,this.iDPos={x:-1*g(this.iSize.width,this.iSize.width*this.dScale.x),y:-1*g(this.iSize.height,this.iSize.height*this.dScale.y)},this.view.setLensCss(this.lensPosition,this.lensSize,this.o.smoothing?"opacity .4s linear, transform .15s ease-in":"none"),this.view.setImageSize(this.iDPos,this.iSize,this.dScale),(this.o.smoothing||"zero"===o)&&this.endOfShowing(),this.eye.show(this.view.getImageForEye()),this.getBoundaries(),this.setEyesParams(),this.animStep=.3,this.o.smoothing?this.anim.start():this.endOfShowing(),this.sendZoomShownEvent(),!0)}setOutsideLensSize(){const i={width:this.o.width,height:this.o.height};"auto"===i.width?i.width=this.pSize.width:/%$/.test(this.o.width)?i.width=this.pSize.width/100*parseInt(this.o.width,10):i.width=parseInt(i.width,10),"auto"===i.height?i.height=this.pSize.height:/%$/.test(this.o.height)?i.height=this.pSize.height/100*parseInt(this.o.height,10):i.height=parseInt(i.height,10),this.currentLensSize={width:i.width,height:i.height}}calcLensSize(){const i=this.currentLensSize;this.lensSize={width:i.width,height:i.height},this.lensHalfSize={width:this.lensSize.width/2,height:this.lensSize.height/2}}setEvents(){if(n.browser.mobile&&this.o.pan&&this.addOutsideTouchDrag(),!n.browser.mobile&&n.browser.touchScreen&&["edge","ie"].includes(n.browser.uaName)&&(this.o.pan||this.eye.addEventToMainContainer("pointerup",(i=>{this.hide()}))),this.eye.addEventToMainContainer("mousemove",(i=>{i.stop();const t=i.pageXY;this.move(t.x,t.y)})),"hover"===this.o.trigger)n.browser.mobile||this.view.addMouseMoveEvent(this.mouseOutHandler),this.eye.addEventToMainContainer("mouseout",this.mouseOutHandler);else{let i=["btnclick","tap"];"dblclick"===this.o.trigger&&(i=["dblbtnclick","dbltap"]),this.eye.addEventToMainContainer(i,(i=>{this.hide()}))}this.o.customZooming&&this.setMouseScrollEvent()}mouseOut(i){const t=i.clientXY;(t.x<this.boundaries.left||t.x>this.boundaries.right||t.y<this.boundaries.top||t.y>this.boundaries.bottom)&&this.hide(!this.getZoomData())}addOutsideTouchDrag(){let i=!1;this.eye.addEventToMainContainer(l,(t=>{t.stop(),"dragstart"===t.state?i=!0:"dragend"===t.state?i=!1:i&&this.move(t.x,t.y)}))}setMouseScrollEvent(){this.eye.addEventToMainContainer("mousescroll",(i=>{const t=this.scale.x;if(i.stop(),i.isMouse){const t=37,e=i.delta/m(i.deltaFactor,t);this.scale.x+=e,this.scale.y+=e}else{let t=i.delta;Math.abs(t)>15&&(t=15,i.delta<0&&(t*=-1)),t/=350,this.scale.x+=t,this.scale.y+=t}this.scale.x=S(this.scale.x,this.baseScale.x,1),this.scale.y=S(this.scale.y,this.baseScale.y,1),this.calcPositionOfImage(this.scale),t!==this.scale.x&&(this.sendZoomingAction(),this.setCursorState(),this.o.smoothing||(this.dScale.x=this.scale.x,this.dScale.y=this.scale.y,this.iDPos.x=this.iPos.x,this.iDPos.y=this.iPos.y,this.deepZoomAction(),this.setImagePosition(this.iPos,this.scale)),this.setEyesParams())}))}setLensStyleOnResize(){this.view.lensPosition=this.lensPosition,this.view.setCanvasNodeSize(this.lensSize)}onResize(){super.onResize(),this.state!==e.APPEARANCE.HIDDEN&&this.state!==e.APPEARANCE.HIDING&&this.eye.resize()}destroy(){this.eye.destroy(),this.view.removeMouseMoveEvent(this.mouseOutHandler),super.destroy()}};return class extends o{constructor(i,t){super(),this.zoomType=t.type,"inner"===t.type?(this.view=new b(i),this.view.addClassToWrapper("inner"),this.controller=new I(this.view,t)):["circle","square"].includes(t.type)?(this.view=new f(i),this.view.addClassToWrapper(t.type),this.controller=new A(this.view,t)):(this.view=new E(i),this.view.addClassToWrapper("outside"),this.controller=new M(this.view,t)),this.controller.parentClass=this,this.controller.init()}set lensContainer(i){this.controller.lensContainer=i}get shown(){return this.controller.shown}get showing(){return this.controller.showing}getZoomData(i){return this.controller.getZoomData(i)}get nextMinZoom(){return this.controller.nextMinZoom}get nextMaxZoom(){return this.controller.nextMaxZoom}zoomUp(i,t){return this.controller.zoomUp(i,t)}zoomDown(i,t){return this.controller.zoomDown(i,t)}showCenter(i,t,e){return this.controller.showCenter(i,t,e)}addLoadedImage(i){this.controller.setImage(i)}show(i,t,e,s,h,o){return this.controller.show(i,t,e,s,h,o)}hide(i){return this.controller.hide(i)}customMove(i,t){this.controller.customMove(i,t)}get baseScale(){return this.controller.baseScale}set basePercent(i){"inner"===this.zoomType&&(this.controller.basePercent=i)}setScale(i,t,e){"inner"===this.zoomType&&this.controller.setScale(i,t,e)}onResize(){this.controller.onResize()}destroy(){this.view.destroy(),this.controller.destroy()}}}));
Sirv.define("Hint",["bHelpers","magicJS","globalVariables","globalFunctions","helper"],((i,t,e,s,n)=>{const o=t,a=o.$;s.rootDOM.addModuleCSSByName("Hint",(()=>".sirv-hint{position:absolute;display:inline-block;top:50%;left:0;width:100%;transform:translate3d(0,-50%,1px);transition:opacity .3s linear;text-align:center;opacity:0;z-index:42;pointer-events:none;-webkit-font-smoothing:antialiased}.sirv-hint.show{opacity:1}.sirv-hint-message{position:relative;display:inline-block;padding:.35em 1.5em;border-radius:2px;background:rgba(55,58,60,.8);color:#fff;font:normal 16px/1.5 'Lucida Grande','Lucida Sans Unicode',Verdana,'Helvetica Neue',Arial,Helvetica,sans-serif;text-decoration:none}"));return class{constructor(i,t){this.parent=a(i),this.options=Object.assign({html:"hint",showClass:"show",additionalClass:[],autohide:3500},t||{}),this.instanceNode=o.$new("div").addClass("sirv-hint"),this.hintContainer=o.$new("span").addClass("sirv-hint-message"),this.inDoc=!1,this.isShown=!1,this.timer=null,this.instanceNode.addClass(...this.options.additionalClass),this.hintContainer.node.innerHTML=this.options.html,this.instanceNode.append(this.hintContainer)}get autoHideTime(){return this.options.autohide}get actionTime(){let i=0,t=this.instanceNode.getCss("transition");try{t=t.split(" ")[1]}catch(i){t=0}return t&&(t=t.trim(),/m?s$/.test(t)&&(/s$/.test(t)?(i=parseFloat(t),i*=1e3):i=parseInt(t,10))),i}get movingTime(){return this.autoHideTime+this.actionTime}append(){this.inDoc||(this.inDoc=!0,this.parent.append(this.instanceNode))}removeEvent(){this.instanceNode.removeEvent("transitionend")}show(){this.append(),clearTimeout(this.timer),this.timer=null,this.instanceNode.render(),this.removeEvent(),this.instanceNode.addClass(this.options.showClass),this.isShown=!0,this.options.autohide&&(this.timer=setTimeout((()=>{this.hide()}),this.options.autohide))}hide(){this.inDoc&&(this.removeEvent(),clearTimeout(this.timer),this.timer=null,this.instanceNode.addEvent("transitionend",(i=>{i.stop(),this.removeEvent(),this.inDoc=!1,this.instanceNode.remove()})),this.instanceNode.removeClass(this.options.showClass),this.isShown=!1)}destroy(){this.instanceNode.setCssProp("transitionend","none"),this.hide(),this.removeEvent(),this.hintContainer.remove(),this.hintContainer.node.innerHTML="",this.instanceNode.remove(),this.inDoc=!1}}}));
Sirv.define("ProgressLoader",["bHelpers","magicJS","globalVariables","globalFunctions","helper","RoundLoader"],((e,s,t,r,i,a)=>{const o=s,l=o.$;r.rootDOM.addModuleCSSByName("ProgressLoader",(()=>".smv-progress-loader{pointer-events:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.smv-progress-loader .smv-pl-circle-wrapper,.smv-progress-loader .smv-pl-indicator,.smv-progress-loader .smv-pl-indicator .smv-pl-pie,.smv-progress-loader .smv-pl-indicator .smv-pl-slice,.smv-progress-loader .smv-pl-text-wrapper,.smv-progress-loader .smv-pl-wrapper{top:0;left:0;width:100%;height:100%}.smv-progress-loader .smv-pl-text-wrapper,.smv-progress-loader .smv-pl-wrapper{display:inline-block;position:relative}.smv-progress-loader .smv-pl-wrapper{transform:scale(0);transition:transform .15s cubic-bezier(.17,.67,.57,1.47),opacity .2s linear;border-radius:50%;background-color:rgba(0,0,0,.55);opacity:0}.smv-progress-loader .smv-pl-circle-wrapper,.smv-progress-loader .smv-pl-indicator,.smv-progress-loader .smv-pl-indicator .smv-pl-pie,.smv-progress-loader .smv-pl-indicator .smv-pl-slice{position:absolute}.smv-progress-loader .smv-pl-circle-wrapper,.smv-progress-loader .smv-pl-indicator{z-index:1}.smv-progress-loader .smv-pl-circle-wrapper{animation:sirv-pl-loader-rotate 2s infinite linear}.smv-progress-loader .smv-pl-indicator .smv-pl-pie,.smv-progress-loader .smv-pl-indicator .smv-pl-slice{stroke-width:2;fill:transparent}.smv-progress-loader .smv-pl-indicator .smv-pl-pie{z-index:1;stroke:rgba(255,255,255,.3)}.smv-progress-loader .smv-pl-indicator .smv-pl-slice{z-index:2;stroke:#fff;stroke-linecap:round}.smv-progress-loader .smv-pl-text-wrapper{display:inline-flex;position:relative;align-items:center;justify-content:center;font-size:12px;text-align:center;z-index:2}.smv-progress-loader .smv-pl-text-wrapper::after{display:inline-block;height:100%;content:'';vertical-align:middle}.smv-progress-loader .smv-pl-text-wrapper .smv-pl-text{display:inline;position:relative;color:#fff;font-weight:700}.smv-progress-loader .smv-pl-text-wrapper .smv-pl-text .smv-pl-text-percent{font-size:.7em}@keyframes sirv-pl-loader-rotate{from{transform:rotateZ(0)}to{transform:rotateZ(360deg)}}"));const n=(e,s)=>{const t=l(o.D.node.createElementNS("http://www.w3.org/2000/svg",e));return s||(s={}),Object.entries(s).forEach((e=>t.attr(...e))),t},p=0,h=1,d=2;return class extends a{constructor(e,s){super(e,s=(e=>(e||(e={}),e.width||(e.width=44),e.height||(e.height=44),e.max||(e.max=0),e))(s)),this.type="progress",this.lineSize=125,this.currentLineSize=125,this.currentPersent=0,this.currentValue=0,this.progressState=p,this.maxOpacityFlag=!1,this.maxOpacity=1,this.circles=[],this.size={width:this.options.width,height:this.options.height},this.state=t.APPEARANCE.HIDDEN,this._createCircles()}addClass(){this.node.addClass("smv-progress-loader")}_createCircles(){this.p='<span class="smv-pl-text-percent">%</span>',this.loaderElement.addClass("smv-pl-wrapper"),this.circleWrapper=o.$new("div").addClass("smv-pl-circle-wrapper");const e=this.size.width,s=e/2;this.circles.push(n("circle",{class:"smv-pl-pie",r:s-2,cx:s,cy:s})),this.circles.push(n("circle",{class:"smv-pl-slice",r:s-2,cx:s,cy:s})),this.svg=n("svg",{class:"smv-pl-indicator",viewBox:"0 0 "+e+" "+e}),this.circles[1].node.style.strokeDasharray=this.lineSize,this.circles[1].node.style.strokeDashoffset=this.lineSize,l(this.circles[1]).addEvent("transitionend",(e=>{e.stop()})).setCssProp("transition","stroke-dashoffset .1s linear"),l(this.svg).append(this.circles[0]),l(this.svg).append(this.circles[1]),this.textWrapper=o.$new("div").addClass("smv-pl-text-wrapper"),this.text=o.$new("span").addClass("smv-pl-text"),this.text.changeContent(this.currentPersent+this.p),this.textWrapper.append(this.text),this.circleWrapper.append(this.svg),this.loaderElement.append(this.circleWrapper),this.loaderElement.append(this.textWrapper)}append(){this.progressState!==d&&super.append()}progress(){var e,s;this.progressState!==d&&(this.progressState=h,this.currentValue+=1,this.currentPersent=(e=this.options.max,s=this.currentValue,Math.round(100/(e/s))),this.currentLineSize=((e,s)=>e-e/100*s)(this.lineSize,this.currentPersent),this.circles[1].node.style.strokeDashoffset=this.currentLineSize,this.text.node.innerHTML=this.currentPersent+this.p,this.currentValue===this.options.max&&(this.progressState=d,this.hide()))}setMaxOpacity(e){!this.maxOpacityFlag&&this.loaderElement&&(this.maxOpacity=e,this.maxOpacityFlag=!0,this.loaderElement.setCssProp("opacity",e))}isEnded(){return this.currentValue===this.options.max}isStarted(){return this.currentValue>0}finishOff(){this.currentValue=this.options.max}isShow(){return this.state===t.APPEARANCE.SHOWN}show(){this.state!==t.APPEARANCE.SHOWN&&(this.state=t.APPEARANCE.SHOWN,this.append(),this.loaderElement.render(),this.loaderElement.removeEvent("transitionend"),this.loaderElement.addEvent("transitionend",(e=>{e.stop()})),this.loaderElement.setCss({display:"block",opacity:this.maxOpacity,transform:"scale(1)"}))}hide(e){if(this.state===t.APPEARANCE.HIDDEN&&!e||!this.inDoc)return;let s=0;this.state=t.APPEARANCE.HIDDEN,clearTimeout(this.timer),this.timer=setTimeout((()=>{this.loaderElement.removeEvent("transitionend"),this.loaderElement.addEvent("transitionend",(e=>{e.stop(),s+=1,s<2||(this.loaderElement.removeEvent("transitionend"),this.loaderElement.setCssProp("display","none"))})),this.loaderElement.setCss({opacity:0,transform:"scale(0)"})}),e?0:400)}getProgressState(){return this.progressState}destroy(){this.hide(!0),clearTimeout(this.timer),this.currentPersent=0,this.currentValue=0,this.progressState=p,this.state=t.APPEARANCE.HIDDEN,this.loaderElement.removeEvent("transitionend"),this.loaderElement.node.innerHTML="",this.loaderElement=null,this.circleWrapper=null,this.textWrapper=null,this.circles=[],this.svg=null,this.text=null,this.inDoc=!1,super.destroy()}}}));
Sirv.define("Spin",["bHelpers","magicJS","globalVariables","globalFunctions","helper","EventEmitter","Zoominstance","ResponsiveImage","Hint","ProgressLoader","SpinHotspots"],((t,e,i,s,n,o,a,r,h,l,m)=>{const d=e,c=d.$;s.rootDOM.addModuleCSSByName("Spin",(()=>".sirv-spin{-webkit-user-select:none!important;-ms-user-select:none!important;user-select:none!important;display:inline-block;position:relative;width:100%;max-width:100%;height:100%;padding:0!important;transform:translate3d(0,0,0);outline:0;outline:0!important;color:#000;font-size:0!important;line-height:100%!important;text-decoration:none;overflow:hidden;vertical-align:middle;visibility:visible;-webkit-backface-visibility:hidden;backface-visibility:hidden;user-select:none;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none!important}.sirv-spin::before{display:inline-block;height:0;content:'';vertical-align:top}.sirv-spin .spin-canvas-container{position:absolute}.sirv-spin .spin-canvas-container,.sirv-spin canvas{top:0;right:0;bottom:0;left:0;margin:auto}.sirv-spin canvas{transition:opacity 1s linear,filter 2s linear;opacity:0;z-index:1}.sirv-spin canvas.smv-shown{opacity:1!important}.sirv-spin canvas.smv-zoomed-in{visibility:hidden!important}.sirv-spin-message{display:block;position:absolute;top:50%;left:33%;width:33%;padding:6px;border:1px solid #aaa;border-radius:15px;background-color:#fff;background-image:none;color:#000;font-size:10px;text-align:center;border-collapse:separate;box-shadow:0 0 10px #000;overflow:hidden;z-index:100}.sirv-hint .spin-hint-animation{display:none;position:relative;width:40px;height:40px;margin-right:10px;transform-style:preserve-3d;vertical-align:middle;perspective:200px}.sirv-hint .sirv-hint-message .spin-hint-animation::before{display:inline-block;position:absolute;top:0;right:0;bottom:0;left:0;width:40%;height:30%;margin:auto;transform-origin:50% 50% -15px;border:1px solid #fff;box-shadow:inset 0 0 1px 1px rgba(255,255,255,.5);content:'';box-sizing:border-box}.sirv-hint.spin-hint-horizontal-animation .sirv-hint-message .spin-hint-animation::before{transform:translateZ(0) rotateY(0);animation:sirv-spin-hint-horizontal-rotate 3s infinite linear}@keyframes sirv-spin-hint-horizontal-rotate{0%{transform:translateZ(0) rotateY(0)}5%{transform:translateZ(100px) rotateY(0)}7%{transform:translateZ(75px) rotateY(0)}20%{transform:translateZ(75px) rotateY(0)}30%{transform:translateZ(75px) rotateY(45deg)}40%{transform:translateZ(75px) rotateY(0)}50%{transform:translateZ(75px) rotateY(-45deg)}60%{transform:translateZ(75px) rotateY(0)}63%{transform:translateZ(75px) rotateY(0)}68%{transform:translateZ(-25px) rotateY(0)}70%{transform:translateZ(0) rotateY(0)}80%{transform:translateZ(0) rotateY(0)}100%{transform:translateZ(0) rotateY(0)}}.sirv-hint.spin-hint-vertical-animation .spin-hint-message .spin-hint-animation::before{transform:translateZ(0) rotateX(0);animation:sirv-spin-hint-vertical-rotate 3s infinite linear}@keyframes sirv-spin-hint-vertical-rotate{0%{transform:translateZ(0) rotateX(0)}5%{transform:translateZ(100px) rotateX(0)}7%{transform:translateZ(75px) rotateX(0)}20%{transform:translateZ(75px) rotateX(0)}30%{transform:translateZ(75px) rotateX(45deg)}40%{transform:translateZ(75px) rotateX(0)}50%{transform:translateZ(75px) rotateX(-45deg)}60%{transform:translateZ(75px) rotateX(0)}63%{transform:translateZ(75px) rotateX(0)}68%{transform:translateZ(-25px) rotateX(0)}70%{transform:translateZ(0) rotateX(0)}80%{transform:translateZ(0) rotateX(0)}100%{transform:translateZ(0) rotateX(0)}}.sirv-hint.spin-hint-horizontal-animation.spin-hint-vertical-animation .sirv-hint-message .spin-hint-animation::before{transform:translateZ(0) rotateX(0) rotateY(0);animation:sirv-spin-hint-double-rotate 5s infinite linear}@keyframes sirv-spin-hint-double-rotate{0%{transform:translateZ(0) rotateX(0) rotateY(0)}4%{transform:translateZ(100px) rotateX(0) rotateY(0)}5%{transform:translateZ(75px) rotateX(0) rotateY(0)}10%{transform:translateZ(75px) rotateX(0) rotateY(0)}19%{transform:translateZ(75px) rotateX(0) rotateY(45deg)}28%{transform:translateZ(75px) rotateX(0) rotateY(0)}37%{transform:translateZ(75px) rotateX(0) rotateY(-45deg)}45%{transform:translateZ(75px) rotateX(0) rotateY(0)}54%{transform:translateZ(75px) rotateX(45deg) rotateY(0)}63%{transform:translateZ(75px) rotateX(0) rotateY(0)}72%{transform:translateZ(75px) rotateX(-45deg) rotateY(0)}81%{transform:translateZ(75px) rotateX(0) rotateY(0)}85%{transform:translateZ(-25px) rotateX(0) rotateY(0)}86%{transform:translateZ(0) rotateX(0) rotateY(0)}90%{transform:translateZ(0) rotateX(0) rotateY(0)}100%{transform:translateZ(0) rotateX(0) rotateY(0)}}.smv-progress-loader{bottom:0;left:0;margin-bottom:5px;margin-left:5px}"));const u={swapSides:{type:"boolean",defaults:!1},wheel:{type:"boolean",defaults:!0},initialize:{type:"string",enum:["load","hover","click","tap"],defaults:"load"},freeDrag:{type:"boolean",defaults:!1},tappingFirst:{type:"boolean",defaults:!1},speed:{type:"number",minimum:0,defaults:0},thumbnail:{type:{type:"string",enum:["image","gif"],defaults:"image"},gifParams:{type:"string",defaults:""}},zoom:{enable:{type:"boolean",defaults:!0},ratio:{oneOf:[{type:"number",minimum:0},{type:"string",enum:["max"]}],defaults:2.5},tiles:{type:"boolean",defaults:!0},pan:{type:"boolean",defaults:!0}},inactivity:{type:"number",minimum:1e3,defaults:3e3},autospin:{enable:{type:"boolean",defaults:!1},type:{type:"string",enum:["row","sphere","full","helix"],defaults:"sphere"},resume:{type:"number",minimum:0,defaults:3e3},duration:{type:"number",minimum:0,defaults:3600}},hint:{message:{enable:{type:"boolean",defaults:!0},text:{type:"string",defaults:"Drag to spin"}},onStart:{enable:{type:"boolean",defaults:!0},effect:{oneOf:[{type:"string",enum:["intro","twitch","spin","momentum","sphere","none"]},{type:"boolean",enum:[!1]}],defaults:"intro"}},onVisible:{enable:{type:"boolean",defaults:!0},effect:{oneOf:[{type:"string",enum:["intro","twitch","spin","momentum","sphere","none"]},{type:"boolean",enum:[!1]}],defaults:"twitch"}},onInactive:{enable:{type:"boolean",defaults:!0},effect:{oneOf:[{type:"string",enum:["intro","twitch","spin","momentum","sphere","none"]},{type:"boolean",enum:[!1]}],defaults:"twitch"}}},row:{start:{type:"number",minimum:1,defaults:1},loop:{type:"boolean",defaults:!1},increment:{type:"number",minimum:1,defaults:1},reverse:{type:"boolean",defaults:!1},sensitivity:{type:"number",minimum:1,maximum:100,defaults:50}},column:{start:{type:"number",minimum:1,defaults:1},loop:{type:"boolean",defaults:!0},increment:{type:"number",minimum:1,defaults:1},reverse:{type:"boolean",defaults:!1},sensitivity:{type:"number",minimum:1,maximum:100,defaults:50}}};class p extends r{constructor(t,e,i,s){super(t,e),this.col=i,this.row=s}_createImageData(t,e){const i=super._createImageData(t,e);return i.col=this.col,i.row=this.row,i}getThumbnail(t){const e=super.getThumbnail(t);return e.col=this.col,e.row=this.row,e}}const g=(()=>{const t=(t,e,i,s,o)=>{const a=[];let r=!1,h=t;for(;h!==e||!r&&o;)r=!0,i?h+=1:h-=1,h=n.getArrayIndex(h,s),a.push(h);return a},e=(t,e)=>{let i="col";null===e.row&&(i="row");const s=[];return t.forEach((t=>{const n={col:e.column,row:e.row};n[i]=t,s.push(n)})),s},i=(e,i,s,o)=>{let a,r=[e],h=!0;return[e+i,e-i,e].forEach((e=>{a=(t=>{let e;return o?e=n.getArrayIndex(t,s):(e=t,e<0&&(e=0),e>s-1&&(e=s-1)),e})(e),r=r.concat(t(r[r.length-1],a,h,s,o)),h=!h})),r},s=(e,s,o)=>{let a=[];return a=o?t(e,n.getArrayIndex(e+s,s),!0,s,o):i(e,s,s,!1),a},o=t=>{const e=n.deepExtend({degree:30,swapSides:!1,accelerate:!1,isBackward:!1,justFirstLine:!1,row:{length:1,loop:!1,current:1,jumpCount:0},column:{length:36,loop:!0,current:1,jumpCount:0},firstSide:"column",secondSide:"row"},t||{});return["row","column"].forEach((t=>{e[t].current>e[t].length-1&&(e[t].current=0)})),e.swapSides&&(e.secondSide=e.firstSide,e.firstSide="row"),e},a={lib:{getRightIndex:(t,e,i)=>{let s;return i?s=n.getArrayIndex(t,e):(t>=e?t=e-1:t<0&&(t=0),s=t),s}},twitch:t=>{const s=o(t),n={column:0,row:0};let a,r=[];return[s.firstSide,s.secondSide].forEach((t=>{const o=t===s.firstSide?s.secondSide:s.firstSide;s[t].length>1&&(n[t]=Math.floor(s[t].length/360*s.degree)||1),n[t]&&(a={},a[t]=null,a[o]=s[o].current,r=r.concat(e(i(s[t].current,n[t],s[t].length,s[t].loop),a)))})),r},sphere:t=>{const i=o(t);let n=[];return(i.justFirstLine?[i.firstSide]:[i.firstSide,i.secondSide]).forEach((t=>{const o=t===i.firstSide?i.secondSide:i.firstSide,a={};if(1===i[t].length)return;a[t]=null,a[o]=i[o].current;const r=e(s(i[t].current,i[t].length,i[t].loop),a);i.isBackward&&r.reverse(),n=n.concat(r)})),t.additionalFrame&&n.push(n[0]),n},intro:t=>{const e=o(t),i={swapSides:e.swapSides,justFirstLine:!0,isBackward:e.isBackward,row:n.deepExtend({},e.row),column:n.deepExtend({},e.column)};let s=[];return s=a.sphere(i),s=s.concat(a.twitch(i)),s},full:t=>{let e;const i=o(t),r=i[i.secondSide].length;e=r>1?s(i[i.secondSide].current,r,i[i.secondSide].loop):[i[i.secondSide].current];const h=n.deepExtend({},i[i.firstSide]),l=n.deepExtend({},i[i.secondSide]);let m=[];return e.forEach((t=>{const e={swapSides:i.swapSides,justFirstLine:!0};l.current=t,e[i.firstSide]=h,e[i.secondSide]=l,m=m.concat(a.sphere(e))})),i.isBackward&&m.reverse(),t.additionalFrame&&m.push(m[0]),m},custom:t=>{const e=o(t),i={x:e.column.current,y:e.row.current},s={x:e.column.current+e.column.jumpCount,y:e.row.current+e.row.jumpCount};let n=[];return n=((t,e)=>{const i={x:[],y:[]},s=(t,e,s,n)=>{const o=s-t;let a,r,h=n-e,l=1,m=e;for(h<0&&(l=-1,h=-h),r=2*h-o,a=t;a<=s;a++)i.x.push(a),i.y.push(m),r>0&&(m+=l,r-=2*o),r+=2*h},n=(t,e,s,n)=>{let o=s-t;const a=n-e;let r,h,l=1,m=t;for(o<0&&(l=-1,o=-o),h=2*o-a,m=t,r=e;r<=n;r++)i.x.push(m),i.y.push(r),h>0&&(m+=l,h-=2*a),h+=2*o};return Math.abs(e.y-t.y)<Math.abs(e.x-t.x)?t.x>e.x?s(e.x,e.y,t.x,t.y):s(t.x,t.y,e.x,e.y):t.y>e.y?n(e.x,e.y,t.x,t.y):n(t.x,t.y,e.x,e.y),i})(i,s),n=(t=>{const e=[];t.x[0]!==i.x&&t.x.reverse(),t.y[0]!==i.y&&t.y.reverse();for(let i=0,s=t.x.length;i<s;i++)e.push({col:t.x[i],row:t.y[i]});return e})(n),n=c(n).map((t=>({col:a.lib.getRightIndex(t.col,e.column.length,e.column.loop),row:a.lib.getRightIndex(t.row,e.row.length,e.row.loop)}))),n}};return a})(),w=(()=>{const t={getStep:t=>{let e=1;return t>24&&(e=Math.floor(t/24),e>3&&(e=3)),e},getIndexes:e=>{const i=[],s=[];let n=!0,o=t.getStep(e);do{const t=[];for(let i=0;i<e;i+=o)s[i]||(t.push(i),s[i]=1);1===o&&(n=!1),i.push(t),o=Math.ceil(o/2)}while(o>=1&&n);return i},getRightIndexes:(t,e,i,s)=>{t.forEach((t=>{const o=t+e,a=n.getArrayIndex(o,i);(o<i||a<e)&&s(a)}))},getOptions:t=>{const e=n.deepExtend({},t);return e.imageSchema=e.images.map((t=>t.map((t=>0)))),e.rowLength=e.images.length,e.colLength=e.images[e.startRow].length,e},all:(t,e,i)=>{const s=[];for(let n=0,o=t.length;n<o;n++)for(let o=0,a=t[n].length;o<a;o++)e[n][o]||(s.push([n,o]),e[n][o]=i+1);return s},getSideOpt:t=>{const e={length:t.colLength,start:t.startCol,otherLength:t.rowLength,otherStart:t.startRow};if(t.swapSides){let t=e.length;e.length=e.otherLength,e.otherLength=t,t=e.start,e.start=e.otherStart,e.otherStart=t}return e}};return{_:t,all:e=>{const i=[],s=t.getOptions(e),o=t.getIndexes(s.colLength),a=[];return s.images.forEach(((e,i)=>{const r=e.length;t.getRightIndexes(o[0],s.startCol,r,(t=>{const e=n.getArrayIndex(i+s.startRow,s.rowLength);a.push([e,t]),s.imageSchema[e][t]=1}))})),i.push(a),i.push([].concat(t.all(s.images,s.imageSchema,1))),i},fastLine:e=>{const i=[],s=t.getOptions(e),o=t.getSideOpt(s),a=[];for(let t=0,e=o.length;t<e;t++){const e=n.getArrayIndex(t+o.start,o.length);s.swapSides?(a.push([e,s.startCol]),s.imageSchema[e][s.startCol]=1):(a.push([s.startRow,e]),s.imageSchema[s.startRow][e]=1)}return i.push(a),i.push([].concat(t.all(s.images,s.imageSchema,1))),i},line:e=>{const i=[],s=t.getOptions(e),n=t.getSideOpt(s),o=t.getIndexes(n.length);let a=[],r=1;for(t.getRightIndexes(o[0],n.start,n.length,(t=>{s.swapSides?(a.push([t,s.startCol]),s.imageSchema[t][s.startCol]=1):(a.push([s.startRow,t]),s.imageSchema[s.startRow][t]=1)})),i.push(a),a=[];r<o.length;)o[r]&&t.getRightIndexes(o[r],n.start,n.length,(t=>{s.swapSides?(a.push([t,s.startCol]),s.imageSchema[t][s.startCol]=r+1):(a.push([s.startRow,t]),s.imageSchema[s.startRow][t]=r+1)})),r+=1;return i.push(a.concat(t.all(s.images,s.imageSchema,r))),i},sphere:e=>{const i=[],s=t.getOptions(e),n=t.getSideOpt(s),o=t.getIndexes(n.length),a=t.getIndexes(n.otherLength),r=Math.max(o.length,a.length);let h=[],l=1;for(t.getRightIndexes(o[0],n.start,n.length,(t=>{s.swapSides?(h.push([t,s.startCol]),s.imageSchema[t][s.startCol]=1):(h.push([s.startRow,t]),s.imageSchema[s.startRow][t]=1)})),t.getRightIndexes(a[0],n.otherStart,n.otherLength,(t=>{s.swapSides?s.imageSchema[s.startRow][t]||(h.push([s.startRow,t]),s.imageSchema[s.startRow][t]=1):s.imageSchema[t][s.startCol]||(h.push([t,s.startCol]),s.imageSchema[t][s.startCol]=1)})),i.push(h),h=[];l<r;)o[l]&&t.getRightIndexes(o[l],n.start,n.length,(t=>{s.swapSides?(h.push([t,s.startCol]),s.imageSchema[t][s.startCol]=l+1):(h.push([s.startRow,t]),s.imageSchema[s.startRow][t]=l+1)})),a[l]&&t.getRightIndexes(a[l],n.otherStart,n.otherLength,(t=>{s.swapSides?(h.push([s.startRow,t]),s.imageSchema[s.startRow][t]=l+1):(h.push([t,s.startCol]),s.imageSchema[t][s.startCol]=l+1)})),l+=1;return i.push(h.concat(t.all(s.images,s.imageSchema,l))),i}}})(),f=(()=>{const t=(t,e)=>t+"."+e,e=(t,e)=>t%e==0,i=(t,e,i)=>{let s;return s=/^\//.test(i)?t+i:e+"/"+i,s};return class extends o{constructor(t){super(),this.o=t,this._startColumn=0,this._startRow=0,this._currentColumn=0,this._currentRow=0,this.nextColumn=0,this.nextRow=0,this.futureColumn=0,this.futureRow=0,this.imgMap=[],this.destroyed=!1,this.images=[],this.isStartedFullInit=!1,this.imageInfoPromise=null,this.loadingMap={queue:[]},this.url=n.spinLib.getUrl(this.o.url),this.absoluteURL=this.o.url.replace(/(^https?:\/\/[^/]*).*/,"$1"),this.infoImg=null,this.imageInfoId="img-"+n.generateUUID(),this.addEvents()}createImageInfo(){const t=()=>{const t=Object.keys(this.o.layers)[0],e=Object.keys(this.o.layers[t])[0];return this.o.layers[t][e]};return this.infoImg||(this.infoImg=new p(s.normalizeURL(i(this.absoluteURL,this.url,t())),{imageSettings:this.o.imageSettings,infoId:this.imageInfoId,round:!0,referrerPolicy:this.o.referrerPolicy},null,null),this.infoImg.parentClass=this),this.infoImg}loadImageInfo(){return this.imageInfoPromise||(this.imageInfoPromise=new Promise(((t,e)=>{this.createImageInfo(),this.infoImg.loadInfo().then((e=>{this.isStartedFullInit&&this.createQueue(),t({size:this.infoImg.originSize})})).catch((t=>{e({error:t})}))}))),this.imageInfoPromise}startFullInit(t){this.isStartedFullInit||(this.isStartedFullInit=!0,this.o=Object.assign(this.o,t),this.o.layers=n.spinLib.checkLayers(this.o.layers),this.o.layers=n.spinLib.swapLayers(this.o.layers,this.o.swapSides),this.imgMap=Object.values(this.o.layers).filter(((t,i)=>e(i,this.o.rowIncrement))).map((t=>Object.values(t).filter(((t,i)=>e(i,this.o.columnIncrement))).map((t=>s.normalizeURL(i(this.absoluteURL,this.url,t)))))),n.spinLib.reverse(this.o.reverseColumn,this.o.reverseRow,this.imgMap),this.createImages(this.imgMap),this.setFirstImage(),this.imageInfoPromise&&this.infoImg.loadInfo().then((t=>{this.loadingMap.queue.length||this.createQueue()})).catch((t=>{})))}setImageSettings(t){return t||(t={}),t.imageSettings||(t.imageSettings={}),t.imageSettings.scale||(t.imageSettings.scale={}),t.callbackData||(t.callbackData={}),t.imageSettings.scale.option="fill",t.srcset||(t.srcset={}),null!==this.o.quality&&(t.src||(t.src={}),t.src=this.o.quality),t.dppx>=1.5?t.srcset.quality=this.o.hdQuality:null!==this.o.quality&&(t.srcset.quality=this.o.quality),t}getImage(t,e){let i=t,s=e;return d.defined(t)||(i=this._currentRow,s=this._currentColumn),this.images[i][s]}getThumbnail(t){return this.getImage(this._startRow,this._startColumn).getThumbnail(t)}get map(){return this.imgMap.map((t=>t.map((t=>!1))))}addEvents(){let t=!1,e=!1,i=!1;const s=s=>{t&&e&&i||s.lens||(t||s.col!==this._currentColumn||s.row!==this._currentRow||(t=!0,this.emit("mapFirstImageLoaded",{data:s})),!e&&this.loadingMap.checkPrimaryImageQueue(s.row,s.col)&&(e=!0,this.emit("mapImagesReady")),this.destroyed||i||!this.loadingMap.checkSecondaryImageQueue(s.row,s.col)||(i=!0),!this.destroyed&&t&&e&&i&&this.emit("mapAllImagesLoaded"))};this.on("imageOnload",(t=>{t.stopAll();const e=Object.assign({isCurrent:this.isCurrent(t.data)},t.data);this.emit("mapImageLoaded",{data:e}),s(e)})),this.on("imageOnerror",(t=>{t.stopAll(),t.data.error=!0,this.emit("mapImageLoaded",{data:t.data}),s(t.data),console.log("image error")}))}getHintType(){let t;const e=this.rowCount,i=this.frameCount;return t=e>1&&i>1?"multi-row":e>1?"col":"row",t}isLoaded(t){const e=this.getImage();return t=this.setImageSettings(t),e.isLoaded(t)}isExist(t){const e=this.getImage();return t=this.setImageSettings(t),e.isExist(t)}isCurrent(t){return t.row===this._currentRow&&t.col===this._currentColumn}get imageCount(){return this.frameCount*this.rowCount}get frameCount(){return this.images[0].length}get rowCount(){return this.images.length}pixelPerFrame(t){let e=t;const i=this.frameCount;return i>1?(this.o.loopColumn||(e/=2),e/=i):e/=this.rowCount,e/=Math.pow(this.o.columnSpeed/50,2),e}pixelPerRow(t){let e=t;const i=this.rowCount;return i>1?(this.o.loopRow||(e/=2),e/=i):e/=this.frameCount,e/=Math.pow(this.o.rowSpeed/50,2),e}createImages(t){for(let e=0,i=t.length;e<i;e++){const i=[];for(let n=0,o=t[e].length;n<o;n++){const o=new p(s.adjustURL(t[e][n]),{imageSettings:this.o.imageSettings,infoId:this.imageInfoId,round:!0,referrerPolicy:this.o.referrerPolicy},n,e);o.parentClass=this,i.push(o)}this.images.push(i)}}setFirstImage(){let t=this.o.startRow,e=this.o.startColumn;this.o.reverseRow&&(t=this.images.length+1-t),this.o.reverseColumn&&(e=this.images[0].length+1-e),this._currentRow=t-1,this._currentColumn=e-1,this._currentRow>this.images.length-1&&(this._currentRow=0),this._currentColumn>this.images[0].length-1&&(this._currentColumn=0),this._startColumn=this.futureColumn=this.nextColumn=this._currentColumn,this._startRow=this.futureRow=this.nextRow=this._currentRow}loadImage(t,e,i){const s=this.getImage(e,i);t=this.setImageSettings(t),s.getImage(t)}loadFirstImage(t){if(!this.loadingMap.queue.length)return;const e=this.loadingMap.queue[0].shift();this.loadImage(t,e[0],e[1])}loadPrimaryImages(t){this.loadingMap.queue.length&&this.loadingMap.queue[0].forEach((e=>{this.loadImage(t,e[0],e[1])}))}loadSecondaryImages(t){!this.destroyed&&this.loadingMap.queue.length&&(t=this.setImageSettings(t),this.loadingMap.queue[1].forEach((e=>{this.loadImage(t,e[0],e[1])})))}loadImages(t){const e=this._currentColumn;this.destroyed||(t=this.setImageSettings(t),this.o.swapSides?this.images.forEach((i=>{const s=i[e];s.isExist(t)?s.sendLoad(t):s.getImage(t)})):this.images.forEach((e=>{e.forEach((e=>{e.isExist(t)?e.sendLoad(t):e.getImage(t)}))})))}isImagesExist(t){return t=this.setImageSettings(t),!this.images.some((e=>e.some((e=>!e.isExist(t)))))}createQueue(){let e;switch(this.o.loadingSchema){case"momentum":e="fastLine";break;case"full":e="all";break;case"row":case"spin":e="line";break;case"sphere":case"intro":case"twitch":e="sphere";break;default:e="all"}this.loadingMap.queue=w[e]({swapSides:this.o.swapSides,images:this.images,startRow:this._currentRow,startCol:this._currentColumn}),this.loadingMap.checkPrimaryImageQueue=(()=>{const e=[];return this.loadingMap.queue[0].forEach((i=>{e.push(t(i[0],i[1]))})),e.shift(),(i,s)=>{if(e.length){const n=e.indexOf(t(i,s));n>=0&&e.splice(n,1)}return 0===e.length}})(),this.loadingMap.checkSecondaryImageQueue=(()=>{let e,i=[];this.loadingMap.queue[1].forEach((e=>{i.push(t(e[0],e[1]))}));let s=!1;return e=i.length,e||(s=!0),(n,o)=>(s||i.indexOf(t(n,o))>=0&&(e-=1,0===e&&(i=[],s=!0)),s)})()}prepareFutureImage(t,e){let i,s,n;e||(e=1),["next","prev"].includes(t)?(n=this.o.loopColumn,i=this.futureColumn,s=this.frameCount,"next"===t?i+=e:i-=e,this.futureColumn=g.lib.getRightIndex(i,s,n)):(n=this.o.loopRow,i=this.futureRow,s=this.rowCount,"down"===t?i+=e:i-=e,this.futureRow=g.lib.getRightIndex(i,s,n))}setPreparedNextImage(){this.futureColumn=this._currentColumn=this.nextColumn,this.futureRow=this._currentRow=this.nextRow,this.emit("frameChange",{data:{column:this._currentColumn,row:this._currentRow}})}setPreparedFutureImage(){const t=this.getImage(this.futureRow,this.futureColumn);t&&t.ready&&(this._currentColumn=this.futureColumn,this._currentRow=this.futureRow,this.emit("frameChange",{data:{column:this._currentColumn,row:this._currentRow}}))}resetPreparedImage(){this.futureColumn=this.nextColumn=this._currentColumn,this.futureRow=this.nextRow=this._currentRow}getCurrentImage(t){t=this.setImageSettings(t);const e=this._currentColumn,i=this._currentRow;let s=this.getImage(i,e);return s=s.getImage(t),s}get originImageUrl(){const t=this._currentColumn,e=this._currentRow;let i=this.getImage(e,t);return i=i.originUrl,i}jump(t,e,i){let s,o,a=!1;const r=(t,e)=>{let i=!1;return this.getImage(t,e).ready&&(this.nextRow=t,this.nextColumn=o,this.setPreparedNextImage(),i=!0),i};switch(t){case"row":s=n.spinLib.getNextIndex(this._currentRow,e,i,this.rowCount,this.o.loopRow),o=this._currentColumn,a=r(s,o);break;case"col":o=n.spinLib.getNextIndex(this._currentColumn,e,i,this.frameCount,this.o.loopColumn),s=this._currentRow,a=r(s,o)}return a}setNextAnimationFrame(t){const e=this._imagesBuffer[t],i=this.getImage(e.row,e.col);i&&i.ready&&(this.nextColumn=e.col,this.nextRow=e.row)}getNextBufferIndex(t){let e=0;const i=this._imagesBuffer.length,s=t=>{const e=this.getImage(t.row,t.col);let i=!1;return e&&e.ready&&(i=!0),i};let n;do{e+=1,(t+=1)>=i?e=0:n=this._imagesBuffer[t]}while(e>0&&(!n||!s(n)));return e}createAnimation(t,e){let i=!1,s=0,n=0,o=!1;switch(t){case"as-row":t="sphere",i=!0,o=!0;break;case"as-sphere":t="sphere",o=!0;break;case"as-full":t="full",o=!0;break;case"as-helix":t="sphere",o=!0;break;case"intro":t="intro",i=!0;break;case"twitch":t="twitch";break;case"spin":case"momentum":t="sphere",i=!0;break;case"sphere":t="sphere";break;default:s=t.cols,n=t.rows,t="custom"}return this._imagesBuffer=g[t]({justFirstLine:i,swapSides:this.o.swapSides,isBackward:e,count:t,additionalFrame:o,row:{length:this.rowCount,loop:this.o.loopRow,current:this._currentRow,jumpCount:n},column:{length:this.frameCount,loop:this.o.loopColumn,current:this._currentColumn,jumpCount:s}}),this._imagesBuffer.length}clearFramesQueue(){this._imagesBuffer=[]}cancelLoadingImage(t){const e=this.getImage();e&&(t=this.setImageSettings(t),e.cancelLoadingImage(t))}get startRow(){return this._startRow}get startColumn(){return this._startColumn}get currentRow(){return this._currentRow}get currentColumn(){return this._currentColumn}get imagesBuffer(){return this._imagesBuffer}destroy(t){this.destroyed=!0,this.resetPreparedImage(),this.clearFramesQueue(),this.images.forEach((t=>{t.forEach((t=>{t.destroy()}))})),this.off("imageOnload"),this.off("imageOnerror"),this.loadingMap={queue:[]},this.imgMap=[],this.images=[],this._currentColumn=0,this._currentRow=0,super.destroy()}}})(),S="smv";class v{constructor(t,e){this.parentNode=t,this.activeNode=e,this.activatedCurtain=d.$new("div").addClass("spin-activated-curtain").setCss({top:0,left:0,width:"100%",height:"100%",position:"absolute","z-index":999999999}),this.state=0}show(){this.state&&(this.activatedCurtain.setCssProp("display","block"),this.activeNode.addClass(S+"-activated"))}hide(){this.state&&(this.activatedCurtain.setCssProp("display","none"),this.activeNode.removeClass(S+"-activated"))}activateCurtain(){this.state||(this.state=1,this.activeNode.addClass(S+"-sleeping"),this.parentNode.append(this.activatedCurtain))}deactivateCurtain(){this.state&&(this.state=0,this.activeNode.removeClass(S+"-sleeping"),this.activatedCurtain.remove())}addTapEvents(t){this.activatedCurtain.addEvent("tap",(e=>{this.state&&(e.action="activate",t(e))})),this.activeNode.addEvent("tap",(e=>{this.state&&(e.action="deactivate",t(e))}))}addPinchEvent(t){this.activeNode.addEvent("pinch",t)}removePinchEvent(t){this.activeNode.removeEvent("pinch",t)}destroy(){this.state=1,this.hide(),this.deactivateCurtain(),this.removePinchEvent(),this.activeNode.removeEvent("tap"),this.activatedCurtain.remove(),this.activatedCurtain.removeEvent("tap"),this.activatedCurtain=null}}const I=t=>{t.stopDefaults()};return class extends a{constructor(t,e){super(t,e,u),this.type=i.SLIDE.TYPES.SPIN,this.canvas=null,this.canvasContainer=d.$new("div").addClass("spin-canvas-container"),this.coreNode=d.$new("div").addClass("sirv-spin"),this.instanceNode.append(this.coreNode),this.ctx=null,this.isSmoothing=!1,this.smoothingTimeout=null,this.minFrameSize=0,this.minRowSize=0,this.size={width:0,height:0},this.isDragMove=!1,this.longTapTimer=!1,this.imagesMap=null,this.isInited=!1,this.loader=null,this.hint=null,this.openedImg=null,this.scale=1,this.cssId=-1,this.boxBoundaries=null,this.hotspots=null,this.animationFX=null,this.loadedImages=[],this.currentSize={width:0,height:0},this.currentImageSize={width:0,height:0},this.standardSize={width:0,height:0},this.lastImg=null,this.startLoadingTime=null,this.isOver=!1,this.isSpinActivated=!d.browser.mobile,this.canvasPromise=null,this.firstImageLoaded=!1,this.firstImagesPartLoaded=!1,this.isInfoLoaded=!1,this.customActionWas=!1,this.isAutoplayPaused=!1,this.reflectDirection=!1,this.instanceUrl||(this.instanceUrl=this.instanceNode.attr("data-config")||""),this.configPath="/"+this.instanceUrl.replace(this.baseUrl.replace(/(^https?:\/\/[^/]*).*/,"$1/"),"");const s=this.instanceUrl.replace(/^http(s)?:\/\//,"");this.configHash=d.getHashCode(s),this.sessionId=d.getHashCode(s+d.D.node.location.href.replace(/^http(s)?:\/\//,"")+Date.now()),this.layers={},this.imageSettings={},this.fullscreenStartTime=0,this.meta={},this.isFullscreen=e.isFullscreen,this.nativeFullscreen=e.nativeFullscreen,this.infoSettings={},this.autospinResumeTimer=null,this.isHidden=!1,this.sessionStartTime=0,this.animationCloud=null,this.touchDragCloud=null,this.slideDragEventStart=!1,this.dppx=null,this.startTimeForZommEvent=null,this.resizeAnimationTimer=n.debounce((()=>{this.animate("inactive")}),1e3),this.keyPressHandlerForShiftButton=null,this.firstUserInteraction=!1,this.userColumn=0,this.userRow=0,this.placeholder=this.instanceNode.node.querySelector("img"),this.placeholder&&(this.placeholder=c(this.placeholder)),this.replaceTextParamURLFromMetadata(),this.trackUnload=()=>{this.sendStats("Page Unload",Date.now()-this.sessionStartTime,{message:"Stopped"},!0)},this.disableScrollOnMobile=()=>{const t=d.D.fullSize,e=this.instanceNode.size;Math.abs(e.height-t.height)<=50?this.instanceNode.addEvent("touchmove",I):this.instanceNode.removeEvent("touchmove",I)},this.resizeWindowTimer=null,this.windowResizeCallback=()=>{clearTimeout(this.resizeWindowTimer),this.resizeWindowTimer=setTimeout((()=>{this.disableScrollOnMobile()}),10)},this.api=Object.assign(this.api,{isInitialized:this.isInitialized.bind(this),play:this.play.bind(this),pause:this.pause.bind(this),rotate:this.rotateXY.bind(this),rotateX:this.rotateX.bind(this),rotateY:this.rotateY.bind(this),jump:this.jump.bind(this),jumpRows:this.jumpRows.bind(this),jumpCols:this.jumpCols.bind(this),currentFrame:this.currentFrame.bind(this)}),this.createHotspotsClass(m),this.getInfo().then((()=>{d.browser.mobile&&this.option("tappingFirst")?this.activatedCurtain=new v(this.instanceNode,this.coreNode):this.isSpinActivated=!0,this.createMap(this.quality,this.hdQuality,this.isHDQualitySet)})).catch((t=>{}))}isInitialized(){return this.isInited}rotateXY(t,e){return!(!this.ready||this.isZoomed())&&this.rotate(t,e)}rotateX(t){return!(!this.ready||this.isZoomed())&&this.rotate(t,null)}rotateY(t){return!(!this.ready||this.isZoomed())&&this.rotate(null,t)}jump(t){return this.jumpRows(t)}jumpRows(t){return!(!this.ready||this.isZoomed())&&this.jumpTo(t,"row")}jumpCols(t){return!(!this.ready||this.isZoomed())&&this.jumpTo(t,"col")}currentFrame(){return this.ready?this.getCurrentFrame():null}isActive(){return this.isSpinActivated}makeGlobalOptions(t){const e=this._options.options;return t.fromJSON(e.common.common),this.infoSettings&&Object.entries(this.infoSettings).forEach((e=>{["images","hotspots"].includes(e[0])||t.set(...e)})),t.fromString(e.local.common),t.fromString(this.instanceNode.attr("data-options")||""),t}makeOptions(){var t;return this._options.options=((t=this._options.options).common||(t.common={}),t.common.common||(t.common.common={}),t.common.mobile||(t.common.mobile={}),t.local||(t.local={}),t.local.common||(t.local.common=""),t.local.mobile||(t.local.mobile=""),t),super.makeOptions()}sendStats(t,e,i,s){const n={account:this.config.account,useBeacon:!!s,event:t,eventTime:e,sessionId:this.sessionId,origin:this.configPath};i&&(n.data=i),this.emit("stats",{data:n})}getInfo(){return this.gettingInfoPromise||(this.gettingInfoPromise=new Promise(((t,e)=>{this.waitGettingInfo.wait((()=>{const i="sirv_spin_info_v1_"+this.configHash,s=this.instanceUrl+(d.stringHas(this.instanceUrl,"?")?"&":"?")+"info="+i;n.getRemoteData(s,i,this.referrerPolicy).then((i=>{this.destroyed||(i.layers?(this.config=i,this.layers=this.config.layers,this.meta=this.config._file.meta||null,this.infoSettings=this.config.settings,this.hotspotsData=this.config.settings.hotspots||[],this.imageSettings=this.config.settings.images.main,this.accountInfo={account:this.config.account,branded:this.config.branded},this.sessionStartTime=Date.now(),this.sendStats("sessionStart",this.sessionStartTime),d.W.addEvent("beforeunload",this.trackUnload),t()):i.contentType&&/image/.test(i.contentType)||i._isplaceholder?e({error:"changeSpinToImage",isPlaceholder:i._isplaceholder,account:i.account}):e({error:{status:404}}))})).catch((t=>{this.destroyed||e({error:t})}))}))}))),this.gettingInfoPromise}replaceTextParamURLFromMetadata(){this.imageSettings.text&&this.imageSettings.text.text&&(this.imageSettings.text.text=this.imageSettings.text.text.replace(/\$\{spin\.(title|description)\}/g,((t,e)=>{const i=this.meta[e]||"";return"string"==typeof i?i:e})),""===this.imageSettings.text.text&&delete this.imageSettings.text)}getDPPX(t){const e=t.height>t.width?"height":"width",i={};i[e]=t[e],this.dppx=n.getDPPX(r.roundImageSize(i)[e],this.infoSize[e],this.upscale)}showHint(){let t=!1;return this.hint&&(this.always&&![i.FULLSCREEN.OPENING,i.FULLSCREEN.OPENED].includes(this.fullscreenState)||this.option("autospin.enable")&&this.firstUserInteraction||(t=!0,this.hint.show())),t}onStartActions(){this.ready?this.animate("slideIn"):this.isStarted&&(this.isInited&&!this.initNameEvent?this.loadPrimaryImages():this.isInView&&this.loadFirstImage())}onStopActions(){this.zoomOut(),this.stopSmoothing(),this.stopAnimation(),this.deactivateSpin(),this.setUserFrame(),this.customActionWas=!1,this.hint&&this.hint.hide(),super.onStopActions()}onInView(t){t?this.isInView||(this.ready?(this.isInView=!0,this.animate("inView")):(this.preload||this.isSlideShown)&&(this.isInView=!0,this.isInited?this.isSlideShown&&!this.initNameEvent&&this.loadPrimaryImages():this.loadFirstImage())):this.isInView&&this.ready&&(this.option("autospin.enable")?this.animationCloud.pause():(this.stopAnimation(),this.setUserFrame()),this.deactivateSpin())}startFullInit(t){this.isStartedFullInit||(super.startFullInit(t),this.getInfo().then((()=>{this.normalizeOptions(),this.getId("spin-");const t=this.option;this.imagesMap.startFullInit({swapSides:t("swapSides"),startColumn:t("column.start"),startRow:t("row.start"),reverseColumn:t("column.reverse"),reverseRow:t("row.reverse"),loopColumn:t("column.loop"),loopRow:t("row.loop"),rowSpeed:t("row.sensitivity"),columnSpeed:t("column.sensitivity"),columnIncrement:t("column.increment"),rowIncrement:t("row.increment")}),this.loadedImages=this.imagesMap.map,this.loader=new l(this.coreNode,{max:this.imagesMap.imageCount,class:"spin-loader"}),this.loader.parentClass=this,this.coreNode.addEvent(["btnclick","tap"],(t=>{t.stop()})),this.on("isSingleSlide",(t=>{t.stop(),this.activatedCurtain&&(t.data.isSingle?this.activatedCurtain.deactivateCurtain():this.activatedCurtain.activateCurtain())})),this.hotspots&&(this.hotspots.Options={columnsRevers:this.option("column.reverse"),rowsRevers:this.option("row.reverse"),rows:this.imagesMap.rowCount,columns:this.imagesMap.frameCount}),this.initAnimation()})).catch((()=>{})),d.browser.touchScreen&&this.on("dragEvent",(t=>{"dragstart"===t.data.type?(this.slideDragEventStart=!0,this.touchDragCloud&&this.touchDragCloud.removeEvent()):"dragend"===t.data.type&&(this.slideDragEventStart=!1,this.touchDragCloud&&this.touchDragCloud.addEvent())})))}getThumbnailData(t){return this.imagesMap.getThumbnail(t)}setUserFrame(){this.jumpTo(this.userRow,"row"),this.jumpTo(this.userColumn,"col")}getSocialButtonData(t,e){return e?this.instanceNode.attr("data-src"):super.getSocialButtonData(t)}turnOnOff(){d.browser.mobile&&this.activatedCurtain&&this.activatedCurtain.addTapEvents((t=>{"activate"===t.action?(this.isSpinActivated||(t.stop(),this.activateSpin()),this.hotspots&&this.hotspots.hideActiveHotspotBox(!0)):this.isSpinActivated&&(t.stop(),this.stopSmoothing(),this.stopAnimation(),this.hotspots&&this.hotspots.isHotspotActivated()?this.hotspots.hideActiveHotspotBox(!0):this.deactivateSpin())}))}activateSpin(){this.isSpinActivated||(this.isSpinActivated=!0,d.browser.mobile&&(this.stopAnimation(),this.customActionWas=!0,this.hint&&this.hint.hide(),this.activatedCurtain&&this.activatedCurtain.hide()))}deactivateSpin(){this.isSpinActivated&&(this.isSpinActivated=!1,d.browser.mobile&&(this.customActionWas||this.showHint(),this.activatedCurtain&&this.activatedCurtain.show()))}createPinchEvent(){let t,e,s,n,o,a,r,h,l;const m=()=>{o=1,a=1,s=this.zoom.baseScale.x,r=1,h=s,t=1-s};super.createPinchEvent(this.coreNode),this.pinchCloud.onPinchStart=t=>{[i.FULLSCREEN.OPENING,i.FULLSCREEN.CLOSING].includes(this.fullscreenState)||(this.pinchCloud.pinch=!0,clearTimeout(this.longTapTimer),this.stopSmoothing(),this.stopAnimation(),this.touchDragCloud&&this.touchDragCloud.removeEvent(),this.hotspots&&this.hotspots.hideActiveHotspotBox(!0),this.customActionWas=!0,l=!1,this.pinchCloud.scale=t.scale,n=1,this.openedImg&&(n=this.zoom.scale.x,s===d.U&&m(),n/=s),this.sendEvent("pinchStart"))},this.pinchCloud.onPinchResize=t=>{this.pinchCloud.pinch&&!this.pinchCloud.block&&this.zoom&&this.fullscreenState===i.FULLSCREEN.OPENED&&this.openedImg&&(this.pinchCloud.scale=t.scale,this.zoom.basePercent=t.centerPoint)},this.pinchCloud.onPinchMove=d=>{this.pinchCloud.pinch&&!this.pinchCloud.block&&(this.fullscreenState!==i.FULLSCREEN.OPENED&&this.isFullscreenEnabled?d.scale>=2&&(this.pinchCloud.block=!0,this.sendEvent("fullscreenIn")):this.openedImg?this.zoom&&(l?(e=d.scale,e*=s,r<e&&(r=e,h=s,a=1,o=t/(r-s)),h>e&&(h=e,r=1,o=1,a=s/h),e*=n,e=(s+(e-s)*o)*a,this.zoom.setScale(e,d.centerPoint.x,d.centerPoint.y)):(l=!0,this.zoom.basePercent=d.centerPoint),this.pinchCloud.scale=d.scale):d.scale>1.1?(this.firstUserInteraction=!0,this.openLens(d.centerPoint.x,d.centerPoint.y,!1,"zero"),m(),n=1):d.scale<.2&&(this.pinchCloud.block=!0,this.sendEvent("fullscreenOut")))},this.pinchCloud.onPinchEnd=t=>{this.pinchCloud.pinch&&(this.pinchCloud.pinch=!1,this.openedImg&&this.activateSpin(),setTimeout((()=>{this.touchDragCloud&&this.touchDragCloud.addEvent()}),16),this.sendEvent("pinchEnd")),this.openedImg&&this.pinchCloud.removeEvent(),this.pinchCloud.block=!1,this.pinchCloud.scale=0}}onStopContext(){this.stopSmoothing(),this.stopAnimation(),this.hint&&this.hint.hide()}onSecondSelectorClick(){this.zoomOut()}setGlobalEvents(){this.on("zoomUp",(t=>{const e=t.data;t.stop(),this.ready&&this.zoom&&!this.isDragMove&&this.isFullscreenActionEnded()&&(this.firstUserInteraction=!0,this.openLens(e.x,e.y))})),this.on("zoomDown",(t=>{t.stop(),this.ready&&this.zoom&&this.isZoomed()&&this.zoom.hide()}))}normalizeOptions(){this.option("autospin.enable")||this.option("autospin.duration",0),this.option("swapSides")&&["start","loop","increment","reverse","sensitivity"].forEach((t=>{const e=this.option("row."+t);this.option("row."+t,this.option("column."+t)),this.option("column."+t,e)})),["onStart","onVisible","onInactive"].forEach((t=>{const e="hint."+t+".effect";"none"===this.option(e)&&this.option(e,!1)})),d.browser.mobile&&"load"!==this.option("initialize")&&this.option("initialize","tap"),this.setDefaultZoomOptions(),this.option("zoom.enable")&&"max"!==this.option("zoom.ratio")&&this.option("zoom.ratio")<i.MIN_RATIO&&this.option("zoom.enable",!1)}setDefaultZoomOptions(){super.setDefaultZoomOptions(),this.defaultZoomOptions=Object.assign(this.defaultZoomOptions,{tiles:this.option("zoom.tiles"),pan:this.option("zoom.pan"),trigger:d.browser.mobile?"dblclick":"click",type:"inner",height:"auto"})}loadPrimaryImages(){this.firstImagesPartLoaded||(this.firstImagesPartLoaded=!0,this.startLoadingTime=Date.now(),this.imagesMap.loadPrimaryImages({width:this.currentImageSize.width,height:this.currentImageSize.height,dppx:this.dppx}),this.loader&&this.loader.show())}isThumbnailGif(){return"gif"===this.option("thumbnail.type")}init(){if(this.infoSize&&!this.isInited){switch(this.isInited=!0,this.initNameEvent=null,this.initFnEvent=t=>{t.stop(),this.coreNode.removeEvent(t.type,this.initFnEvent),this.activatedCurtain&&this.activatedCurtain.activatedCurtain.removeEvent(this.initNameEvent,this.initFnEvent),this.loadPrimaryImages()},this.option("initialize")){case"hover":this.initNameEvent="mouseover";break;case"click":this.initNameEvent="btnclick";break;case"tap":this.initNameEvent="tap"}this.initNameEvent?(this.coreNode.addEvent(this.initNameEvent,this.initFnEvent),this.activatedCurtain&&this.activatedCurtain.activatedCurtain.addEvent(this.initNameEvent,this.initFnEvent),this.loadFirstImage()):this.isInView&&this.isSlideShown&&this.loadPrimaryImages(),this.sendEvent("init")}}run(t,e,i){const s=super.run(t,e,i);return s&&(d.W.addEvent("resize",this.windowResizeCallback),this.initCanvas(),this.startGettingInfo()),s}initCanvas(){this.canvas=d.$new("canvas"),this.canvas.node.getContext&&(this.ctx=this.canvas.node.getContext("2d"));const t=this.rightAlt;t&&(this.canvas.attr("role","img"),this.canvas.attr("aria-label",t),this.canvas.attr("alt",t));let e=this.infoSize.width,i=this.infoSize.height;const s=this.coreNode.size;e<s.width&&(e=s.width),i<s.height&&(i=s.height),0===s.height&&(this.cssId=d.addCSS("#"+this.id+" .smv-spin:before",{"padding-top":this.infoSize.height/this.infoSize.width*100+"%"},this.id+"-css"),s.height=s.width*(this.infoSize.height/this.infoSize.width)),this.currentSize=n.spinLib.calcProportionSize(s,this.infoSize),this.getDPPX(this.currentSize),this.standardSize.width=this.currentSize.width,this.standardSize.height=this.currentSize.height,this.setImageSize(),this.canvas.setCss({top:"0",left:"0",zIndex:10,position:"absolute"}),this.setCanvasSize(),this.canvasContainer.append(this.canvas),this.coreNode.append(this.canvasContainer),this.isInView&&(this.preload||this.isSlideShown)&&this.loadFirstImage()}loadContent(){this.loadFirstImage()}loadFirstImage(){if(!this.firstImageLoaded&&this.isInfoLoaded){if(this.currentImageSize.width&&this.currentImageSize.height||(this.currentSize=n.spinLib.calcProportionSize(this.coreNode.size,this.infoSize),this.getDPPX(this.currentSize),this.currentSize.width&&this.currentSize.height&&(this.setImageSize(),this.isStarted&&this.currentImageSize.width&&this.currentImageSize.height&&(this.setCanvasSize(),this.draw()))),!this.currentImageSize.width||!this.currentImageSize.height)return;this.waitToStart.start(),this.firstImageLoaded=!0,this.imagesMap.loadFirstImage({width:this.currentImageSize.width,height:this.currentImageSize.height,dppx:this.dppx})}}get rightAlt(){let t=null;return t=!this.dataAlt&&this.meta&&this.meta.description?this.meta.description:this.dataAlt,t}createMap(t,e,i){const s=this.option;let n=null;s("autospin.enable")?n=s("autospin.type"):s("hint.onStart.enable")&&s("hint.onStart.effect")&&(n=s("hint.onStart.effect")),this.imagesMap=new f({url:this.baseUrl,imageSettings:this.imageSettings,layers:this.layers,swapSides:s("swapSides"),startColumn:s("column.start"),startRow:s("row.start"),reverseColumn:s("column.reverse"),reverseRow:s("row.reverse"),loopColumn:s("column.loop"),loopRow:s("row.loop"),rowSpeed:s("row.sensitivity"),columnSpeed:s("column.sensitivity"),columnIncrement:s("column.increment"),rowIncrement:s("row.increment"),loadingSchema:n,quality:t,hdQuality:e,isHDQualitySet:i,referrerPolicy:this.referrerPolicy}),this.imagesMap.parentClass=this,this.userColumn=this.imagesMap.startColumn,this.userRow=this.imagesMap.startRow,this.on("mapFirstImageLoaded",(t=>{if(t.stopAll(),this.placeholder&&this.placeholder.setCssProp("display","none"),this.isInited||(this.firstImageLoaded&&(this.draw(),this.canvas.setCssProp("transition","none"),this.canvas.render(),this.canvas.setCssProp("transition","")),this.loader&&this.loader.progress(),this.setCanvas().finally((()=>{this.init()}))),this.hotspots){const t=this.imagesMap.getCurrentImage({width:this.currentSize.width,height:this.currentSize.height});this.hotspots.setFramePosition(t.row,t.col),this.hotspots.updateAndShow(),this.isInView&&this.isSlideShown&&this.hotspots.showNeededElements()}})),this.on("mapImagesReady",(t=>{t.stopAll(),this.imagesMap.loadSecondaryImages({width:this.currentImageSize.width,height:this.currentImageSize.height,dppx:this.dppx}),this.calcMinSizeForDrag();const e=Date.now();this.sendStats("framesPreloaded",e-this.sessionStartTime,{duration:e-this.startLoadingTime}),this.done(),this.sendContentLoadedEvent()})),this.on("mapImageLoaded",(t=>{t.stopAll(),this.loader&&(this.loadedImages[t.data.row][t.data.col]||(this.loadedImages[t.data.row][t.data.col]=!0,this.loader.progress())),t.data.error||t.data.isCurrent&&(t.data.callbackData.lens?this.zoom&&(this.zoom.shown||this.zoom.showing)&&this.openedImg&&this.openedImg.col===t.data.col&&this.openedImg.row===t.data.row&&this.zoom.addLoadedImage(t.data):this.lastImg&&(this.lastImg.width!==t.data.width||this.lastImg.height!==t.data.height)&&this.firstImageLoaded&&this.draw())})),this.on("mapAllImagesLoaded",(t=>{t.stopAll();const e=Date.now();this.sendStats("framesLoaded",e-this.sessionStartTime,{duration:e-this.startLoadingTime}),this.loader&&2!==this.loader.getProgressState()&&this.loader.hide()})),this.on("frameChange",(t=>{t.stop(),this.ready&&this.sendEvent("frameChange",{row:t.data.row,column:t.data.column})})),this.imagesMap.loadImageInfo().then((t=>{this.isInfoLoaded=!0;const e=Object.assign({},t.size);this.infoSize=e,this.hotspots&&(this.hotspots.originImageSize=this.infoSize)})).catch((t=>{this.isInfoLoaded=!0}))}getSelectorImgUrl(t){return new Promise(((e,i)=>{this.getInfo().then((()=>{this.imagesMap.loadImageInfo().then((i=>{this.waitToStart.wait((()=>{const i=this.imagesMap.setImageSettings({dppx:this.dppx});i.src&&(t.src=i.src),t.srcset=i.srcset,"gif"===this.option("thumbnail.type")&&(t.originUrl=this.baseUrl,t.imageSettings={image:24},this.option("thumbnail.gifParams")&&(t.imageSettings=n.paramsFromQueryString(this.option("thumbnail.gifParams")))),e(Object.assign(this.imagesMap.getThumbnail(t),{alt:this.rightAlt}))}))})).catch(i)})).catch(i)}))}getInfoSize(){return new Promise(((t,e)=>{this.getInfo().then((()=>{this.imagesMap.loadImageInfo().then(t).catch(e)})).catch(e)}))}onHotspotActivate(t){this.customActionWas=!0,this.stopAnimation(),super.onHotspotActivate(t)}onHotspotDeactivate(t){super.onHotspotDeactivate(t),this.animateWithDelay()}createHint(){if(!this.option("hint.message.enable"))return;let t='<div class="spin-hint-animation"></div>';const e=["spin-hint-horizontal-animation"],i=["spin-hint-vertical-animation"];let s=[];switch(t+="<span>",t+=this.option("hint.message.text"),t+="</span>",this.imagesMap.getHintType()){case"multi-row":s=e.concat(i);break;case"row":s=e;break;case"col":s=i}const n={html:t,additionalClass:s};(d.browser.mobile||this.option("autospin.enable"))&&(n.autohide=0),this.hint=new h(this.coreNode,n),this.isSlideShown&&this.isInView&&"infinite"===this.option("autospin.type")&&this.showHint()}get imageClassContainer(){return this.imagesMap}createZoom(){let t=null;return!this.destroyed&&this.option("zoom.enable")&&(t=super.createZoom(this.coreNode,{}),this.zoomContainer&&(this.zoom.lensContainer=this.zoomContainer),this.coreNode.addEvent(["btnclick","dbltap"],(t=>{this.isFullscreenActionEnded()&&(this.firstUserInteraction=!0,this.openLens(t.x,t.y))})),d.browser.mobile),t}onZoomGetImage(t){super.onZoomGetImage(t),this.checkImage(t.data,t.data.dontLoad)?this.zoom.addLoadedImage(this.imagesMap.getCurrentImage(t.data)):this.imagesMap.loadImage(t.data)}onZoomCancelLoadingOfTiles(t){super.onZoomGetImage(t),t.data.round=!1,this.imagesMap.cancelLoadingImage(t.data)}onZoomBeforeShow(t){this.canvas.addClass(this.zoomClassName),this.hotspots&&this.hotspots.hideAll()}onZoomShown(t){this.isSlideShown?(this.startTimeForZommEvent=Date.now(),this.openedImg&&this.sendStats("zoomIn",Date.now()-this.sessionStartTime,{frame:{row:this.openedImg.row,column:this.openedImg.col},clientX:t.data.clientPosition.x,clientY:t.data.clientPosition.y,pageX:t.data.pagePosition.x,pageY:t.data.pagePosition.y}),this.sendEvent("zoomIn")):this.zoom.hide(!0)}onZoomHidden(t){if(this.openedImg){this.canvas.removeClass(this.zoomClassName);const e=Date.now();this.sendStats("zoomOut",e-this.sessionStartTime,{duration:e-this.startTimeForZommEvent,frame:{row:this.openedImg.row,column:this.openedImg.col},clientX:t.data.clientPosition.x,clientY:t.data.clientPosition.y,pageX:t.data.pagePosition.x,pageY:t.data.pagePosition.y}),this.hotspots&&(this.hotspots.showAll(),this.isInView&&this.isSlideShown&&this.hotspots.showNeededElements())}this.sendEvent("zoomOut"),this.isSlideShown&&this.animateWithDelay(),this.startTimeForZommEvent=null,this.openedImg=null,this.pinchCloud&&this.pinchCloud.addEvent()}setLongTapEvents(){const t=d.W.node.navigator.pointerEnabled;let e=!1,i=!1,s=["touchstart"];t?s.push("pointerdown"):s.push("MSPointerDown"),this.coreNode.addEvent(s,(t=>{this.isDragMove||this.pinchCloud.pinch||!this.isFullscreenActionEnded()||(clearTimeout(this.longTapTimer),this.longTapTimer=setTimeout((()=>{t.stop(),e=!0,this.customActionWas=!0;const i=t.pageXY;this.touchDragCloud&&this.touchDragCloud.removeEvent(),this.firstUserInteraction=!0,this.openLens(i.x,i.y,!0)}),500),i=!0)})),s=["touchmove"],t?s.push("pointermove"):s.push("MSPointerMove"),this.coreNode.addEvent(s,(t=>{if(e&&this.isFullscreenActionEnded()){t.stop();const e=t.pageXY;this.zoom.customMove(e.x,e.y)}}),1),s=["touchend"],t?s.push("pointerup"):s.push("MSPointerUp"),this.coreNode.addEvent(s,(t=>{i&&(t.stop(),i=!1,clearTimeout(this.longTapTimer)),e&&this.isFullscreenActionEnded()&&(t.stop(),e=!1,this.zoom.hide(!0),this.touchDragCloud&&this.touchDragCloud.addEvent())}))}get zoomSize(){const t=this.option("zoom.ratio"),e=this.infoSize.width,i=this.infoSize.height;let s={width:e,height:i};return"max"!==t&&(s.width=this.currentImageSize.width*t,s.height=this.currentImageSize.height*t,s=r.roundImageSize(s)),s.width=Math.min(e,s.width),s.height=Math.min(i,s.height),{width:s.width,height:s.height,originWidth:e,originHeight:i}}openLens(t,e,i,s){let n=!1;if(this.isZoomSizeExist()){const o=this.zoomSize;n=!0,this.stopSmoothing(),this.stopAnimation(),this.hint&&this.hint.hide(),this.hotspots&&this.hotspots.hideActiveHotspotBox(!0);let a,r,h=!1;this.isFullscreenActionEnded()&&this.imagesMap.isLoaded({width:this.currentImageSize.width,height:this.currentImageSize.height})?(a=this.currentImageSize.width,r=this.currentImageSize.height,h=!0):(a=this.lastImg.serverWidth,r=this.lastImg.serverHeight);const l=this.imagesMap.getCurrentImage({width:a,height:r,round:h});this.openedImg=l,n=void 0===t?this.zoom.showCenter(l.node,o):this.zoom.show(l.node,o,t,e,i,s)}return n}done(){const t=this.imagesMap.rowCount,e=this.imagesMap.frameCount;if(this.loader&&this.loader.setMaxOpacity(.5),this.setBrowserEvents(),this.createHint(),this.createZoom(),this.setZoomEvents(),t>1&&e>1?this.coreNode.setCssProp("touch-action","none"):t>1?this.coreNode.setCssProp("touch-action","pan-x"):this.coreNode.setCssProp("touch-action","pan-y"),this.boxBoundaries=this.coreNode.rect,this.animate("start"),this.accountInfo.branded){const t=s.getNodeWithSirvClassName(this.instanceNode)||d.D.node.head||d.D.node.body;s.rootDOM.showSirvAd(t,this.instanceNode,"https://sirv.com/about-spin/?utm_source=client&utm_medium=sirvembed&utm_content=typeofembed(spin)&utm_campaign=branding","360-degree viewer by Sirv")}this.sendStats("viewerReady",Date.now()-this.sessionStartTime,{rows:this.imagesMap.rowCount,columns:this.imagesMap.frameCount,viewerSize:{width:this.currentSize.width,height:this.currentSize.height}}),this.isZoomSizeExist()&&this.coreNode.addClass(i.CSS_CURSOR_ZOOM_IN),this.setGlobalEvents(),this.turnOnOff(),super.done(),this.hotspots&&(this.hotspots.instanceComponentNode=this.canvasContainer,this.hotspots.containerSize=this.canvasContainer.node.getBoundingClientRect())}setBrowserEvents(){this.setDrag(this.coreNode),this.setMouseWheel(this.coreNode)}setCanvas(){if(!this.canvasPromise){let t,e,i=null;this.canvasPromise=n.makeQueryblePromise(new Promise(((s,n)=>{t=s,this.firstImageLoaded&&this.draw(),this.isInView&&this.isSlideShown?(i=setTimeout((()=>{this.canvas&&this.canvas.removeEvent("transitionend",e),s()}),1100),e=t=>{"opacity"===t.propertyName&&(t.stop(),clearTimeout(i),this.canvas.removeEvent(t.type,e),s())},this.canvas.addEvent("transitionend",e),this.canvas.render(),this.canvas.addClass(S+"-shown")):(this.canvas.addClass(S+"-shown"),s())}))),this.canvasPromise.resolve=()=>{this.canvas.removeEvent("transitionend",e),t()}}return this.canvasPromise}clearCanvas(){this.ctx&&this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}draw(t){if(this.ctx){const e=t||this.currentImageSize,i={width:e.width,height:e.height,maxSize:!0,dppx:this.dppx},s=this.imagesMap.getCurrentImage(i);if(this.lastImg=s,!s)return;this.ctx.imageSmoothingQuality="high",this.hotspots&&this.hotspots.changeHotspotsPosition(s.row,s.col),this.clearCanvas(),this.canvas.node.width=s.node.node.width,this.canvas.node.height=s.node.node.height,this.ctx.drawImage(s.node.node,0,0,this.canvas.node.width,this.canvas.node.height)}}setCanvasSize(){const t=this.currentSize;this.canvas.setCss({width:t.width,height:t.height}),this.canvasContainer.setCss({width:t.width,height:t.height}),this.canvas.width=t.width,this.canvas.height=t.height}calcMinSizeForDrag(){const t=this.currentSize;this.minFrameSize=this.imagesMap.pixelPerFrame(t.width),this.minRowSize=this.imagesMap.pixelPerRow(t.height)}smoothing(t,e,i){if(!e)return;let s=t/e;const n=()=>{s*=.97,this.smoothingTimeout=setTimeout((()=>{this.imagesMap.prepareFutureImage(i),this.imagesMap.setPreparedFutureImage(),this.draw(),s>.3&&n()}),this.minFrameSize/s)};this.isSmoothing||(this.isSmoothing=!0,n())}stopSmoothing(){this.isSmoothing&&(this.isSmoothing=!1,clearTimeout(this.smoothingTimeout),this.smoothingTimeout=null,this.imagesMap.resetPreparedImage())}animateWithDelay(t){let e="inactive";t&&(e=t),this.option("autospin.enable")?(clearTimeout(this.autospinResumeTimer),this.autospinResumeTimer=setTimeout((()=>{this.animate(e)}),this.option("autospin.resume"))):this.animate(e)}setDrag(t){const e=this.imagesMap.rowCount,s=this.imagesMap.frameCount,o=e>1&&s>1,a={x:{minSize:this.minFrameSize,count:s},y:{minSize:this.minRowSize,count:e}},r=this.option("freeDrag");let h={x:0,y:0},l={x:0,y:0},m=null;o||(m=s>1?"x":"y");let d,c=null;const u={};let p,g,w={x:{next:0,prev:0},y:{up:0,down:0}},f=!1;const S=n.debounce((()=>{f=!1}),50),v=65e-5,I={x:v*s*9.8,y:v*e*9.8},C={x:["prev","next"],y:["down","up"]};!o&&r&&(s>1?C.y=C.x:C.x=C.y);const y=t=>{clearTimeout(this.longTapTimer),u[t.state](t)},x=(t,e,i,s)=>{w[t][s]+=i},b=t=>{const e=w[t];let i;const s="x"===t?["next","prev"]:["up","down"];return i=e[s[0]]>e[s[1]]?{distance:e[s[0]],direction:s[0]}:{distance:e[s[1]],direction:s[1]},i},z=(t,e,i,s,n)=>{let o;return o=e*Math.pow(i/s,2)/(2*t),o=Math.floor(o/n),o},E=(t,e,i,s)=>e*(i/s)/t,M=(t,e)=>C[e][t>=0?0:1];u.dragstart=t=>{this.firstUserInteraction=!0,this.isDragMove=!0,this.stopSmoothing(),this.stopAnimation(),this.hint&&this.hint.hide(),this.hotspots&&this.hotspots.hideNeededElements(!0),this.userColumn=this.imagesMap.startColumn,this.userRow=this.imagesMap.startRow,this.fullscreenState===i.FULLSCREEN.OPENED&&t.stop(),h.x=t.x,h.y=t.y,c=t.timeStamp,g=Date.now();const e=g-this.sessionStartTime;this.sendStats("dragStart",e,{clientX:t.x-this.boxBoundaries.left,clientY:t.y-this.boxBoundaries.top,pageX:t.x,pageY:t.y}),this.sendEvent("spinStart"),this.sendEvent("rotate"),this.sendStats("rotate",e,{}),this.pinchCloud&&this.pinchCloud.removeEvent()},u.dragend=t=>{let e,i,n,u,v;const C=[];if(this.isDragMove){t.stop(),this.isDragMove=!1,S.cancel(),f&&m===d||f&&(o||r)?(e=Date.now()-g,i=b(d),n=z(I[d],s,i.distance,e,a[d].minSize),u=E(I[d],s,i.distance,e),C.push({items:n,direction:i.direction}),o&&(i=b(p),n=z(I[p],s,i.distance,e,a[p].minSize),v=E(I[p],s,i.distance,e),v>u&&(u=v),C.push({items:n,direction:i.direction})),this.animateTo(u,C),this.pinchCloud&&this.pinchCloud.addEvent()):(this.hotspots&&this.isInView&&this.isSlideShown&&this.hotspots.showNeededElements(),this.animateWithDelay()),this.sendEvent("spinEnd");const y=Date.now();this.sendStats("dragEnd",y-this.sessionStartTime,{duration:y-g,clientX:t.x-this.boxBoundaries.left,clientY:t.y-this.boxBoundaries.top,pageX:t.x,pageY:t.y}),h={x:0,y:0},c=null,l={x:0,y:0},w={x:{next:0,prev:0},y:{up:0,down:0}},f=!1}};const P=(t,e)=>{let i=!1;if(l[t]>a[t].minSize){i=!0;const s=Math.floor(l[t]/a[t].minSize);l[t]=l[t]%a[t].minSize,this.imagesMap.prepareFutureImage(e,s),this.imagesMap.setPreparedFutureImage()}return i};u.dragmove=t=>{const n={},a={x:0,y:0},u={x:0,y:0};let g;this.isDragMove&&(f=!0,this.customActionWas=!0,a.x=t.x-h.x,a.y=t.y-h.y,u.x=Math.abs(a.x),u.y=Math.abs(a.y),g=t.timeStamp-c,c=t.timeStamp,d=u.x>=u.y?"x":"y",p="x"===d?"y":"x",(this.fullscreenState===i.FULLSCREEN.OPENED||o||r||"x"===d&&s>1||"y"===d&&e>1)&&t.stop(),n[d]=M(a[d],d),n[p]=M(a[p],p),x(d,0,u[d],n[d]),x(p,0,u[p],n[p]),o||r?(l.x+=u.x,l.y+=u.y):m&&(m===d&&"x"===m?l.x+=u.x:m===d&&"y"===m&&(l.y+=u.y)),P(d,n[d])&&r&&(l[p]=0),o&&P(p,n[p]),this.userColumn=this.imagesMap.currentColumn,this.userRow=this.imagesMap.currentRow,h.x=t.x,h.y=t.y,this.draw(),S())};const R={eventAdded:!1,addEvent:()=>{R.eventAdded||(R.eventAdded=!0,t.addEvent(["mousedrag","touchdrag"],y))},removeEvent:()=>{R.eventAdded&&(R.eventAdded=!1,t.removeEvent(["mousedrag","touchdrag"],y))}};this.touchDragCloud=R,this.slideDragEventStart||this.touchDragCloud.addEvent()}animateTo(t,e){const i=[],s=[],n={};clearTimeout(this.autospinResumeTimer),this.animationFX&&this.animationFX.stop();for(let t=0,o=e.length;t<o;t++)s.push(e[t].direction),i.push(0),n[e[t].direction]=[0,e[t].items];this.animationFX=new d.FX(d.$new("div"),{duration:Math.abs(t),transition:d.FX.getTransition().cubicIn,onBeforeRender:c(((t,e)=>{let s,n;for(s=0;s<t.length;s++)n=Math.round(e[t[s]]),i[s]!==n&&(this.imagesMap.prepareFutureImage(t[s],n-i[s]),this.imagesMap.setPreparedFutureImage(),this.userColumn=this.imagesMap.currentColumn,this.userRow=this.imagesMap.currentRow,i[s]=n);this.draw()})).bind(this,s),onComplete:()=>{this.stopAnimation(),this.animateWithDelay(),this.hotspots&&this.isInView&&this.isSlideShown&&this.hotspots.showNeededElements()}}).start(n)}setMouseWheel(t){let e,i;let s=0,o=!1;const a=n.debounce((t=>{o=!1,this.sendEvent("spinEnd"),t?s=0:this.animateWithDelay()}),200),r=this.imagesMap.rowCount,h=this.imagesMap.frameCount,l=r>1&&h>1,m=this.option("freeDrag");if(this.option("wheel")){let n=!1;this.keyPressHandlerForShiftButton=t=>{16===t.oe.keyCode&&(n="keydown"===t.type)},d.W.addEvent(["keydown","keyup"],this.keyPressHandlerForShiftButton),t.addEvent("mousescroll",(t=>{this.firstUserInteraction=!0;const h=!!t.isMouse&&n,d=Math.abs(t.deltaY)<Math.abs(t.deltaX);(d||l||m)&&(this.customActionWas=!0,t.stop(),this.animationFX&&(this.animationFX.stop(),this.animationFX=null),this.stopSmoothing(),this.stopAnimation(),this.hotspots&&this.hotspots.hideActiveHotspotBox(),o||(o=!0,this.sendEvent("spinStart"),this.sendEvent("rotate"),this.sendStats("rotate",Date.now()-this.sessionStartTime,{})),d?(e=t.deltaX,i=e>=0?"next":"prev"):(e=t.deltaY,i=r>1&&!h?e>=0?"down":"up":e>=0?"next":"prev"),t.isMouse?(e=e/Math.abs(e)*3,s+=Math.abs(e),this.animateTo(200,[{direction:i,items:s}])):(e*=.14814814814814814,s+=e,Math.abs(s)>1&&(e=parseInt(s,10),s-=e,this.imagesMap.prepareFutureImage(i,Math.abs(e)),this.imagesMap.setPreparedFutureImage(),this.draw())),a(t.isMouse))}))}}animate(t,e,i,s){const n="autoplay"===t||this.option("autospin.enable");if(!this.isInView||!this.isSlideShown||this.animationCloud.isMoving()||this.isDragMove||this.customActionWas&&!n&&!s||this.openedImg)return;if(this.animationCloud.isPaused())return void this.animationCloud.resume();clearTimeout(this.animationCloud.hintTimer),clearTimeout(this.autospinResumeTimer);let o=!1,a=null;if(n){if(this.isAutoplayPaused)return;a="as-"+(i||this.option("autospin.type")),"start"!==t&&(o=!0)}else{let e;switch(t){case"start":e="onStart";break;case"inView":case"slideIn":e="onVisible";break;case"inactive":o=!0,e="onInactive";break;default:a=t}if(e&&this.option("hint."+e+".enable")){const t=this.option("hint."+e+".effect");t&&(a=t)}}this.animationCloud.start({speed:e,type:a,infinite:n,delay:o,userInteraction:s},(()=>{const t=this.showHint();this.hotspots&&this.isInView&&this.isSlideShown&&this.hotspots.showNeededElements(),this.option("hint.onInactive.enable")&&(t?this.animationCloud.hintTimer=setTimeout((()=>{this.animationCloud.hintTimer=null,this.animate("inactive")}),this.hint.movingTime):this.animate("inactive"))}))}initAnimation(){let t,e;const i=this.option("swapSides")?this.imagesMap.rowCount:this.imagesMap.frameCount,s=Math.min(150*i,3600),n=t=>{let e=s;return this.instanceOptions.isset("speed")?0!==this.option("speed")&&(e=this.option("speed")):["as-row","as-sphere","as-full","as-helix"].includes(t)&&this.instanceOptions.isset("autospin.duration")&&0!==this.option("autospin.duration")&&(e=this.option("autospin.duration")),e},o={hintTimer:null,isMoving:()=>{var t;return null==(t=e)?void 0:t.isPlaying()},isPaused:()=>{var t;return null==(t=e)?void 0:t.isPaused()},start:(s,o)=>{if(e||!this.imagesMap||!s.type)return void o();const a=this.imagesMap.createAnimation(s.type,this.reflectDirection);if(!a)return void o();if(s.userInteraction&&this.imagesMap.imagesBuffer&&this.imagesMap.imagesBuffer.length){const t=this.imagesMap.imagesBuffer[this.imagesMap.imagesBuffer.length-1];this.userColumn=t.col,this.userRow=t.row}s.infinite&&this.showHint();let r=null;var h;e=new d.FX(d.$new("div"),{duration:Math.floor((s.speed||n(s.type))/i*a),transition:(h=s.type,"momentum"===h?[.645,.045,.355,1]:d.FX.getTransition().linear),cycles:s.infinite?"infinite":1,onBeforeRender:(t,e)=>{const i=Math.floor(t.value);r!==i&&(this.imagesMap.setNextAnimationFrame(i),this.imagesMap.setPreparedNextImage(),this.draw(),r=i)},onComplete:()=>{e=null,o()}});const l={value:[0,a-1]};s.delay&&!s.infinite?t=setTimeout((()=>{e.start(l)}),this.option("inactivity")):e.start(l)},resume:()=>{e&&e.resume()},pause:()=>{e&&(e.pause(),clearTimeout(o.hintTimer),clearTimeout(t))},stop:()=>{e&&(e.stop(),e=null,this.imagesMap.clearFramesQueue(),this.imagesMap.resetPreparedImage()),clearTimeout(t)}};this.animationCloud=o}stopAnimation(){this.animationFX&&(this.animationFX.stop(),this.animationFX=null),clearTimeout(this.autospinResumeTimer),this.animationCloud&&this.animationCloud.stop()}onBeforeFullscreenIn(t){this.stopSmoothing(),this.stopAnimation(),this.zoom&&this.zoom.hide(!0),this.deactivateSpin(),this.boxBoundaries=this.coreNode.rect,super.onBeforeFullscreenIn(t),this.hotspots&&this.hotspots.hideAll(),this.isInited&&this.isInView&&this.isSlideShown&&(this.isHidden=!0,this.canvas.setCss({opacity:0,visibility:"hidden"}))}onAfterFullscreenIn(t){this.infoSize&&(this.canvasPromise&&this.canvasPromise.isPending()&&this.canvasPromise.resolve(),this.currentSize=n.spinLib.calcProportionSize(this.coreNode.size,this.infoSize,!0,this.standardSize),this.getDPPX(this.currentSize),this.setImageSize(),this.setCanvasSize(),this.ready&&(this.imagesMap.isImagesExist({width:this.currentImageSize.width,height:this.currentImageSize.height})||this.imagesMap.loadImages({width:this.currentImageSize.width,height:this.currentImageSize.height,dppx:this.dppx})),this.firstImageLoaded&&this.draw(),this.isHidden&&(this.isHidden=!1,setTimeout((()=>{this.canvas.setCss({opacity:"",visibility:""})}),0)),this.hotspots&&this.fullscreenState===i.FULLSCREEN.OPENED&&(this.hotspots.showAll(),this.isInView&&this.isSlideShown&&this.hotspots.showNeededElements()),this.ready&&(this.animate("inactive"),d.browser.mobile||this.showHint(),this.fullscreenStartTime=Date.now(),this.sendStats("fullscreenOpen",Date.now()-this.sessionStartTime)))}onBeforeFullscreenOut(t){this.stopSmoothing(),this.stopAnimation(),this.zoom&&this.zoom.hide(!0),this.deactivateSpin(),this.hint&&this.always&&this.hint.hide(),super.onBeforeFullscreenOut(t),this.isInited&&this.isInView&&this.isSlideShown&&(this.isHidden=!0,this.canvas.setCss({opacity:0,visibility:"hidden"}))}onAfterFullscreenOut(t){if(this.infoSize&&(this.canvasPromise&&this.canvasPromise.isPending()&&this.canvasPromise.resolve(),this.currentSize=n.spinLib.calcProportionSize(this.coreNode.size,this.infoSize),this.getDPPX(this.currentSize),this.standardSize.width=this.currentSize.width,this.standardSize.height=this.currentSize.height,this.currentImageSize.width=this.currentSize.width,this.currentImageSize.height=this.currentSize.height,this.setCanvasSize(),this.ready&&(this.imagesMap.isImagesExist({width:this.currentSize.width,height:this.currentSize.height})||this.imagesMap.loadImages({width:this.currentSize.width,height:this.currentSize.height,dppx:this.dppx})),this.firstImageLoaded&&this.draw(),this.isHidden&&(this.isHidden=!1,setTimeout((()=>{this.destroyed||this.canvas.setCss({opacity:"",visibility:""})}),0)),super.onAfterFullscreenOut(t),this.ready)){this.animate("inactive"),d.browser.mobile||this.showHint();const t=Date.now();this.sendStats("fullscreenClose",t-this.sessionStartTime,{duration:t-this.fullscreenStartTime})}}play(t,e){let i=!1;return this.ready&&!this.isZoomed()&&(this.isAutoplayPaused=!1,this.stopSmoothing(),this.stopAnimation(),this.instanceOptions.checkValue("autospin.duration",t)||this.instanceOptions.checkValue("speed",t)||(t=null),this.instanceOptions.checkValue("autospin.type",e)||(e=null),this.animate("autoplay",t,e),i=!0),i}pause(){let t=!1;return this.ready&&!this.isZoomed()&&(this.isAutoplayPaused=!0,this.stopSmoothing(),this.stopAnimation(),this.animateWithDelay(),t=!0),t}rotate(t,e){let i=!1;return this.ready&&(t=n.toInteger(t),e=n.toInteger(e),0===t&&0===e||(this.stopAnimation(),this.stopSmoothing(),this.isDragMove||(this.sendEvent("rotate"),this.sendStats("rotate",Date.now()-this.sessionStartTime,{}),this.animate({cols:t,rows:e},d.U,d.U,!0),i=!0))),i}jumpTo(t,e){let i=!1,s=null;return this.ready&&("string"===d.typeOf(t)&&(t=t.trim(),s=/^-/.test(t)?"prev":"next"),t=parseInt(t,10),isNaN(t)||(i=this.imagesMap.jump(e,t,s),i&&this.firstImageLoaded&&(this.sendEvent("rotate"),this.sendStats("rotate",Date.now()-this.sessionStartTime,{}),this.draw()))),i}zoomIn(){return!(!this.ready||!this.zoom||this.isDragMove||!this.isFullscreenActionEnded())&&this.openLens()}zoomOut(){return!(!this.ready||!this.zoom)&&this.zoom.hide()}getCurrentFrame(){if(this.ready){const t=this.imagesMap.getCurrentImage({width:this.currentSize.width,height:this.currentSize.height});return{row:t.row+1,column:t.col+1}}return!1}get originImageUrl(){return this.ready?this.imagesMap.originImageUrl:null}setCallback(t,e){return!!this.ready&&(this.option(t,e),!0)}setImageSize(){this.currentImageSize.width=this.currentSize.width,this.currentImageSize.height=this.currentSize.height}isZoomSizeExist(){let t=!1;if(this.option("zoom.enable")){const e=this.currentImageSize;this.zoomSize.originWidth-e.width>=100&&(t=!0)}return t}get orientation(){return this.imagesMap.getHintType()}onResize(){if(this.fullscreenState===i.FULLSCREEN.OPENING||!this.isStarted)return!1;const t=this.fullscreenState===i.FULLSCREEN.OPENED;return this.stopSmoothing(),this.option("autospin.enable")?this.animationCloud.pause():this.stopAnimation(),this.boxBoundaries=this.coreNode.rect,this.currentSize=n.spinLib.calcProportionSize(c(this.coreNode.node.parentNode).size,this.infoSize,t,this.standardSize),this.getDPPX(this.currentSize),this.standardSize.width=this.currentSize.width,this.standardSize.height=this.currentSize.height,this.setImageSize(),this.setCanvasSize(),this.calcMinSizeForDrag(),this.isZoomSizeExist()?this.coreNode.addClass(i.CSS_CURSOR_ZOOM_IN):this.coreNode.removeClass(i.CSS_CURSOR_ZOOM_IN),this.zoom&&this.zoom.onResize(),this.imagesMap.isImagesExist({width:this.currentSize.width,height:this.currentSize.height})||this.imagesMap.loadImages({width:this.currentSize.width,height:this.currentSize.height,dppx:this.dppx}),this.firstImageLoaded&&this.draw(),this.ready&&this.hotspots&&(this.hotspots.containerSize=this.canvasContainer.node.getBoundingClientRect(),this.hotspots.updateAndShow()),this.resizeAnimationTimer(),!0}getContainerForBoundengClientRect(){return this.canvasContainer}destroy(){return this.instanceNode.removeEvent("touchmove",I),d.W.removeEvent("resize",this.windowResizeCallback),clearTimeout(this.resizeWindowTimer),this.isInited&&this.sendStats("sessionEnd",Date.now()-this.sessionStartTime,{message:"Stopped"}),this.coreNode.removeEvent(["btnclick","tap"]),this.coreNode.del("instance"),this.resizeAnimationTimer.cancel(),this.resizeAnimationTimer=null,this.touchDragCloud&&(this.touchDragCloud.removeEvent(),this.touchDragCloud=null),this.placeholder&&this.placeholder.setCssProp("display",""),this.keyPressHandlerForShiftButton&&(d.W.removeEvent(["keydown","keyup"],this.keyPressHandlerForShiftButton),this.keyPressHandlerForShiftButton=null),this.cssId>-1&&(d.removeCSS(this.id+"-css",this.cssId),d.$(this.id+"-css").remove()),this.cssId=-1,this.initNameEvent&&this.coreNode.removeEvent(this.initNameEvent,this.initFnEvent),this.activatedCurtain&&this.activatedCurtain.destroy(),this.stopSmoothing(),this.stopAnimation(),this.hint&&(this.hint.destroy(),this.hint=null),this.coreNode.removeEvent(["mousedrag","touchdrag","pinch"]),this.loader&&(this.loader.destroy(),this.loader=null),this.imagesMap&&(this.imagesMap.destroy(),this.imagesMap=null,this.off("mapFirstImageLoaded"),this.off("mapImagesReady"),this.off("mapImageLoaded"),this.off("mapAllImagesLoaded")),this.clearCanvas(),this.canvas&&(this.canvas.removeEvent("transform"),this.canvas.removeClass(this.zoomClassName),this.canvas.remove()),this.canvasContainer.removeEvent("transform"),this.canvasContainer.removeEvent("mouseover"),this.canvasContainer.removeEvent("mouseout"),this.canvasContainer.remove(),this.canvasContainer=null,this.ctx=null,this.canvas=null,this.loadedImages=[],this.off("isSingleSlide"),this.off("zoomUp"),this.off("zoomDown"),this.off("frameChange"),this.coreNode.remove(),this.infoSize=null,this.startLoadingTime=null,this.isInited=!1,this.openedImg=null,this.coreNode=null,this.firstUserInteraction=!1,this.animationCloud&&(clearTimeout(this.animationCloud.hintTimer),this.animationCloud=null),this.lastImg=null,this.hotspotsData=null,super.destroy(),!0}}}));
Sirv.define("Zoom",["bHelpers","magicJS","globalVariables","globalFunctions","helper","EventEmitter","Zoominstance","Hint","ResponsiveImage","RoundLoader","Hotspots"],((t,i,e,s,o,n,h,a,r,d,l)=>{const m=i,c=m.$;s.rootDOM.addModuleCSSByName("Zoom",(()=>".smv-zoom-view{display:inline-block;position:relative;top:0;left:0;width:100%;height:100%;outline:0!important;-webkit-backface-visibility:hidden!important;backface-visibility:hidden!important;-webkit-user-select:none!important;-ms-user-select:none!important;user-select:none!important;-webkit-tap-highlight-color:transparent!important;-webkit-touch-callout:none!important;touch-action:pan-y}.smv-zoom-view::after{display:inline-block;height:100%;content:'';vertical-align:middle}.smv-zoom-view .zoom-loader{bottom:0;left:0;margin:5px}.smv-zoom-view>img.smv-zoomed-in{visibility:hidden!important}.smv-zoom-view .sirv-zoom{z-index:126}.smv .smv-slides-box .smv-zoom-view>img{display:inline-block!important;position:relative!important;width:auto;max-width:100%;height:auto;max-height:100%;margin:0;padding:0;vertical-align:middle}.zoom-controls{display:flex;position:absolute;right:16px;bottom:16px;flex-flow:row-reverse;height:28px;z-index:168}.zoom-controls>button{background-color:rgba(245,245,245,.9);color:#777}.zoom-controls>button::after,.zoom-controls>button::before{transition:opacity .2s linear;opacity:.65}.zoom-controls>button:hover::after,.zoom-controls>button:hover::before{opacity:1}.zoom-controls>button.disable::after,.zoom-controls>button.disable::before{opacity:.2}.zoom-controls>button+button{margin-right:4px}.zoom-controls .zoom-close,.zoom-controls .zoom-in,.zoom-controls .zoom-out{display:inline-block;position:relative;width:28px;height:28px;padding:0;border:1px solid #d7d7d7;border-radius:2px;outline:0;cursor:pointer}.zoom-controls .zoom-close::after,.zoom-controls .zoom-close::before,.zoom-controls .zoom-in::after,.zoom-controls .zoom-in::before,.zoom-controls .zoom-out::before{transform:translate3d(-50%,-50%,0);position:absolute;top:50%;left:50%;width:65%;border-top:2px solid currentcolor;font-size:0;line-height:100%;content:''}.zoom-controls .zoom-close::after,.zoom-controls .zoom-in::after{transform-origin:center;border-left:1px solid}.zoom-controls .zoom-in::after{transform:translate3d(-50%,-50%,0) rotateZ(-90deg)}.zoom-controls .zoom-close{display:none!important}.zoom-controls .zoom-close::before{transform:translate3d(-50%,-50%,0) rotateZ(-45deg)}.zoom-controls .zoom-close::after{transform:translate3d(-50%,-50%,0) rotateZ(-135deg)}"));let p={mode:{type:"string",enum:["top","left","right","bottom","inner","magnifier","deep"],defaults:"inner"},margin:{type:"number",defaults:9},width:{oneOf:[{type:"number"},{type:"string",enum:["auto"]}],defaults:"auto"},height:{oneOf:[{type:"number"},{type:"string",enum:["auto"]}],defaults:"auto"},pan:{type:"boolean",defaults:!1},ratio:{oneOf:[{type:"number",minimum:0},{type:"string",enum:["max"]}],defaults:2.5},wheel:{type:"boolean",defaults:!0},tiles:{type:"boolean",defaults:!0},trigger:{oneOf:[{type:"string",enum:["hover","click","dblclick"]},{type:"boolean",enum:[!1]}],defaults:"click"},hint:{enable:{type:"boolean",defaults:!0},text:{hover:{type:"string",defaults:"Hover to zoom"},click:{type:"string",defaults:"Click to zoom"},dblclick:{type:"string",defaults:"Double click to zoom"}}},map:{enable:{type:"boolean",defaults:!1},size:{type:"number",minimum:0,maximum:50,defaults:25}}};m.browser.touchScreen&&(p=o.deepExtend(p,{hint:{text:{hover:{defaults:"Tap and hold to zoom"}}}}));const g={hint:{text:{hover:{type:"string",defaults:"Tap and hold to zoom"},click:{type:"string",defaults:"Tap to zoom"},dblclick:{type:"string",defaults:"Double tap to zoom"}}}},u={trigger:{oneOf:[{type:"string",enum:["hover","click","dblclick"]},{type:"boolean",enum:[!1]}],defaults:"hover"}},z={trigger:{oneOf:[{type:"string",enum:["hover","click","dblclick"]},{type:"boolean",enum:[!1]}],defaults:"dblclick"}},S={ratio:{oneOf:[{type:"number",minimum:0},{type:"string",enum:["max"]}],defaults:"max"}};class b extends n{constructor(t,i,e){super(),this.parentNode=c(t),this.options=Object.assign({class:null,disabledClass:"disable"},i),this.events=e||{},this.disabled=!1,this.isDisabledClassAdded=!1,this.instanceNode=m.$new("button"),this.options.class&&this.instanceNode.addClass(this.options.class),Object.entries(this.events).forEach((t=>{this.instanceNode.addEvent(...t)}))}append(){this.parentNode.append(this.instanceNode)}changeState(t){t?(this.disable(!0),this.isDisabledClassAdded||(this.isDisabledClassAdded=!0,this.instanceNode.addClass(this.options.disabledClass))):(this.isDisabledClassAdded&&(this.isDisabledClassAdded=!1,this.instanceNode.removeClass(this.options.disabledClass)),this.disable())}disable(t){t?this.disabled||(this.disabled=!0,this.instanceNode.attr("disabled","disabled")):this.disabled&&(this.disabled=!1,this.instanceNode.removeAttr("disabled"))}destroy(){Object.entries(this.events).forEach((t=>{this.instanceNode.removeEvent(...t)})),this.events={},this.changeState(),this.instanceNode.remove(),this.instanceNode=null,super.destroy()}}class f extends n{constructor(t){super(),this.parentNode=c(t),this.instanceNode=m.$new("div").addClass("zoom-controls"),this.zoomInButton=new b(this.instanceNode,{class:"zoom-in"},{btnclick:t=>{t.stop(),this.emit("zoomControlsAction",{data:{type:"zoomin"}})},tap:t=>{t.stop(),this.emit("zoomControlsAction",{data:{type:"zoomin"}})}}),this.zoomInButton.parentClass=this,this.zoomOutButton=new b(this.instanceNode,{class:"zoom-out"},{btnclick:t=>{t.stop(),this.emit("zoomControlsAction",{data:{type:"zoomout"}})},tap:t=>{t.stop(),this.emit("zoomControlsAction",{data:{type:"zoomout"}})}}),this.zoomOutButton.parentClass=this,this.zoomCloseButton=new b(this.instanceNode,{class:"zoom-close"},{btnclick:t=>{t.stop(),this.emit("zoomControlsAction",{data:{type:"zoomclose"}})},tap:t=>{t.stop(),this.emit("zoomControlsAction",{data:{type:"zoomclose"}})}}),this.zoomCloseButton.parentClass=this,this.zoomInButton.append(),this.zoomOutButton.append(),this.zoomCloseButton.append()}show(){this.parentNode.append(this.instanceNode)}hide(){this.instanceNode.remove()}invisibleDisable(t){this.zoomInButton.disable(t),this.zoomOutButton.disable(t),this.zoomCloseButton.disable(t)}disable(t){t?"in"===t?(this.zoomInButton.changeState(!0),this.zoomOutButton.changeState(),this.zoomCloseButton.changeState()):(this.zoomOutButton.changeState(!0),this.zoomCloseButton.changeState(!0),this.zoomInButton.changeState()):(this.zoomInButton.changeState(),this.zoomOutButton.changeState(),this.zoomCloseButton.changeState())}destroy(){this.zoomInButton.destroy(),this.zoomOutButton.destroy(),this.zoomCloseButton.destroy(),this.hide(),super.destroy()}}return(()=>{const t="smv",i=t=>{t.stop()},n=i=>{let e=null;for(;i.node!==m.D.node.body&&!e;)(i=c(i.node.parentNode)).hasClass(t+"-slides-box")&&(e=i);return e},b=(t,i)=>new Promise(((e,s)=>{const o=c(t).size;i||(i=100),i-=1,o.width||o.height?e(o):i>0?setTimeout((()=>{b(t,i).then(e).catch(s)}),16):s(null)}));return class extends h{constructor(t,i){if(super(t,i,p),this.type=e.SLIDE.TYPES.ZOOM,this.insideOptions={type:"outside",position:"right",hideZoomForClickTrigger:!0,zooming:!0,map:!1,mapSize:50,controls:!1,trigger:"click",outsideModeWasChanged:!1},this.queryParamsObj=o.paramsFromQueryString(this.queryParams),this.queryParamsObj){const t=parseInt(this.queryParamsObj.quality,10);isNaN(t)?delete this.queryParamsObj.quality:this.queryParamsObj.quality=t}this.isFullscreen=i.isFullscreen,this.nativeFullscreen=i.nativeFullscreen,this.queryParamsQuality=this.queryParamsObj.quality||null,this.imageNode=null,this.loader=null,this.image=null,this.controls=null,this.differenceBetweenSizes=100,this.currentSize={width:0,height:0},this.currentImageSize={width:0,height:0},this.isInfoLoaded=!1,this.zoomIsOpened=!1,this.imageShowPromise=null,this.hint=null,this.longTapTimer=null,this.setImageCss=!1,this.lastTriggerAction=null,this.isNotMouse=!1,this.accountInfo={},this.postInitState=0,this.clonedImage=null,this.isHidden=!1,this.destroyed=!1,this.waitingCallbacks=[],this.lastImageSize={width:0,height:0},this.hotspotsTurnedOn=!0,this.scrollDebounce=o.debounce((()=>{this.replaceZoom()}),16),this.zoomDebounce=o.debounce((()=>{this.controls&&(this.controls.invisibleDisable(),this.changeControlsState(this.zoom.getZoomData()))}),42),this.onScrollHandler=this.onScroll.bind(this),this.instanceNode.addEvent("selectstart",(t=>{t.stop()})),this.createHotspotsClass(),this.createSirvImage()}makeOptions(){let t=new m.Options(this.defaultSchema);return t=this.makeGlobalOptions(t),["top","left","right","bottom","inner","magnifier"].includes(t.get("mode"))&&t.parseSchema(u,!0),m.browser.touchScreen&&m.browser.mobile&&(t.parseSchema(g,!0),t=this.makeMobileOptions(t),["inner","deep"].includes(t.get("mode"))&&t.parseSchema(z,!0)),"deep"===t.get("mode")&&t.parseSchema(S,!0),t}getInfo(){return this.gettingInfoPromise||(this.gettingInfoPromise=new Promise(((t,i)=>{this.waitGettingInfo.wait((()=>{this.image.loadInfo().then((i=>{this.destroyed||(this.isInfoLoaded=!0,this.accountInfo=this.image.accountInfo,this.dataAlt||(this.dataAlt=this.image.description),this.hotspotsData=i.hotspots,this.infoSize=this.image.originSize,this.hotspots&&(this.hotspots.originImageSize=this.infoSize),t())})).catch((t=>{this.destroyed||i(t)}))}))}))),this.gettingInfoPromise}showHint(){this.hint&&(this.always&&![e.FULLSCREEN.OPENING,e.FULLSCREEN.OPENED].includes(this.fullscreenState)||this.hint.show())}onStartActions(){this.ready?this.isInView&&this.isZoomSizeExist()&&this.showHint():this.isStarted&&this.isInView&&this.isSlideShown&&!this.preload&&this.postInit(),super.onStartActions()}onStopActions(){this.zoomOut(!0),this.hint&&this.hint.hide(),super.onStopActions()}onInView(t){t&&(this.ready?this.isSlideShown&&this.isZoomSizeExist()&&this.showHint():this.isStarted&&(this.isInView||!this.preload&&!this.isSlideShown||(this.isInView=!0,this.postInit())))}startFullInit(e){this.isStartedFullInit||(super.startFullInit(e),this.normalizeOptions(),this.getId("zoom-"),this.instanceNode.addClass(t+"-zoom-view"),this.instanceNode.addEvent("mousedown",i),this.createLoader())}imageSettings(t){t||(t={}),t.imageSettings||(t.imageSettings={}),t.imageSettings.scale||(t.imageSettings.scale={}),t.callbackData||(t.callbackData={}),t.imageSettings.scale.option="fill",null!==this.quality&&null===this.queryParamsQuality&&(t.src||(t.src={}),t.src.quality=this.quality);const i=this.hdQuality;return(null===this.queryParamsQuality||this.isHDQualitySet&&i<this.queryParamsQuality)&&(t.srcset={quality:i}),t}setHDQuality(t){return t.dppx>1&&t.dppx<1.5&&(null===this.queryParamsQuality&&null!==this.quality?t.srcset.quality=this.quality:t.srcset&&delete t.srcset.quality),t}isOutsideZoom(){return["top","left","right","bottom"].includes(this.option("mode"))}createHint(t){this.option("hint.enable")&&(this.hint=new a(this.instanceNode,{html:"<span>"+t+"<span>"}),this.hint.append())}clearZoom(){this.zoom&&(this.off("zooming"),this.off("zoomUp"),this.off("zoomDown"),this.imageNode&&this.imageNode.removeClass(this.zoomClassName)),super.clearZoom()}replaceZoom(){let t=!1;const i=this.option("trigger"),s={clickBehavior:"both"};if(!this.ready)return;"hover"===i&&"magnifier"!==this.option("mode")&&([e.FULLSCREEN.OPENING,e.FULLSCREEN.OPENED].includes(this.fullscreenState)?(t="click",s.trigger=t):t=i);let o,n=t&&this.insideOptions.trigger!==t;if(t&&this.insideOptions.trigger!==t&&(n=!0),"outside"===this.insideOptions.type){o=this.canIUseOutsideZoom(),(o&&this.insideOptions.outsideModeWasChanged||!o&&!this.insideOptions.outsideModeWasChanged)&&(this.insideOptions.outsideModeWasChanged=!this.insideOptions.outsideModeWasChanged,n=!0);const t=this.imageNode.size;!n&&o&&this.lastImageSize.width!==t.width&&(this.lastImageSize=t,n=!0)}n&&(this.clearZoom(),"outside"===this.insideOptions.type&&(o?s.type="outside":(s.type="inner",m.browser.mobile&&(s.pan=!0,"hover"===i&&(t="dblclick",s.trigger=t)))),t&&(this.insideOptions.trigger=t),this.setTriggerAction(t),this.createZoom(s),this.setZoomEvents())}canIUseOutsideZoom(){let t=!1;if("outside"===this.insideOptions.type){if([e.FULLSCREEN.OPENING,e.FULLSCREEN.OPENED].includes(this.fullscreenState))return t;const i=this.option("margin"),s=this.imageNode.size,o=m.W.scroll,n=this.imageNode.position,h=this.option("width"),a=this.option("height"),r={width:s.width,height:s.height};let d;switch("auto"!==h&&(/%$/.test(h)?s.width=s.width/100*parseInt(h,10):s.width=parseInt(h,10)),"auto"!==a&&(/%$/.test(a)?s.height=s.height/100*parseInt(a,10):s.height=parseInt(a,10)),this.insideOptions.position){case"top":d=n.top-o.y-i,d>s.height&&(t=!0);break;case"left":d=n.left-o.x-i,d>=s.width&&(t=!0);break;case"right":d=n.left-o.x,d+=r.width+i,m.W.node.innerWidth-d>=s.width&&(t=!0);break;case"bottom":d=n.top-o.y,d+=r.height+i,m.W.node.innerHeight-d>=s.height&&(t=!0)}}return t}createHotspotsClass(){"magnifier"!==this.option("mode")&&(m.browser.mobile||"hover"!==this.option("trigger")||(this.hotspotsTurnedOn=!1),super.createHotspotsClass(l))}run(t,i,e){const s=super.run(t,i,e);return s&&(this.getInfo().finally((()=>{this.calcContainerSize(),this.isInView&&(this.preload||this.isSlideShown)&&this.postInit()})),this.startGettingInfo()),s}done(){if(!this.ready&&!this.destroyed){super.done(),this.hotspots&&(this.hotspots.instanceComponentNode=this.imageNode,this.hotspots.containerSize=this.imageNode.node.getBoundingClientRect()),this.createZoom(),this.replaceZoom(),this.createControls();const t=this.isZoomSizeExist();if(this.controls&&(this.controls.disable("out"),t&&this.controls.show()),this.imageNode&&t&&this.imageNode.addClass(e.CSS_CURSOR_ZOOM_IN),this.setZoomEvents(),this.isSlideShown&&this.isInView&&t&&this.showHint(),this.accountInfo.branded){const t=s.getNodeWithSirvClassName(this.instanceNode)||m.D.node.head||m.D.node.body;s.rootDOM.showSirvAd(t,this.instanceNode,"https://sirv.com/about-zoom/?utm_source=client&utm_medium=sirvembed&utm_content=typeofembed(zoom)&utm_campaign=branding","Deep zoom image viewer by Sirv")}}}normalizeOptions(){switch("deep"!==this.option("mode")&&this.option("map.enable",!1),("deep"===this.option("mode")||m.browser.mobile)&&this.option("pan",!0),"magnifier"!==this.option("mode")||m.browser.mobile||this.option("pan",!1),this.isOutsideZoom()||"auto"===this.option("width")&&"auto"===this.option("height")&&this.option("width","70%"),this.option("trigger")){case"hover":"deep"===this.option("mode")&&this.option("trigger","click");break;case"click":case"dblclick":break;default:this.option("trigger",!1)}switch(this.option("mode")){case"top":case"left":case"right":case"bottom":this.insideOptions.type="outside",this.insideOptions.position=this.option("mode");break;case"magnifier":this.insideOptions.type="circle";break;case"inner":this.insideOptions.type="inner";break;case"deep":this.insideOptions.type="deep",this.insideOptions.controls=!0}"deep"===this.insideOptions.type&&this.option("map.enable")&&(this.insideOptions.map=0!==this.option("map.size"),this.insideOptions.map&&(this.insideOptions.mapSize=2*this.option("map.size"))),this.insideOptions.trigger=this.option("trigger"),m.browser.mobile&&(this.insideOptions.hideZoomForClickTrigger=!1),"max"!==this.option("ratio")&&this.option("ratio")<e.MIN_RATIO&&this.option("ratio",0),this.setDefaultZoomOptions()}setDefaultZoomOptions(){const t="deep"===this.insideOptions.type;super.setDefaultZoomOptions(),this.defaultZoomOptions=Object.assign(this.defaultZoomOptions,{trigger:this.option("trigger"),tiles:this.option("tiles"),width:this.option("width"),height:this.option("height"),map:this.insideOptions.map,clickBehavior:t?"up":"both",outsidePosition:this.insideOptions.position,margin:this.option("margin"),type:t?"inner":this.insideOptions.type,pan:this.option("pan"),customZooming:this.option("wheel"),mapSize:this.insideOptions.mapSize})}onZoomGetImage(t){super.onZoomGetImage(t),t.data=this.imageSettings(t.data),t.data=this.setHDQuality(t.data);const i=this.image.getImage(t.data);this.checkImage(t.data,t.data.dontLoad)&&this.zoom.addLoadedImage(i)}onZoomCancelLoadingOfTiles(t){super.onZoomCancelLoadingOfTiles(t),t.data=this.imageSettings(t.data),this.image.cancelLoadingImage(t.data)}onZoomBeforeShow(t){"magnifier"!==this.option("mode")&&("outside"!==this.insideOptions.type||this.insideOptions.outsideModeWasChanged?this.imageNode.addClass(this.zoomClassName):this.imageNode.addClass("sirv-filter-bw"),this.hotspots&&this.hotspots.disableAll())}onZoomShown(t){this.isSlideShown&&this.sendEvent("zoomIn",{trigger:this.option("trigger"),isOutsideZoom:this.isOutsideZoom()})}onZoomHidden(t){this.imageNode.removeClass(this.zoomClassName),this.imageNode.removeClass("sirv-filter-bw"),this.sendEvent("zoomOut"),this.isNotMouse=!1,this.zoomIsOpened=!1,this.pinchCloud&&this.pinchCloud.addEvent(),this.hotspots&&(this.hotspotsTurnedOn&&[e.FULLSCREEN.CLOSED,e.FULLSCREEN.OPENING].includes(this.fullscreenState)||"hover"!==this.insideOptions.trigger&&[e.FULLSCREEN.OPENED,e.FULLSCREEN.CLOSING].includes(this.fullscreenState))&&(this.hotspots.enableAll(),this.isInView&&this.isSlideShown&&this.hotspots.showNeededElements())}setZoomEvents(){super.setZoomEvents(),this.on("zooming",(t=>{const i=t.data.zoom;t.stopAll(),this.controls&&(this.controls.invisibleDisable(!0),this.changeControlsState(i),this.zoomDebounce())})),this.on("zoomUp",(t=>{t.stop(),this.makeZoom("zoomin",t.data.x,t.data.y)})),this.on("zoomDown",(t=>{t.stop(),this.makeZoom("zoomout",t.data.x,t.data.y)}))}onBeforeFullscreenIn(t){this.zoomIsOpened&&(this.zoom.hide(!0),this.controls&&this.controls.disable("out")),this.ready&&this.isSlideShown&&this.isInView&&this.imageNode&&(this.isHidden=!0,this.imageNode.setCss({opacity:0,visibility:"hidden"})),super.onBeforeFullscreenIn(t),this.hotspots&&this.hotspots.disableAll()}onAfterFullscreenIn(t){this.calcContainerSize(),this.replaceZoom(),this.isHidden&&(this.isHidden=!1,setTimeout((()=>{this.setImageWidthHeight(),this.imageNode.setCss({opacity:"",visibility:""})}),0)),this.hotspots&&setTimeout((()=>{this.hotspotsTurnedOn&&this.fullscreenState===e.FULLSCREEN.OPENED&&(this.hotspots.enableAll(),this.isInView&&this.isSlideShown&&this.hotspots.showNeededElements())}),100)}onBeforeFullscreenOut(t){this.zoomIsOpened&&(this.zoom.hide(!0),this.controls&&this.controls.disable("out")),super.onBeforeFullscreenOut(t),this.hotspots&&(this.hotspotsTurnedOn||this.hotspots.disableAll()),this.replaceZoom(),this.ready&&this.isSlideShown&&this.isInView&&this.imageNode&&(this.isHidden=!0,this.imageNode.setCss({opacity:0,visibility:"hidden"}))}onAfterFullscreenOut(t){this.isHidden&&(this.isHidden=!1,setTimeout((()=>{this.destroyed||(this.setImageWidthHeight(),this.imageNode.setCss({opacity:"",visibility:""}))}),0)),super.onAfterFullscreenOut(t)}onSecondSelectorClick(){this.zoomOut(!0)}onMouseAction(t){"mouseout"===t&&(["deep","magnifier"].includes(this.option("mode"))||!("outside"===this.insideOptions.type&&this.insideOptions.outsideModeWasChanged||"inner"===this.insideOptions.type)||"hover"!==this.insideOptions.trigger&&!this.insideOptions.hideZoomForClickTrigger||this.isNotMouse||this.zoomOut(!0))}makeZoom(t,i,e){let s=!1;if(this.ready&&this.zoom)switch(t){case"zoomin":this.zoomIsOpened?(1===this.zoom.nextMinZoom&&this.controls.disable("in"),s=this.zoom.zoomUp(i,e)):s=this.openZoom(i,e,"deep"===this.insideOptions.type&&"first");break;case"zoomout":this.zoomIsOpened&&(0===this.zoom.getZoomData()||0===this.zoom.nextMinZoom?(s=this.zoom.hide(),this.controls&&this.controls.disable("out")):s=this.zoom.zoomDown(i,e));break;default:this.zoomIsOpened&&(s=this.zoom.hide(),this.controls&&this.controls.disable("out"))}return s}calcContainerSize(){const t=this.instanceNode.size;if(t.height&&t.width)this.currentSize=t;else{const i=this.image.originSize;t.height?(this.currentSize.height=t.height,this.currentSize.width=i.width/i.height*t.height):(this.currentSize.width=t.width,this.currentSize.height=i.height/i.width*t.width)}}getImageSize(){let t,i;const e=this.currentSize,s=this.image.originSize;return e.width>=e.height?(i=Math.min(e.height,s.height),t=s.width/s.height*i,t>e.width&&(t=Math.min(e.width,s.width),i=s.height/s.width*t)):(t=Math.min(e.width,s.width),i=s.height/s.width*t,i>e.height&&(i=Math.min(e.height,s.height),t=s.width/s.height*i)),Object.assign({realWidth:t,realHeight:i},this.image.getClearSizeWithoutProcessingSettings({width:t,height:i}))}setTriggerAction(t){let i=this.option("trigger");if(this.isNotMouse=!1,!("max"!==this.option("ratio")&&this.option("ratio")<e.MIN_RATIO)&&i){let s,o,n=!1;switch(this.lastTriggerAction&&(this.lastTriggerAction(),this.lastTriggerAction=null,this.hint&&(this.hint.destroy(),this.hint=null,n=!0)),t&&(i=t),i){case"click":s=["btnclick","tap"],o=this.option("hint.text.click");break;case"dblclick":s=["dblbtnclick","dbltap"],o=this.option("hint.text.dblclick");break;case"hover":s="mouseover",o=this.option("hint.text.hover"),m.browser.mobile&&this.outsideModeWasChanged&&(o=this.option("hint.text.dblclick"),s="dbltap",i=s)}this.createHint(o),n&&this.isSlideShown&&this.isInView&&this.isZoomSizeExist()&&this.showHint();const h=[];if("hover"===i)m.browser.touchScreen&&h.push(this.setLongTapEvents()),m.browser.mobile||h.push(this.setHoverEvents());else{const t=t=>{if((this.fullscreenState===e.FULLSCREEN.OPENED||!this.always)&&(t.stop(),this.isFullscreenActionEnded())){const i=t.pageXY;this.openZoom(i.x,i.y,!1)}};if(m.browser.touchScreen){const t=t=>{this.isNotMouse=t.isTouchEvent()};this.imageNode.addEvent("pointerup",t),h.push(c((t=>{this.isNotMouse=!1,this.imageNode.removeEvent("pointerup",t)})).bind(this,t))}this.imageNode.addEvent(s,t),h.push(c(((t,i)=>{this.imageNode.removeEvent(t,i)})).bind(this,s,t))}this.lastTriggerAction=c((t=>{c(t).forEach((t=>{t()}))})).bind(this,h)}}setImageSrc(t,i,e){this.imageNode&&(this.imageNode.attr("src",t),i?this.imageNode.attr("srcset",i+" "+e+"x"):this.imageNode.removeAttr("srcset"),this.clonedImage=c(this.imageNode.node.cloneNode(!0)),this.clonedImage.node.className="")}setImageWidthHeight(){this.destroyed||(this.currentImageSize.realWidth/this.currentImageSize.realHeight>=this.currentSize.width/this.currentSize.height?this.imageNode.setCss({width:"100%",height:""}):this.imageNode.setCss({width:"",height:"100%"}))}createImage(t,i,e,s){if(!this.imageNode){this.imageNode=t?c(t):m.$new("img"),this.imageNode.attr("referrerpolicy",this.referrerPolicy);const o=this.image.originSize;this.imageNode.setCss({maxWidth:o.width,maxHeight:o.height}),this.setImageWidthHeight(),this.setTriggerAction(),this.option("wheel")&&"deep"===this.option("mode")&&this.imageNode.addEvent("mousescroll",(t=>{!this.zoomIsOpened&&t.delta>0&&(t.stop(),this.openZoom(t.x,t.y,"first"))})),m.W.addEvent("scroll",this.onScrollHandler),this.dataAlt&&this.imageNode.attr("alt",this.dataAlt),this.setImageSrc(i,e,s)}}setLongTapEvents(){let t=!1,i=!1;const s=e=>{clearTimeout(this.longTapTimer),this.zoomIsOpened||e.isTouchEvent()&&!e.isPrimaryTouch()||this.isFullscreenActionEnded()&&(this.longTapTimer=setTimeout((()=>{if(e.isTouchEvent()&&!e.isPrimaryTouch())return;e.stop(),t=!0;const i=e.pageXY;this.openZoom(i.x,i.y,!1,!0)}),201),i=!0)},o=i=>{if(!i.isTouchEvent()||i.isPrimaryTouch(i))if(t){i.stop();const t=i.pageXY;this.zoom.customMove(t.x,t.y)}else clearTimeout(this.longTapTimer)},n=e=>{e.isTouchEvent()&&!e.isPrimaryTouch(e)||(i&&(i=!1,clearTimeout(this.longTapTimer)),t&&(e.stop(),t=!1,this.zoom.hide(!0)))};return this.fullscreenState!==e.FULLSCREEN.OPENED&&this.always||(this.instanceNode.addEvent(["touchstart","pointerdown"],s),this.instanceNode.addEvent(["touchmove","pointermove"],o),this.instanceNode.addEvent(["touchend","pointerup"],n)),()=>{this.instanceNode.removeEvent(["touchstart","pointerdown"],s),this.instanceNode.removeEvent(["touchmove","pointermove"],o),this.instanceNode.removeEvent(["touchend","pointerup"],n)}}setHoverEvents(){let t,i,s,o=!1;const n=()=>m.browser.touchScreen&&!m.browser.mobile,h=h=>{const a=h.pageXY;t=a.x,i=a.y,n()&&h.isTouchEvent()||o||!this.isSlideShown||this.fullscreenState!==e.FULLSCREEN.OPENED&&this.always||(o=!0,s=setTimeout((()=>{this.openZoom(t,i,!1)}),84))},a=h=>{let a=c(h.related);if((!n()||!h.isTouchEvent())&&o&&(this.fullscreenState===e.FULLSCREEN.OPENED||!this.always)&&(o=!1,this.isFullscreenActionEnded())){for(;a&&a!==this.imageNode.node&&a!==m.D.node.body;)a=c(a.parentNode);a!==this.imageNode.node&&(t=null,i=null,clearTimeout(s))}};let r=()=>{},d="mousemove",l="mouseout";return n()&&["edge","ie"].includes(m.browser.uaName)&&(r=this.on("zoomHidden",(t=>{t.stop(),o=!1})),d="pointermove",l="pointerup"),this.imageNode.addEvent(d,h),this.imageNode.addEvent(l,a),()=>{r(),this.imageNode.removeEvent(d,h),this.imageNode.removeEvent(l,a)}}getZoomImageSize(){const t=this.image.originSize,i=t.width,e=t.height,s=this.option("ratio");let o={width:i,height:e};return"max"!==s&&(o.width=this.currentImageSize.realWidth*s,o.height=this.currentImageSize.realHeight*s,o=r.roundImageSize(o)),o.width=Math.min(i,o.width),o.height=Math.min(e,o.height),{width:o.width,height:o.height,originWidth:i,originHeight:e}}openZoom(t,i,e,s){"deep"===this.insideOptions.type&&"zero"!==e&&(e="first");let o=!1;if(!this.zoom||!this.isZoomSizeExist())return o;this.zoomIsOpened=!0,this.hint&&this.hint.hide(),this.hotspots&&this.hotspots.hideActiveHotspotBox(!0);const n=this.clonedImage,h=this.getZoomImageSize();return o=void 0===t?this.zoom.showCenter(n,h,e):this.zoom.show(n,h,t,i,s,e),o}createPinchEvent(){let t,i,s,o,n,h,a,r,d;const l=()=>{n=1,h=1,i=this.zoom.baseScale.x,a=1,r=i,s=1-i};super.createPinchEvent(this.instanceNode),this.pinchCloud.onPinchStart=t=>{[e.FULLSCREEN.OPENING,e.FULLSCREEN.CLOSING].includes(this.fullscreenState)||"outside"===this.insideOptions.type&&!this.insideOptions.outsideModeWasChanged||(this.pinchCloud.pinch=!0,clearTimeout(this.longTapTimer),d=!1,this.pinchCloud.scale=t.scale,o=1,this.hotspots&&this.hotspots.hideActiveHotspotBox(!0),this.zoomIsOpened&&(o=this.zoom.scale.x,i===m.U&&l(),o/=i),this.sendEvent("pinchStart"))},this.pinchCloud.onPinchResize=t=>{this.pinchCloud.pinch&&!this.pinchCloud.block&&this.zoom&&this.fullscreenState===e.FULLSCREEN.OPENED&&this.zoomIsOpened&&(this.pinchCloud.scale=t.scale,this.zoom.basePercent=t.centerPoint)},this.pinchCloud.onPinchMove=m=>{this.pinchCloud.pinch&&!this.pinchCloud.block&&(this.fullscreenState!==e.FULLSCREEN.OPENED&&this.isFullscreenEnabled?m.scale>=2&&(this.pinchCloud.block=!0,this.sendEvent("fullscreenIn")):this.zoomIsOpened?this.zoom&&(d?(t=m.scale,t*=i,a<t&&(a=t,r=i,h=1,n=s/(a-i)),r>t&&(r=t,a=1,n=1,h=i/r),t*=o,t=(i+(t-i)*n)*h,this.zoom.setScale(t,m.centerPoint.x,m.centerPoint.y)):(d=!0,this.zoom.basePercent=m.centerPoint),this.pinchCloud.scale=m.scale):m.scale>1.1?"magnifier"!==this.option("mode")&&this.option("wheel")&&(this.openZoom(m.centerPoint.x,m.centerPoint.y,"zero"),l(),o=1):m.scale<.2&&this.isFullscreenEnabled&&(this.pinchCloud.block=!0,this.sendEvent("fullscreenOut")))},this.pinchCloud.onPinchEnd=t=>{this.pinchCloud.pinch&&(this.pinchCloud.pinch=!1,this.sendEvent("pinchEnd")),this.zoomIsOpened&&this.pinchCloud.removeEvent(),this.pinchCloud.block=!1}}loadContent(){this.postInit()}postInit(){this.postInitState||(this.postInitState=1,this.waitToStart.start(),b(this.instanceNode.node).then((t=>{this.currentSize=t})).catch((t=>{this.destroyed||this.calcContainerSize()})).finally((()=>{this.destroyed||(this.postInitState=2,this.getImage())})))}get imageClassContainer(){return this.image}getImage(){const t=this.getImageSize(),i=(s=r.roundImageSize({width:this.currentImageSize.width}).width,n=r.roundImageSize({width:t.width}).width,Math.abs(s-n));var s,n;let h,a;if(this.setImageCss=!1,!this.ready||i>=this.differenceBetweenSizes||this.fullscreenState===e.FULLSCREEN.OPENED){if(!this.ready&&!t.width&&!t.height)return void setTimeout((()=>{this.calcContainerSize(),this.getImage()}),16);(i>=this.differenceBetweenSizes||this.fullscreenState===e.FULLSCREEN.OPENED||!this.currentImageSize.width)&&(this.currentImageSize=t);let s=this.imageSettings({width:this.currentImageSize.realWidth,height:this.currentImageSize.realHeight,round:!0,dontLoad:true});if(m.DPPX>1&&(h=this.image.originSize,a=s.height>s.width?o.getDPPX(s.round?r.roundImageSize({height:s.height}).height:s.height,h.height,this.upscale):o.getDPPX(s.round?r.roundImageSize({width:s.width}).width:s.width,h.width,this.upscale),s.dppx=a),s=this.setHDQuality(s),this.checkImage(s,true)&&this.ready){const t=this.image.getImage(s);this.setImageSrc(t.src,t.srcset,a)}else this.image.getImage(s)}else i<this.differenceBetweenSizes&&(this.setImageCss=!0)}imageRequest(){this.image.getImage(this.imageSettings({width:this.currentImageSize.width,height:this.currentImageSize.height}))}showImage(){return this.imageShowPromise||(this.imageShowPromise=new Promise(((t,i)=>{let e=null,s=null;this.isInView&&this.isSlideShown?(this.imageNode.setCss({opacity:0,transition:"opacity .3s linear"}),this.instanceNode.append(this.imageNode),o.loadImage(this.imageNode.node).then((t=>{e=t})).catch((t=>{s=t})).finally((()=>{this.destroyed||(this.imageNode.addEvent("transitionend",(o=>{o.stop(),this.imageNode.removeEvent("transitionend"),this.imageNode.setCss({opacity:"",transition:""}),e?(this.sendContentLoadedEvent(),t(e)):i(s)})),this.imageNode.render(),this.imageNode.setCssProp("opacity",1))}))):(this.instanceNode.append(this.imageNode),o.loadImage(this.imageNode.node).then((t=>{e=t})).catch((t=>{s=t})).finally((()=>{e?(this.sendContentLoadedEvent(),t(e)):i(s)})))}))),this.imageShowPromise}createLoader(){this.loader=new d(this.instanceNode,{class:"zoom-loader"})}createSirvImage(){this.instanceUrl&&(this.on("imageOnload",(t=>{t.stopAll(),t.data.callbackData.lens?(this.zoom.shown||this.zoom.showing)&&this.zoomIsOpened&&this.zoom.addLoadedImage(t.data):this.ready?this.imageShowPromise&&this.setImageSrc(t.data.src,t.data.srcset,t.data.dppx):(this.createImage(t.data.node,t.data.src,t.data.srcset,t.data.dppx),this.showImage().finally((()=>{this.loader&&this.loader.hide(),this.done(),this.sendContentLoadedEvent()})))})),this.on("imageOnerror",(t=>{t.stopAll(),this.loader&&this.loader.hide(),console.log("image error")})),this.image=new r(this.instanceUrl,{imageSettings:this.queryParamsObj,referrerPolicy:this.referrerPolicy}),this.image.parentClass=this,this.getInfo())}getInfoSize(){return new Promise(((t,i)=>{this.getInfo().then((()=>{t({size:this.infoSize})})).catch((t=>{i({error:t,isPlaceholder:t._isplaceholder})}))}))}getSelectorImgUrl(t){return new Promise(((i,e)=>{const s=this.imageSettings();s.src&&(t.src=s.src),t.srcset=s.srcset,this.isInfoLoaded?this.waitToStart.wait((()=>{i(Object.assign(this.image.getThumbnail(t),{alt:this.dataAlt}))})):this.getInfo().then((()=>{this.waitToStart.wait((()=>{i(Object.assign(this.image.getThumbnail(t),{alt:this.dataAlt}))}))})).catch(e)}))}getThumbnailData(t){return this.image.getThumbnail(t)}createControls(){this.insideOptions.controls&&(this.controls=new f(this.instanceNode),this.controls.parentClass=this,this.on("zoomControlsAction",(t=>{t.stopAll(),this.zoom&&this.makeZoom(t.data.type)})))}changeControlsState(t){this.controls&&(1===t||0===t?1===t?this.controls.disable("in"):this.controls.disable("out"):this.controls.disable())}createZoom(t){let i=null;if(!this.destroyed){let s=this.zoomContainer;i=super.createZoom(this.instanceNode,t),"magnifier"===this.option("mode")?s=n(this.instanceNode):[e.FULLSCREEN.OPENING,e.FULLSCREEN.OPENED].includes(this.fullscreenState)||"outside"===i.type&&(s=n(this.instanceNode),s=m.D.node.body),s&&(this.zoom.lensContainer=s)}return i}zoomIn(){let t=!1;return this.ready&&this.zoom&&(this.option("fullscreenOnly")&&this.fullscreenState===e.FULLSCREEN.CLOSED?this.sendEvent("fullscreenIn"):t=this.makeZoom("zoomin")),t}zoomOut(t){let i=!1;return this.ready&&this.zoom&&(t?this.zoomIsOpened&&(i=this.zoom.hide(!this.zoom.getZoomData())):i=this.makeZoom("zoomout")),i}get originImageUrl(){return this.ready?this.image.originUrl:null}isZoomSizeExist(){let t=!1;if(this.ready){const i=100,s=this.currentImageSize;this.getZoomImageSize().originWidth-s.realWidth>=i&&("max"===this.option("ratio")||this.option("ratio")>=e.MIN_RATIO)&&(t=!0)}return t}onResize(){let t=!1;if(!this.destroyed)return this.isStarted&&2===this.postInitState&&(this.calcContainerSize(),this.getImage(),this.hotspots&&(this.hotspotsTurnedOn&&[e.FULLSCREEN.CLOSED,e.FULLSCREEN.OPENING].includes(this.fullscreenState)||"hover"!==this.insideOptions.trigger&&[e.FULLSCREEN.OPENED,e.FULLSCREEN.CLOSING].includes(this.fullscreenState))&&(this.hotspots.containerSize=this.imageNode.node.getBoundingClientRect(),this.isInView&&this.isSlideShown&&this.hotspots.showNeededElements()),this.imageNode&&(this.setImageWidthHeight(),this.isZoomSizeExist()?this.imageNode.addClass(e.CSS_CURSOR_ZOOM_IN):(this.hint&&this.hint.hide(),this.imageNode.removeClass(e.CSS_CURSOR_ZOOM_IN))),t=!0),this.controls&&(this.isZoomSizeExist()?this.controls.show():this.controls.hide()),this.replaceZoom(),this.zoom&&this.zoom.onResize(),t}onScroll(t){this.zoomIsOpened&&t.stop(),clearTimeout(this.longTapTimer),this.scrollDebounce()}destroy(){return this.destroyed=!0,this.loader&&(this.loader.destroy(),this.loader=null),c(m.W).removeEvent("scroll",this.onScrollHandler),this.onScrollHandler=null,this.lastTriggerAction&&(this.lastTriggerAction(),this.lastTriggerAction=null),this.hint&&(this.hint.destroy(),this.hint=null),this.image&&(this.off("imageOnload"),this.off("imageOnerror"),this.image.destroy(),this.image=null),this.controls&&(this.controls.destroy(),this.controls=null,this.off("zoomControlsAction")),this.hotspots&&(this.hotspotsTurnedOn=!1,this.instanceNode.removeEvent("tap")),this.zoom&&(this.off("zooming"),this.off("zoomUp"),this.off("zoomDown")),this.instanceNode.clearEvents(),this.instanceNode.removeClass(t+"-zoom-view"),this.imageNode&&(this.imageNode.remove(),this.imageNode=null),this.clonedImage&&(this.clonedImage=null),this.zoomDebounce.cancel(),this.zoomDebounce=null,this.scrollDebounce.cancel(),this.scrollDebounce=null,clearTimeout(this.longTapTimer),this.longTapTimer=null,this.hotspotsData=null,super.destroy(),!0}}})()}));
Sirv.define("Video",["bHelpers","magicJS","globalVariables","globalFunctions","helper","EventEmitter","Instance","defaultsVideoOptions"],((i,t,e,s,o,n,a,r)=>{const l=t;l.$;s.rootDOM.addModuleCSSByName("Video",(()=>".smv-sirv-video .js-focus-visible .vjs-menu li.vjs-menu-item:hover,.smv-sirv-video .js-focus-visible .vjs-menu li.vjs-selected:hover,.smv-sirv-video .vjs-menu li.vjs-menu-item:focus,.smv-sirv-video .vjs-menu li.vjs-menu-item:hover,.smv-sirv-video .vjs-menu li.vjs-selected,.smv-sirv-video .vjs-menu li.vjs-selected:focus,.smv-sirv-video .vjs-menu li.vjs-selected:hover{background-color:transparent;color:inherit}.smv-sirv-video .vjs-playback-rate .vjs-playback-rate-value{font-size:1.2em;line-height:2.5em;pointer-events:none}.smv-sirv-video.video-js .vjs-big-play-button,.smv-sirv-video.video-js .vjs-control-bar,.smv-sirv-video.video-js .vjs-menu-button .vjs-menu-content,.smv-sirv-video.video-js .vjs-volume-vertical{background-color:rgba(55,58,60,.8)}.smv-sirv-video{position:relative;top:0;left:0;width:100%!important;height:100%!important}.smv-sirv-video :focus{outline:0}.smv-sirv-video .vjs-poster{background-color:transparent}.smv-sirv-video .vjs-button{display:inline-block;transition:none;border:0!important;background:0 0;color:inherit;font-size:inherit;line-height:inherit;text-decoration:none;text-transform:none;-webkit-appearance:none;appearance:none}.smv-sirv-video .vjs-big-play-button{top:50%;left:50%;width:1.2em;height:1.2em;margin-top:-.6em;margin-left:-.6em;border:.04em solid transparent;border-radius:1em;color:inherit!important;font-size:5em;letter-spacing:0!important;line-height:1.2em;box-shadow:none}.smv-sirv-video:hover .vjs-big-play-button{border-color:transparent}.smv-sirv-video.vjs-controls-disabled .vjs-big-play-button,.smv-sirv-video.vjs-has-started .vjs-big-play-button{display:block;transition:opacity .25s}.smv-sirv-video.vjs-has-started.vjs-playing .vjs-big-play-button{opacity:0;pointer-events:none}.smv-sirv-video.vjs-has-started.vjs-paused .vjs-big-play-button{opacity:1}.smv-sirv-video.video-js{background-color:transparent;color:#fff;font-size:10px}.smv-sirv-video.video-js:not(.vjs-has-started) .vjs-tech{opacity:.001}.smv-sirv-video.video-js .vjs-control-bar :last-child .vjs-menu{left:100%;transform:translateX(-100%)}.smv-sirv-video.video-js .vjs-control-bar .vjs-control{color:inherit!important;box-shadow:none}.smv-sirv-video.video-js .vjs-control-bar .vjs-control .vjs-icon-placeholder{font-family:VideoJS;font-style:normal;font-weight:400;line-height:1}.smv-sirv-video.video-js.vjs-has-started .vjs-control-bar{transition:visibility .2s,opacity .2s}.smv-sirv-video.video-js .vjs-menu-button{padding:0}.smv-sirv-video.video-js .vjs-slider{background-color:rgba(255,255,255,.2)}.smv-sirv-video.video-js .vjs-progress-control .vjs-progress-holder{transform:scaleY(.6);transition:transform .1s cubic-bezier(.4,0,1,1);font-size:1.6666666667em}.smv-sirv-video.video-js .vjs-progress-control .vjs-play-progress::before{transform:scale(0);transition:transform .1s cubic-bezier(.4,0,1,1)}.smv-sirv-video.video-js .vjs-progress-control:hover .vjs-play-progress::before,.smv-sirv-video.video-js .vjs-progress-control:hover .vjs-progress-holder{transform:none}.smv-sirv-video.video-js .vjs-load-progress{background-color:transparent}.smv-sirv-video.video-js .vjs-load-progress div{background:rgba(255,255,255,.4)}.smv-sirv-video.video-js .vjs-menu{left:50%;width:8em;transform:translateX(-50%)}.smv-sirv-video.video-js .vjs-menu .vjs-menu-item{padding:.6em .6em .3em;font-size:1.2em;text-align:left;text-transform:none}.smv-sirv-video.video-js .vjs-menu .vjs-menu-item~.vjs-menu-item{padding-top:.3em}.smv-sirv-video.video-js .vjs-menu .vjs-menu-item::before{padding:0 1em;font-family:VideoJS;font-size:.66em;content:'\\f111';opacity:0}.smv-sirv-video.video-js .vjs-menu .vjs-menu-item.vjs-selected::before{opacity:1}.smv-sirv-video.video-js .vjs-volume-panel .vjs-volume-control.vjs-volume-vertical{transition:visibility .1s,opacity .1s,height .1s,width .1s,left 0s,top 0s}:root:not(.mobile-magic) .smv-sirv-video.video-js.vjs-has-started:not(:hover) .vjs-control-bar{opacity:0}.smv-disabled-action .vjs-tech{pointer-events:none!important}.smv-disabled-action .vjs-poster{pointer-events:none!important}"));return(()=>{const i="v3.9.1-ba425205".replace(/^v/,""),t="smv-disabled-action",n="https://video.sirv.com",h=50*l.DPPX,d=0,c=1,v=2,p=4,u=5,m=6,y=t=>s.loadCssFile(t,e.SIRV_ASSETS_URL+"vjs/sirv.videojs.css?v="+i,"sirv-stylesheet-vjs");return class extends a{constructor(i,t){super(i,t,r),this.type=e.SLIDE.TYPES.VIDEO,this.info=null,this.HLS=[],this.currentSize={width:0,height:0},this.videoNode=null,this.areSourcesAdded=!1,this.player=null,this.thumbnail=this.option("thumbnail"),this.currentTime=0,this.isVideoPaused=!1,this.fps=30,this.pluginResizeDebounce=null,this.playPromise=null,this.posterSize=null,this.lastAction=d,this.isPlayed=!1,this.isEnded=!1,this.seoElement=null,this.playingState=e.VIDEO.NONE,this.nativeFullscreen=t.nativeFullscreen,this.url=this.baseUrl,this.queryParams&&(this.url+="?"+this.queryParams),this.disableAction(),this.isLoadeddata=!1,this.controlsFullscreen=this.option("controls.fullscreen"),this.getInfo()}normalizeOptions(){const i=this.option("quality.min");i>this.option("quality.max")&&this.option("quality.max",i)}getSelectorImgUrl(i){return new Promise(((t,e)=>{const s=i.width||i.height;let o=this.baseUrl+"?thumbnail="+s;l.DPPX>1&&(o=this.baseUrl+"?thumbnail="+s*l.DPPX+"&quality=60"),this.thumbnail&&(o=isNaN(parseFloat(this.thumbnail))?this.thumbnail:this.getThumbnailPoster(o));const n={src:o,callbackData:i.callbackData};l.DPPX>1&&(n.srcset=o),this.getInfo().then((()=>{t(n)})).catch(e)}))}disableAction(){this.always&&[e.FULLSCREEN.CLOSED,e.FULLSCREEN.CLOSING].includes(this.fullscreenState)&&this.instanceNode.addClass(t)}enableAction(){this.always&&this.instanceNode.removeClass(t)}getInfo(){return this.gettingInfoPromise||(this.gettingInfoPromise=new Promise(((i,t)=>{this.waitGettingInfo.wait((()=>{let e=this.baseUrl;const s=l.getHashCode(this.baseUrl.replace(/^http(s)?:\/\//,""));/\?/.test(e)?e+="&":e+="?",e+="info=sirv_video_info_"+s+"_main",o.getRemoteData(e,"video_info_"+o.generateUUID(),this.referrerPolicy).then((t=>{this.destroyed||(this.info=t,this.info.QuickTime&&this.info.QuickTime.VideoFrameRate&&(this.fps=this.info.QuickTime.VideoFrameRate),this.HLS=this.info.original.HLS||[],this.HLS.length>1&&this.HLS.sort(((i,t)=>{let e=0;return i.width<t.width?e=-1:i.width>t.width?e=1:i.height<t.height?e=-1:i.height>t.height&&(e=1),e})),this.infoSize={width:this.info.original.width,height:this.info.original.height},this.option("seo")&&this.createSEO(),i(this.infoSize))})).catch((i=>{this.destroyed||t(i)}))}))}))),this.gettingInfoPromise}createSEO(){const i={"@type":"VideoObject","@context":"http://schema.org/","@id":this.url,name:this.info.original.title,description:this.info.original.description,thumbnailUrl:this.baseUrl+"?thumbnail="+(this.isHLS()?this.HLS[this.HLS.length-1].width:this.info.width||this.info.original.width),contentUrl:this.url,uploadDate:this.info.original.ctime};this.info.original.duration&&(i.duration=(i=>{i=Math.floor(i);const t=Math.floor(i/3600),e=Math.floor(i%3600/60),s=Math.floor(i%3600%60);let o="PT";return t>0&&(o+=t+"H"),e>0&&(o+=e+"M"),s>0&&(o+=s+"S"),"PT"===o&&(o+="0S"),o})(this.info.original.duration));const t=l.$new("script");t.attr("type","application/ld+json"),t.node.textContent=JSON.stringify(i),t.appendTo(document.head),this.seoElement=t}getInfoSize(){return new Promise(((i,t)=>{this.getInfo().then((()=>{i({size:this.infoSize})})).catch((i=>{t({error:i})}))}))}addSources(){const t=s.getNodeWithSirvClassName(this.instanceNode)||l.D.node.head||l.D.node.body;Promise.all([y(l.D.node.head||l.D.node.body),y(t),s.loadJsFile(e.SIRV_ASSETS_URL+"vjs/sirv.videojs.js?v="+i)]).finally((()=>{window.Sirv.require("qualitySelector",(()=>{this.areSourcesAdded=!0,this.isStarted&&this.isInView&&(this.preload||this.isSlideShown)&&this.createVideoNode()}))}))}onStartActions(i){this.ready?this.player&&this.isInView&&(this.fullscreenState===e.FULLSCREEN.OPENED&&this.always&&this.option("controls.enable")&&(this.player.controlBar.show(),this.player.bigPlayButton.show()),!this.option("autoplay")||!this.player.paused()||this.fullscreenState!==e.FULLSCREEN.OPENED&&this.always||(this.player.muted(!0),this.isPlayed?this.lastAction=p:i===e.SLIDE_SHOWN_BY.USER&&(this.lastAction=c),this.play())):this.isStarted&&this.isInView&&this.isSlideShown&&!this.preload&&this.areSourcesAdded&&this.createVideoNode()}onStopActions(){this.player&&(this.player.paused()||this.playingState!==e.VIDEO.PLAYING||(this.lastAction=m,this.pause()))}onInView(i){i?this.ready?this.player&&this.isSlideShown&&i&&(this.option("autoplay")||this.playingState!==e.VIDEO.NONE&&!this.isVideoPaused)&&(this.lastAction=v,this.play()):this.isStarted&&!this.isInView&&(this.preload||this.isSlideShown)&&this.areSourcesAdded&&(this.isInView=!0,this.createVideoNode()):this.player&&(this.isVideoPaused=this.playingState===e.VIDEO.PAUSE,this.player.paused()||this.playingState!==e.VIDEO.PLAYING||(this.lastAction=u,this.pause()))}startFullInit(i){this.isStartedFullInit||(super.startFullInit(i),this.normalizeOptions(),this.thumbnail=this.option("thumbnail"),this.getId("video-"),this.instanceNode.addClass("sirv-video"),this.instanceNode.addEvent("mousedown",(i=>{i.stop()})))}onBeforeFullscreenIn(i){this.controlsFullscreen=!1,this.player&&(this.isVideoPaused=this.playingState===e.VIDEO.PAUSE,this.toggleFullscreenButton())}onAfterFullscreenIn(i){this.enableAction(),this.isSlideShown&&this.isInView&&this.player&&this.player.paused()&&(this.always&&this.option("controls.enable")&&(this.player.controlBar.show(),this.player.bigPlayButton.show()),this.option("autoplay")&&!this.isVideoPaused&&(this.player.currentTime(this.currentTime),this.playingState=e.VIDEO.PLAY,this.player.play_()))}onBeforeFullscreenOut(i){this.disableAction(),this.option("controls.fullscreen")&&(this.controlsFullscreen=!0),this.player&&(this.isVideoPaused=this.playingState===e.VIDEO.PAUSE,this.toggleFullscreenButton())}onAfterFullscreenOut(i){this.isSlideShown&&this.isInView&&this.player&&(this.always&&this.option("controls.enable")&&(this.player.controlBar.hide(),this.player.bigPlayButton.hide()),this.option("autoplay")&&!this.isVideoPaused&&(this.lastAction=c,this.play()))}onSecondSelectorClick(){this.player&&this.isSlideShown&&this.isInView&&(this.fullscreenState!==e.FULLSCREEN.OPENED&&this.always||(this.player.paused()?(this.lastAction=c,this.play()):this.playingState===e.VIDEO.PLAYING&&this.isLoadeddata&&this.pause()))}createVideoNode(){this.videoNode||(this.videoNode=l.$new("video",{class:"smv-sirv-video",preload:"none"}),this.videoNode.addClass("video-js"),this.instanceNode.append(this.videoNode),this.waitToStart.start(),this.done())}play(){this.player&&!this.playPromise&&(this.playingState=e.VIDEO.PLAY,this.playPromise=this.player.play())}pause(){this.player&&(this.playPromise||new Promise((i=>i(null)))).then((()=>{this.player.pause(),this.playPromise=null})).catch((()=>{this.player.pause(),this.playPromise=null}))}loadContent(){this.createVideoNode()}run(i,t,e){const s=super.run(i,t,e);return s&&(this.calcContainerSize(),this.isInView&&(this.preload||this.isSlideShown)&&this.areSourcesAdded&&this.createVideoNode(),this.startGettingInfo()),s}createMasterManifest(){const i=["#EXTM3U"],t=this.option("motionFactor"),e=this.option("dynamicAdaptiveStreaming");return this.HLS.forEach((s=>{let o="#EXT-X-STREAM-INF:PROGRAM-ID=1,";var a,r,l;e&&(o+="BANDWIDTH="+(a=s,r=this.fps,l=t,parseInt(a.width*a.height*r*l*.07,10)+",")),o+="RESOLUTION="+s.width+"x"+s.height,i.push(o),i.push(n+s.index)})),i.join("\n")}toggleFullscreenButton(){const i=this.player.controlBar.getChild("FullscreenToggle"),t=this.player.options_.userActions;this.controlsFullscreen?(t.doubleClick=!0,i.show()):(t.doubleClick=!1,i.hide())}isHLS(){return this.HLS.length>0&&"ie"!==l.browser.uaName}getThumbnailSize(){const i=this.isHLS()?this.HLS[this.HLS.length-1].height:this.info.height||this.info.original.height||140;let t=i;return this.currentSize.height<t&&(t=this.currentSize.height),t*=l.DPPX,t>i&&(t=i),t}get posterUrl(){return this.getThumbnailPoster(this.baseUrl+"?thumbnail="+this.posterSize)}done(){if(!this.ready){this.posterSize=this.getThumbnailSize();const i=this.posterUrl;let t={inline:!1};!1===this.option("controls.volume")&&(t=!1);const s={nativeTextTracks:!1,nativeAudioTracks:!1,nativeVideoTracks:!1},a=this.isHLS(),r={overrideNative:a&&"safari"!==l.browser.uaName};s.smoothQualityChange=!0,s.vhs=r;const h={controls:this.option("controls.enable"),fluid:!1,muted:0===this.option("volume")||this.option("autoplay"),loop:this.option("loop"),autoplay:this.option("autoplay")&&this.isSlideShown,preload:this.option("autoplay")||this.option("preload")?"auto":"none",playbackRates:[.5,1,1.5,2],textTrackSettings:!1,controlBar:{fullscreenToggle:!0,volumePanel:t,muteToggle:!1,playbackRateMenuButton:this.option("controls.speed"),children:["playToggle","currentTimeDisplay","timeDivider","durationDisplay","progressControl","remainingTimeDisplay","volumePanel","customControlSpacer","playbackRateMenuButton","fullscreenToggle"]},poster:i,playsinline:!0,html5:s,userActions:{doubleClick:!0},qualityLevels:{}};if(a)this.player=l.W.node.videojs(this.videoNode.node,h),"safari"!==l.browser.uaName&&this.player.src({src:"data:application/x-mpegURL;base64,"+window.btoa(this.createMasterManifest()),type:"application/x-mpegURL"}),this.player.hlsQualitySelectorAutoMode({visibility:this.option("controls.quality"),hls:this.HLS,host:n,max:this.option("quality.max"),min:this.option("quality.min"),width:this.info.original.width,height:this.info.original.height}),this.pluginResizeDebounce=o.debounce((()=>{this.player.hlsQualitySelectorAutoMode.recalc()}),600);else{h.src=this.url;const i=(i=>{switch(i=(i=(i=(i=(i=i||"").split("?")[0]).split("."))[i.length-1]).toLowerCase()){case"3gp":i="video/3gpp";break;case"flv":i="video/flv";break;case"mp4":i="video/mp4";break;case"ogv":i="video/ogg";break;case"webm":i="video/webm";break;default:i=""}return i})(this.url);this.videoNode.append(l.$new("source",{src:this.url,type:i})),this.player=l.W.node.videojs(this.videoNode.node,h)}this.player.volume(parseInt(this.option("volume"),10)/100),this.toggleFullscreenButton(),this.player.on("loadeddata",(()=>{this.isLoadeddata=!0})),this.player.on("play",(()=>{if(this.isVideoPaused=!1,this.playingState=e.VIDEO.PLAYING,this.isSlideShown&&this.isInView){let i="user";this.lastAction===v?i="viewport":this.lastAction===c?i="autoplay":this.lastAction===p&&(i="itemchange"),this.lastAction=d,this.isPlayed?this.sendEvent("resume",{event:{reason:i,playbackTime:this.player.currentTime()}}):(this.isPlayed=!0,this.sendEvent("play",{event:{reason:i}}))}else this.lastAction=u,this.pause()})),this.player.on("pause",(()=>{if(this.player.currentTime()===this.player.duration())return;this.playingState=e.VIDEO.PAUSE;let i="user";this.lastAction===u?i="viewport":this.lastAction===m&&(i="itemchange"),this.lastAction=d,this.sendEvent("pause",{event:{reason:i,playbackTime:this.player.currentTime()}})})),this.player.on("ended",(()=>{this.isPlayed=!1,this.isEnded=!0,this.playingState=e.VIDEO.PAUSE,this.sendEvent("end")})),this.player.on("fullscreenchange",(()=>{let i="fullscreenOut";this.player.isFullscreen()&&(i="fullscreenIn"),this.sendEvent(i,{event:{playbackTime:this.player.currentTime()}})}));let y=null,g=0,S=0;this.player.on("timeupdate",(()=>{g=S,S=this.player.currentTime()})),this.player.on("seeking",(()=>{null===y&&(y=g)})),this.player.on("seeked",(()=>{this.isEnded?this.isEnded=!1:this.sendEvent("seek",{event:{seekStart:y,seekEnd:this.player.currentTime()}}),y=null})),this.player.on("error",(i=>{console.log("error",i)})),l.browser.touchScreen&&l.browser.mobile&&this.player.on("touchstart",(i=>{"video"===l.$(i.target).tagName&&this.player.hasClass("vjs-user-active")&&(this.player.paused()?(this.lastAction=c,this.play()):this.pause())})),this.player.on("ready",(()=>{this.option("controls.fullscreen")||this.player.off(this.player.tech_,"dblclick",this.player.handleTechDoubleClick_),this.option("controls.enable")&&this.fullscreenState!==e.FULLSCREEN.OPENED&&this.always&&(this.player.controlBar.hide(),this.player.bigPlayButton.hide()),this.isSlideShown&&this.isInView&&this.option("autoplay")&&(this.fullscreenState!==e.FULLSCREEN.OPENED&&this.always||(this.player.muted(!0),this.lastAction=c,this.play(),this.player.muted(!0))),super.done(),this.sendContentLoadedEvent()}))}}getThumbnailPoster(i){let t=i;if(t||(t=""),this.thumbnail||0===this.thumbnail){const i="&video.thumbPos=",e=parseFloat(this.thumbnail);!isNaN(e)&&e<this.info.original.duration?t+=i+this.thumbnail:/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/i.test(this.thumbnail)&&(t=this.thumbnail)}return t}calcContainerSize(){const i=this.instanceNode.size;if(i.height&&i.width)this.currentSize=i;else{const t={width:0,height:0};t.width=this.info.original.width,t.height=this.info.original.height,i.height?(this.currentSize.height=i.height,this.currentSize.width=t.width/t.height*i.height):(this.currentSize.width=i.width,this.currentSize.height=t.height/t.width*i.width)}}createPinchEvent(){super.createPinchEvent(this.instanceNode),this.pinchCloud.onPinchStart=i=>{[e.FULLSCREEN.OPENING,e.FULLSCREEN.CLOSING].includes(this.fullscreenState)||(this.pinchCloud.pinch=!0,this.pinchCloud.scale=i.scale,this.sendEvent("pinchStart"))},this.pinchCloud.onPinchMove=i=>{if(this.pinchCloud.pinch&&!this.pinchCloud.block){const t=i.scale-this.pinchCloud.scale;this.fullscreenState===e.FULLSCREEN.OPENED?t<-.08&&(this.pinchCloud.block=!0,this.sendEvent("fullscreenOut")):i.scale>=.11&&(this.pinchCloud.block=!0,this.sendEvent("fullscreenIn"))}}}onResize(){if(this.player){if(this.isSlideShown&&this.isInView||this.player.paused()||this.playingState!==e.VIDEO.PLAYING||this.pause(),this.pluginResizeDebounce&&this.pluginResizeDebounce(),this.playingState===e.VIDEO.NONE){this.calcContainerSize();const i=this.getThumbnailSize();i>this.posterSize&&i-this.posterSize>=h&&(this.posterSize=i,this.player.poster(this.posterUrl))}return!0}return!1}destroy(){return this.seoElement&&(this.seoElement.remove(),this.seoElement=null),this.player&&(this.player.off(),this.player.dispose(),this.player=null),this.videoNode&&(this.videoNode.remove(),this.videoNode=null),this.pluginResizeDebounce&&(this.pluginResizeDebounce.cancel(),this.pluginResizeDebounce=null),this.instanceNode.clearEvents(),this.instanceNode.removeClass("sirv-video"),this.instanceNode.removeClass(t),this.playPromise=null,this.HLS=[],super.destroy(),!0}}})()}));
Sirv.define("LazyImage",["bHelpers","magicJS","globalVariables","globalFunctions","helper","ResponsiveImage","BaseInstance","getDPPX"],((t,i,e,s,a,h,n,o)=>{const r=i,d=r.$,c={resize:{type:"boolean",defaults:!0},threshold:{type:"number",minimum:0,defaults:0},fit:{type:"string",enum:["contain","cover","crop","none"],defaults:"contain"},quality:{type:"number",minimum:0,maximum:100,defaults:80},hdQuality:{type:"number",minimum:0,maximum:100,defaults:60},autostart:{oneOf:[{type:"string",enum:["created","visible","off"]},{type:"boolean",enum:[!1]}],defaults:"visible"},onReady:{type:"function",defaults:()=>{}}};class l{constructor(t){this.node=d(t),this.state=0,this.states=d(["sirv-image-loading","sirv-image-loaded"])}setState(t){this.state!==t&&(this.state-1>=0&&this.node.removeClass(this.states[this.state-1]),this.state=t,this.node.addClass(this.states[t-1]))}destroy(){this.state=0,this.states.forEach((t=>{this.node.removeClass(t)})),this.node=null}}const g="smv",m=t=>{const i=t.getBoundingClientRect();return!(0===i.top&&0===i.right&&0===i.bottom&&0===i.left&&0===i.width&&0===i.height)};return class extends n{constructor(t,i,s){i.options={common:{common:i.options.common,mobile:{}},local:{common:"",mobile:""}},super(t,i,c),this.node=this.instanceNode,this.type=e.SLIDE.TYPES.IMAGE,this.isLazy="visible"===this.option("autostart"),this.image=null,this.isInfoLoaded=!1,this.infoSize={width:0,height:0},this.isNotSirv=!1,this.isInView=!1,this.isStaticImage=!1,this.dppx=1,this.getImageInfoPromise=null,this.loadStaticImagePromise=null,this.upscale=!1,this.size={width:0,height:0},this.maxSize={},this.lastImageSize={width:0,height:0},this.srcWasSetted=!1,this.originAlt=null,this.infoAlt=null,this.originTitle=null,this.src=null,this.srcset=null,this.startedSrc=null,this.dataSrc=null,this.imageUrl=null,this.dontLoad=!0,this.appearanceState=null,this.dataBgSrc=null,this.inViewModule=null,this.rootMargin=0,this.fitSize=null,this.backgroundNodeSize=null,this.isMaxWidthSet=!1,this.cropPosition={x:null,y:null},this.cssBackgroundSize=null,this.isPlaceholder=!1,this.isRun=!1,this.inited=!1,this.resizeDebounce=a.debounce((()=>{this._setRootMargin(),this.onResize()}),50),this.resizeHandler=t=>{this.resizeDebounce()};const h=this.instanceOptions.get("autostart");(h&&"off"!==h||s)&&this.preInit()}preInit(){this.isRun=!0,this.inViewModule=new a.InViewModule((t=>{t.forEach((t=>{const i=t.isIntersecting||t.intersectionRatio>0;this.isInView!==i&&(this.inited?this.inViewCallback(i):(this.isInView=i,(i||m(this.instanceNode.node))&&this.init()))}))}),{rootMargin:this.rootMargin+"px 0px"}),this.inViewModule.observe(this.instanceNode),m(this.instanceNode.node)&&this.init()}init(){this.inited=!0;try{this.maxWidth=this.instanceNode.node.style.maxWidth}catch(t){}this._getBaseData(),this.imageUrl&&(r.browser.ready||"loading"!==r.D.node.readyState)&&this.startFullInit(),this.createSirvImage()}stop(){return this.destroy(),!0}getOptionsForStartFullInit(t){t&&(t={common:{common:t.common.lazyImage||{},mobile:t.mobile.lazyImage||{}},local:{common:"",mobile:""}}),super.getOptionsForStartFullInit(t)}checkReadiness(t,i){return"onLoad"===t&&this.ready}_setRootMargin(){let t=parseInt(this.option("threshold"),10);"string"===r.typeOf(this.option("threshold"))&&(t=(r.W.node.innerHeight||r.D.node.documentElement.clientHeight)/100*t),this.rootMargin=t}_getQueryParams(){if(this.imageUrl){if(this.queryParams=a.paramsFromQueryString(this.imageUrl.replace(e.REG_URL_QUERY_STRING,"$2")),this.queryParams){const t=parseInt(this.queryParams.quality,10);isNaN(t)?delete this.queryParams.quality:this.queryParams.quality=t}this.queryParamsQuality=this.queryParams.quality||null}}_getBaseData(){this.originAlt=this.instanceNode.attr("alt"),this.originTitle=this.instanceNode.attr("title"),this.src=this.instanceNode.attr("src"),this.srcset=this.instanceNode.attr("srcset"),this.startedSrc=this.src,this.dataSrc=this.instanceNode.attr("data-src"),this.isStaticImage=this.src&&!this.dataSrc,this.imageUrl=this.dataSrc||this.src,(a.isSVG(this.imageUrl)||"static"===this.instanceNode.attr("data-type"))&&(this.isNotSirv=!0),this.dataBgSrc=this.instanceNode.attr("data-bg-src"),this.isStaticImage=this.isStaticImage&&!this.dataBgSrc,this.imageUrl=this.dataBgSrc||this.imageUrl,"img"===this.instanceNode.tagName&&(this.instanceNode.attr("referrerpolicy",this.referrerPolicy),this.dataBgSrc&&(this.dataSrc||(this.dataSrc=this.dataBgSrc),this.dataBgSrc=null)),this.dataBgSrc&&(this.dontLoad=!1),this.imageUrl&&(this.src=s.normalizeURL(this.imageUrl.replace(e.REG_URL_QUERY_STRING,"$1"))),this._getQueryParams(),this.startedSrc&&this.dataSrc&&this.startedSrc!==this.dataSrc&&(this.isPlaceholder=this.instanceNode.attr("src"))}createSirvImage(){this.imageUrl&&!this.isNotSirv&&(this.on("imageOnload",(t=>{if(t.stopAll(),this.replaceSrc(),!this.ready)if(this.isStaticImage)this.done();else{const i=()=>{this.appearanceState&&(this.appearanceState.setState(2),this.done())};t.data.node?i():a.loadImage(this.instanceNode).finally((()=>{i()}))}})),this.on("imageOnerror",(t=>{t.stopAll(),console.log("image error")})),this.image=new h(this.imageUrl,{imageSettings:this.queryParams,round:!0,dontLoad:this.dontLoad,convertSmallerSideToZero:"crop"!==this.option("fit"),referrerPolicy:this.referrerPolicy}),this.image.parentClass=this,this.getInfoSize().catch((t=>{t._isplaceholder&&(this.infoSize=t,this.isNotSirv=!0)})).finally((()=>{"loading"!==r.D.node.readyState&&this.isStartedFullInit&&this.run()})))}getInfoSize(){return this.getImageInfoPromise||(this.getImageInfoPromise=new Promise(((t,i)=>{this.image?this.image.loadInfo().then((i=>{this.isInfoLoaded=!0,this.infoAlt=this.image.description,this.infoSize=this.image.originSize,this.cropPosition=this.image.getCropPosition(),t(i)})).catch((t=>{this.isInfoLoaded=!0,t.status&&404===t.status||(this.isNotSirv=!0),i(t)})):i()}))),this.getImageInfoPromise}getId(t,i){this.id=this.instanceNode.attr("id"),this.id||this.isStaticImage||super.getId(t,i)}startFullInit(t,i){if(this.isStartedFullInit||!this.inited)return;this.getOptionsForStartFullInit(t);const e=this.option("autostart");if(!this.inited&&!(e&&"off"!==e||i))return;super.startFullInit(t),t&&(this.isLazy="visible"===this.option("autostart")),this.getId("responsive-image-"," "),this.dataBgSrc&&(this.cssBackgroundSize=a.imageLib.getBackgroundSize(this.instanceNode),this.cssBackgroundSize&&this.option("fit","none"),this.instanceNode.addClass(g+"-bg-image"),"none"!==this.option("fit")&&("contain"===this.option("fit")?this.instanceNode.addClass(g+"-bg-contain"):this.instanceNode.addClass(g+"-bg-cover"))),this._setRootMargin(),this.isStaticImage?this.isLazy=!1:(this.appearanceState=new l(this.instanceNode),this.isPlaceholder||this.appearanceState.setState(1));const s="img"===this.instanceNode.tagName;this.isLazy&&s&&this.instanceNode.attr("loading","lazy"),(!this.isLazy||s&&"ie"!==r.browser.uaName)&&(this.isInView=!0,this.inViewModule.disconnect(),this.inViewModule=null),(this.isInfoLoaded||this.isNotSirv)&&"loading"!==r.D.node.readyState&&this.run(),r.W.addEvent("resize",this.resizeHandler)}fixHeight(t){if(0!==t){(t===parseInt(this.instanceNode.getCss("block-size"),10)||t<=16)&&(t=0)}return t}run(){const t=super.run();if(t){this.instanceNode.removeAttr("alt"),this.instanceNode.removeAttr("title"),this.instanceNode.setCss({display:"inline-flex"}).render(),this.instanceNode.setCss({display:""}).render();let t=null;a.imageLib.getSize(this.instanceNode).then((i=>{t=i})).finally((()=>{if(!this.destroyed){if(t=a.fixSize(this.instanceNode,t),0===t.width&&0===t.height&&(this.instanceNode.setCss({width:"100%"}),t.width=this.instanceNode.size.width),0===t.width&&0===t.height&&(t.width=r.W.node.innerWidth),"contain"===this.option("fit")?this.fitSize={width:"contain",height:"contain"}:this.fitSize={width:"cover",height:"cover"},"none"===this.option("fit")?this.cssBackgroundSize?this.size=a.imageLib.calcProportionalBackgroundSize(this.cssBackgroundSize,this.infoSize):this.size=this.infoSize:this.size=a.imageLib.calcProportionSize(t,this.infoSize,this.fitSize),!this.dataBgSrc){const t=this.instanceNode.getCss("objectFit");this.maxWidth||!(this.infoSize.width>0)||t&&"fill"!==t||this.instanceNode.attr("width")||(this.isMaxWidthSet=!0,this.instanceNode.setCss({maxWidth:this.infoSize.width}))}(this.originAlt||this.infoAlt)&&this.instanceNode.attr("alt",this.originAlt||this.infoAlt),this.originTitle&&this.instanceNode.attr("title",this.originTitle),this.isStaticImage?this.loadStaticImage().finally((()=>{this.isInfoLoaded&&this.done()})):this.isLazy&&!this.isInView||this.getImage()}}))}return t}_setSrc(t,i){this.dataBgSrc?this.instanceNode.setCss({backgroundImage:'url("'+(i||t)+'")'}):(this.instanceNode.attr("src",t),i?!this.isNotSirv&&this.dppx>1&&this.instanceNode.attr("srcset",i+" "+this.dppx+"x"):this.instanceNode.removeAttr("srcset"))}_setHDQuality(t){if(t.dppx>1&&t.dppx<1.5){const i=this.instanceOptions.isset("quality")?this.option("quality"):null;null===this.queryParamsQuality&&null!==i?t.srcset.quality=i:t.srcset&&delete t.srcset.quality}return t}replaceSrc(){let t;if(this.isNotSirv){if(this.srcWasSetted)return;this.srcWasSetted=!0,t={src:this.imageUrl}}else{let i=this._getImageCreateSettings();i.dppx>1&&i.dppx<1.5&&delete i.srcset.quality,i=this._setHDQuality(i),t=this.image.getImage(i),this.lastImageSize.width=t.width||t.serverWidth,this.lastImageSize.height=t.height||t.serverHeight}this._setSrc(t.src,t.srcset)}loadStaticImage(){return this.loadStaticImagePromise||(this.loadStaticImagePromise=new Promise(((t,i)=>{this.isStaticImage?this.instanceNode.node.complete?t():(this.instanceNode.addEvent("load",(i=>{t()})),this.instanceNode.addEvent("error",(t=>{i()}))):t()}))),this.loadStaticImagePromise}_getImageCreateSettings(){let t={src:{},srcset:{}};const i=this.instanceOptions.isset("quality")?this.option("quality"):null;null!==i&&null===this.queryParamsQuality&&(t.src.quality=i);const e=this.option("hdQuality");return(null===this.queryParamsQuality||this.instanceOptions.isset("hdQuality")&&e<this.queryParamsQuality)&&(t.srcset={quality:e}),t.width=this.size.width,this.size.height&&(t.height=this.size.height),t=a.imageLib.checkMaxSize(t,this.infoSize),this.infoSize.width!==t.width&&this.infoSize.height!==t.height||(t.round=!1),r.DPPX>1&&(t.dppx=this.dppx),"crop"===this.option("fit")&&(t.round=!1),t=this.setCrop(t),t}setCrop(t){if("crop"===this.option("fit")){const i=d(this.instanceNode.node).getInnerSize(!!this.dataBgSrc);t.imageSettings||(t.imageSettings={}),t.imageSettings.crop||(t.imageSettings.crop={}),t.imageSettings.crop={x:this.cropPosition.x||"center",y:this.cropPosition.y||"center",width:i.width,height:i.height}}return t}getImage(){this.isStaticImage||(this.isNotSirv?this.getNonSirvImg():this.getSirvImg())}getNonSirvImg(){this.isPlaceholder?a.loadImage(this.dataSrc).finally((()=>{this.replaceSrc(),this.appearanceState.setState(2),this.done()})):(this.replaceSrc(),this.appearanceState.setState(2),this.done())}get imageClassContainer(){return this.image}getSirvImg(){let t=this._getImageCreateSettings();if(t.width&&(this.maxSize.width=t.width),t.height&&(this.maxSize.height=t.height),r.DPPX>1){const i=this.image.originSize;this.dppx=o(t.width,t.height,i.width,i.height,!r.defined(t.round)||t.round,this.upscale),t.dppx=this.dppx}t=this._setHDQuality(t),this.checkImage(t)?this.replaceSrc():this.image.getImage(t)}checkSize(t){const i=this.infoSize.width,e=this.infoSize.height;return(t.width>i||t.height>e)&&(t.width=i,t.height&&(t.height=e),t.round=!1),t}done(){super.done(),this.option("onReady")(this.id),this.sendEvent("ready")}inViewCallback(t){t&&!this.isStaticImage&&(this.ready||this.isInView||this.isStarted&&(this.isInView=!0,this.isNotSirv?this.srcWasSetted||this.getImage():this.isInfoLoaded&&this.getImage())),this.isInView=t}sendEvent(t,i){i||(i={}),i.image||(i.image={}),i.image.event||(i.image.event={}),"ready"===t&&(t="onLoad"),i.type=t,i.image.id=this.id,i.image.url=this.instanceUrl,i.image=Object.assign(i.image,this.api),i.node=this.instanceNode,i.image.node=this.instanceNode.node,i.image.event.timestamp=Date.now(),i.image.event.type="lazyimage:"+t,this.emit("imagePublicEvent",{data:i})}get originImageUrl(){return this.src}onResize(){if(!this.isStarted||this.isStaticImage||!this.option("resize")||this.isNotSirv)return!1;let t;if(["crop","cover"].includes(this.option("fit"))?t=d(this.instanceNode.node.parentNode).size:(t=this.instanceNode.size,t.height=this.fixHeight(t.height)),t=a.imageLib.calcProportionSize(t,this.infoSize,this.fitSize),this.size.width=t.width,this.size.height&&(this.size.height=t.height),this.ready&&!this.isNotSirv){const t=50;"crop"===this.option("fit")?(Math.abs(this.size.width-this.lastImageSize.width)>t||Math.abs(this.size.height-this.lastImageSize.height)>t)&&this.getImage():(this.size.width-this.lastImageSize.width>t||this.size.height-this.lastImageSize.height>t)&&this.getImage()}return!0}destroy(){if(this.dataBgSrc&&(this.instanceNode.removeClass(g+"-bg-image"),this.instanceNode.setCssProp("background-image","")),this.isMaxWidthSet&&(this.isMaxWidthSet=!1,this.instanceNode.setCss({maxWidth:""})),this.appearanceState&&this.appearanceState.destroy(),this.inViewModule&&(this.inViewModule.disconnect(),this.inViewModule=null),r.W.removeEvent("resize",this.resizeHandler),this.resizeDebounce.cancel(),this.resizeDebounce=null,this.image&&(this.off("imageOnload"),this.off("imageOnerror"),this.image.destroy(),this.image=null),this.instanceNode.node.hasAttribute("src"))try{this.instanceNode.removeAttr("src"),this.isStaticImage&&this.instanceNode.attr("src",this.imageUrl)}catch(t){}if(this.isStaticImage?this.instanceNode.attr("src",this.src):this.instanceNode.removeAttr("src"),this.srcset)this.instanceNode.attr("srcset",this.srcset);else try{this.instanceNode.removeAttr("srcset")}catch(t){}this.srcset=null,!this.originAlt&&this.infoAlt&&this.instanceNode.removeAttr("alt"),this.instanceNode.removeEvent("load"),this.isPlaceholder&&(this.instanceNode.attr("src",this.isPlaceholder),this.isPlaceholder=!1),super.destroy()}}}));
Sirv.define("Slider",["bHelpers","magicJS","globalVariables","globalFunctions","ResponsiveImage","helper","EventEmitter","ContextMenu","ComponentLoader","defaultsVideoOptions","ViewerImage","SliderBuilder","ProductDetail","Description","Spin","Zoom","Video"],((e,t,s,i,n,o,r,l,a,h,d,c,u,p,m,f,S)=>{const v=t,y=v.$,g="smv",b="smv-thumbnail";v.W.node.devicePixelRatio;const C={orientation:{type:"string",enum:["horizontal","vertical"],defaults:"horizontal"},arrows:{type:"boolean",defaults:!0},loop:{type:"boolean",defaults:!0},quality:{type:"number",minimum:0,maximum:100,defaults:80},hdQuality:{type:"number",minimum:0,maximum:100,defaults:60},itemsOrder:{type:"array",defaults:[]},autostart:{oneOf:[{type:"string",enum:["created","visible","off"]},{type:"boolean",enum:[!1]}],defaults:"visible"},threshold:{type:"number",minimum:0,defaults:0},slide:{first:{type:"number",minimum:0,defaults:0},delay:{type:"number",minimum:9,defaults:3e3},preload:{type:"boolean",defaults:!0},autoplay:{type:"boolean",defaults:!1},animation:{type:{oneOf:[{type:"string",enum:["off","slide","fade"]},{type:"boolean",enum:[!1]}],defaults:"fade"},duration:{type:"number",minimum:9,defaults:200}},socialbuttons:{enable:{type:"boolean",defaults:!1},types:{facebook:{type:"boolean",defaults:!0},twitter:{type:"boolean",defaults:!0},linkedin:{type:"boolean",defaults:!0},reddit:{type:"boolean",defaults:!0},tumblr:{type:"boolean",defaults:!0},pinterest:{type:"boolean",defaults:!0},telegram:{type:"boolean",defaults:!0}}}},thumbnails:{enable:{type:"boolean",defaults:!0},size:{type:"number",minimum:5,defaults:70},position:{type:"string",enum:["top","left","right","bottom"],defaults:"bottom"},type:{type:"string",enum:["square","auto","bullets","grid","crop"],defaults:"square"},always:{type:"boolean",defaults:!1},target:{oneOf:[{type:"string"},{type:"boolean",enum:[!1]}],defaults:!1},watermark:{type:"boolean",defaults:!0}},fullscreen:{enable:{type:"boolean",defaults:!0},always:{type:"boolean",defaults:!1},native:{type:"boolean",defaults:!1},history:{type:"boolean",defaults:!0},thumbnails:{enable:{type:"boolean",defaults:!0},size:{oneOf:[{type:"string",enum:["auto"]},{type:"number",minimum:5}],defaults:"auto"},position:{type:"string",enum:["top","left","right","bottom"],defaults:"bottom"},type:{type:"string",enum:["square","auto","bullets","grid","crop"],defaults:"square"},always:{type:"boolean",defaults:!1},autohide:{type:"boolean",defaults:!1},watermark:{type:"boolean",defaults:!0}}},contextmenu:{enable:{type:"boolean",defaults:!1},text:{zoom:{in:{oneOf:[{type:"string"},{type:"boolean",enum:[!1]}],defaults:"Zoom In"},out:{oneOf:[{type:"string"},{type:"boolean",enum:[!1]}],defaults:"Zoom Out"}},fullscreen:{enter:{oneOf:[{type:"string"},{type:"boolean",enum:[!1]}],defaults:"Enter Full Screen"},exit:{oneOf:[{type:"string"},{type:"boolean",enum:[!1]}],defaults:"Exit Full Screen"}},download:{oneOf:[{type:"string"},{type:"boolean",enum:[!1]}],defaults:"Download Image"}}},productdetail:{enable:{type:"boolean",defaults:!1},position:{type:"string",enum:["top","right","bottom","left"],defaults:"top"}}};class E extends r{constructor(e,t,i){super(),this.node=y(e),this.options=t,this._type=s.SLIDE.TYPES.NONE,this.imgSrc=null,this.effect=null,this.additionalEffects=[],this.isStarted=!1,this.isPrepared=!1,this.toolOptions={},this.api={},this.isActive=!1,this.additionalOptions=i,this.parse(),this.setEvents()}static isExist(e){let t=!1;const i=o.getSirvType(e);return i&&{Image:d,Spin:m,Zoom:f,Video:S}[v.camelize("-"+s.SLIDE.NAMES[i.type])]&&(t=!0),t}createAPI(){if(this.effect){this.api=this.effect.api;let e=[];const t=s.SLIDE.TYPES;switch(this._type){case t.SPIN:e=["play","rotate","rotateX","rotateY","zoomIn","zoomOut"];break;case t.ZOOM:this.api.zoomIn&&(e=["zoomIn","zoomOut"])}e.forEach((e=>{const t=this.api[e];this.api[e]=(...e)=>{let s=!1;const i=t;return this.isActive&&(s=i.apply(this,e)),s}}))}}setEvents(){this.on("stats",(e=>{e.stopEmptyEvent(),e.data.component=s.SLIDE.NAMES[this._type]})),this.on("componentEvent",(e=>{e.stopEmptyEvent(),e.data.component=s.SLIDE.NAMES[this._type],"ready"===e.data.type&&(this._type===s.SLIDE.TYPES.IMAGE&&null!==e.data.data.imageIndex&&e.stopAll(),this.toolOptions=this.effect.options)}))}parse(){const e=o.getSirvType(this.node.node);e&&(this._type=e.type,this.imgSrc=e.imgSrc)}push(e){if(d){const t=new d(e,{options:this.options.image,isFullscreen:this.additionalOptions.isFullscreen,imageIndex:this.additionalEffects.length});t.parentClass=this,this.additionalEffects.push({node:e,src:y(e).attr("src"),datasrc:y(e).attr("data-src"),effect:t})}}sendEvent(e){this.effect&&this.effect.sendEvent&&this.effect.sendEvent(e)}resize(){this.broadcast("resize")}startFullInit(e){this.effect&&(this.effect.startFullInit(e?e[this._type]:null),this.additionalEffects.length&&this.additionalEffects.forEach((t=>{t.effect&&t.effect.startFullInit(e?e[this._type]:null)})))}getSelectorImgUrl(e){return this.effect.getSelectorImgUrl(e)}getInfoSize(){let e=null;return e=this._type===s.SLIDE.TYPES.IMAGE?new Promise(((e,t)=>{Promise.all([this.effect.getInfoSize()].concat(this.additionalEffects.map((e=>e.effect.getInfoSize())))).then((t=>{e(t[0])})).catch(t)})):this.effect.getInfoSize(),e}start(){if(this.isPrepared)return;this.isPrepared=!0;const e={isFullscreen:this.additionalOptions.isFullscreen,quality:this.additionalOptions.quality,hdQuality:this.additionalOptions.hdQuality,isHDQualitySet:this.additionalOptions.isHDQualitySet,always:this.additionalOptions.always,nativeFullscreen:this.additionalOptions.nativeFullscreen},t=s.SLIDE.TYPES;switch(this._type){case t.IMAGE:d&&(this.effect=new d(this.node.node,Object.assign(e,{options:this.options.image,imageIndex:null})),this.effect.parentClass=this);break;case t.PANZOOM:case t.ZOOM:f&&(this.effect=new f(this.node.node,Object.assign(e,{options:this.options.zoom})),this.effect.parentClass=this);break;case t.SPIN:m&&(this.node.setCss({width:"100%",height:"100%"}),this.effect=new m(this.node.node,Object.assign(e,{options:this.options.spin})),this.effect.parentClass=this);break;case t.VIDEO:S&&(this.effect=new S(this.node.node,Object.assign(e,{options:this.options.video,nativeFullscreen:this.additionalOptions.nativeFullscreen})),this.effect.parentClass=this)}this.createAPI()}isThumbnailGif(){return!(!this.effect||this._type!==s.SLIDE.TYPES.SPIN)&&this.effect.isThumbnailGif()}isZoomSizeExist(){const e=s.SLIDE.TYPES;return!(!this.effect||![e.SPIN,e.PANZOOM,e.ZOOM].includes(this._type))&&this.effect.isZoomSizeExist()}startGettingInfo(){this.effect&&this.effect.startGettingInfo()}startTool(e,t,s){!this.isStarted&&this.effect&&(this.isStarted=!0,this.effect.run(e,t,s),this.additionalEffects.length&&this.additionalEffects.forEach((i=>{i.effect&&i.effect.run(e,t,s)})))}loadContent(){this.isStarted&&this.effect.loadContent()}loadThumbnail(){this.isStarted&&this.effect.loadThumbnail()}get type(){return this._type}getData(){let e={};return this.effect&&(e=Object.assign(e,this.api),delete e.start,delete e.stop,delete e.refresh),e}get originImageUrl(){return this.effect?this.effect.originImageUrl:null}getZoomData(){return[s.SLIDE.TYPES.SPIN,s.SLIDE.TYPES.ZOOM].includes(this._type)?{isZoomed:this.effect.isZoomed(),zoom:this.effect.getZoomData()}:null}getSpinOrientation(){return this._type===s.SLIDE.TYPES.SPIN?this.effect.orientation:null}getSocialButtonData(e,t){let i=null;return this.isStarted&&(i=this._type===s.SLIDE.TYPES.SPIN?this.effect.getSocialButtonData(e,t):this.effect.getSocialButtonData(e)),i}loadVideoSources(){this.effect&&this.effect.addSources()}isEffectActive(){return!(!this.effect||"spin"!==this._type)&&this.effect.isActive()}activate(){this.isActive||(this.isActive=!0)}deactivate(){this.isActive=!1}getToolOptions(){return this.toolOptions}destroy(){this.effect&&(this.effect.destroy(),this.additionalEffects.length&&this.additionalEffects.forEach((e=>{e.effect?e.effect.destroy():!e.src&&e.datasrc&&e.node.removeAttribute("src")}))),this.toolOptions={},this.api={},this.isActive=!1,this.isStarted=!1,this.isPrepared=!1,this.off("stats"),this.off("componentEvent"),super.destroy()}}const w={},I=(()=>{const e=(e,t)=>{let s;return s="horizontal"===t?"next"===e?"right":"left":"next"===e?"bottom":"top",s};return class extends r{constructor(e){super(),this.options=Object.assign({effect:"blank",orientation:"horizontal",time:600,easing:"ease-in-out"},e),this.isMove=!1,this.callbackData=null,this.effectName="blank",this.effect=null,this.addEvents()}addEvents(){this.on("effectStart",(e=>{e.data={callbackData:this.callbackData},this.isMove=!0})),this.on("effectEnd",(e=>{e.data={callbackData:this.callbackData},this.isMove=!1,this.effect.destroy(),this.effect=null}))}make(t,s,i,n){const o=Object.assign(this.options,i||{});this.stop();let r=(l=o.effect,v.camelize("-"+l));var l;Object.prototype.hasOwnProperty.call(w,r)||(r="Blank"),this.effect=new w[r](t,s,{time:o.time,easing:o.easing,direction:e(o.direction,o.orientation)}),this.effect.parentClass=this,this.callbackData=n,this.effect.make()}stop(){this.effect&&(this.effect.destroy(),this.effect=null),this.callbackData=null}destroy(){this.stop(),this.off("effectStart"),this.off("effectEnd"),this.isMove=!1,super.destroy()}}})();class x extends r{constructor(e,t,s){super(),this.name="blank",this.elements=[e,t],this.elements[0].node=y(this.elements[0].node),this.elements[1].node=y(this.elements[1].node),this.options=Object.assign({},s||{}),this.states={NOT_STARTED:0,MOVING:1,ENDED:2},this.state=this.states.NOT_STARTED,this.isDestroyed=!1}_show(e){this.elements[e].node.setCss({opacity:1,visibility:"visible"})}_hide(e){this.elements[e].node.setCss({opacity:0,visibility:"hidden"})}_start(){this.emit("effectStart",{name:this.name,indexes:[this.elements[0].index,this.elements[1].index]}),this._show(0),this.elements[0].node.setCssProp("z-index",9),this._show(1),this.elements[1].node.setCssProp("z-index",7)}_move(e){e()}_end(){this.state!==this.states.ENDED&&(this.state=this.states.ENDED,this._hide(0),this.emit("effectEnd",{name:this.name,indexes:[this.elements[0].index,this.elements[1].index]}))}_clear(){this.elements.forEach((e=>{e.node.setCss({zIndex:"",opacity:"",visibility:""})}))}make(){this.state===this.states.NOT_STARTED&&(this.state=this.states.MOVING,this._start(),this._move((()=>{this._end(),this._clear()})))}destroy(){this.isDestroyed||(this.isDestroyed=!0,this._end(),this._clear(),this.state=this.states.ENDED,super.destroy(this))}}w.Blank=x,w.Slide=(()=>{const e=e=>e.map((e=>(e=>e+"%")(e)));return class extends x{constructor(t,s,i){super(t,s,i),this.options=Object.assign(this.options,Object.assign({direction:"left",time:600,easing:"ease-in-out"},i||{})),this.name="slide",this.from=y([0,-100]),this.to=y([100,0]),["right","bottom"].includes(this.options.direction)&&(this.from[1]*=-1,this.to[0]*=-1),this.from=e(this.from),this.to=e(this.to)}_show(e){const t=this.elements[e].node;["left","right"].includes(this.options.direction)?(this.from[e]=this.from[e]+", 0%",this.to[e]=this.to[e]+", 0%"):(this.from[e]="0%, "+this.from[e],this.to[e]="0%, "+this.to[e]),t.setCssProp("transform","translate3d("+this.from[e]+", 0px)"),super._show(e)}_move(e){const t=this.options;this.elements[1].node.addEvent("transitionend",(t=>{this.elements[1].node.node===t.target&&(t.stop(),super._move(e))})),this.elements.forEach(((e,s)=>{e.node.render(),e.node.setCssProp("transition","transform "+t.time+"ms "+t.easing),e.node.setCssProp("transform","translate3d("+this.to[s]+", 0px)")}))}_clear(){this.elements.forEach((e=>{e.node.removeEvent("transitionend"),e.node.setCss({transform:"",transition:""})})),super._clear(this)}}})();w.Fade=class extends x{constructor(e,t,s){super(e,t,s),this.options=Object.assign(this.options,Object.assign({time:600,easing:"linear"},s||{})),this.name="fade",this.from=y([1,0]),this.to=y([0,1])}_show(e){super._show(e);this.elements[e].node.setCssProp("opacity",this.from[e])}_move(e){const t=this.options;this.elements[1].node.addEvent("transitionend",(t=>{this.elements[1].node.node===t.target&&(t.stop(),super._move(e))})),this.elements.forEach(((e,s)=>{e.node.render(),e.node.setCssProp("transition","opacity "+t.time+"ms "+t.easing),e.node.setCssProp("opacity",this.to[s])}))}_clear(){this.elements.forEach((e=>{e.node.removeEvent("transitionend"),e.node.setCss({opacity:"",transition:""})})),super._clear()}};const O=class extends r{constructor(e){var t;super(),this.options=Object.assign({orientation:"horizontal",customClass:""},e||{}),this.arrows=(this.options.orientation,t=this.options.customClass,y(["prev","next"]).map((e=>{const s=v.$new("div").addClass(["smv-arrow-control","smv-arrow-control-"+e]),i=v.$new("div").addClass(["smv-button","smv-arrow","smv-arrow-"+e]);return t&&""!==t&&i.addClass("smv-arrow-"+t),s.append(i),s}))),this.arrows.forEach(((e,t)=>{const s=t?"next":"prev",i=y(e.node.firstChild);e.store("arrowType",s),i.append(v.$new("div").addClass("smv-icon")),i.addEvent(["btnclick","tap"],y(((t,s)=>{s.stop(),e.fetch("disabled")||this.emit("arrowAction",{data:{type:t}})})).bind(this,s))})),this.isShow=!0}get nodes(){return y([this.arrows[0],this.arrows[1]])}show(){this.isShow||(this.arrows.forEach((e=>{e.removeClass("smv-hidden")})),this.isShow=!0)}hide(){this.isShow&&(this.isShow=!1,this.arrows.forEach((e=>{e.addClass("smv-hidden")})))}disable(e){if(e&&this.isShow){const t="forward"===e?1:0;this.arrows[t].store("disabled",!0),y(this.arrows[t].node.firstChild).attr("disabled","")}else this.arrows.forEach((e=>{y(e.node.firstChild).removeAttr("disabled"),e.store("disabled",!1)}))}destroy(){this.arrows.forEach((e=>{y(e.node.firstChild).removeEvent(["btnclick","tap"]),e.del("arrowType"),e.del("disabled"),e.remove()})),this.arrows=y([]),this.isShow=!1,super.destroy()}},P=(()=>{const e=e=>{let t="horizontal";return["left","right"].includes(e)&&(t="vertical"),t},t={width:560,height:315},s=0,n=1,l=2;class a extends r{constructor(e,t,s,i){super(),this.node=y(e),this.type=t,this.size=s,this.orientation=i,this.getPlaceholderSizePromise=null,this.destroyed=!1,this.loaded=!1,this.content=null,this.node.tagName===b&&(this.content=Array.from(this.node.node.childNodes))}isLoaded(){return this.loaded}setCssSize(){this.node.setCss(this.selectorSize)}get selectorSize(){const e={};return["square","crop"].includes(this.type)?(e.width=this.size,e.height=this.size):"horizontal"===this.orientation?e.height=this.size:e.width=this.size,e}get placeholderSize(){return this.getPlaceholderSizePromise||(this.getPlaceholderSizePromise=new Promise((e=>{const t=this.selectorSize;if(t.width&&t.height)e(t);else if(this.destroyed)e({width:0,height:0});else{let s;this.proportion.then((e=>{s=e})).finally((()=>{t.width?t.height=s.height/s.width*t.width:t.width=s.width/s.height*t.height,e(t)}))}}))),this.getPlaceholderSizePromise}get proportion(){return Promise.resolve(t)}complete(){return this.node.setCss({width:"",height:""}),this.setCssSize(),Promise.resolve()}appendTo(e){this.content?this.content.forEach((t=>{e.append(t)})):e.append(this.node)}destroy(){this.destroyed=!0,this.node=null,this.getPlaceholderSizePromise=null,super.destroy()}}class h extends a{constructor(e,t,s,i,n){super(e,t,s,i),this.imageOrientation="horizontal",this.isSirv=!1,this.watermark=n,this.src=null,this.srcset=null,this._imageSize={width:0,height:0},this.getProportionPromise=null,this.getUrlPromise=null,this.loadImagePromise=null}setCssSize(){["square","crop"].includes(this.type)?this.customSquare():this.removeCustomSquare(),super.setCssSize()}get proportion(){return this.getProportionPromise||(this.getProportionPromise=new Promise(((e,s)=>{this.destroyed?e({width:0,height:0}):this.emit("getSelectorProportion",{data:{resultingCallback:s=>{let i=s.size;this.isSirv=s.isSirv,i?(i.width||(i=t),e(i)):e(t)}}})}))),this.getProportionPromise}setImageUrl(e,t,s,i){this.src=e,this.srcset=t,this.node&&((this.src||this.srcset)&&(i&&this.node.attr("referrerpolicy",i),this.srcset&&this.node.attr("srcset",this.srcset+" 2x"),this.node.attr("src",this.src),v.browser.mobile||this.node.addEvent("mousedown",(e=>{e.stopDefaults()}))),s&&this.node.attr("alt",s))}get url(){return this.getUrlPromise||(this.getUrlPromise=new Promise(((e,t)=>{this.destroyed?e(this):this.emit("getSelectorImgUrl",{data:{crop:"crop"===this.type,type:this.type,watermark:this.watermark,size:this.selectorSize,resultingCallback:s=>{s?(this.setImageUrl(s.src,s.srcset,s.alt,s.referrerpolicy),e(this)):t(this)}}})}))),this.getUrlPromise}set imageSize(e){this._imageSize=e,this.imageOrientation=this._imageSize.width>=this._imageSize.height?"horizontal":"vertical"}loadImage(){return this.loadImagePromise||(this.loadImagePromise=new Promise(((e,t)=>{this.node?o.loadImage(this.isSirv?this.node.node:this.node.node.src).then((t=>{this.loaded=!0,this.imageSize=t.size,this.setCssSize(),e(this)})).catch((s=>{this.destroyed?e(this):t(this)})):e(this)}))),this.loadImagePromise}customSquare(){if("div"!==this.node.tagName){const e=v.$new("div").setCss({overflow:"hidden",position:"relative"});this.node.attr("data-image-orientation",this.imageOrientation),e.append(this.node),this.node.setCss({width:"",height:"",maxWidth:"none"}),"crop"===this.type?"horizontal"===this.imageOrientation?this.node.setCssProp("height",this.size):this.node.setCssProp("width",this.size):"vertical"===this.imageOrientation?this.node.setCssProp("height",this.size):this.node.setCssProp("width",this.size),this.node=e}}removeCustomSquare(){this.node&&"div"===this.node.tagName&&(this.node.removeEvent(["touchstart","selectstart","contextmenu"]),this.node.remove(),this.node=y(this.node.node.firstChild),this.node.setCss({width:"",height:"",maxWidth:""}),this.node.removeAttr("data-image-orientation"))}complete(){return this.url.then((()=>this.loadImage()))}destroy(){this.node&&this.node.removeEvent("mousedown"),this.getProportionPromise=null,this.getUrlPromise=null,this.loadImagePromise=null,super.destroy()}}class d extends r{constructor(e,t,i,n,r,l){super(),this.UUID=n,this.options=o.deepExtend({standard:{type:"square",size:70,orientation:"horizontal",watermark:!0},fullscreen:{type:"square",size:70,orientation:"horizontal",watermark:!0},activeClass:"smv-active",placeholderClass:"smv-thumbnail-placeholder",selectorContent:null,disabled:!1},r||{}),this.parentContainer=y(e),this._index=t,this.selector=y(i)||v.$new("div"),this._container=v.$new("div").addClass("smv-item").setCss({display:"inline-block"}),this.placeholder=v.$new("div").addClass(this.options.placeholderClass),this._size={width:0,height:0},this.currentObject=null,this.actived=!1,this._disabled=!1,this._destroyed=!1,this._container.append(this.selector),this.parentContainer.append(this._container),this.options.disabled&&this.disable(),this.infoPromise=l||Promise.resolve(!1),this.state=s,this.initPromise=null,this.init()}init(){return this.initPromise||(this.initPromise=new Promise((e=>{this.infoPromise.then((()=>{var t,s;this.standard=this.createContent(this.options.standard),this.standard&&this.standard instanceof h&&(t=this.options.standard,s=this.options.fullscreen,!Object.entries(t).some((([e,t])=>t!==s[e])))?this.fullscreen=this.standard:this.fullscreen=this.createContent(this.options.fullscreen,!0),this.selector.append(this.placeholder);this.selector.attr("data-type")||this.selector.setCssProp("font-size",0),this.addEvents(),this.addCustomClick(),e()}))}))),this.initPromise}createContent(e,t){let s;if("bullets"!==e.type){if(this.options.selectorContent)s=new a(this.options.selectorContent,e.type,e.size,e.orientation);else{const t=y(new Image);s=new h(t,e.type,e.size,e.orientation,e.watermark)}s.parentClass=this}return s}get proportion(){let e=Promise.resolve();return this._disabled||(this.state===l&&this.fullscreen?e=this.fullscreen.proportion:this.standard&&(e=this.standard.proportion)),new Promise(((t,s)=>{this.init().then((()=>{e.then(t).catch(s)}))}))}get canActivate(){return this.options.activated}addEvents(){this.on("getSelectorProportion",(e=>{e.data.UUID=this.UUID})),this.on("getSelectorImgUrl",(e=>{e.data.UUID=this.UUID}))}addPlaceholder(e,t){this._container.attr("data-selector-type",e),this.selector.append(this.placeholder),this.placeholder.setCss(t)}toggle(e){return new Promise(((t,s)=>{this.init().then((()=>{let i;const n=Promise.resolve();if(this.state!==e)if(this.state=e,this._disabled)i=n;else{let t=this.standard,s=this.options.standard.type;2===e&&(t=this.fullscreen,s=this.options.fullscreen.type),"bullets"===s?(this.selector.node.innerHTML="",this.currentObject=s,this._container.attr("data-selector-type",s),this.emit("resize"),i=n):(t instanceof h||this._container.attr("data-selector-type",s),i=new Promise(((i,n)=>{t?t.placeholderSize.then((n=>{if(this.state!==e||this._destroyed)i();else{if(!t.isLoaded()&&!this.options.selectorContent){for(;this.selector.node.firstChild;)this.selector.node.removeChild(this.selector.node.firstChild);this.addPlaceholder(s,n)}i(),t.complete().then((()=>{if(this.state===e&&!this._destroyed){for(this._container.attr("data-selector-type",s),this.placeholder.remove();this.selector.node.firstChild;)this.selector.node.removeChild(this.selector.node.firstChild);t.appendTo(this.selector),this.currentObject=t,this.emit("resize")}})).catch((()=>{}))}})):i()})))}else i=n;i.then(t).catch(s)}))}))}addClick(){this._container.addEvent(["btnclick","tap"],(e=>{e.stop(),this.emit("selectorAction",{data:this.UUID})}))}addCustomClick(){if(this.options.selectorContent&&v.$(this.options.selectorContent).tagName===b){const e=y(this.options.selectorContent).node.querySelectorAll("a");Array.from(e).forEach((e=>{v.$(e).addEvent(["btnclick","tap"],(t=>{t.stop(),"#"===v.$(e).attr("href")[0]?(v.W.node.location.hash="",v.W.node.location.hash=v.$(e).attr("href")):v.W.node.open(v.$(e).attr("href"))}))}))}}activate(){this.actived||(this.actived=!0,this._container.addClass(this.options.activeClass))}get activated(){return this.actived}deactivate(){this.actived&&(this.actived=!1,this._container.removeClass(this.options.activeClass))}get size(){return this._size=this._container.size,this._size}disable(){this._disabled||(this._disabled=!0,this._container.attr("disabled","true"),this._container.setCssProp("display","none"),this.deactivate(),this.emit("resize"))}_toggleForEnable(){let e,t;if(this.state!==s&&(e=this.state===n?this.standard||"bullets":this.fullscreen||"bullets"),e!==this.currentObject){const e=this.state;this.state=s,t=this.toggle(e)}else t=Promise.resolve();return t}enable(){this._disabled&&(this._disabled=!1,this._toggleForEnable().then((()=>{this._disabled||(this._container.removeAttr("disabled"),this._container.setCssProp("display",""),this.emit("resize"))})))}set index(e){this._index=e}get index(){return this._index}get container(){return this._container}get pinnedPosition(){return this.options.pinned}get destroyed(){return this._destroyed}get disabled(){return this._disabled}destroy(){this._destroyed=!0,this.placeholder.remove(),this.off("getSelectorProportion"),this.off("getSelectorImgUrl"),this.standard&&(this.standard.destroy(),this.standard=null),this.fullscreen&&(this.fullscreen.destroy(),this.fullscreen=null),this._container.removeEvent(["btnclick","tap"]),this._container.remove(),this._container=null,this.parentContainer=null,this.selector=null,super.destroy()}}const c=(e,t)=>(t?e+="px, 0":e="0, "+e+"px",e);return class extends r{constructor(e,t){super(),this.options=Object.assign({isStandardGrid:!1,standardStyle:"square",standardSize:70,standardPosition:"bottom",standardWatermark:!0,isFullscreenGrid:!1,fullscreenStyle:"square",fullscreenSize:70,fullscreenPosition:"bottom",fullscreenAutohide:!1,fullscreenWatermark:!0,arrows:!0,activeClass:"smv-active"},t||{}),this.instanceNode=v.$new("div").addClass("smv-selectors").setCss({opacity:0,visibility:"hidden",transition:""}),this.selectorsContainer=v.$new("div").addClass("smv-ss"),this.selectorsScroll=v.$new("div").addClass("smv-scroll").setCss({transform:"translate3d(0, 0, 0)"}),this.controlButton=v.$new("div").addClass("smv-selectors-toggle-switch"),this.selectorsScrollContainer=v.$new("div").addClass("smv-selectors-scroll-container"),this.startPinnedNode=null,this.endPinnedNode=null,this.baseSelectorsList=[],this.pinnedStartList=[],this.pinnedEndList=[],this.isMove=!1,this.currentPosition=0,this.containerSize={width:0,height:0},this.halfContainerSize=0,this.scrollSize={width:0,height:0},this.halfScrollSize=0,this.currentActiveItem=null,this.isShown=!1,this.isControlShown=!0,this.isControlInDoc=!1,this.controlDebounce=null,this.isReady=!1,this.resizeTimeout=null,this.isActionsEnabled=!0,this.isDone=!1,this.isInView=!1,this.state=n,this.arrows=null,this._currentStylePosition=this.options.standardPosition,this.longSide=null,this._shortSide=null,this.currentAxis="x",this.isStarted=!1,this.isDestroyed=!1,e.some((e=>!!e.pinned))&&this.initPinnedBlocks(),this.selectors=e.map(((e,t)=>this.createSelector(e,t))),this.sortPinnedSelectors(),this.identifyVariables(),this.setContainerCss()}findSelector(e){var t;return null!=(t=this.selectors.find((t=>t.UUID===e)))?t:null}get hasPinnedSelector(){return!(!this.pinnedStartList.length&&!this.pinnedEndList.length)}insertBefore(e,t){let s=this.selectors,i=this.selectorsScroll;if(this.hasPinnedSelector){var n,o;if("start"===t.pinnedPosition)s=this.pinnedStartList,i=v.$(null!=(n=null==(o=this.startPinnedNode)?void 0:o.node.firstChild.firstChild)?n:null);else if("end"===t.pinnedPosition){var r,l;s=this.pinnedEndList,i=v.$(null!=(r=null==(l=this.endPinnedNode)?void 0:l.node.firstChild.firstChild)?r:null)}else s=this.baseSelectorsList;e=s.indexOf(t)}let a=null;e+1<s.length&&(a=s[e+1].container),this.hide(),i.node.insertBefore(t.container.node,a?a.node:a)}insert(e,t){t.pinned&&(this.initPinnedBlocks(),this.appendPinnedBlocks());const s=this.createSelector(t,e);this.isDone&&s.addClick(),this.hide(),this.selectors.splice(e,0,s),this.selectors.forEach(((e,t)=>{e.index=t})),this.sortPinnedSelectors(),this.insertBefore(e,s),s.toggle(this.state)}disable(e){const t=this.findSelector(e);t&&(this.currentActiveItem&&this.currentActiveItem===t&&(this.currentActiveItem=null),this.hide(),t.disable())}enable(e){const t=this.findSelector(e);t&&(this.hide(),t.enable())}pickOut(e){const t=this.findSelector(e);t&&(t.destroy(),this.selectors.splice(t.index,1),this.selectors.forEach(((e,t)=>{e.index=t})),this.sortPinnedSelectors())}createSelector(t,s){let i=this.selectorsScroll;var n,o;if("start"===t.pinned)i=null!=(n=null==(o=this.startPinnedNode)?void 0:o.node.firstChild.firstChild)?n:null;else if("end"===t.pinned){var r,l;i=null!=(r=null==(l=this.endPinnedNode)?void 0:l.node.firstChild.firstChild)?r:null}const a=new d(i,s,t.node,t.UUID,{standard:{type:this.options.standardStyle,size:this.options.standardSize,orientation:e(this.options.standardPosition),watermark:this.options.standardWatermark},fullscreen:{type:this.options.fullscreenStyle,size:this.options.fullscreenSize,orientation:e(this.options.fullscreenPosition),watermark:this.options.fullscreenWatermark},activeClass:this.options.activeClass,selectorContent:t.selectorContent,disabled:t.disabled,pinned:t.pinned,activated:t.activated},t.infoPromise);return a.parentClass=this,a}addEventsFromSelectors(){let e;this.on("selectorAction",(e=>{e.stopAll(),this.emit("changeSlide",{data:{UUID:e.data}});const t=this.selectors.find((t=>t.UUID===e.data));t!==v.U&&this.activateItem(t)})),this.on("resize",(t=>{t.stopAll(),clearTimeout(e),e=setTimeout((()=>{this.onResize()}),16)}))}initPinnedBlocks(){if(!this.pinnedBlocksInited){const e=e=>v.$new("div").addClass(g+e).append(v.$new("div").addClass("smv-ss").append(v.$new("div").addClass("smv-scroll").setCss({transform:"translate3d(0, 0, 0)"})));this.startPinnedNode=e("-selectors-pinned-start"),this.endPinnedNode=e("-selectors-pinned-end")}}get pinnedBlocksInited(){return!!this.startPinnedNode&&!!this.endPinnedNode}appendPinnedBlocks(){this.pinnedBlocksInited&&(this.instanceNode.append(this.startPinnedNode),this.instanceNode.append(this.endPinnedNode))}sortPinnedSelectors(){this.pinnedStartList=this.selectors.filter((e=>"start"===e.pinnedPosition)),this.pinnedEndList=this.selectors.filter((e=>"end"===e.pinnedPosition)),this.baseSelectorsList=this.selectors.filter((e=>!e.pinnedPosition))}init(){if(this.createArrows(),this.selectorsScrollContainer.append(this.selectorsContainer).appendTo(this.instanceNode),this.appendPinnedBlocks(),this.arrows){this.arrows.hide();const e=this.arrows.nodes;this.selectorsScrollContainer.append(e[0]),this.selectorsScrollContainer.append(e[1])}this.selectorsContainer.append(this.selectorsScroll),this.isShown=!0,this.hide(),this.identifyVariables(),this.addEventsFromSelectors(),this._currentStylePosition||this.instanceNode.setCssProp("display","none"),Promise.all(this.selectors.map((e=>e.proportion))).finally((()=>{this.isReady=!0,this.emit("selectorsReady")}))}identifyVariables(){if(this._currentStylePosition){const t="horizontal"===e(this._currentStylePosition);this.longSide=t?"width":"height",this._shortSide="width"===this.longSide?"height":"width",this.currentAxis=t?"x":"y"}else this.longSide=null,this._shortSide=null}changeSelectors(e){return Promise.all(this.selectors.map((t=>t.toggle(e))))}getSelectorsSize(){return this.selectors.filter((e=>!e.destroyed)).map((e=>e.size))}enableActions(){this.isActionsEnabled||(this.isActionsEnabled=!0,this.show(),this.options.fullscreenAutohide&&(this.selectorsState=!0))}disableActions(){this.isActionsEnabled&&(this.isActionsEnabled=!1,this.hide(),this.controlDebounce&&this.controlDebounce.cancel())}show(e){if(!this.isShown&&this.isActionsEnabled&&!this.isDestroyed){const t=e?"":"opacity 400ms linear";this.isShown=!0,this.selectorsScroll.setCss({display:"inline-flex"}),this.getSizes(),this.jump(this.activatedItem,!0),this.instanceNode.setCss({opacity:1,visibility:"visible",transition:t})}}get activatedItem(){return this.currentActiveItem?this.currentActiveItem.index:0}activateCurrentItemByUUID(e){const t=this.findSelector(e);t&&!this.currentActiveItem&&(this.currentActiveItem=t)}hide(){this.isShown&&(this.isShown=!1,this.instanceNode.setCss({opacity:0,visibility:"hidden",transition:""}))}start(e){!this.isStarted&&this.isInView&&(this.isStarted=!0,this._currentStylePosition?this.changeSelectors(1).then((()=>i.rootDOM.addMainStyle(e))).then((()=>{this.isDestroyed||(this.getSelectorsSize(),this.done(),this.show())})):this.done())}addControl(){this.isControlInDoc||(this.instanceNode.addEvent(["mouseover","mouseout"],(e=>{let t=e.related;for(t&&(t=y(t));t&&t.node!==this.instanceNode.node&&t.node!==v.D.node.body;)t=t.node.parentNode,t&&(t=y(t));t&&t.node===this.instanceNode.node||this.setControlTimeout("mouseover"===e.type)})),this.controlButton.addEvent(["btnclick","tap"],(e=>{this.setControlTimeout(!0),this.selectorsState=!this.isControlShown})),y(this.instanceNode.node.parentNode).append(this.controlButton),this.controlDebounce=o.debounce((()=>{this.selectorsState=!1}),3e3),this.isControlInDoc=!0)}removeControl(){this.isControlInDoc&&(this.instanceNode.removeEvent(["mouseover","mouseout"]),this.controlDebounce.cancel(),this.isControlShown=!0,this.controlButton.removeEvent(["btnclick","tap"]),this.controlButton.remove(),this.isControlInDoc=!1)}set selectorsState(e){this.isControlShown=e,this.setControlTimeout(),this.emit("visibility",{action:this.isControlShown?"show":"hide"})}setControlTimeout(e){this.isControlInDoc&&(this.controlDebounce.cancel(),this.isControlShown&&!e&&this.controlDebounce())}get node(){return this.instanceNode}get horizontal(){return"horizontal"===e(this._currentStylePosition)}inView(e,t){this.isInView=e,this.start(t)}done(){this.isDone||this.isDestroyed||(this.isDone=!0,this.getSizes(),this.selectors.forEach((e=>{e.addClick()})),this.onResize(),this.setDrag(),this.emit("selectorsDone"))}activateItem(e){const t=this.selectors[e];t&&(this.currentActiveItem&&this.currentActiveItem.deactivate(),!t.disabled&&t.canActivate&&(t.activate(),this.currentActiveItem=t),!t.activated&&this.currentActiveItem&&this.currentActiveItem.activate())}createArrows(){!this.options.arrows||"grid"===this.options.standardStyle&&"grid"===this.options.standardStyle||(this.arrows=new O({orientation:e(this.currentPosition||this.options.fullscreenPosition),customClass:"thumbnails"}),this.arrows.parentClass=this,this.on("arrowAction",(e=>{e.stopAll(),this.jump(e.data.type)})))}isGrid(){return this.state===l?this.options.isFullscreenGrid:this.options.isStandardGrid}calculateContainerScroll(){if(this.hasPinnedSelector||this.pinnedBlocksInited){const e=this.instanceNode.size;this.arrows&&this.arrows.hide();let t=e[this.longSide]-(this.startPinnedNode.size[this.longSide]+this.endPinnedNode.size[this.longSide]);t<0&&(t=0),this.scrollSize[this.longSide]<t&&(t=this.scrollSize[this.longSide]),this.selectorsScrollContainer.setCssProp("max-"+this.longSide,t),this.getSizes()}}normalizePositionValue(e){const t=this.containerSize[this.longSide]-this.scrollSize[this.longSide];return this.arrows&&(this.arrows.disable(),t>=0||this.isGrid()?(this.arrows.hide(),this.getSizes()):this.arrows.isShow||(this.arrows.show(),this.getSizes())),0===t?0:(this.halfScrollSize<=this.halfContainerSize?e=this.halfContainerSize-this.halfScrollSize:(e>=0&&(e=0,this.arrows&&this.arrows.disable("backward")),e<=t&&(e=t,this.arrows&&this.arrows.disable("forward"))),e)}findItemPosition(e){if(!this.selectors[e]||this.selectors[e].pinnedPosition)return null;if(e=((e,t)=>(e<0?e=0:e>t-1&&(e=t-1),e))(e,this.selectors.length),this.hasPinnedSelector){const t=this.baseSelectorsList.indexOf(this.selectors[e]);t>=0&&(e=t)}const t=this.selectors[e].size[this.longSide]/2;let s=0,i=0;for(;i<e;)this.selectors[i]&&(s+=this.selectors[i].size[this.longSide]),i+=1;const n=this.halfContainerSize-(s+t);return this.normalizePositionValue(n)}stopMoving(){if(this.isMove){let e=o.getMatrix(this.selectorsScroll);e&&(e=e.transform[this.currentAxis],this.currentPosition=e),this.clearAnimation(),this.selectorsScroll.setCssProp("transform","translate3d("+c(this.currentPosition,this.horizontal)+", 0)")}}clearAnimation(){this.selectorsScroll&&(this.selectorsScroll.removeEvent("transitionend"),this.selectorsScroll.setCssProp("transition","")),this.isMove=!1}jump(e,t){let s=this.currentPosition;this.stopMoving(),"string"!==v.typeOf(e)&&"number"!==v.typeOf(e)||("string"===v.typeOf(e)?("next"===e?s-=this.containerSize[this.longSide]:s+=this.containerSize[this.longSide],s=this.normalizePositionValue(s)):s=this.findItemPosition(e),null!==s&&this.move(s,null,t))}move(e,t,s){if(t||(t=400),this.currentPosition===e)return;this.selectorsScroll.removeEvent("transitionend");const i={};s||(this.isMove=!0,this.selectorsScroll.addEvent("transitionend",(e=>{e.stop(),this.clearAnimation()})),i.transition="transform "+((e,t,s)=>{let i=e;const n=parseInt(e/3,10);return i=parseInt(Math.abs(s)/t*e,10),i<n?i=n:i>e&&(i=e),i})(t,this.containerSize[this.longSide],Math.abs(e)-Math.abs(this.currentPosition))+"ms ease"),i.transform="translate3d("+c(e,this.horizontal)+", 0)",this.selectorsScroll.setCss(i),this.currentPosition=e}getSizes(){this.containerSize=this.selectorsContainer.size,this.halfContainerSize=this.containerSize[this.longSide]/2,this.scrollSize=this.selectorsScroll.size,this.halfScrollSize=this.scrollSize[this.longSide]/2}setDrag(){const e={};let t,s,i,n,o,r,l,a,h,d={x:null,y:null},u=!1,p=0;const m=(e,s)=>({x:e-t.left,y:s-t.top});e.dragstart=e=>{o=this.currentAxis,r="x"===o?"y":"x",l=this.longSide,d={x:e.x,y:e.y},this.containerSize[l]<this.scrollSize[l]&&(u=!0),t=this.selectorsContainer.position,this.stopMoving(),s=m(e.x,e.y)[o],i=this.containerSize[l]-this.scrollSize[l],n=0,h=e.timeStamp},e.dragend=e=>{let t,s;var o;u&&(u=!1,e.stop(),s=e.timeStamp-h,t=this.currentPosition-((o=n)+o/2),(t>0||t<i)&&(t=t>0?0:i),t=this.normalizePositionValue(t),this.move(t),a=null),p=0},e.dragmove=e=>{let t,i,l;var h,f;p||(p=Math.abs(d[o]-e[o])>Math.abs(d[r]-e[r])?1:2),u&&1===p&&(t=m(e.x,e.y),t[o]>t[r]&&(e.stop(),i=s-t[o],this.currentPosition-=i,h=s,f=t[o],l=h>f?"next":"prev",a&&l===a||(n=0),n+=i,s=t[o],a=l),this.selectorsScroll.setCssProp("transform","translate3d("+c(this.currentPosition,this.horizontal)+", 0)")),d={x:e.x,y:e.y}},this.selectorsContainer.addEvent(["mousedrag","touchdrag"],(t=>{e[t.state](t)}))}setContainerCss(){const e={};let t=this.options.standardSize;this.state===l&&(t=this.options.fullscreenSize),e["min-"+this._shortSide]=t+"px",e[this._shortSide]="100%",this.instanceNode.setCss(e)}beforeEnterFullscreen(){this.hide(),this.state=l,this._currentStylePosition=this.options.fullscreenPosition,this._currentStylePosition||(this.instanceNode.setCssProp("display","none"),y(this.instanceNode.node.parentNode).setCssProp("display","none")),this.identifyVariables()}afterEnterFullscreen(){this._currentStylePosition&&(this.instanceNode.setCssProp("display",""),y(this.instanceNode.node.parentNode).setCssProp("display",""),this.setContainerCss(),this.options.fullscreenAutohide&&(this.addControl(),this.isActionsEnabled&&(this.selectorsState=!0)),this.removeStyleForIE(),this.changeSelectors(2).then((()=>{this.getSelectorsSize(),setTimeout((()=>{this.show()}),150),this._currentStylePosition&&this.isActionsEnabled&&setTimeout((()=>{this.selectorsState=!0}),1e3)})))}beforeExitFullscreen(){this.hide(),this.state=n,this._currentStylePosition=this.options.standardPosition,this.options.fullscreenAutohide&&this.removeControl(),this._currentStylePosition||(this.instanceNode.setCssProp("display","none"),y(this.instanceNode.node.parentNode).setCssProp("display","none")),this.identifyVariables()}afterExitFullscreen(){this._currentStylePosition&&(this.instanceNode.setCssProp("display",""),y(this.instanceNode.node.parentNode).setCssProp("display",""),this.setContainerCss(),this.removeStyleForIE(),this.changeSelectors(1).then((()=>{this.getSelectorsSize(),this.show()})))}get currentStylePosition(){return this.state===l?this.options.fullscreenPosition:this.options.standardPosition}removeStyleForIE(){"ie"===v.browser.uaName&&this.selectorsScroll.setCssProp(this.shortSide,"")}removeStyleForIE(){"ie"===v.browser.uaName&&this.selectorsScroll.setCssProp(this.shortSide,"")}isSelectorsActionEnabled(){return this.isActionsEnabled}get shortSide(){return this._shortSide}sortSelectors(e,t){this.selectors=e.map((e=>this.selectors.find((t=>t.UUID===e)))),this.selectors.forEach(((e,t)=>{e.index=t}));for(let e=t-1;e>=0;e--)this.selectorsScroll.node.insertBefore(this.selectors[e].container.node,this.selectorsScroll.node.firstChild)}onResize(){this.isDone&&this._currentStylePosition&&!this.isDestroyed&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout((()=>{const e=this.activatedItem;if(this.clearAnimation(),"ie"===v.browser.uaName){const e=this.isGrid()?"":this.selectors.reduce(((e,t)=>(t.destroyed||(e+=t.size[this.longSide]),e)),0);this.selectorsScroll.setCssProp(this.longSide,e)}this.getSizes(),this.calculateContainerScroll(),this.activateItem(e),this.normalizePositionValue(),this.jump(e,!0),this.show()}),100))}destroy(){this.isDestroyed=!0,clearTimeout(this.resizeTimeout),this.instanceNode.removeEvent("transitionend"),this.removeControl(),this.controlButton=null,this.off("selectorAction"),this.off("resize"),this.clearAnimation(),this.arrows&&(this.arrows.destroy(),this.arrows=null,this.off("arrowAction")),this.selectors.forEach((e=>{e.destroy()})),this.selectorsScroll.remove(),this.selectorsScroll=null,this.selectorsContainer.remove(),this.selectorsContainer=null,this.instanceNode.remove(),this.instanceNode=null,this.currentActiveItem=null,this.pinnedBlocksInited&&(this.baseSelectorsList=[],this.pinnedStartList=[],this.pinnedEndList=[],this.endPinnedNode=null,this.startPinnedNode=null,this.selectorsScrollContainer=null,this.pinnedStartList=null,this.pinnedEndList=null),super.destroy()}}})(),D=(()=>{const e=e=>{const t=(e=y(e)).attr("data-src");return t?(e.attr("data-src",t.split("?")[0]),e.removeAttr("src")):e.node.src=e.node.src.split("?")[0],e};class t extends r{constructor(e,t){super(),this._node=y(e),this.instanceOptions=((e,t)=>{const s=new v.Options(h);return s.fromJSON(t.common.common),s.fromString(t.local.common),s.fromString(e.attr("data-options")||""),v.browser.touchScreen&&v.browser.mobile&&(s.fromJSON(t.common.mobile),s.fromString(t.local.mobile),s.fromString(e.attr("data-mobile-options")||"")),s})(this._node,t),this.option=(...e)=>e.length>1?this.instanceOptions.set(e[0],e[1]):this.instanceOptions.get(e[0]),this.type="video",this.player=null,this.state=s.VIDEO.NONE,this.isReady=!1,this.isShown=!1,this.id=null,this.playDebounce=null,this.currentTime=0,this.videoNode=v.$new("div"),this.videoWrapper=v.$new("div").addClass("smv-video").setCss({transition:"opacity .3 linear"}),Array.from(this._node.node.attributes).forEach((e=>{["class","style"].includes(e.name)||this.videoWrapper.attr(e.name,e.value)})),this.videoWrapper.attr("data-video-type",this.type),this.fullscreen=this.option("controls.fullscreen"),this.hide()}get autoplay(){return this.option("autoplay")}onBeforeFullscreenIn(){this.getCurrentTime(),this.fullscreen=!1}onAfterFullscreenIn(){}onBeforeFullscreenOut(){this.getCurrentTime(),this.fullscreen=this.option("controls.fullscreen")}onAfterFullscreenOut(){}getSize(){return new Promise((e=>{const t=this.videoWrapper.size;t.width&&t.height?e(t):o.videoModule.getAspectRatio(this._node).then((s=>{t.width?t.height=t.width*s:t.width=t.height/s,e(t)})).catch((()=>{e(null)}))}))}createPlayer(e){return this.player={ready:!0,play:()=>{this.playDebounce()},pause:()=>{this.player.player.node.pause()},player:this._node},this.playDebounce=o.debounce((()=>{this.player.player.node.play()}),100),this.option("loop")?this.player.player.attr("loop","loop"):this.player.player.removeAttr("loop"),this.player.player.attr("playsinline","playsinline"),this.option("controls.enable")?this.player.player.attr("controls","controls"):this.player.player.removeAttr("controls"),this.autoplay?(this.player.player.volume=0,this.player.player.attr("muted","muted")):this.player.player.volume=this.option("volume")/100,this.player.player.attr("preload",this.option("preload")?"auto":"none"),this.addEvents(),this.emit("slideVideoReady",{data:{type:this.type,error:null}}),Promise.resolve()}get node(){return this.videoWrapper}init(){if("video"===this.type){let e=this._node.attr("data-src");e&&this._node.attr("src",e),Array.from(this._node.node.children).forEach((t=>{(t=y(t))&&"source"===t.tagName&&(e=t.attr("data-src"),e&&(t.attr("src",e),"gecko"===v.browser.engine&&t.node.parentNode.load()))})),this.videoNode=this._node}this.id=this.type+"-"+o.generateUUID(),this.videoNode.attr("id",this.id),this.videoWrapper.append(this.videoNode);const e={type:this.type,error:null};o.videoModule.getAPI(this._node).then((t=>{this.createPlayer(t).then((()=>{e.error=!1})).catch((t=>{e.error=!!t})).finally((()=>{this.isReady=!0}))})).catch((t=>{e.error=!0,this.emit("slideVideoReady",{data:e})}))}addEvents(){this.player.player.addEvent("play",(e=>{e.stop(),this.state=s.VIDEO.PLAY,this.emit("slideVideoPlay",{data:{type:this.type}})})),this.player.player.addEvent("pause",(e=>{e.stop(),this.state=s.VIDEO.PAUSE,this.emit("slideVideoPause",{data:{type:this.type}})})),this.player.player.addEvent("ended",(e=>{e.stop(),this.state=s.VIDEO.PAUSE,this.emit("slideVideoEnd",{data:{type:this.type}})}))}play(){this.player&&this.player.ready&&(this.setCurrentTime(),this.player.play())}pause(){this.player&&this.player.ready&&this.player.pause()}getCurrentTime(){this.player&&this.player.player&&(this.currentTime=this.player.player.currentTime)}setCurrentTime(){this.player&&this.player.ready&&(this.player.player.currentTime=this.currentTime)}get preStart(){return this.state===s.VIDEO.NONE}get paused(){return this.state===s.VIDEO.PAUSE}show(){this.isShown=!0,this.videoWrapper.setCssProp("opacity",1)}hide(){this.isShown=!1,this.videoWrapper.setCssProp("opacity",0)}destroy(){this.playDebounce&&(this.playDebounce.cancel(),this.playDebounce=null),this.pause(),this.videoWrapper.remove(),this._node=e(this._node),"video"===this.type&&Array.from(this._node.node.children).forEach((t=>{"source"===y(t).tagName&&e(t)})),super.destroy()}}return{HTMLVideo:t,YouTubeVideo:class extends t{constructor(e,t){super(e,t),this.type="youtube",this.playerState=-1,this.videoWrapper.attr("data-video-type",this.type),this.apiPlayer=null}setCurrentTime(){this.player&&this.player.ready&&this.player.player.seekTo(this.currentTime)}getCurrentTime(){this.player&&this.player.player&&(this.player.player.getCurrentTime?this.currentTime=this.player.player.getCurrentTime():this.currentTime=0)}destroyVideoPlayer(){this.getCurrentTime(),this.player&&this.player.player&&(this.player.ready=!1,this.player.player.destroy()),this.playerState=-1}onBeforeFullscreenIn(){this.fullscreen=!1,this.destroyVideoPlayer()}onAfterFullscreenIn(){this.createPlayer(this.apiPlayer)}onBeforeFullscreenOut(){this.fullscreen=this.option("controls.fullscreen"),this.destroyVideoPlayer()}onAfterFullscreenOut(){this.createPlayer(this.apiPlayer)}createPlayer(e){return this.apiPlayer=e,new Promise(((t,s)=>{const i=o.videoModule.getId(this._node);this.player={ready:!1,play:()=>{this.player.player.playVideo()},pause:()=>{this.player.player.pauseVideo()},player:new e.Player(this.id,{videoId:i,playerVars:{playlist:i,fs:this.fullscreen?1:0,rel:0,loop:this.option("loop")?1:0,autoplay:0,playsinline:1,controls:this.option("controls.enable")?1:0},events:{onReady:()=>{this.playerState=-1,this.player.ready=!0,this.player.player.setVolume(this.option("volume")),this.emit("slideVideoReady",{data:{type:this.type,error:null}}),t()},onError:e=>{100===e.data&&(this.player=null),this.emit("slideVideoReady",{data:{type:this.type,error:!0}}),s(!0)},onStateChange:this.addEvents.bind(this)}})}}))}addEvents(e){const t=(e.target||e.target).getPlayerState();switch(this.playerState=t,this.state===s.VIDEO.PLAY&&(this.state=s.VIDEO.PAUSE),t){case-1:break;case 0:this.option("loop")||this.player.pause(),this.emit("slideVideoEnd",{data:{type:this.type}});break;case 1:this.state=s.VIDEO.PLAY,this.emit("slideVideoPlay",{data:{type:this.type}});break;case 2:this.state=s.VIDEO.PAUSE,this.emit("slideVideoPause",{data:{type:this.type}})}}destroy(){super.destroy(),this.player&&this.player.player&&(this.player.player.destroy(),this.player.player=null)}},VimeoVideo:class extends t{constructor(e,t){super(e,t),this.type="vimeo",this.apiPlayer=null,this.videoWrapper.attr("data-video-type",this.type)}createPlayer(e){return this.apiPlayer=e,new Promise(((t,s)=>{if(this.videoNode.attr("data-vimeo-id",o.videoModule.getId(this._node)),e.Player){const s=this.videoNode.attr("data-src");s&&this.videoNode.attr("src",s);const i={id:o.videoModule.getId(this._node),loop:this.option("loop"),controls:this.option("controls.enable"),speed:this.option("controls.speed")};this.player={ready:!1,play:()=>{this.player.player.setVolume(0),this.player.player.play()},pause:()=>{this.player.player.pause()},player:new e.Player(this.videoNode.node,i)},this.addEvents(t)}else s(!0)}))}destroyVideoPlayer(){this.player&&this.player.player&&(this.player.ready=!1,this.player.player.destroy())}play(){this.player&&this.player.ready&&(this.setCurrentTime(),this.player.play())}onBeforeFullscreenIn(){this.destroyVideoPlayer()}onAfterFullscreenIn(){this.createPlayer(this.apiPlayer)}onBeforeFullscreenOut(){this.destroyVideoPlayer()}onAfterFullscreenOut(){this.createPlayer(this.apiPlayer)}getCurrentTime(){}setCurrentTime(){this.player&&this.player.ready&&this.player.player.setCurrentTime(this.currentTime)}addEvents(e){this.player.player.on("play",(()=>{this.state=s.VIDEO.PLAY,this.emit("slideVideoPlay",{data:{type:this.type}})})),this.player.player.on("pause",(()=>{this.state=s.VIDEO.PAUSE,this.emit("slideVideoPause",{data:{type:this.type}})})),this.player.player.on("ended",(()=>{this.state=s.VIDEO.PAUSE,this.emit("slideVideoEnd",{data:{type:this.type}})})),this.player.player.on("loaded",(()=>{})),this.player.player.on("timeupdate",(e=>{this.currentTime=e.seconds})),this.player.player?this.player.player.ready().then((()=>{this.player.ready=!0,this.state===s.VIDEO.PLAY&&(this.state=s.VIDEO.PAUSE),this.player.player.setVolume(0),this.emit("slideVideoReady",{data:{type:this.type,error:null}}),e()})):this.emit("slideVideoReady",{data:{type:this.type,error:new Error("Player does not exist.")}})}destroy(){super.destroy(),this.videoNode.remove(),this.videoNode=null,this.videoWrapper.remove(),this.videoWrapper=null,this.player&&this.player.player&&(this.player.player.destroy(),this.player.player=null),this._node=null}}}})(),N=(()=>{const e="smv-can-zoom",t={top:0,left:0,width:"100%",height:"100%"},i=(e,t)=>new Promise((s=>{if(e=y(e),void 0===t&&(t=10),t>0){const n=e.size;n.width&&n.height?s(n):setTimeout((()=>{i(e,t-=1).then(s)}),32)}else s(null)})),l=e=>{const t={type:"node",data:null};if(o.videoModule.isVideo(e))t.type=o.videoModule.getType(e),t.type||(t.data=v.$new("div"));else{let s,i;if("img"===y(e).tagName)s=e;else try{s=e.getElementsByTagName("img")[0]}catch(e){}s&&(i=o.sliderLib.getSrc(y(s).attr("src"))||o.sliderLib.getSrc(y(s).attr("data-src"))),i?(t.type="img",t.data=i):(s=e.cloneNode?e.cloneNode(!0):v.$new("div"),t.data=s)}return t},h=e=>{let t=y(e.node.querySelector(b));return t||(t=e.tagName===b?e:null),t};class d extends r{constructor(e,i,n,o){super(),this.$J_UUID=v.$uuid(this),this.groups=(y(e).attr("data-group")||"").split(/\s*(?:,|$)\s*/);const r=N.parse(e);this.id=r.id,this._enabled=r.enabled,this.type=r.type,this.url=r.url,this.slideContent=y(e),this._index=i,this.isCustomAdded=o||!1,this._options={},this.options=n,this.instanceNode=v.$new("div").addClass("smv-slide").setCss({position:"absolute"}),this.instanceNode.setCss(t),this.contentWrapper=v.$new("div").addClass("smv-content"),this.contentWrapper.setCss(t),this.fullscreenOnlyNode=null,this.selector={UUID:this.$J_UUID,isCustom:!1,node:h(this.slideContent),isSirv:!1,isVideo:!1,selectorContent:null,size:{width:0,height:0},src:null,srcset:null,pinned:null,activated:!0,infoPromise:null,isStatic:!1},this.selector.isStatic=d.checkNonSirv(this.selector.node),this.selector.pinned=d.findPinnedSelectorSide(this.slideContent.node.querySelector(b)||this.slideContent.node),this.selector.isCustom=!!this.selector.node,this.thumbnailReferrerPolicy=this.getSelectorReferrerPolicy(),this.availableSlide=!0,this.isStartedFullInit=!1,this.fullscreenState=s.FULLSCREEN.CLOSED,this.isStarted=!1,this.sirvService=null,this.componentSize=null,this.inView=!1,this.isActive=!1,this.isReady=!1,this.video=null,this.isVideoPaused=!1,this.isVideoReady=!1,this.slideShownBy=s.SLIDE_SHOWN_BY.NONE,this.componentLoader=null,this.infoSize=null,this.sizePromise=null,this.isInDom=0,this.multiImages=[],this.lastOriginNode=null,this.dataThumbnailImage=this.getThumbnailImage(),this.dataThumbnailHtml=this.slideContent.attr("data-thumbnail-html"),this.dataHiddenSelector=this.slideContent.hasAttribute("data-hidden-selector"),this.swipeDisabled=this.slideContent.hasAttribute("data-swipe-disabled"),this.spinWasInited=!1,this.socialbuttons=null,this.getVideoThumbnailPromise=null,this.isPlaceholder=!1,this.customThumbnailImageClassPromise=null;const l=this;this._api={get index(){return l.index},get component(){return l.sirvService?s.SLIDE.NAMES[l.sirvService.type]:"unknown"},get groups(){return l.groups},get thumbnail(){var e,t;return null!=(e=null==(t=l.selector.node)?void 0:t.node)?e:null},isDisabled:()=>!l.enabled,isActive:()=>l.isActive,getSelector(){return this.thumbnail}},this.sendEventCloseFullscreenByClick=e=>{e.stop(),this.emit("goToFullscreenOut")},this.beforeParseSlide(),this.parseSlide()}static findPinnedSelectorSide(e){if(e.hasAttribute("data-pinned")){const t=v.$(e).attr("data-pinned");return"start"!==t?"end":t}return null}static parse(e){e=y(e);const t={};t.node=e.node,t.id=e.attr("data-id");let i=null,n=s.SLIDE.TYPES.HTML,r=!0;if(N.isSirvComponent(e)){const t=o.getSirvType(e);n=t.type,i=t.imgSrc}else o.videoModule.isVideo(e)?(n=s.SLIDE.TYPES.VIDEO,i=o.videoModule.getSrc(e)):("img"===e.tagName||"div"===e.tagName&&e.attr("data-src"))&&(n=s.SLIDE.TYPES.IMAGE,i=e.attr("data-src")||e.attr("src"));t.type=n,t.url=i;const l=e.node.getAttribute("data-disabled");return(l&&"false"!==l||""===l)&&(r=!1),t.enabled=r,t}static checkNonSirv(e){return!(!e||"static"!==y(e).attr("data-type"))}static isSirvComponent(e){const t=(e=y(e)).attr("data-src"),s=e.attr("src"),i=N.checkNonSirv(e),n=e.tagName,r=e.fetch("view-content");return!(i||!(r||"div"===n&&!["youtube","vimeo"].includes(o.videoModule.getType(t))&&t||"img"===n&&(t||s)))}static hasComponent(e){return E.isExist(e)}isSwipeDisabled(){return this.swipeDisabled}getThumbnailImage(){let e=this.slideContent.attr("data-thumbnail-image");if(!e&&this.selector.isCustom&&(e=this.selector.node.attr("data-src"),!e)){const t=this.selector.node.node.children;1===t.length&&"img"===y(t[0]).tagName&&(e=y(t[0]).attr("data-src")||y(t[0]).attr("src"))}return e}startGettingInfo(){this.sirv&&this.sirvService.startGettingInfo()}loadContent(){this.sirv&&this.getSlideSize().then((e=>{this.isInDom&&this.sirvService.loadContent()})).catch((e=>{}))}loadThumbnail(){this.sirv&&this.getSlideSize().then((e=>{this.isInDom&&this.sirvService.loadThumbnail()})).catch((e=>{}))}get videoSlide(){let e=!1;return this.sirv?e=this.sirvService.type===s.SLIDE.TYPES.VIDEO:this.video&&(e=!0),e}belongsTo(e){let t=!1;return e&&("string"===v.typeOf(e)&&(e=[e]),t=e.some((e=>this.groups.includes(e)))),t}addGroup(e){let t=!1;return e&&"string"===v.typeOf(e)&&!this.groups.includes(e)&&(t=!0,this.groups.push(e)),t}removeGroup(e){let t=!1;if(e&&"string"===v.typeOf(e)){const s=this.groups.indexOf(e);s>-1&&(t=!0,this.groups.splice(s,1))}return t}get customSelector(){return this.selector.isCustom}single(e){this.sirv&&this.broadcast("isSingleSlide",{data:{isSingle:e}})}set newIndex(e){this._index=e}get index(){return this._index}checkReadiness(e,t){let i=!1;return this.sirv&&s.SLIDE.NAMES[this.sirvService.type]===t&&(i="init"===e?this.spinWasInited:this.isReady),i}sendReadyEvent(e,t){this.sirv&&s.SLIDE.NAMES[this.sirvService.type]===t&&this.sirvService.sendEvent(e)}createFullscreenOnlyScreen(){this._options.fullscreenOnly&&(this.fullscreenOnlyNode=v.$new("div").addClass("smv-fullscreen-always"),this.fullscreenOnlyNode.addEvent(["btnclick","tap"],(e=>{e.stop(),this.emit("goToFullscreen")})),this.createPinchEvent(this.fullscreenOnlyNode),this.instanceNode.append(this.fullscreenOnlyNode,"top"))}createPinchEvent(e){if(v.browser.touchScreen){const t=2;e.addEvent("pinch",(e=>{if(e.stop(),"pinchend"===e.state)0===this.fullscreenState&&e.scale>=t&&this.emit("goToFullscreen")}))}}get enabled(){return this._enabled}disable(){this._enabled=!1,this.video&&this.video.pause(),this.componentLoader&&this.componentLoader.hide(!0)}enable(){this._enabled=!0}get blokedTouchdrag(){let e=!1;return this.sirv&&(e=this.sirvService.type===s.SLIDE.TYPES.SPIN||this.sirvService.isEffectActive()),e}set options(e){this._options=Object.assign({spin:{},zoom:{},image:{},video:{},fullscreenOnly:!1},e||{})}dragEvent(e){this.sirvService&&this.broadcast("dragEvent",{data:{type:e}})}startFullInit(e){this.isStartedFullInit||(this.isStartedFullInit=!0,e&&(this.options=e),this.sirvService&&this.sirvService.startFullInit(e?this._options:null),this.hide(),this.instanceNode.append(this.contentWrapper),this.sirv||this.appendToDOM())}createComponentLoader(){this.componentLoader||(this.componentLoader=new a(this.instanceNode),this.componentLoader.show())}get slideAvailable(){return this.availableSlide}get selectorPinned(){return["start","end"].includes(this.selector.pinned)}get pinnedSelectorSide(){return this.selector.pinned}setFullscreenEvents(){this.on("beforeFullscreenIn",(e=>{this.fullscreenState===s.FULLSCREEN.OPENING?e.stopPropagation():(this.fullscreenState=s.FULLSCREEN.OPENING,this.video&&(this.isVideoPaused=this.video.paused,this.video.onBeforeFullscreenIn())),this.fullscreenOnlyNode&&this.fullscreenOnlyNode.setCssProp("display","none"),this.addEventCloseFullscreenByClick()})),this.on("afterFullscreenIn",(e=>{this.socialbuttons&&this.socialbuttons.closeButtons(),this.fullscreenState===s.FULLSCREEN.OPENED?e.stopPropagation():(this.fullscreenState=s.FULLSCREEN.OPENED,this.sirv&&this.componentLoader.isHiding()&&this.componentLoader.hide(!0),this.video&&(this.video.onAfterFullscreenIn(),!this.video.autoplay&&this.video.preStart||this.playVideo()))})),this.on("beforeFullscreenOut",(e=>{this.socialbuttons&&this.socialbuttons.closeButtons(),this.fullscreenState===s.FULLSCREEN.CLOSING?e.stopPropagation():(this.fullscreenState=s.FULLSCREEN.CLOSING,this.video&&(this.isVideoPaused=this.video.paused,this.video.onBeforeFullscreenOut())),this.fullscreenOnlyNode&&this.fullscreenOnlyNode.setCssProp("display","")})),this.on("afterFullscreenOut",(e=>{this.fullscreenState===s.FULLSCREEN.CLOSED?e.stopPropagation():(this.fullscreenState=s.FULLSCREEN.CLOSED,this.video&&(this.video.onAfterFullscreenOut(),!this.video.autoplay&&this.video.preStart||this.playVideo())),this.removeEventCloseFullscreeByClick()})),this.on("inView",(e=>{this.inView=e.data,this.video&&(this.inView?(!this.isVideoPaused&&!this.video.preStart||this.video.autoplay)&&this.playVideo():(this.isVideoPaused=this.video.paused,this.video.getCurrentTime(),this.video.pause()))}))}addEventCloseFullscreenByClick(){this._options.fullscreenOnly&&this.type===s.SLIDE.TYPES.IMAGE&&(this.contentWrapper.addEvent(["btnclick","tap"],this.sendEventCloseFullscreenByClick),this.slideContent.addEvent(["btnclick","tap"],this.sendEventCloseFullscreenByClick))}removeEventCloseFullscreeByClick(){this._options.fullscreenOnly&&this.type===s.SLIDE.TYPES.IMAGE&&(this.contentWrapper.removeEvent(["btnclick","tap"],this.sendEventCloseFullscreenByClick),this.slideContent.removeEvent(["btnclick","tap"],this.sendEventCloseFullscreenByClick))}get sirv(){return!!this.sirvService}get node(){return this.instanceNode}get originNode(){return this.lastOriginNode||this.slideContent}get originImageUrl(){return this.sirv?this.sirvService.originImageUrl:null}zoomIn(e,t){this.broadcast("zoomUp",{data:{x:e,y:t}})}zoomOut(e,t){this.broadcast("zoomDown",{data:{x:e,y:t}})}mouseAction(e,t){this.sirv&&this.broadcast("mouseAction",{data:{type:e,originEvent:t}})}get zoomData(){return this.sirv?this.sirvService.getZoomData():null}get typeOfSlide(){let e=null;return this.sirv&&(e=this.sirvService.type),e}get options(){return this.sirv?this.sirvService.getToolOptions():{}}createSlideApi(){this.sirv&&!this.isStarted&&(this.isStarted=!0,this.api[s.SLIDE.NAMES[this.sirvService.type]]=this.sirvService.getData())}beforeShow(){this.isActive=!0,this.show(),this.sirv&&this.sirvService.activate(),this.createSlideApi()}afterShow(e){this.slideShownBy=e||s.SLIDE_SHOWN_BY.NONE,this.broadcast("startActions",{who:this.slideShownBy}),this.video&&this.video.autoplay&&this.playVideo()}beforeHide(){this.video?this.video.pause():this.broadcast("stopActions")}afterHide(){this.slideShownBy=s.SLIDE_SHOWN_BY.NONE,this.isActive=!1,this.hide(),this.sirv&&this.sirvService.deactivate(),this.socialbuttons&&this.socialbuttons.closeButtons()}show(){this.instanceNode.removeClass("smv-hidden"),this.instanceNode.addClass("smv-shown")}hide(){this.instanceNode.removeClass("smv-shown"),this.instanceNode.addClass("smv-hidden")}get zoomSizeExist(){return!!this.sirv&&this.sirvService.isZoomSizeExist()}startTool(e,t,s){this.sirv?this.getSlideSize().then((i=>{this.isInDom&&this.sirvService?(this.sirvService.startTool(e||this.isActive,t,s),this.addSocialButtons()):this.emit("contentLoaded",{data:{slide:{index:this._index}}})})).catch((e=>{})):this.getSlideSize().then((()=>{this.emit("contentLoaded",{data:{slide:{index:this._index}}})}))}getSlideSize(){return this.sizePromise||(this.sizePromise=new Promise(((e,t)=>{if(this.sirv){const i={UUID:this.$J_UUID};this.sirvService.getInfoSize().then((t=>{!this.infoSize&&t.size&&(this.infoSize=t.size),i.size=this.infoSize,e(i)})).catch((n=>{if(i.error=!0,this.sirvService){const o=this.sirvService.type;if(this.removeSirvService(),n&&n.error&&n.error.status&&404===n.error.status)i.error=n.error,t(i);else if(n&&("changeSpinToImage"===n.error||o===s.SLIDE.TYPES.IMAGE||n.isPlaceholder)){if(this.isPlaceholder=n.isPlaceholder,o===s.SLIDE.TYPES.IMAGE){this.isInDom=0,this.appendToDOM();const e=l(this.slideContent.node);this.selector.isCustom||(this.selector.src=e?e.data:null,this.selector.isSirv=!1)}else this.changeSpinToImage();const i=this.sizePromise;this.sizePromise=null;const r=this.getSlideSize();this.sizePromise=i,r.then(e).catch(t)}else i.error={status:404},t(i)}else i.error={status:404},t(i)})).finally((()=>{this.isCustomAdded&&this.emit("infoReady",{data:{index:this._index}})}))}else{let s,n;if("img"===this.slideContent.tagName)s=this.slideContent.node;else try{s=this.slideContent.node.getElementsByTagName("img")[0]}catch(e){}s&&(n=o.sliderLib.getSrc(y(s).attr("src")),n||(n=o.sliderLib.getSrc(y(s).attr("data-src")))),n?o.loadImage(n).then((t=>{this.infoSize=t.size,e({size:this.infoSize,UUID:this.$J_UUID})})).catch((t=>{e({size:this.infoSize,UUID:this.$J_UUID,error:{status:404}})})):this.video?this.video.getSize().then((t=>{this.infoSize=t||{width:0,height:0},e({size:this.infoSize,UUID:this.$J_UUID})})).catch((e=>{t({size:this.infoSize,UUID:this.$J_UUID,error:e})})):i(this.slideContent.node).then((t=>{this.infoSize=t||{width:0,height:0},e({size:this.infoSize,UUID:this.$J_UUID})})).catch((e=>{t({size:this.infoSize,UUID:this.$J_UUID,error:e})}))}}))),this.sizePromise}get api(){return this._api}removeSirvService(){this.infoSize=null,this.slideContent&&this.slideContent.remove(),this.selector.node&&this.selector.node.removeAttr("data-type"),this.sirvService&&(this.sirvService.destroy(),this.sirvService=null),this.selector.isSirv=!1,this.off("stats"),this.off("componentEvent"),this.off("beforeFullscreenIn"),this.off("afterFullscreenIn"),this.off("beforeFullscreenOut"),this.off("afterFullscreenOut"),this.componentLoader&&(this.componentLoader.hide(!0),this.componentLoader.destroy(),this.componentLoader=null),this.fullscreenOnlyNode&&(this.fullscreenOnlyNode.kill(),this.fullscreenOnlyNode=null)}changeSpinToImage(){if(this.slideContent.removeClass("smv-component"),this.contentWrapper.removeClass("smv-content-"+s.SLIDE.NAMES[this.typeOfSlide]),this.lastOriginNode=this.slideContent,this.slideContent=v.$new("img",{"data-src":this.slideContent.attr("data-src")}),this.slideContent.addClass("smv-component"),this.parseSlide(),this.isInDom=0,this.appendToDOM(),this.isPlaceholder){const e=l(this.slideContent);this.selector.isCustom||(this.selector.src=e?e.data:null)}this.selector.node&&!this.selector.isCustom&&this.selector.node.attr("data-type",s.SLIDE.NAMES[this.typeOfSlide]),this.isStartedFullInit&&(this.isStartedFullInit=!1,this.startFullInit())}setSirvEvents(){this.on("stats",(e=>{e.stopEmptyEvent(),e.data.index=this._index})),this.on("componentEvent",(t=>{t.stopEmptyEvent();const i=t.data.data;if(i.type=t.data.type,i.node=this.slideContent,"ready"===t.data.type&&(this.isReady=!0),t.data.slide=this.api,t.data.componentEventData=i,t.data.component===s.SLIDE.NAMES[s.SLIDE.TYPES.SPIN]){if("init"===t.data.type){this.componentLoader.hide(),this.spinWasInited=!0;const e={row:"spin-x",col:"spin-y","multi-row":"spin-xy"};this.selector.node&&this.selector.node.addClass(e[this.sirvService.getSpinOrientation()]||"")}}else"ready"===t.data.type&&this.componentLoader.hide();"ready"===t.data.type&&["spin","zoom"].includes(t.data.component)&&this.sirvService.isZoomSizeExist()&&this.contentWrapper.addClass(e)}))}addSocialButtons(){if(this.validateComponentSocialButton()){const e=["facebook","twitter","linkedin","reddit","tumblr","pinterest","telegram"],t={};e.forEach((e=>{t[e]=this._options["sb"+v.camelize("-"+e)]}));const s=SocialButtons.getDataImage(),i={};e.forEach((e=>{i[e]=this.getLinkSocialButton(s[e],t[e])})),this.socialbuttons=new SocialButtons({text:this.slideContent.attr("alt"),link:i,title:this.slideContent.attr("title")},t,this.instanceNode)}}validateComponentSocialButton(){return!(!this._options.sbEnable||!SocialButtons||this.socialbuttons||!(this.sirv&&this.sirvService.type!==s.SLIDE.TYPES.VIDEO||this.video&&"video"!==this.video.type||"img"===this.slideContent.tagName))}getLinkSocialButton(e,t,i){let n=null;return i&&(n=this.sirv?this.sirvService.getSocialButtonData(e,this.api.component===s.SLIDE.NAMES[s.SLIDE.TYPES.SPIN]):"iframe"===this.slideContent.tagName?this.video.node.attr("data-src"):this.slideContent.attr("data-src")),n}searchImagesInHtmlContent(){let e=!1;const t=Array.from(this.slideContent.node.querySelectorAll("img"));return t.length&&(e=!0,this.multiImages=t,t.forEach(((e,t)=>{const s=!N.checkNonSirv(e);s&&(this.sirvService?this.sirvService.push(e):(this.setSirvEvents(),this.selector.isSirv=!0,this.sirvService=new E(e,this._options,{quality:this._options.quality,hdQuality:this._options.hdQuality,isHDQualitySet:this._options.isHDQualitySet,always:this._options.fullscreenOnly,isFullscreen:this._options.isFullscreen,nativeFullscreen:this._options.nativeFullscreen}),this.sirvService.parentClass=this,this.sirvService.start(),this.createSlideApi())),this.multiImages.push({isSirv:s,node:e,src:y(e).attr("src"),datasrc:y(e).attr("data-src")})}))),e}isCustomSlideEmpty(){if(this.customSelector){const e=this.slideContent.node.querySelector(b);if(e){v.$(e).remove();const t=Array.from(this.slideContent.node.children).length;if(this.slideContent.append(e),N.isSirvComponent(this.slideContent)&&N.hasComponent(this.slideContent)&&!this.isPlaceholder||t||o.videoModule.isVideo(this.slideContent))return!1}}return!0}beforeParseSlide(){this.customSelector&&(this.isCustomSlideEmpty()&&(this.availableSlide=!1,this.selector.activated=!1),this.selector.node.remove())}createImgFromDiv(){if("div"===this.slideContent.tagName&&this.type===s.SLIDE.TYPES.IMAGE){const e=this.slideContent;this.slideContent=v.$new("img"),this.slideContent.attr("data-src",this.url);let t=e.attr("alt");t&&this.slideContent.attr("alt",t),t=e.attr("title"),t&&this.slideContent.attr("title",t),t=e.attr("data-alt"),t&&this.slideContent.attr("data-alt",t),t=e.attr("data-referrerpolicy"),t&&this.slideContent.attr("data-referrerpolicy",t)}}parseSlide(){N.isSirvComponent(this.slideContent)&&N.hasComponent(this.slideContent)&&!this.isPlaceholder?(this.setSirvEvents(),this.createImgFromDiv(),this.sirvService=new E(this.slideContent.node,this._options,{quality:this._options.quality,hdQuality:this._options.hdQuality,isHDQualitySet:this._options.isHDQualitySet,always:this._options.fullscreenOnly,isFullscreen:this._options.isFullscreen,nativeFullscreen:this._options.nativeFullscreen}),this.sirvService.parentClass=this,this.selector.isSirv=!0,this.sirvService.start(),this.createSlideApi(),this.selector.isVideo=this.sirvService.type===s.SLIDE.TYPES.VIDEO,this.contentWrapper.addClass("smv-content-"+s.SLIDE.NAMES[this.typeOfSlide])):(this.createImgFromDiv(),this.searchImagesInHtmlContent(),o.videoModule.isVideo(this.slideContent)&&(this.selector.isVideo=!0,this.initVideo(),this.contentWrapper.addClass("smv-content-video"))),(this.dataThumbnailImage||this.dataThumbnailHtml)&&(this.selector.isSirv=!1)}appendToDOM(){this.isInDom||(this.isInDom=1,this.createFullscreenOnlyScreen(),this.sirv||this.video?(this.createComponentLoader(),this.video?this.contentWrapper.append(this.video.node):this.contentWrapper.append(this.slideContent)):("img"===this.slideContent.tagName&&(this.contentWrapper.addClass("smv-slide-img"),o.sliderLib.getSrc(this.slideContent.attr("src"))||this.slideContent.attr("src",this.slideContent.attr("data-src"))),this.multiImages.length&&this.multiImages.forEach((e=>{!e.src&&e.datasrc&&y(e.node).attr("src",e.datasrc)})),this.contentWrapper.append(this.slideContent)),this.setFullscreenEvents())}initVideoPlayer(){this.video?this.video.init():this.sirv&&this.sirvService.type===s.SLIDE.TYPES.VIDEO&&this.sirvService.loadVideoSources()}secondSelectorClick(){this.sirv?this.broadcast("secondSelectorClick",{data:{slideIndex:this._index}}):this.video&&this.video.pause()}isSirvSelector(){return!this.selector.isCustom&&(this.sirv&&this.sirvService.type!==s.SLIDE.TYPES.VIDEO)}getSelectorProportion(){let e;return e=this.dataThumbnailImage?new Promise(((e,t)=>{this.getResponsiveImage().then((()=>e(Object.assign({},this.selector)))).catch((s=>{o.loadImage(this.dataThumbnailImage).then((t=>{this.selector.size=t.size,e(Object.assign({},this.selector))})).catch((e=>{t(e)}))}))})):this.video?this.getNonSirvVideoThumbnail():this.getSlideSize(),e}getSelectorReferrerPolicy(){const e="no-referrer-when-downgrade";if(this.selector.isCustom){if(this.selector.node.hasAttribute("data-referrerpolicy"))return this.selector.node.attr("data-referrerpolicy");const t=Array.from(this.selector.node.node.children).filter((e=>"img"===y(e).tagName));if(1===t.length)return y(t[0]).attr("referrerpolicy")||e}return this.slideContent.attr("data-referrerpolicy")||this.slideContent.attr("referrerpolicy")||e}getResponsiveImage(){return this.customThumbnailImageClassPromise||(this.customThumbnailImageClassPromise=new Promise(((e,t)=>{const s=new n(this.dataThumbnailImage);s.loadInfo().then((t=>{this.selector.isSirv=!0,this.selector.size=s.originSize,e(s)})).catch(t)}))),this.customThumbnailImageClassPromise}getSirvThumbnailForCustomSelector(e){return new Promise(((t,s)=>{this.getResponsiveImage().then((s=>{const i=s.getThumbnail(e);i.referrerpolicy=this.thumbnailReferrerPolicy,t(i)})).catch(s)}))}getSelectorImgUrl(e,t,s,i){const n={crop:s,watermark:i};t.width&&(n.width=t.width),t.height&&(n.height=t.height);const o=e=>{e.src&&(this.selector.src=e.src),e.srcset&&(this.selector.srcset=e.srcset);let t=Object.assign({},e);return t=Object.assign(t,this.selector),t};return new Promise(((e,t)=>{const s=()=>{this.selector.isCustom&&this.dataThumbnailImage?this.selector.isStatic?e(Object.assign({},this.selector)):this.getSirvThumbnailForCustomSelector(n).then((t=>e(o(t)))).catch((()=>e(Object.assign({},this.selector)))):"img"===this.slideContent.tagName||this.multiImages.length?e(Object.assign({},this.selector)):this.video&&this.getNonSirvVideoThumbnail().then(e).catch(t)};this.sirv?this.sirvService.getInfoSize().then((s=>{this.selector.isCustom?this.selector.isStatic?e(Object.assign({},this.selector)):this.getSirvThumbnailForCustomSelector(n).then((t=>e(o(t)))).catch((()=>e(Object.assign({},this.selector)))):this.sirvService.getSelectorImgUrl(n).then((t=>{t.referrerpolicy=this.thumbnailReferrerPolicy,e(o(t))})).catch(t)})).catch((()=>{this.selector.isCustom?s():t()})):s()}))}getNonSirvVideoThumbnail(){return this.getVideoThumbnailPromise||(this.getVideoThumbnailPromise=new Promise(((e,t)=>{o.videoModule.getImageSrc(this.slideContent,!0).then((t=>{this.selector.isCustom||(this.selector.src=t.thumbnail.url,this.selector.size={width:t.thumbnail.width,height:t.thumbnail.height}),e(Object.assign({},this.selector))})).catch((e=>{e&&!0!==e?e.UUID=this.$J_UUID:e={UUID:this.$J_UUID},t(e)}))}))),this.getVideoThumbnailPromise}get spinInited(){return this.spinWasInited}get slideReady(){return this.isReady}get selectorData(){if(this.dataHiddenSelector)return null;if(this.selector.node||(this.selector.node=v.$new(b),this.selector.node.addClass("smv-selector")),this.dataThumbnailImage){const e=this.typeOfSlide;null!==e&&this.selector.node.attr("data-type",s.SLIDE.NAMES[e]),this.selector.src=this.dataThumbnailImage,this.selector.isStatic||(this.selector.infoPromise=new Promise((e=>{this.getResponsiveImage().catch((e=>{})).finally((()=>{e(this.selector.isSirv,this.selector.size)}))})))}else if(this.dataThumbnailHtml){const e=v.$new("div");e.node.innerHTML=this.dataThumbnailHtml,this.selector.selectorContent=e.node.firstChild,this.selector.node.attr("data-type","html")}else if(this.selector.isCustom)this.selector.node.attr("data-type","html"),this.selector.selectorContent=this.selector.node;else if(this.sirv){const e=this.typeOfSlide;this.selector.node.attr("data-type",s.SLIDE.NAMES[e]),e===s.SLIDE.TYPES.SPIN&&this.sirvService.isThumbnailGif()&&this.selector.node.addClass("spin-thumbnail-gif")}else{const e=l(this.slideContent.node);["youtube","vimeo","video"].includes(e.type)?this.selector.node.attr("data-type",e.type):"img"===e.type?this.selector.src=e.data:(this.selector.selectorContent=e.data,this.selector.node.attr("data-type","html"))}return this.selector.isCustom&&this.selector.node.addClass("smv-custom-thumbnail"),this.selector.disabled=!this._enabled,this.selector}get UUID(){return this.$J_UUID}get slideActive(){return this.isActive}playVideo(){this.isActive&&this.inView&&this.video&&(this.fullscreenState===s.FULLSCREEN.OPENED||[s.SLIDE_SHOWN_BY.AUTOPLAY,s.SLIDE_SHOWN_BY.USER,s.SLIDE_SHOWN_BY.INIT].includes(this.slideShownBy))&&this.video.play()}initVideo(){this.on("slideVideoReady",(e=>{e.stop(),this.isVideoReady||(this.isVideoReady=!0,this.isReady=!0,this.video.show(),this.componentLoader.hide()),!this.video.autoplay&&this.video.preStart||this.playVideo()})),this.on("slideVideoPlay",(e=>{e.data.slide=this.api,this.isVideoPaused&&!this.video.autoplay&&this.video.pause(),this.isVideoPaused=!1})),this.on("slideVideoPause",(e=>{e.data.slide=this.api})),this.on("slideVideoEnd",(e=>{e.data.slide=this.api}));const e=this._options.video;switch(o.videoModule.getType(this.slideContent)){case"youtube":this.video=new D.YouTubeVideo(this.slideContent,e);break;case"vimeo":this.video=new D.VimeoVideo(this.slideContent,e);break;case"video":this.video=new D.HTMLVideo(this.slideContent,e)}this.video.parentClass=this}resize(){if(this._enabled&&this.sirvService){this.sirvService.resize();const t=s.SLIDE.TYPES;this.isReady&&[t.SPIN,t.ZOOM].includes(this.typeOfSlide)&&(this.sirvService.isZoomSizeExist()?this.contentWrapper.addClass(e):this.contentWrapper.removeClass(e))}}destroy(){this.sirvService?(this.sirvService.destroy(),this.sirvService=null,this.off("stats"),this.off("componentEvent")):this.multiImages.length&&this.multiImages.forEach((e=>{!e.src&&e.datasrc&&e.node.removeAttribute("src")})),this.slideContent.del("view-content"),this.removeEventCloseFullscreeByClick(),this.sendEventCloseFullscreenByClick=null,this.lastOriginNode&&(this.slideContent.remove(),this.slideContent=this.lastOriginNode,this.lastOriginNode=null),this.fullscreenOnlyNode&&(this.fullscreenOnlyNode.kill(),this.fullscreenOnlyNode=null),this.off("beforeFullscreenIn"),this.off("afterFullscreenIn"),this.off("beforeFullscreenOut"),this.off("afterFullscreenOut"),this.off("inView"),this.video&&(this.off("slideVideoReady"),this.off("slideVideoPlay"),this.off("slideVideoPause"),this.off("slideVideoEnd"),this.video.destroy()),this.video=null,this.componentLoader&&(this.componentLoader.destroy(),this.componentLoader=null),this.socialbuttons&&this.socialbuttons.destroy(),this.sizePromise=null,this.componentSize=null,this.contentWrapper.remove(),this.contentWrapper=null,this.instanceNode.remove(),this.instanceNode=null,this.slideContent=null,this.isReady=!1,this.availableSlide=null,super.destroy()}}return d})();let z=null,A=null;const F=(()=>{const e=v.camelize("-fullscreen"),t="smv-button-fullscreen-open",n="smv-button-fullscreen-close",a="smv-button-hidden",h="smv-pseudo-fullscreen",d={width:"100%",height:"100%"};return class extends r{constructor(e,t){super(),this.instanceNode=y(e),this.instanceOptions=t.options,this.viewerFileContent=t.viewerFileContent,this.option=(...e)=>e.length>1?this.instanceOptions.set(e[0],e[1]):this.instanceOptions.get(e[0]),this.slideOptions=this.makeSlideOptions(t.slideOptions),this.id=this.instanceNode.attr("id"),this.id||(this.id="smv-"+o.generateUUID(),this.instanceNode.attr("id",this.id)),this.lazyInit=t.lazyInit,this.movingContainer=v.$new("div").addClass(g),this.slideWrapper=v.$new("div").addClass("smv-slides-box"),this.slidesContainer=v.$new("div").addClass("smv-slides"),this.selectorsWrapper=v.$new("div").addClass("smv-selectors-box"),this.fullScreenBox=v.$new("div").addClass("smv-fullscreen-box"),this.controlsWrapper=v.$new("div").addClass("smv-controls"),this.producDetailsText=this.instanceNode.attr("data-product-detail"),this.productDetail=null,this.fullScreenBox.addEvent(["mousescroll","touchstart"],(e=>{e.stopDistribution()})),this.isReady=!1,this.isMoving=!1,this.isSelectorsReady=!1,this.isToolStarted=!1,this.isInitialized=!1,this.isStartedFullInit=!1,this.inViewModule=null,this.isInView=!1,this.firstSlideAhead=!1,this.rootMargin=0,this.fullscreenButton=null,this.doSetSize=!1,this.heightProportion=null,this.slides=[],this.enabledIndexesOfSlides=[],this.selectors=null,this.arrows=null,this.contextMenu=null,this.countOfSizes=y([]),this.isFullscreen=s.FULLSCREEN.CLOSED,this.fullscreenStartTime=null,this.index=this.option("slide.first"),this.movingContainerId="smv-"+o.generateUUID(),this.cssRulesId="sirv_css_rules-"+o.generateUUID(),this.isComponentPinching=!1,this.isZoomIn=!1,this.hasSize=!1,this.isPseudo=!1,this.isAutoplay=this.option("slide.autoplay"),this.autoplayDelay=this.option("slide.delay"),this.residualAutoplayTime=this.autoplayDelay,this.sliderNodes=[],this.destroyed=!1,this.autoplayTimer=null,this.timerRemove=null,this.onResizeDebounce=o.debounce((()=>{this.onResizeWithoutSelectors()}),16),this.selectorsDebounce=null,this.option("fullscreen.history")&&(this.fullscreenViewId=Math.floor(Math.random()*Date.now()),s.FULLSCREEN_VIEWERS_IDs_ARRAY.push(this.fullscreenViewId)),this.controlsWrapperWasAppended=!1,this.isStandardGrid=!1,this.isFullscreenGrid=!1,this.clearingTouchdragFunction=null,this.classes={standard:{movingContainerClasses:y([]),selectorsWrapperClasses:y([])},fullscreen:{movingContainerClasses:y([]),selectorsWrapperClasses:y([])}},this.externalContainer=null,v.browser.mobile&&this.movingContainer.addClass("smv-mobile"),this.onResizeHandler=this.onResize.bind(this),this.pseudoFSEvent=e=>{27===e.oe.keyCode&&(y(v.D).removeEvent("keydown",this.pseudoFSEvent),this.exitFullScreen())},this.keyBoardArrowsCallback=e=>{let t;const s=e.oe.keyCode;this.isReady&&[37,39].includes(s)&&(e.stop(),t=37===s?"prev":"next",this.jump(t,2))},this.onHistoryStateChange=e=>{try{e.oe.state&&"Sirv.viewer"===e.oe.state.name?(s.FULLSCREEN_VIEWERS_IDs_ARRAY.indexOf(e.oe.state.hash)<0&&(s.FULLSCREEN_VIEWERS_IDs_ARRAY.splice(s.FULLSCREEN_VIEWERS_IDs_ARRAY.indexOf(this.fullscreenViewId),1),this.fullscreenViewId=e.oe.state.hash,s.FULLSCREEN_VIEWERS_IDs_ARRAY.push(this.fullscreenViewId)),e.oe.state.hash===this.fullscreenViewId&&this.enterFullScreen()):this.isFullscreenState()&&this.exitFullScreen()}catch(e){}};const n=this.getSlides();this.addComponentsCSS=o.debounce((()=>{i.rootDOM.addCSSStringToHtml()}),100),i.rootDOM.addCSSStringToHtml(),i.rootDOM.addCSSString(this.instanceNode.node),this.setComponentsEvents(),this.createSlides(n),(v.browser.ready||"loading"!==v.D.node.readyState)&&this.startFullInit(),u&&this.option("productdetail.enable")&&this.producDetailsText&&this.createProductDetails()}isFullscreenState(){return[s.FULLSCREEN.OPENING,s.FULLSCREEN.OPENED].includes(this.isFullscreen)}createProductDetails(){this.productDetail=new u({text:this.producDetailsText,position:this.option("productdetail.position")},this.movingContainer,this.fullScreenBox)}setRootMargin(){let e=parseInt(this.option("threshold"),10);if("string"===v.typeOf(this.option("threshold"))){e=(v.W.node.innerHeight||v.D.node.documentElement.clientHeight)/100*e}this.rootMargin=e}makeSlideOptions(e){return Object.assign(e,{quality:this.instanceOptions.isset("quality")?this.option("quality"):null,hdQuality:this.option("hdQuality"),isHDQualitySet:this.instanceOptions.isset("hdQuality"),fullscreenOnly:this.option("fullscreen.always"),isFullscreen:this.option("fullscreen.enable"),nativeFullscreen:this.option("fullscreen.native"),sbEnable:this.option("slide.socialbuttons.enable"),sbFacebook:this.option("slide.socialbuttons.types.facebook"),sbTwitter:this.option("slide.socialbuttons.types.twitter"),sbLinkedin:this.option("slide.socialbuttons.types.linkedin"),sbReddit:this.option("slide.socialbuttons.types.reddit"),sbTumblr:this.option("slide.socialbuttons.types.tumblr"),sbPinterest:this.option("slide.socialbuttons.types.pinterest"),sbTelegram:this.option("slide.socialbuttons.types.telegram")})}startFullInit(e){if(this.isStartedFullInit||!this.slides.length)return;if(this.isStartedFullInit=!0,this.isHiddenSlides())return;e&&(this.instanceOptions=e.options,this.option=(...e)=>e.length>1?this.instanceOptions.set(e[0],e[1]):this.instanceOptions.get(e[0]),this.slideOptions=this.makeSlideOptions(e.slideOptions),this.slideOptions.autoplay=this.option("video.autoplay"),this.lazyInit=e.lazyInit,this.isAutoplay=this.option("slide.autoplay"),this.autoplayDelay=this.option("slide.delay"),this.residualAutoplayTime=this.autoplayDelay),this.option("fullscreen.always")&&this.movingContainer.addClass("smv-fullsreen-always"),null===z&&(z=v.browser.mobile&&window.matchMedia&&window.matchMedia("(max-device-width: 767px), (max-device-height: 767px)").matches),z&&"ios"===v.browser.platform&&(A=v.$new("div").setCss({position:"fixed",top:0,width:0,height:"100vh"})),this.normalizeOptions(),this.setRootMargin(),this.slideWrapper.addClass("smv-"+("horizontal"===this.option("orientation")?"h":"v")),this.index=this.option("slide.first");const t=this.slides.length;if(this.index>t-1&&(this.index=0),t>0&&(!this.slides[this.index].enabled||!this.slides[this.index].slideAvailable)){let e=null;for(let s=0;s<t;s++){const i=o.sliderLib.findIndex("next",this.index+s,t,!0);if(this.slides[i].enabled&&this.slides[i].slideAvailable){e=i;break}}if(null===e)return console.warn("Sirv Media Viewer: All items are disabled.",this.instanceNode.node),void this.emit("destroy",{data:{id:this.id,node:this.instanceNode.node}});this.index=e}this.createContextMenu(),this.setInViewAction(),this.option("thumbnails.enable")&&this.option("thumbnails.target")&&(this.externalContainer=y(v.D.node.querySelector(this.option("thumbnails.target"))),this.externalContainer||(this.externalContainer=null));const s=v.D.node.createDocumentFragment();s.appendChild(this.movingContainer.node),this.movingContainer.setCss(d),this.movingContainer.setCssProp("font-size",0),this.movingContainer.append(this.slideWrapper),this.slides.forEach((t=>{t.startFullInit(e?this.slideOptions:null)})),this.appendSelectors(!0),this.createClasses(),this.setClasses(),this.instanceNode.append(s),this.instanceNode.setCssProp("font-size",0),this.slideWrapper.append(this.slidesContainer),this.slidesContainer.setCss(d),this.instanceNode.render(),this.movingContainer.render(),this.selectorsWrapper.render(),this.slideWrapper.render();const i=this.instanceNode.size.height>0;this.createSelectors(),this.selectors&&this.isStandardGrid&&this.selectorsWrapper.setCss({flexBasis:this.option("thumbnails.size")+"px"});let n=10;const r=()=>{if(this.destroyed)return;let e=this.slidesContainer.node.getBoundingClientRect();e.height||(e=this.slideWrapper.node.getBoundingClientRect()),n-=1,n>0&&(!e.width&&!e.height||i&&!e.height)?setTimeout(r,16):(this.instanceNode.setCssProp("font-size",""),e.width&&e.height||(this.doSetSize=!0),this.slides.forEach((e=>{e.slideAvailable&&this.slidesContainer.append(e.node),e.appendToDOM(),e.initVideoPlayer()})),this.setClasses(),this.searchingOfProportions(),this.selectors&&this.selectors.init(),this.postInitialization())};this.firstSlideAhead&&this.broadcast("inView",{data:this.isInView}),setTimeout(r,16)}visibleSlides(){return this.slides.filter((e=>e.slideAvailable&&e.enabled)).length}searchingOfProportions(){const e=this.slides.length,t=()=>{const e=this.index,t=!this.firstSlideAhead&&this.option("slide.preload");this.hasSize=this.setContainerSize(),this.inViewModule&&["edge","ie"].includes(v.browser.uaName)&&this.inViewModule.takeRecords(),this.slides.forEach(((s,i)=>{s.startTool(e===i,t,this.firstSlideAhead)})),this.createEffect(),this.isToolStarted=!0,this.checkSingleSlide(),this.slides[this.index].beforeShow(),this.slides[this.index].afterShow(s.SLIDE_SHOWN_BY.INIT),this.postInitialization()},i=(t,s)=>new Promise(((n,r)=>{const l=this.slides[t],a=this.slides.length;if(s.push(t),l){const h=()=>{let r=o.getArrayIndex(t+1,e);if(a!==this.slides.length&&r>t&&(r=t),s.includes(r)){const e=this.slidesContainer.size;e.width||(e.width=500),e.height||(e.height=.5625*e.width),this.heightProportion=e,n()}else i(r,s).then(n)};l.getSlideSize().then((e=>{const t=e.size;t&&t.width&&t.height?(this.heightProportion=t,n()):h()})).catch((e=>{let t=this.slides.length;e&&e.error&&404===e.error.status&&(t-=1,this.pickOut(e.UUID)),t>0?h():r()}))}}));this.doSetSize?i(this.index,[]).then((()=>{t()})).catch((()=>{})):t()}initTouchDrag(){let e,t,i,n,o=["x","left","width"],r="y",l=!1,a=null,h=null,d=null;const c=this.option("loop");let u=null,p=null,m=!0,f=!0,S=null,y=null,g=0,b={x:null,y:null},C=!1;const E=e=>e/n*100,w=(e,t)=>{e&&e.node.setCssProp("transform",(e=>{const t={x:0,y:0};return t[o[0]]=e,"translate3d("+t.x+"%, "+t.y+"%, 0px)"})(t))},I=e=>new Promise(((t,s)=>{let n,o=100,r=0;const l=Math.abs(i);if((l<25||2===g||"next"===e&&i<0||"prev"===e&&i>0)&&(f=!1),f||(e=i<0?"prev":"next"),S="next"===e?a:d,y="next"===e?d:a,"next"!==e&&(o*=-1),y&&(y.node.setCssProp("transform",""),y.afterHide()),f?(h.beforeHide(),this.sendEvent("beforeSlideIn",{slide:S.api}),this.sendEvent("beforeSlideOut",{slide:h.api}),this.index=S.index):(n=o,o=r,r=n,r*=-1,l<2&&(m=!1)),m){let e;h.node.addEvent("transitionend",(e=>{e.stop(),t()})),S&&S.node.setCssProp("transition","transform, .3s"),h.node.setCssProp("transition","transform, .3s"),S&&(e=S.node.size),e=h.node.size,this.selectors&&(this.selectors.activateItem(this.index),this.selectors.jump(this.index))}S&&w(S,r),w(h,o),m||t()})),x=()=>{if(l){const e={transform:"",transition:""};h.node.removeEvent("transitionend"),S&&(f?(this.checkLoop(this.index),S.afterShow(s.SLIDE_SHOWN_BY.USER),h.afterHide(),this.sendEvent("afterSlideIn",{slide:S.api}),this.sendEvent("afterSlideOut",{slide:h.api})):S&&S.afterHide(),S&&S.node.setCss(e)),h.node.setCss(e),m=!0,f=!0,S=null,y=null,this.enableFullscreenButton(),this.autoplay(),l=!1,this.isMoving=!1,u=null,p=null,a=null,h=null,d=null,C=!1}},O=(e,t)=>{let s=null,i=t;i===v.U&&(i=this.index);const n=this.getNextIndex(e,i,this.slides.length,c);if(null!==n){const t=this.slides[n];t.index!==this.index&&(s=t.enabled?t:O(e,t.index))}return s},P=s=>{C||(x(),this.effect.stop(),null!==this.index&&(h=this.slides[this.index],h.isSwipeDisabled()||(l=!0,this.isMoving=!0,e=this.slidesContainer.position[o[1]],n=this.slidesContainer.size[o[2]],p=s[o[0]]-e,t=E(p),i=t,a=O("prev"),d=O("next"),a&&d&&(a.index===d.index?a.index<h.index?d=null:a=null:a.index!==h.index&&h.index!==d.index||(a.index===h.index?a=null:d=null)),a&&(w(a,-100),a.beforeShow()),d&&(w(d,100),d.beforeShow()),this.disableFullscreenButton())))},D=s=>{let n,r;var c;l&&!C&&(l=!0,s.stop(),r=s[o[0]]-e,r<p?n="prev":r>p?n="next":n||(n=i>0?"next":"prev"),p=r,u=n,i=E(p)-t,!d&&i<-10&&(i=-10),!a&&i>10&&(i=10),w(a,(c=i)-100),w(h,c),w(d,c+100))};"vertical"===this.option("orientation")&&(o=["y","top","height"],r="x"),this.clearingTouchdragFunction=x,this.slidesContainer.addEvent("touchdrag",(e=>{this.isComponentPinching||this.isZoomIn||this.slides[this.index].blokedTouchdrag||this.option("fullscreen.always")&&this.isFullscreen!==s.FULLSCREEN.OPENED||("dragstart"===e.state?(b={x:e.x,y:e.y},P(e),h.dragEvent(e.state)):"dragmove"===e.state?(g||(g=Math.abs(b[o[0]]-e[o[0]])>Math.abs(b[r]-e[r])?1:2),1===g&&D(e),b={x:e.x,y:e.y}):"dragend"===e.state&&((e=>{l&&!C&&(1===g&&e.stop(),h.dragEvent(e.state),C=!0,I(u).finally((()=>{C=!1,x()})))})(e),g=0,b={x:null,y:null}))}))}appendSelectors(e){let t=this.movingContainer;this.externalContainer&&(this.isFullscreenState()?this.selectorsWrapper.removeClass("smv-external"):(t=this.externalContainer,this.selectorsWrapper.addClass("smv-external"))),(e||this.externalContainer)&&t.append(this.selectorsWrapper)}createClasses(){const e=this.option;["standard","fullscreen"].forEach((t=>{const s="standard"===t,i=e(s?"thumbnails.enable":"fullscreen.thumbnails.enable"),n=e(s?"thumbnails.position":"fullscreen.thumbnails.position"),o=(e=>{let t="thumbnails";return"bullets"===e&&(t=e),t})(e(s?"thumbnails.type":"fullscreen.thumbnails.type")),r=s?this.isStandardGrid:this.isFullscreenGrid;i&&(s&&this.externalContainer||this.classes[t].movingContainerClasses.push("smv-selectors-"+n),this.classes[t].selectorsWrapperClasses.push("smv-"+o),this.classes[t].selectorsWrapperClasses.push("smv-"+(["left","right"].includes(n)?"v":"h")),r&&this.classes[t].selectorsWrapperClasses.push("smv-grid"),e("fullscreen.thumbnails.autohide")&&!s&&(this.classes[t].movingContainerClasses.push("smv-autohide"),this.classes[t].movingContainerClasses.push("smv-selectors-closed")))}))}changeClasses(e,t){const s=t?"removeClass":"addClass";e.movingContainerClasses.forEach((e=>{this.movingContainer[s](e)})),e.selectorsWrapperClasses.forEach((e=>{this.selectorsWrapper[s](e)}))}setClasses(){this.isFullscreenState()?(this.changeClasses(this.classes.standard,!0),this.changeClasses(this.classes.fullscreen)):(this.changeClasses(this.classes.fullscreen,!0),this.changeClasses(this.classes.standard))}setInViewAction(){"visible"===this.option("autostart")?(this.inViewModule=new o.InViewModule((e=>{e.forEach((e=>{const t=this.isInView;let s=e.isIntersecting||e.intersectionRatio>0;this.isFullscreenState()&&!s&&(s=!0),t!==s&&(this.isInView=s,this.postInitialization(),this.broadcast("inView",{data:s}),this.isInView?this.autoplay():this.pauseAutoplay())}))}),{rootMargin:this.rootMargin+"px 0px"}),this.inViewModule.observe(this.instanceNode.node)):this.isInView=!0}sendEvent(e,t){t||(t={}),t.node=this.instanceNode,t.slider||(t.slider={type:e}),this.emit("viewerPublicEvent",{data:t})}checkReadiness(e,t){let s=!1;if(["init","ready"].includes(e))if("viewer"===t)"ready"===e&&(s=this.isReady);else for(let i=0,n=this.slides.length;i<n;i++)if(this.slides[i].checkReadiness(e,t)){s=!0;break}return s}sendReadyEvent(e,t){"viewer"===t?this.sendEvent("ready"):this.slides.forEach((s=>{s.sendReadyEvent(e,t)}))}sendStats(e,t){let s,i;if(t||(t={}),t.slider=this.id,e&&(t.data={},t.data.event=e),"spin"===t.component)s={account:t.account,event:{type:t.component,name:t.event,data:t.data||{},sessionId:t.sessionId,origin:t.origin}},s.event["sessionStart"===t.event?"ts":"time"]=t.eventTime,i=JSON.parse(JSON.stringify(s)),i.event=JSON.stringify(i.event);s&&(!0===t.useBeacon?o.sendRawStats(i,!0):setTimeout((()=>{o.sendRawStats(i)}),1),this.sendEvent("sendStats",v.detach(s)))}setComponentsEvents(){const t=e=>{if(this.firstSlideAhead&&e===this.index){const e=this.option("slide.preload");this.enabledIndexesOfSlides.forEach((t=>{this.slides[t].startGettingInfo(),e?this.slides[t].loadContent():this.slides[t].loadThumbnail()}))}},i=e=>{this.index===e&&this.autoplay()},n=e=>{this.index===e&&this.pauseAutoplay()};this.on("stats",(e=>{e.stopAll();const t=v.D.node,s=v.W.node,i=s.screen;"sessionStart"===e.data.event&&(e.data.data||(e.data.data={}),e.data.data.screen={width:i.width,height:i.height,availWidth:i.availWidth,availHeight:i.availHeight,colorDepth:i.colorDepth,pixelDepth:i.pixelDepth},e.data.data.browser={width:s.innerWidth||t.documentElement.clientWidth||t.body.clientWidth||0,height:s.innerHeight||t.documentElement.clientWidth||t.body.clientWidth||0}),this.sendStats(null,e.data)})),this.on("slideVideoPlay",(e=>{e.stopAll(),n(e.data.slide.index)})),this.on("slideVideoPause",(e=>{e.stopAll()})),this.on("slideVideoEnd",(e=>{e.stopAll(),i(e.data.slide.index)})),this.on("contentLoaded",(e=>{e.stopAll(),t(e.data.slide.index)})),this.on("componentEvent",(e=>{const o=e.data.type;switch(e.stopAll(),o){case"init":(this.index===e.data.slide.index||this.slides[this.index]&&this.slides[this.index].spinInited)&&(this.addControllWrapper(),this.enableFullscreenButton(),this.visibleFullscreenButton()),this.sendEvent("componentEvent",e.data);break;case"ready":this.index!==e.data.slide.index||"spin"===e.data.component||this.slides[e.data.slide.index].videoSlide&&!this.isFullscreenState()||(this.addControllWrapper(),this.enableFullscreenButton(),this.visibleFullscreenButton()),this.sendEvent("componentEvent",e.data);break;case"rotate":this.sendEvent("componentEvent",e.data);break;case"fullscreenIn":"video"===e.data.component?this.sendEvent("componentEvent",e.data):this.option("fullscreen.enable")&&this.isFullscreen===s.FULLSCREEN.CLOSED&&this.enterFullScreen();break;case"fullscreenOut":"video"===e.data.component?this.sendEvent("componentEvent",e.data):this.exitFullScreen();break;case"pinchStart":this.isComponentPinching=!0;break;case"pinchEnd":this.isComponentPinching=!1;break;case"zoomIn":this.isZoomIn=!0,n(e.data.slide.index),this.sendEvent("componentEvent",e.data);break;case"zoomOut":this.isZoomIn=!1,i(e.data.slide.index),this.sendEvent("componentEvent",e.data);break;case"hotspotOpened":n(e.data.slide.index);break;case"hotspotClosed":i(e.data.slide.index);break;case"spinStart":n(e.data.slide.index);break;case"spinEnd":i(e.data.slide.index);break;case"play":case"resume":"video"===e.data.component&&(n(e.data.slide.index),this.sendEvent("componentEvent",e.data));break;case"pause":"video"===e.data.component&&this.sendEvent("componentEvent",e.data);break;case"end":"video"===e.data.component&&(i(e.data.slide.index),this.sendEvent("componentEvent",e.data));break;case"seek":this.sendEvent("componentEvent",e.data);break;case"contentLoaded":t(e.data.slide.index)}})),this.on("goTo"+e,(e=>{e.stopAll(),this.option("fullscreen.enable")&&this.isFullscreen===s.FULLSCREEN.CLOSED&&this.enterFullScreen()})),this.on("goTo"+e+"Out",(e=>{e.stopAll(),this.exitFullScreen()})),this.on("infoReady",(t=>{if(t.stop(),this.isFullscreen===s.FULLSCREEN.OPENED){const s=this.slides[t.data.index];s.broadcast("before"+e+"In",{data:{pseudo:this.isPseudo}}),s.broadcast("after"+e+"In",{data:{pseudo:this.isPseudo}})}})),this.on((e=>{e.stopAll()}))}normalizeOptions(){const e=y(["contextmenu.text.zoom.in","contextmenu.text.zoom.out","contextmenu.fullscreen.enter","contextmenu.fullscreen.exit","contextmenu.text.download"]);"auto"===this.option("fullscreen.thumbnails.size")&&this.option("fullscreen.thumbnails.size",this.option("thumbnails.size")),"off"===this.option("slide.animation.type")&&this.option("slide.animation.type",!1),"grid"===this.option("thumbnails.type")&&(this.isStandardGrid=!0,this.option("thumbnails.type","square")),"grid"===this.option("fullscreen.thumbnails.type")&&(this.isFullscreenGrid=!1,this.option("fullscreen.thumbnails.type","square")),e.forEach((e=>{var t;t=this.option(e),"string"===v.typeOf(t)&&""===t.trim()&&this.option(e,!1)})),this.option("thumbnails.enable")&&this.option("thumbnails.target")&&""===this.option("thumbnails.target").trim()&&this.option("thumbnails.target",!1),!this.option("slide.socialbuttons.enable")||this.option("slide.socialbuttons.types.facebook")||this.option("slide.socialbuttons.types.twitter")||this.option("slide.socialbuttons.types.linkedin")||this.option("slide.socialbuttons.types.reddit")||this.option("slide.socialbuttons.types.tumblr")||this.option("slide.socialbuttons.types.pinterest")||this.option("slide.socialbuttons.types.telegram")||this.option("slide.socialbuttons.enable",!1),this.slideOptions.sbEnable=this.option("slide.socialbuttons.enable")}addControllWrapper(){!this.controlsWrapperWasAppended&&this.controlsWrapper.node.childNodes.length&&(this.controlsWrapperWasAppended=!0,this.slideWrapper.append(this.controlsWrapper))}postInitialization(){if(!this.isInitialized&&this.isInView&&this.isSelectorsReady&&this.isToolStarted&&this.isStartedFullInit){if(this.isInitialized=!0,this.hasSize||this.setContainerSize(),this.broadcast("inView",{data:this.isInView}),this.createArrows(),this.selectors&&(this.selectors.inView(this.isInView,this.instanceNode),this.selectors.activateItem(this.index)),!v.browser.mobile){const e=["edge","ie"].includes(v.browser.uaName)?"pointerout":"mouseout";this.movingContainer.addEvent(e,(e=>{if(e.pointerType&&"mouse"!==e.pointerType)return;let t=e.related;for(;t&&t!==this.movingContainer.node;)t=t.parentNode;this.movingContainer.node!==t&&null!==this.index&&this.slides[this.index].mouseAction("mouseout",e)}))}this.slides.length>1&&this.initTouchDrag(),y(v.W).addEvent("resize",this.onResizeHandler),this.showHideArrows(),this.showHideSelectors(),this.option("fullscreen.always")&&this.slideWrapper.addClass(s.CSS_CURSOR_FULSCREEN_ALWAYS),this.movingContainer.attr("id",this.movingContainerId),this.createFullscreenButton(),this.addControllWrapper(),!this.slides[this.index]||this.slides[this.index].sirv||this.slides[this.index].videoSlide&&!this.isFullscreenState()||(this.enableFullscreenButton(),this.visibleFullscreenButton()),this.checkLoop(this.index),this.movingContainer.setCssProp("font-size",""),this.option("fullscreen.history")&&y(v.W).addEvent("popstate",this.onHistoryStateChange),this.autoplay(),this.isReady=!0,this.sendEvent("ready")}}addHistory(){if(this.option("fullscreen.history")){const e="#sirv-viewer-"+this.fullscreenViewId;if(v.W.node.location.hash!==e){const t={name:"Sirv.viewer",hash:this.fullscreenViewId},s=v.D.node.body.title||"Sirv viewer";try{v.W.node.history.state&&"Sirv.viewer"===v.W.node.history.state.name&&v.W.node.history.replaceState(null,s,""),v.W.node.history.pushState(t,s,e)}catch(e){}}}}setContainerSize(){let e=!1,t=0;this.selectors&&(t=this.selectorsWrapper.size[this.selectors.shortSide]);const i=this.movingContainer.size,n=this.option("thumbnails.position"),o=this.option("thumbnails.enable")&&this.canShowSelectors(this.slides.length)&&t>0&&!this.externalContainer;if(i.width||i.height)if(e=!0,this.isFullscreen===s.FULLSCREEN.OPENED)this.movingContainer.setCssProp("height",""),this.slideWrapper.setCssProp("height","");else if(this.doSetSize&&this.heightProportion){o&&["left","right"].includes(n)&&(i.width-=t);let e=i.width*(this.heightProportion.height/this.heightProportion.width);e>this.heightProportion.height&&(e=this.heightProportion.height),!o||["left","right"].includes(n)&&!this.isStandardGrid?this.movingContainer.setCssProp("height",e+"px"):this.slideWrapper.setCssProp("height",e+"px")}return e}findSlideIndex(e){let t=-1;for(let s=0,i=this.slides.length;s<i;s++)if(this.slides[s].id&&this.slides[s].id===e){t=this.slides[s].index;break}return t}getCountOfEnabledSlides(e){let t=this.enabledIndexesOfSlides.length;return e&&(t=this.slides.length-t),t}getItems(e){let t=null,s=this.slides;e&&(v.defined(e.enabled)&&(t=e.enabled),e.group&&(s=this.getSlidesByGroup(e.group)));const i=[];return s.forEach((e=>{!0===t?e.enabled&&i.push(e.api):!1===t&&e.enabled||i.push(e.api)})),i}controlEnabledSlides(e,t){t?this.enabledIndexesOfSlides.splice(this.enabledIndexesOfSlides.indexOf(e),1):(this.enabledIndexesOfSlides.push(e),this.enabledIndexesOfSlides=this.enabledIndexesOfSlides.sort(((e,t)=>{let s=0;return e<t?s=-1:e>t&&(s=1),s})))}disableSlide(e,t){let s=!1,i="next";const n=this.slides.length;if("string"===v.typeOf(e)&&(e=this.findSlideIndex(e)),"number"===v.typeOf(e)&&e>=0&&e<this.slides.length&&this.slides[e].enabled){const o=this.slides[e].$J_UUID;this.effect&&this.effect.stop(),this.slides[e].isActive&&(this.index===n-1&&this.option("loop")&&(i=0),this.jump(i,4,!0)||(this.slides[e].beforeHide(),this.slides[e].afterHide())),this.slides[e].enabled&&this.controlEnabledSlides(e,!0),this.slides[e].disable(),this.checkLoop(this.index),this.enabledIndexesOfSlides.length||(this.index=null),this.selectors&&this.selectors.disable(o),t||this.sendEvent("disableItem",{slide:this.slides[e].api}),this.checkSingleSlide(),this.showHideArrows(),this.showHideSelectors(),s=!0}return s}enableSlide(e){let t=!1;if("string"===v.typeOf(e)&&(e=this.findSlideIndex(e)),"number"===v.typeOf(e)&&e>=0&&e<this.slides.length&&!this.slides[e].enabled){this.slides[e].startGettingInfo(),this.slides[e].loadThumbnail(),this.slides[e].enable(),this.slides[e].resize();const i=this.enabledIndexesOfSlides.filter((e=>this.slides[e].slideAvailable));this.enabledIndexesOfSlides.length||(this.index=e),this.slides[e].slideAvailable&&!i.length&&(this.index=e,this.slides[e].loadContent(),this.slides[e].beforeShow(),this.slides[e].afterShow(s.SLIDE_SHOWN_BY.ENABLE)),this.controlEnabledSlides(e),this.checkLoop(this.index),this.selectors&&(this.selectors.enable(this.slides[e].UUID),this.slides[e].slideAvailable&&this.selectors.activateCurrentItemByUUID(this.slides[e].UUID)),this.sendEvent("enableItem",{slide:this.slides[e].api}),this.checkSingleSlide(),this.showHideArrows(),this.showHideSelectors(),t=!0}return t}getSlidesByGroup(e){let t=null;return e&&(t=[],this.slides.forEach((s=>{s.belongsTo(e)&&t.push(s)}))),t}enableGroupOfSlides(e){let t=!1;const s=this.getSlidesByGroup(e);return s&&s.length&&(t=!0,s.forEach((e=>{this.enableSlide(e.index)}))),t}disableGroupOfSlides(e){let t=!1;const s=this.getSlidesByGroup(e);return s&&s.length&&(t=!0,s.forEach((e=>{this.disableSlide(e.index)}))),t}switchGroupOfSlides(e){let t=!1;if(e){this.getItems({enabled:!0}).forEach((t=>{this.slides[t.index].belongsTo(e)||this.disableSlide(t.index)})),t=this.enableGroupOfSlides(e)}return t}jump(e,t,s,i){let n=!1,r=this.option("slide.animation.type"),l=i;const a=["next","prev"].includes(e),h=this.slides.length;if(!this.effect||!this.enabledIndexesOfSlides.length||null===this.index)return n;if(l===v.U&&(l=this.index),!a){const t=this.findSlideIndex(e);t>=0&&(e=t)}const d=o.sliderLib.findIndex(e,l,h,this.option("loop"));if(null===d)return n;if(this.index!==d){if(!this.slides[d].enabled||!this.slides[d].slideAvailable)return a&&(n=this.jump(e,t,s,d)),n;clearTimeout(this.autoplayTimer),a||(e=d>this.index?"next":"prev"),this.checkLoop(d),r&&!s||(r="blank"),this.selectors&&(this.selectors.activateItem(d),this.selectors.jump(d)),this.effect.make({index:this.index,node:this.slides[this.index].node},{index:d,node:this.slides[d].node},{effect:r,direction:e},{whoUse:t}),n=!0}else this.slides[d].secondSelectorClick();return this.index=d,n}checkLoop(e){if(this.arrows){const t=this.enabledIndexesOfSlides.filter((e=>!this.slides[e].selectorPinned&&this.slides[e].slideAvailable)).length;if(t<2)this.arrows.disable("backward"),this.arrows.disable("forward");else if(this.option("loop"))this.arrows.disable();else{const s=this.enabledIndexesOfSlides.indexOf(e);this.arrows.disable(),0!==s&&1!==t||this.arrows.disable("backward"),s!==t-1&&1!==t||this.arrows.disable("forward")}}}createFullscreenButton(){this.option("fullscreen.enable")&&!this.fullscreenButton&&(this.fullscreenButton=v.$new("div").addClass("smv-button").addClass("smv-button-fullscreen").addClass(t),this.fullscreenButton.append(v.$new("div").addClass("smv-icon")),this.slides[this.index].spinInited?(this.enableFullscreenButton(),this.visibleFullscreenButton()):(this.disableFullscreenButton(),this.hideFullscreenButton()),this.fullscreenButton.addEvent(["btnclick","tap"],(e=>{e.stop(),this.isFullscreen!==s.FULLSCREEN.CLOSED&&this.isFullscreen!==s.FULLSCREEN.OPENED||(this.disableFullscreenButton(),this.hideFullscreenButton(),this.isFullscreen===s.FULLSCREEN.CLOSED?this.enterFullScreen():this.exitFullScreen())})),this.controlsWrapper.append(this.fullscreenButton),this.slides[this.index].slideReady&&setTimeout((()=>{this.slides[this.index].videoSlide&&!this.isFullscreenState()||(this.enableFullscreenButton(),this.visibleFullscreenButton())}),0))}visibleFullscreenButton(){this.fullscreenButton&&this.fullscreenButton.removeClass(a)}hideFullscreenButton(){this.fullscreenButton&&this.fullscreenButton.addClass(a)}enableFullscreenButton(){this.fullscreenButton&&this.fullscreenButton.removeAttr("disabled")}disableFullscreenButton(){this.fullscreenButton&&this.fullscreenButton.attr("disabled","disabled")}createEffect(){this.effect=new I({time:this.option("slide.animation.duration"),orientation:this.option("orientation")}),this.effect.parentClass=this,this.on("effectStart",(e=>{e.stopAll(),this.isMoving=!0,this.disableFullscreenButton(),this.slides[e.indexes[1]].videoSlide&&this.isFullscreen!==s.FULLSCREEN.OPENED&&this.hideFullscreenButton(),this.slides[e.indexes[0]].beforeHide(),this.slides[e.indexes[1]].beforeShow(),4!==e.data.callbackData.whoUse&&(this.sendEvent("beforeSlideIn",{slide:this.slides[e.indexes[1]].api}),this.sendEvent("beforeSlideOut",{slide:this.slides[e.indexes[0]].api}))})),this.on("effectEnd",(e=>{e.stopAll(),this.slides[e.indexes[1]].videoSlide&&this.isFullscreen!==s.FULLSCREEN.OPENED||(this.enableFullscreenButton(),this.visibleFullscreenButton()),this.slides[e.indexes[0]].afterHide(),this.slides[e.indexes[1]].afterShow(e.data.callbackData.whoUse),4!==e.data.callbackData.whoUse&&(this.sendEvent("afterSlideIn",{slide:this.slides[e.indexes[1]].api}),this.sendEvent("afterSlideOut",{slide:this.slides[e.indexes[0]].api})),this.autoplay(),this.isMoving=!1,this.residualAutoplayTime=this.autoplayDelay}))}createArrows(){const e=this.option;e("arrows")&&(this.arrows=new O({orientation:e("orientation")}),this.arrows.hide(),this.arrows.parentClass=this,this.on("arrowAction",(e=>{e.stopAll();const t=this.getNextIndex(e.data.type,this.index,this.slides.length,this.option("loop"));this.jump(t,2)})),this.arrows.nodes.forEach((e=>{this.controlsWrapper.append(e)})))}getNextIndex(e,t,s,i){const n=o.sliderLib.findIndex(e,t,s,i);let r=n;return null===n||n===this.index||!this.slides[n].selectorPinned&&this.slides[n].slideAvailable&&this.slides[n].enabled||(r=this.getNextIndex(e,n,s,i)),r}isHiddenSlides(){return!this.slides.some((e=>!e.customSelector||e.customSelector&&e.slideAvailable))}createSelectors(){const e=this.option;e("thumbnails.enable")||e("fullscreen.thumbnails.enable")?(this.selectors=new P(this.slides.filter((e=>e.selectorData)).map((e=>e.selectorData)),{isStandardGrid:this.isStandardGrid,standardStyle:e("thumbnails.type"),standardSize:e("thumbnails.size"),standardPosition:!!e("thumbnails.enable")&&e("thumbnails.position"),standardWatermark:e("thumbnails.watermark"),isFullscreenGrid:this.isFullscreenGrid,fullscreenStyle:e("fullscreen.thumbnails.type"),fullscreenSize:e("fullscreen.thumbnails.size"),fullscreenPosition:!!e("fullscreen.thumbnails.enable")&&e("fullscreen.thumbnails.position"),fullscreenAutohide:e("fullscreen.thumbnails.autohide"),fullscreenWatermark:e("fullscreen.thumbnails.watermark"),arrows:e("arrows")}),this.selectors.parentClass=this,this.on("selectorsReady",(e=>{e.stopAll(),this.isSelectorsReady=!0,this.postInitialization()})),this.on("getSelectorProportion",(e=>{e.stopAll();const t=this.getSlideByUUID(e.data.UUID);if(null!==t){const s=this.slides[t];if(s){const t={size:null,isSirv:!0};s.getSelectorProportion().then((i=>{t.isSirv=s.isSirvSelector(),t.size=i.size,e.data.resultingCallback(t)})).catch((i=>{t.isSirv=s.isSirvSelector(),this.pickOut(i.UUID),e.data.resultingCallback(t)}))}else e.data.resultingCallback(null)}else e.data.resultingCallback(null)})),this.on("getSelectorImgUrl",(e=>{e.stopAll();const t=this.getSlideByUUID(e.data.UUID);if(null!==t){const s=this.slides[t];s?s.getSelectorImgUrl(e.data.type,e.data.size,e.data.crop,e.data.watermark).then((t=>{e.data.resultingCallback({src:t.src,srcset:t.srcset,size:t.size,alt:t.alt,referrerpolicy:t.referrerpolicy})})).catch((t=>{e.data.resultingCallback(null)})):e.data.resultingCallback(null)}else e.data.resultingCallback(null)})),this.on("changeSlide",(e=>{e.stopAll();const t=this.getSlideByUUID(e.data.UUID);if(null!==t){const e=this.option("fullscreen.enable")&&this.option("fullscreen.always");this.slides[t].customSelector&&this.sendEvent("thumbnailClick",{slide:this.slides[t].api}),this.jump(t,2,e),e&&this.enterFullScreen()}})),this.on("visibility",(e=>{switch(e.stop(),e.action){case"show":this.movingContainer.removeClass("smv-selectors-closed");break;case"hide":this.movingContainer.addClass("smv-selectors-closed")}})),this.on("selectorsDone",(e=>{e.stopAll(),["left","right"].includes(this.selectors.currentStylePosition)&&this.onResize()})),this.selectorsWrapper.append(this.selectors.node),this.slides.forEach(((e,t)=>{e.enabled||this.selectors.disable(e.UUID)})),this.showHideSelectors(!0)):this.isSelectorsReady=!0}findSlide(){let e=this.instanceNode.attr("data-src");if(e){let t,i;try{this.viewerFileContent?t=this.viewerFileContent:(t=e.split("?")[0],t=t.split("."),t=t[t.length-1])}catch(e){}"spin"===t||o.isVideo(e)?(i=v.$new("div",{"data-src":e}),t=s.SLIDE.TYPES.SPIN):[this.instanceNode.attr("data-type"),this.instanceNode.attr("data-effect")].includes("zoom")?(t=s.SLIDE.TYPES.ZOOM,i=v.$new("div",{"data-type":"zoom","data-src":e})):(t=s.SLIDE.TYPES.IMAGE,i=v.$new("img",{"data-src":e})),this.viewerFileContent&&i.store("view-content",t),this.instanceNode.append(i)}else e=this.instanceNode.attr("data-bg-src"),e&&this.instanceNode.append(v.$new("img",{"data-src":e}));return this.getSlides(!0)}canPinSlide(e){const t=N.findPinnedSelectorSide(e);return this.slides.filter((e=>e.pinnedSelectorSide===t)).length<3}getSlideByUUID(e){let t=null;for(let s=0,i=this.slides.length;s<i;s++){if(this.slides[s].UUID===e){t=s;break}}return t}pickOut(e){const t=this.getSlideByUUID(e);null!==t&&(this.removeSlide(t),this.slides.length?(this.slides.length<2&&(this.option("thumbnails.enable")||this.option("fullscreen.thumbnails.enable"))&&(this.changeClasses(this.classes.standard,!0),this.setContainerSize()),this.isToolStarted||this.searchingOfProportions(),this.postInitialization()):this.emit("destroy",{data:{id:this.id,node:this.instanceNode.node}}))}getSlides(e){let t;e?t=Array.from(this.instanceNode.node.childNodes):(t=Array.from(this.instanceNode.node.childNodes).filter((e=>{let t=!1;return this.sliderNodes.push(e.cloneNode(!0)),e.tagName&&["div","img","iframe","figure","video","picture",b].includes(y(e).tagName)&&(t=!0),e.parentNode.removeChild(e),t})),t=(e=>{const t=[];let s=0,i=0;for(let n=0,o=e.length;n<o;n++){let o=e[n];o.querySelector(b)&&(o=o.querySelector(b));const r=v.$(o).attr("data-pinned"),l=o.hasAttribute("data-pinned");i>=3&&"start"===r||s>=3&&(l&&r&&("end"===r||"end"!==r&&"start"!==r)||l&&!r)||(i<3&&"start"===r&&i++,(s<3&&l&&r&&("end"===r||"end"!==r&&"start"!==r)||l&&!r)&&s++,t.push(e[n]))}return t})(t));let n=t.map((e=>N.parse(e)));return i.viewerFilters.forEach((e=>{let t=[].concat(n);t=t.map((e=>{const t={};return Object.entries(e).forEach((e=>{"type"===e[0]&&(e[1]=s.SLIDE.NAMES[e[1]]),o.createReadOnlyProp(t,...e)})),t}));const i=e(this.id,t);Array.isArray(i)&&(n=i.map((e=>{let t=e;for(let s=0,i=n.length;s<i;s++)if(e.node===n[s].node){t=n.splice(s,1)[0];break}return t})))})),t=n,e||t.length||(t=this.findSlide()),t=o.sortSlidesByOrder(this.option("itemsOrder"),t),t}createSlides(e){let t=0;e.forEach((e=>{if(!N.isSirvComponent(e.node)||N.hasComponent(e.node)){if((e=y(e.node)).tagName===b){const t=v.$new("div");e.attr("data-id")&&t.attr("data-id",e.attr("data-id")),e.attr("data-group")&&t.attr("data-group",e.attr("data-group")),t.append(e),e=t}e.addClass("smv-component");const s=new N(e.node,t,this.slideOptions);s.parentClass=this,this.slides.push(s),s.enabled&&s.slideAvailable&&this.enabledIndexesOfSlides.push(t),t+=1}})),this.firstSlideAhead=this.enabledIndexesOfSlides.length>8,this.enabledIndexesOfSlides.forEach(((e,t)=>{(!this.firstSlideAhead||t<8||t===this.index)&&this.slides[e].startGettingInfo()})),this.index>this.slides.length-1&&(this.index=0),this.postInitialization()}checkSingleSlide(){const e=1===this.enabledIndexesOfSlides.length;this.enabledIndexesOfSlides.forEach((t=>{this.slides[t].single(e)}))}showHideArrows(){if(this.arrows){const e=this.visibleSlides();e<2||this.option("fullscreen.always")&&!this.isFullscreenState()?this.arrows.hide():e>1&&(!this.option("fullscreen.always")||this.isFullscreenState())&&this.arrows.show()}}canShowSelectors(e){const t=this.isFullscreen===s.FULLSCREEN.OPENED?"fullscreen.thumbnails.always":"thumbnails.always";return this.option(t)||e>1}showHideSelectors(e){this.selectors&&(this.selectorsDebounce||(this.selectorsDebounce=o.debounce((()=>{if(this.selectors){this.canShowSelectors(this.enabledIndexesOfSlides.length)?this.selectors.isSelectorsActionEnabled()||(this.movingContainer.setCssProp("height","100%"),this.selectorsWrapper.removeClass("smv-hide-selectors"),this.selectors.enableActions(),this.onResize()):this.selectors.isSelectorsActionEnabled()&&(this.selectorsWrapper.addClass("smv-hide-selectors"),this.selectors.disableActions(),this.onResize())}}),e?0:32)),this.selectorsDebounce())}getAvailableSlideIndex(e){return e!==this.slides.length-1||this.slides[e].slideAvailable?this.slides[e+1].slideAvailable?e+1:this.getAvailableSlideIndex(e+1):-1}addAvailableSlideNode(e,t){const s=e.node,i=this.slides.length;if(e.slideAvailable)if(i>1&&t!==i-1)if(this.slides[t+1].slideAvailable)this.slidesContainer.node.insertBefore(s.node,this.slides[t+1].node.node);else{const e=this.getAvailableSlideIndex(t);e<0?this.slidesContainer.append(s):this.slidesContainer.node.insertBefore(s.node,this.slides[e].node.node)}else this.slidesContainer.append(s)}sortItems(e){if(Array.isArray(e)||(e=this.option("itemsOrder")),e.length){this.slides=o.sortSlidesByOrder(e,this.slides),this.selectors&&this.selectors.sortSelectors(this.slides.map((e=>e.UUID)),e.length),this.slides.forEach(((e,t)=>{e.newIndex=t}));for(let e=0,t=this.slides.length;e<t;e++)if(this.slides[e].slideActive){this.index=this.slides[e].index;break}}}insertSlide(t,i){const n=i.querySelector(b)||i;if(N.findPinnedSelectorSide(n)&&!this.canPinSlide(n))return!1;if(v.defined(t)||(t=this.slides.length+1),"number"===v.typeOf(t)&&t>=0&&i&&(!N.isSirvComponent(i)||N.hasComponent(i))){y(i).addClass("smv-component"),t>this.slides.length&&(t=this.slides.length),clearTimeout(this.timerRemove);const n=new N(i,t,this.slideOptions,!0);n.parentClass=this,this.slides.splice(t,0,n);let o=null===this.index;return null===this.index?n.enabled&&n.slideAvailable?this.index=t:o=!1:t<=this.index&&(this.index+=1),this.enabledIndexesOfSlides=[],this.slides.forEach(((e,t)=>{e.newIndex=t,e.enabled&&this.controlEnabledSlides(t)})),this.addAvailableSlideNode(n,t),this.addComponentsCSS(),n.appendToDOM(),n.initVideoPlayer(),n.startGettingInfo(),n.loadThumbnail(),n.startFullInit(null),n.startTool(this.index===t,!this.firstSlideAhead&&this.option("slide.preload"),this.firstSlideAhead),n.broadcast("inView",{data:this.isInView}),this.index===t&&(n.loadContent(),n.beforeShow(),n.afterShow(s.SLIDE_SHOWN_BY.INIT)),this.isFullscreen!==s.FULLSCREEN.OPENED||n.sirv||(n.broadcast("before"+e+"In",{data:{pseudo:this.isPseudo}}),n.broadcast("after"+e+"In",{data:{pseudo:this.isPseudo}})),this.checkLoop(this.index),this.selectors&&(this.selectors.insert(t,n.selectorData),o&&this.selectors.activateItem(this.index)),this.checkSingleSlide(),this.showHideSelectors(),this.showHideArrows(),!0}return!1}removeSlide(e){let t=!1;if("string"===v.typeOf(e)&&(e=this.findSlideIndex(e)),"number"===v.typeOf(e)&&e>=0&&e<this.slides.length){const s=this.slides[e].$J_UUID;return this.slides[e].enabled?this.disableSlide(e,!0):t=!0,this.slides[e].destroy(),this.slides.splice(e,1),this.enabledIndexesOfSlides=[],this.slides.forEach(((e,t)=>{e.newIndex=t,e.enabled&&this.controlEnabledSlides(t)})),this.selectors&&this.selectors.pickOut(s),null!==this.index&&e<=this.index&&0!==this.index&&(this.index-=1),t&&this.checkSingleSlide(),this.isHiddenSlides()&&(this.timerRemove=setTimeout((()=>{this.instanceNode&&this.emit("destroy",{data:{id:this.id,node:this.instanceNode.node}})}),100)),!0}return!1}createContextMenu(){const e=this.option,t=[];e("contextmenu.enable")?((e("contextmenu.text.zoom.in")||e("contextmenu.text.zoom.out"))&&(e("contextmenu.text.zoom.in")&&t.push({id:"zoomin",label:e("contextmenu.text.zoom.in"),hidden:!1,action:e=>{this.slides[this.index].zoomIn(e.left,e.top)}}),e("contextmenu.text.zoom.out")&&t.push({id:"zoomout",label:e("contextmenu.text.zoom.out"),disabled:!0,hidden:!1,action:e=>{this.slides[this.index].zoomOut(e.left,e.top)}})),e("fullscreen.enable")&&(e("contextmenu.text.fullscreen.enter")||e("contextmenu.text.fullscreen.exit"))&&(e("contextmenu.text.fullscreen.enter")&&t.push({id:"enterfullscreen",label:e("contextmenu.text.fullscreen.enter"),hidden:!e("fullscreen.enable"),action:()=>{this.enterFullScreen()}}),e("contextmenu.text.fullscreen.exit")&&t.push({id:"exitfullscreen",label:e("contextmenu.text.fullscreen.exit"),hidden:!0,action:()=>{this.exitFullScreen()}})),e("contextmenu.text.download")&&(t.length&&t.push({id:"sirv-separator",hidden:!1,separator:!0}),t.push({id:"download",label:e("contextmenu.text.download"),action:()=>{let e;const t=this.slides[this.index].originImageUrl;t&&(e=v.$new("iframe").setCss({width:0,height:0,display:"none"}).appendTo(v.D.node.body),e.node.src=t+"?format=original&dl")}})),this.movingContainer.addEvent("contextmenu",(t=>{let i,n,o=!1,r=!0,l=!1,a=!1,h=!1;const d="zoomin",c="zoomout",u="enterfullscreen",p="exitfullscreen";if(t.stopDefaults(),this.contextMenu&&!this.isMoving&&this.enabledIndexesOfSlides.length){const t=this.slides[this.index],m=t.typeOfSlide,f=s.SLIDE.TYPES;if(this.isReady&&t.isReady&&t.sirv&&m){const s=t.options;switch(m){case f.SPIN:i=!0;break;case f.ZOOM:i="deep"===s.mode;break;case f.IMAGE:break;case f.VIDEO:r=!1}i&&this.slides[this.index].zoomSizeExist&&(e("contextmenu.text.zoom.in")||e("contextmenu.text.zoom.out"))?(n=this.slides[this.index].zoomData,this.contextMenu.showItem(d),n.isZoomed&&1===n.zoom?this.contextMenu.disableItem(d):this.contextMenu.enableItem(d),this.contextMenu.showItem(c),n.isZoomed?this.contextMenu.enableItem(c):this.contextMenu.disableItem(c),l=!0):(this.contextMenu.hideItem(d),this.contextMenu.hideItem(c)),e("fullscreen.enable")&&(this.isFullscreenState()?(this.contextMenu.hideItem(u),this.contextMenu.isExist(p)&&(this.contextMenu.showItem(p),n&&n.isZoomed?this.contextMenu.disableItem(p):this.contextMenu.enableItem(p),a=!0)):(this.contextMenu.isExist(u)&&(this.contextMenu.showItem(u),n&&n.isZoomed?this.contextMenu.disableItem(u):this.contextMenu.enableItem(u),a=!0),this.contextMenu.hideItem(p))),this.contextMenu.isExist("download")&&r?(this.contextMenu.showItem("download"),h=!0):this.contextMenu.hideItem("download"),(l||a||h)&&((l||a)&&h&&m!==f.VIDEO?this.contextMenu.showItem("sirv-separator"):this.contextMenu.hideItem("sirv-separator"),o=!0,this.broadcast("stopContext"))}this.contextMenu.canShow=o}})),t.length&&!v.browser.mobile&&(this.contextMenu=new l(this.movingContainer,t,"sirv"),e("fullscreen.enable")&&(this.contextMenu.fullScreenBox=this.fullScreenBox))):this.movingContainer.addEvent("contextmenu",(e=>{e.stop()}))}enterFullScreen(){if(this.isFullscreen!==s.FULLSCREEN.CLOSED)return!1;this.addHistory(),this.isFullscreen=s.FULLSCREEN.OPENING,this.fullscreenStartTime=Date.now();const t=!this.option("fullscreen.native")||!v.browser.fullScreen.capable||!v.browser.fullScreen.enabled();return A&&A.appendTo(v.D.node.body),this.disableFullscreenButton(),this.hideFullscreenButton(),this.selectors&&(this.setClasses(),this.option("fullscreen.thumbnails.enable")&&this.appendSelectors(),this.selectors.beforeEnterFullscreen()),this.slideWrapper.removeClass(s.CSS_CURSOR_FULSCREEN_ALWAYS),this.fullScreenBox.setCss({position:"fixed",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",zIndex:99999999999}),this.boxSize=this.instanceNode.size,this.boxBoundaries=this.instanceNode.rect,this.fullScreenBox.append(this.movingContainer),y(v.D.node.body).append(this.fullScreenBox),this.movingContainer.setCssProp("height","100%"),this.broadcast("before"+e+"In",{data:{pseudo:t}}),this.slideWrapper.setCssProp("height",""),u&&this.productDetail&&this.productDetail.open(),v.browser.fullScreen.request(this.fullScreenBox,{windowFullscreen:!this.option("fullscreen.native"),onEnter:this.onEnteredFullScreen.bind(this),onExit:()=>{[s.FULLSCREEN.CLOSED,s.FULLSCREEN.OPENING].includes(this.isFullscreen)||(this.isFullscreen=s.FULLSCREEN.CLOSING,this._beforeExitFullscreen(),this.broadcast("before"+e+"Out",{data:{pseudo:!1}}),this.onExitFullScreen())},fallback:()=>{const e=v.D.node.getElementsByTagName("html")[0];y(e).addClass(h),y(document.body).render(),setTimeout((()=>this.onEnteredFullScreen(!0)),64)}}),!0}onEnteredFullScreen(i){if(this.isFullscreen!==s.FULLSCREEN.OPENING)return;this.isPseudo=i,i&&this.isFullscreen===s.FULLSCREEN.OPENING&&(this.fullScreenBox.setCss({top:A?Math.abs(A.node.getBoundingClientRect().top):0,left:0,right:0,bottom:0,width:"auto",height:A?v.W.node.innerHeight:"auto",display:this.productDetail?"flex":"block",position:"fixed"}),v.D.addEvent("keydown",this.pseudoFSEvent)),this.isFullscreen=s.FULLSCREEN.OPENED,this.fullscreenButton&&(this.fullscreenButton.removeClass(t),this.fullscreenButton.addClass(n),this.slides[this.index]&&this.slides[this.index].videoSlide&&this.isFullscreen!==s.FULLSCREEN.OPENED||setTimeout((()=>{this.enableFullscreenButton(),this.visibleFullscreenButton()}),1)),this.selectors&&this.selectors.afterEnterFullscreen(),this.slides.length>1&&v.D.addEvent("keyup",this.keyBoardArrowsCallback),this.showHideArrows(),this.showHideSelectors(),this.broadcast("after"+e+"In",{data:{pseudo:i}}),this.onResize();let o={};this.enabledIndexesOfSlides.length&&(o={slide:this.slides[this.index].api}),this.sendEvent("fullscreenIn",o)}_beforeExitFullscreen(){this.disableFullscreenButton(),this.hideFullscreenButton(),this.option("fullscreen.always")&&this.slideWrapper.addClass(s.CSS_CURSOR_FULSCREEN_ALWAYS),this.selectors&&(this.option("fullscreen.thumbnails.enable")&&this.appendSelectors(),this.setClasses(),this.selectors.beforeExitFullscreen()),u&&this.productDetail&&this.productDetail.close()}exitFullScreen(){if(this.isFullscreen!==s.FULLSCREEN.OPENED)return!1;if(this.isFullscreen=s.FULLSCREEN.CLOSING,this._beforeExitFullscreen(),A&&A.remove(),v.browser.fullScreen.capable&&v.browser.fullScreen.enabled()&&this.option("fullscreen.native"))this.broadcast("before"+e+"Out",{data:{pseudo:!1}}),v.browser.fullScreen.cancel.call(document);else{const t=v.D.node.getElementsByTagName("html")[0];y(t).removeClass(h),this.broadcast("before"+e+"Out",{data:{pseudo:!0}}),this.onExitFullScreen(!0)}return!0}onExitFullScreen(i){if([s.FULLSCREEN.CLOSED,s.FULLSCREEN.OPENING].includes(this.isFullscreen))return;if(v.D.removeEvent("keyup",this.keyBoardArrowsCallback),this.showHideArrows(),this.showHideSelectors(),this.instanceNode.append(this.movingContainer),this.fullScreenBox.remove(),this.fullscreenButton&&(this.fullscreenButton.removeClass(n),this.fullscreenButton.addClass(t),this.slides[this.index]&&this.slides[this.index].videoSlide&&this.isFullscreen!==s.FULLSCREEN.OPENED||setTimeout((()=>{this.enableFullscreenButton(),this.visibleFullscreenButton()}),1)),this.option("fullscreen.history")){const e="#sirv-viewer-"+this.fullscreenViewId;try{v.W.node.location.hash===e&&v.W.node.history.back()}catch(e){}}this.isFullscreen=s.FULLSCREEN.CLOSED,this.isPseudo=!1,this.selectors&&this.selectors.afterExitFullscreen(),this.setContainerSize(),this.fullscreenStartTime=null,this.broadcast("after"+e+"Out",{data:{pseudo:i}});let o={};this.enabledIndexesOfSlides.length&&(o={slide:this.slides[this.index].api}),this.sendEvent("fullscreenOut",o),this.onResize()}getSlide(e){var t;return(null===e||"number"===v.typeOf(e)&&e>=this.slides.length)&&(e=this.index),"string"===v.typeOf(e)&&(e=this.findSlideIndex(e)),null==(t=this.slides[e])?void 0:t.api}onResizeWithoutSelectors(){this.destroyed||(A&&this.isFullscreen===s.FULLSCREEN.OPENED&&this.fullScreenBox.setCss({height:v.W.node.innerHeight,top:Math.abs(A.node.getBoundingClientRect().top)}),this.setRootMargin(),this.setContainerSize(),this.slides.forEach((e=>{e.resize()})))}onResize(){this.destroyed||(this.selectors&&this.selectors.onResize(),this.onResizeDebounce())}play(e){let t=!1,s=this.option("slide.delay");return v.defined(e)&&"number"===v.typeOf(e)&&e>9&&(s=e),(null===this.autoplayTimer&&!this.isAutoplay||s!==this.autoplayDelay)&&(this.autoplayDelay=s,this.isAutoplay=!0,this.residualAutoplayTime=this.autoplayDelay,this.autoplay(),t=!0),t}pause(){const e=this.autoplayTimer;return this.isAutoplay=!1,clearTimeout(this.autoplayTimer),this.autoplayTimer=null,this.residualAutoplayTime=this.autoplayDelay,null===e}pauseAutoplay(){clearTimeout(this.autoplayTimer),this.autoplayTimer=null,this.residualAutoplayTime-=Date.now()-this.currentAutoplayTime}autoplay(){if(this.isAutoplay){this.currentAutoplayTime=Date.now();let e=this.autoplayDelay;this.residualAutoplayTime!==e&&(e=this.residualAutoplayTime<1e3?1e3:this.residualAutoplayTime),clearTimeout(this.autoplayTimer),this.autoplayTimer=setTimeout((()=>{this.destroyed||this.jump("next",s.SLIDE_SHOWN_BY.AUTOPLAY)}),e)}}destroy(){this.destroyed=!0,this.onResizeDebounce.cancel(),this.onResizeDebounce=null,clearTimeout(this.autoplayTimer),this.autoplayTimer=null,this.selectorsDebounce&&(this.selectorsDebounce.cancel(),this.selectorsDebounce=null),y(v.W).removeEvent("resize",this.onResizeHandler),this.onResizeHandler=null,y(v.D).removeEvent("keyup",this.keyBoardArrowsCallback),this.inViewModule&&(this.inViewModule.disconnect(),this.inViewModule=null),this.option("fullscreen.history")&&(y(v.W).removeEvent("popstate",this.onHistoryStateChange),s.FULLSCREEN_VIEWERS_IDs_ARRAY.splice(s.FULLSCREEN_VIEWERS_IDs_ARRAY.indexOf(this.fullscreenViewId),1)),this.movingContainer.removeEvent("mouseout"),this.slideWrapper.removeClass(s.CSS_CURSOR_FULSCREEN_ALWAYS),this.clearingTouchdragFunction&&this.clearingTouchdragFunction(),this.slidesContainer.removeEvent("touchdrag"),(e=>{let t=!1;return(e=e.split("-")).splice(e.length-1,1),(e=e.join("-"))===g&&(t=!0),t})(this.id)&&this.instanceNode.removeAttr("id"),this.contextMenu&&(this.movingContainer.removeEvent("contextmenu"),this.contextMenu.destroy(),this.contextMenu=null),this.productDetail&&(this.productDetail.destroy(),this.productDetail=null),this.fullscreenButton&&(this.fullscreenButton.removeEvent(["btnclick","tap"]),this.fullscreenButton.remove()),this.fullscreenButton=null,this.effect&&(this.effect.destroy(),this.effect=null,this.on("effectStart"),this.on("effectEnd")),this.arrows&&(this.arrows.destroy(),this.arrows=null,this.off("arrowAction")),this.selectors&&(this.selectors.destroy(),this.selectors=null,this.off("visibility"),this.off("changeSlide"),this.off("selectorsReady"),this.off("getSelectorImgUrl"),this.off("selectorsDone"),this.off("getSelectorProportion")),this.off("componentEvent"),this.off("goTo"+e),this.off("goTo"+e+"Out"),this.off("infoReady"),this.off("slideVideoPlay"),this.off("slideVideoPause"),this.off("slideVideoEnd"),this.slides.forEach((e=>{const t=e.originNode;y(t).removeClass("smv-component"),e.destroy()})),this.slides=[],this.off("stats"),this.sliderNodes.forEach((e=>this.instanceNode.append(e))),this.sliderNodes=[],y(v.D).removeEvent("keydown",this.pseudoFSEvent),this.pseudoFSEvent=null,y(v.D).removeEvent("keyup",this.keyBoardArrowsCallback),this.keyBoardArrowsCallback=null,this.fullScreenBox.remove(),this.fullScreenBox=null,this.controlsWrapper.remove(),this.controlsWrapper=null,this.slidesContainer.remove(),this.slidesContainer=null,this.selectorsWrapper.remove(),this.selectorsWrapper=null,this.slideWrapper.remove(),this.slideWrapper=null,this.movingContainer.remove(),this.movingContainer=null,this.isReady=!1,this.doSetSize=!1,this.instanceNode=null,this.externalContainer=null,super.destroy()}}})();return(()=>{const e=e=>(Object.entries(e).forEach((([t,s])=>{(s=y(s.split(";"))).length&&(""===s[s.length-1]&&s.splice(s.length-1,1),s=s.map((e=>e.replace(new RegExp("^"+t+"\\."),""))),e[t]=s.join(";"))})),e),t=(e,s)=>{const i=v.typeOf(s);let n,o=null;return"string"===i?o=e[s]:"array"===i&&(n=s.shift(),e[n]&&(o=s.length?t(e[n],s):e[n])),o},s=(e,s,i)=>({common:t(e.common,s)||i,mobile:t(e.mobile,s)||i});return class extends r{constructor(e,t,s,i){super(),this.node=e,this.slider=null,this.lazyInit=i,this.options={},this.spinOptions={},this.zoomOptions={},this.imageOptions={},this.videoOptions={},this.sliderBuilder=new c(t,this.node),this.parseOptions(t),this.privateOptions={common:{},mobile:{}},this.toolOptions=null,this.inViewTimer=null,this.isRun=!1,this.api={isReady:this.isReady.bind(this),items:this.items.bind(this),disableItem:this.disableItem.bind(this),enableItem:this.enableItem.bind(this),enableGroup:this.enableGroup.bind(this),disableGroup:this.disableGroup.bind(this),switchGroup:this.switchGroup.bind(this),insertItem:this.insertItem.bind(this),removeItem:this.removeItem.bind(this),removeAllItems:this.removeAllItems.bind(this),jump:this.jump.bind(this),itemsCount:this.itemsCount.bind(this),next:this.next.bind(this),prev:this.prev.bind(this),isFullscreen:this.isFullscreen.bind(this),fullscreen:this.fullscreen.bind(this),child:this.child.bind(this),play:this.play.bind(this),pause:this.pause.bind(this),sortItems:this.sortItems.bind(this)},this.on("viewerPublicEvent",(e=>{Object.assign(e.data.slider,this.api),e.data.slide&&(e.data.slide.parent=()=>this.api,e.data.slide[e.data.slide.component]&&(e.data.slide[e.data.slide.component].parent=()=>e.data.slide))})),this.makeOptions();const n=this.toolOptions.get("autostart");(n&&"off"!==n||s)&&this.run()}parseOptions(e){const i="viewer",n="spin",o="zoom",r="image",l="video",a=e.common,h=e.mobile;this.options=s(e,i,{}),this.spinOptions={common:t(a,[i,n])||t(a,n)||{},mobile:t(h,[i,n])||t(h,n)||{}},this.zoomOptions={common:t(a,[i,o])||t(a,o)||{},mobile:t(h,[i,o])||t(h,o)||{}},this.imageOptions={common:t(a,[i,r])||t(a,r)||{},mobile:t(h,[i,r])||t(h,r)||{}},this.videoOptions={common:t(a,[i,l])||t(a,l)||{},mobile:t(h,[i,l])||t(h,l)||{}},(e=>{const t=e=>{["spin","zoom","image","video"].forEach((t=>{e[t]&&delete e[t]}))};t(e.common),t(e.mobile)})(this.options)}getSlideOptions(){const e=s(this.privateOptions,"spin",""),t=s(this.privateOptions,"zoom",""),i=s(this.privateOptions,"image",""),n=s(this.privateOptions,"video","");return{spin:{common:this.spinOptions,local:e},zoom:{common:this.zoomOptions,local:t},image:{common:this.imageOptions,local:i},video:{common:this.videoOptions,local:n}}}makeOptions(){const t={spin:/^spin/,zoom:/^zoom/,image:/^image/,video:/^video/};this.toolOptions=new v.Options(C),this.toolOptions.fromJSON(this.options.common),this.privateOptions.common=this.toolOptions.fromString(this.node.attr("data-options")||"",t),this.privateOptions.common=e(this.privateOptions.common),v.browser.touchScreen&&v.browser.mobile&&(this.toolOptions.fromJSON(this.options.mobile),this.privateOptions.mobile=this.toolOptions.fromString(this.node.attr("data-mobile-options")||"",t),this.privateOptions.mobile=e(this.privateOptions.mobile))}createSlider(e){this.slider=new F(this.node,{options:this.toolOptions,slideOptions:this.getSlideOptions(),lazyInit:this.lazyInit,viewerFileContent:e}),this.slider.parentClass=this,this.api.id=this.slider.id}run(e){return this.isRun=!0,this.sliderBuilder.getOptions().then((t=>{this.parseOptions(t.dataOptions),e&&this.makeOptions(),t.content?this.createSlider(t.content):this.sliderBuilder.buildViewer().then((e=>{this.node=e.mainNode,this.createSlider()}))})).catch((e=>{console.log("Sirv: cannot get view from "+e.error)})),!0}isReady(){let e=!1;return this.slider&&(e=this.slider.isReady),e}isFullscreen(){let e=!1;return this.isReady()&&(e=2===this.slider.isFullscreen),e}startFullInit(e,t,s){let i;this.slider&&(this.lazyInit=s,this.parseOptions(e),this.makeOptions(),i=this.toolOptions.get("autostart"),(i&&"off"!==i||t)&&this.slider.startFullInit({options:this.toolOptions,slideOptions:this.getSlideOptions(),lazyInit:this.lazyInit}))}start(){let e=!1;return this.slider||(e=this.run(!0)),e}stop(){let e=!1;return this.slider&&(e=!0,this.slider.destroy(),this.slider=null,this.off("viewerPublicEvent"),this.isRun=!1,this.sliderBuilder.destroy(),this.sliderBuilder=null,this.destroy()),e}insertItem(e,t){let s=!1;if(this.isReady()){if("string"===v.typeOf(e)){const t=v.$new("div");t.node.innerHTML=e.trim(),!(e=t.node.firstChild)||3!==e.nodeType&&8!==e.nodeType&&["div","img",b].includes(y(e).tagName)||(e=null)}else if(y(e).tagName===b){const t=v.$new("div");t.append(e),e=t.node}s=this.slider.insertSlide(t,e)}return s}removeItem(e){let t=!1;return this.isReady()&&(t=this.slider.removeSlide(e)),t}removeAllItems(){let e=!0;if(this.isReady())for(let t=this.itemsCount()-1;t>=0;t--){const s=this.removeItem(t);e&&(e=s)}else e=!1;return e}itemsCount(e){let t=0;if(this.isReady()){const s=this.items(e);null!==s&&(t=s.length)}return t}items(e){let t=null;return this.isReady()&&(t=this.slider.getItems(e),t.forEach((e=>{e.parent=()=>this.api}))),t}disableItem(e){let t=!1;return this.isReady()&&(t=this.slider.disableSlide(e)),t}enableItem(e){let t=!1;return this.isReady()&&(t=this.slider.enableSlide(e)),t}enableGroup(e){let t=!1;return this.isReady()&&(t=this.slider.enableGroupOfSlides(e)),t}disableGroup(e){let t=!1;return this.isReady()&&(t=this.slider.disableGroupOfSlides(e)),t}switchGroup(e){let t=!1;return this.isReady()&&(t=this.slider.switchGroupOfSlides(e)),t}jump(e){let t=!1;return this.isReady()&&(t=this.slider.jump(e)),t}next(){let e=!1;return this.isReady()&&(e=this.slider.jump("next")),e}prev(){let e=!1;return this.isReady()&&(e=this.slider.jump("prev")),e}fullscreen(){let e=!1;return this.isReady()&&(e=this.isFullscreen()?this.slider.exitFullScreen():this.slider.enterFullScreen()),e}child(e){let t=null;var s;return this.isReady()&&(s=e,"number"!==v.typeOf(s)&&"string"!==v.typeOf(s)&&(s=null),e=s,t=this.slider.getSlide(e),t&&(t.parent=()=>this.api)),t}play(e){let t=!1;return this.isReady()&&(t=this.slider.play(e)),t}pause(){let e=!1;return this.isReady()&&(e=this.slider.pause()),e}sortItems(e){this.isReady()&&this.slider.sortItems(e)}isEqual(e){return e===this.node}checkReadiness(e,t){let s=!1;return this.isReady()&&(s=this.slider.checkReadiness(e,t)),s}sendEvent(e,t){this.isReady()&&this.slider.sendReadyEvent(e,t)}}})()}));const w=window,_Sirv={items:{},eventManager:null,options:{}},isLazyImage=!0,baseModules=["magicJS","globalVariables","globalFunctions","EventManager","helper","Slider"];baseModules.push("LazyImage"),w.Sirv.require(baseModules,((e,t,s,i,n,o,r)=>{const l=e,a=(e,t,s)=>{let i=[],n=null;const o=_Sirv.items[t];return o.length&&e&&(n=((e,t)=>{let s=e;return"string"===l.typeOf(s)&&(s=(t||document).querySelector(s)),l.$(s)})(e,s),n&&(i=o.filter((e=>e.node===n)))),i.length?i[0]:null},h=(e,t)=>{let s;return t||(t=document),s="collection"===l.typeOf(e)?e:["element","magicjs-element"].includes(l.typeOf(e))?[e]:Array.from((l.$(t).node||t).querySelectorAll(e||".Sirv")),s},d=e=>{let t=null;return(e=l.$(e)).hasClass("Sirv")&&(t="img"===e.tagName||e.attr("data-bg-src")||e.getCss("background-image")&&"none"!==e.getCss("background-image")?"image":"viewer"),t};_Sirv.items.image=[],_Sirv.items.viewer=[],_Sirv.start=(e,t,i,c)=>{let u=!1;"boolean"===l.typeOf(e)&&(u=e,e=void 0),Array.from(h(e,t)).forEach((e=>{const t=l.$(e);if(e&&t.hasClass("Sirv")){let h=d(t.node);if(i&&i!==h&&(h=null),_Sirv.options.common=n.deepExtend({},l.W.node.SirvOptions||{}),_Sirv.options.mobile=n.deepExtend({},l.W.node.SirvMobileOptions||{}),h&&["image","viewer"].includes(h)){if(!c&&((e,t)=>{let s=!1,i=t;return"image"===i&&(i="lazyImage"),e.common[i]&&(!1===e.common[i].autostart||["false","off"].includes(e.common[i].autostart))&&(s=!0),!s&&l.browser.touchScreen&&l.browser.mobile&&e.mobile[i]&&(!1===e.mobile[i].autostart||["false","off"].includes(e.mobile[i].autostart))&&(s=!0),s})(_Sirv.options,h))return;let i=a(t.node,h);if(i)i.startFullInit(Object.assign({},_Sirv.options),c,u);else switch(h){case"image":s.rootDOM.attachNode(e),s.rootDOM.resetGlobalCSS(e),i=new r(t.node,{options:{common:n.deepExtend({},_Sirv.options.common.lazyImage||{}),mobile:n.deepExtend({},_Sirv.options.mobile.lazyImage||{})}},c),i.isRun?(_Sirv.items.image.push(i),i.parentClass=_Sirv.eventManager):s.rootDOM.detachNode(e);break;case"viewer":s.rootDOM.attachNode(e),s.rootDOM.addMainStyle(e),i=new o(t,Object.assign({},_Sirv.options),c,u),i.isRun?(_Sirv.items.viewer.push(i),i.parentClass=_Sirv.eventManager):s.rootDOM.detachNode(e)}}}}))},_Sirv.stop=(e,t,s)=>{let i=["image","viewer"];s&&(i=[s]),i.forEach((s=>{e||t?Array.from(h(e,t)).forEach((e=>{const t=a(e,s);t&&t.stop()&&_Sirv.items[s].splice(_Sirv.items[s].indexOf(t),1)})):_Sirv.items[s]=_Sirv.items[s].filter((e=>!e.stop(!0)))}))},_Sirv.getInstance=(e,t,s)=>{const i=a(e,t,s);return i?i.api:i},_Sirv.eventManager=new i(_Sirv.items),_Sirv.addFilterCallback=(e,t)=>{t?s.viewerFilters.unshift(e):s.viewerFilters.push(e)},_Sirv.removeFilterCallback=e=>{const t=[];s.viewerFilters.forEach((s=>{s!==e&&t.push(s)})),s.viewerFilters=t},_Sirv.removeAllFilterCallback=()=>{s.viewerFilters=[]},s.stop=(e,t)=>_Sirv.stop(e,null,t);const c=()=>{const e={added:[],removed:[]},t=n.debounce((()=>{const t=e.added.splice(0),i=e.removed.splice(0);t.forEach((e=>{(e=l.$(e)).node&&3!==e.node.nodeType&&8!==e.node.nodeType&&e.node.getElementsByClassName&&(e.hasClass("Sirv")?_Sirv.start(e,null,d(e)):s.rootDOM.rootContains(e.node)&&(e=>{let t=!1;return t=e.closest?!e.closest("div.Sirv"):"trident"===l.browser.engine,t})(e.node)&&_Sirv.start(null,e))}));const n=[];i.forEach((e=>{(e=l.$(e)).node&&3!==e.node.nodeType&&8!==e.node.nodeType&&e.node.getElementsByClassName&&(e.hasClass("Sirv")?n.push(e):[].push.apply(n,e.node.getElementsByClassName("Sirv"))),n.forEach((e=>{if(e=l.$(e),!l.D.node.body.contains(e.node))try{_Sirv.stop(e,null,d(e))}catch(e){}}))}))}),250),i=(s,i)=>{for(let t=0,i=s.length;t<i;t++)"childList"===s[t].type&&([].push.apply(e.added,s[t].addedNodes),[].push.apply(e.removed,s[t].removedNodes));t()};l.W.node.MutationObserver&&new MutationObserver(i).observe(l.D.node.body,{childList:!0,subtree:!0,attributes:!1})};s.rootDOM.resetGlobalCSS(),s.iconsHash.make(),"loading"===l.D.node.readyState&&_Sirv.start(!0),l.D.addEvent("domready",(()=>{_Sirv.start(),c()}))}));const sayDeprecated=e=>{console.log("sirv.js: The method Sirv"+e+".refresh() is deprecated. \r\n         Use Sirv"+e+".stop() and Sirv"+e+".start() instead.")};w.Sirv.version="v3.9.1",w.Sirv.build="ba425205",w.Sirv.options={},w.Sirv.lazyimage={start:(e,t)=>{_Sirv.start(e,t,"image",!0)},stop:(e,t)=>{_Sirv.stop(e,t,"image")},getInstance:(e,t)=>{let s=null;return _Sirv.getInstance&&(s=_Sirv.getInstance(e,"image",t)),s},refresh:()=>{sayDeprecated(".image")},on:(e,t)=>w.Sirv.on(e,t),off:(e,t)=>w.Sirv.off(e,t)},w.Sirv.viewer={start:(e,t)=>{_Sirv.start(e,t,"viewer",!0)},stop:(e,t)=>{_Sirv.stop(e,t,"viewer")},getInstance:(e,t)=>{let s=null;return _Sirv.getInstance&&(s=_Sirv.getInstance(e,"viewer",t)),s},refresh:()=>{sayDeprecated(".viewer")},on:(e,t)=>w.Sirv.on(e,t),off:(e,t)=>w.Sirv.off(e,t),filters:{add:(e,t)=>{_Sirv.addFilterCallback(e,t)},remove:e=>{_Sirv.removeFilterCallback(e)},removeAll:()=>{_Sirv.removeAllFilterCallback()}}},w.Sirv.start=(e,t)=>{_Sirv.start(e,t,null,!0)},w.Sirv.stop=(e,t)=>{_Sirv.stop(e,t)},w.Sirv.getInstance=(e,t,s)=>{let i=null;if(_Sirv.getInstance){i=("lazyimage"===t?w.Sirv.lazyimage:w.Sirv.viewer).getInstance(e,s)}return i},w.Sirv.refresh=()=>{sayDeprecated("")},w.Sirv.on=(e,t)=>_Sirv.eventManager.addEvent(e,t),w.Sirv.off=(e,t)=>_Sirv.eventManager.removeEvent(e,t),w.Sirv.whenReady=e=>e(),w.Sirv.whenLoaded=e=>e();})();}